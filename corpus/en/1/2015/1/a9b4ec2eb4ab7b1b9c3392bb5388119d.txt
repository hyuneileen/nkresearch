Journal of Kim Il Sung University (Natural Science) Vol. 4 No. 1 Juche104(2015) Improvement of Euler Deconvolution to Estimate Parameters of Magnetic Source Jon Kwang Chol Abstract In this paper, I applied interval constraint, which allows discriminating anomalous extremum location and determining anomalous efficient extent and minimum variance criterion between anomalous observed value and calculated value, to obtain good solutions among the Euler solutions. I also applied dispersion between the Euler solutions in order to estimate structural index of magnetic source correctly. The structural index satisfying the minimum dispersion between Euler solutions was estimated as the most approximate to the true structural index. Through synthetic numerical experiments and field data processing, the feasibility of the proposed method was demonstrated. Key words Euler deconvolution, structural index, magnetic anomaly  Introduction  Euler deconvolution method is widely used in the interpretation of magnetic anomaly because it needs a little priori information of the initial model and is capable of large-scale data processing. In this method, scattering solutions that do not relate with the true location of source may occur if applied to the low amplitude data on the periphery of anomalous maximum and if data with weak S/N ratio were used and in the case of using wrong structural index of the magnetic source. In those cases, in order to select good solutions that are concentrated close to the true location of source and reduce scattering solutions, various approaches were applied. For instance, applying  the threshold based on the ratio dispersion to estimated depth [3], and the reducing of solutions out the calculating window as the scattering ones [6], constraint of calculation domain using horizontal derivative or analytical signal amplitude [4, 5] and using Gaussian regular distribution function[1] etc. Those approaches were not focused on the relation between solutions and anomalous field so that they cannot avoid some subjective errors. Using correct structural indices in the application of Euler deconvolution is a vital questio n to obtain correct analysis results. To determine the structural index, mainly two approaches are known; an approach to calculate the structural index directly in the deconvolution procedure was introduced and another one is using of multi indices to calculate Euler deconvolution and then select the correct index. In the reference [7] considered the variation property of structural indices according to the several simple gravity model’s parameter variance while calculating the location and structural indices of gravity anomalous bodies directly. Such this method has to estimate the concentration of structural index calculated in the calculating window solutions. In the reference [2] suggested that it is not proper to estimate － 133 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) depth and structural index simultaneously, for the reason that structural index is linear with respect to depth estimation parameters, so proposed a method which determines the structural index by using minimum correlation coefficient between the estimated background field and observed anomaly. However, this method cannot be applied in the case of using derivative or analytical signal. We suggested interval constraint and minimum variance criterion, which allows distinguishing anomalous extremum location and determining its efficient extent to obtain good solutions among the Euler solutions. We also suggested that the structural index satisfying the minimum dispersion between Euler solutions was estimated as the closest to the true structural index in order to estimate structural index of magnetic source correctly. Through synthetic examples and field examples, the feasibility of the proposed method was demonstrated. 1. Methodology In the 2D-geophysical coordinate, the total magnetic component zxTΔ ,( satisfies the following differential equation; located at the point ( x , 0 z 0 ) ) caused by a source ( x − x ) 0 Δ∂ ) ,( zxT ∂ x + ( z − z ) 0 Δ∂ ) ,( zxT ∂ z Δ−= η ,( zxT ) (1) where η is the structural index related to the source’s geometry. Provided that η is given by the interpreter and the magnetic field is observed on the line , equation (1) is written as 0=z x 0 Δ∂ T ∂ x + z 0 Δ∂ T ∂ z = x Δ∂ T ∂ x Δ+ η T (2) The unknown parameter ( x , 0 z 0 ) , which indicates source’s position, is given by minimum squares method after forming simultaneous equations with field values measured on numerous points. In practice, data window with three, or more than three points is selected and moving the window along measuring line, within each window linier system of equations are solved to obtain the source’s location. Matrix equation to solve the unknown parameters in each window is written by T GPG = T yG (3) where, P is the unknown parameter vector as follows. and P = (4) ⎡ ⎢ ⎣ x 0 z 0 ⎤ ⎥ ⎦ T GG = T yG = ⎡ ⎢ ⎢ ⎢ ⎢ ⎣ T Δ∂ x ∂ T Δ∂ x ∂ , , T Δ∂ x ∂ T Δ∂ z ∂ ⎡ ⎢ ⎢ ⎢ ⎢ ⎣ T Δ∂ x ∂ T Δ∂ z ∂ , x , x T Δ∂ x ∂ T Δ∂ x ∂ T Δ∂ x ∂ T Δ∂ z ∂ , , T Δ∂ z ∂ T Δ∂ z ∂ ⎤ ⎥ ⎥ ⎥ ⎥ ⎦ + η , Δ T + η , Δ T T Δ∂ x ∂ T Δ∂ z ∂ ⎤ ⎥ ⎥ ⎥ ⎥ ⎦ (5) (6) － 134 － Improvement of Euler Deconvolution to Estimate Parameters of Magnetic Source In the equations (5) and (6), the symbol <·> means scalar product within the calculation window. For the sake of convenience, let’s introduce the following expressions; T T Δ∂ Δ∂ z x ∂ ∂ T Δ∂ z ∂ T Δ∂ x ∂ T Δ∂ z ∂ T Δ∂ x ∂ T Δ∂ x ∂ T Δ∂ x ∂ , , , = = = = , d a b c x , , , , , e = Δ T T Δ∂ Δ∂ x x ∂ ∂ )ˆ,ˆ( Then, the estimate of unknown parameter vector x 0 z 0 be cg ( ) η − 2 T Δ∂ z ∂ bd , , cf − = + T = g ˆ x x f 0 , = T Δ∂ z ∂ , Δ T is given by [2] (7) bd − cf − cg ) ˆ z 0 = ab + ab c − ( be η 2 − c (8) 1.1. Discrimination of anomalous extremum location and the selection of efficient extent  While processing the Euler Deconvolution, an interpreter takes a window with certain size and moving it overall data domain, calculates and then obtains good solution with relation to true position of source among the given solutions. Then, in the calculation, if use the anomalous value near the causative source, solutions is concentrated to the true position of source, if not so, solutions do not converge and are dispersed. Therefore, the interval constraint, which discriminates the anomalous extremum position and use the anomalous value near the causative source, is regarded as a reasonable way. From the above consideration, we discriminated anomalous extremum position among the observed anomaly and selected the suitable interval which is used in calculation. In the paper, the extreme points of the analytical signal of magnetic anomaly’s first order vertical derivative was considered as the anomalous extremum position and select the half distance interval between the maximum point and neighbored minimums as an efficient extent, then calculation was performed. 1.2. Scattering solution removing criterion In case of calculating unknown parameters by using the moving calculation windows, scattering solutions appears when the window was located far from the source. The difference between the field values by the using these scattering solutions and observed anomalous value becomes larger than difference between the field values by the using good solutions and observed anomalous value. Therefore, we used following criterion to remove scattering solutions; ,ˆ,ˆ( ′ xj Φ 0 0 )( ηΦλη < z ) (9) where ′ Φ j ,ˆ,ˆ( x 0 0 z Φη = j ( ) ,ˆ,ˆ( x 0 0 z ηΦηΦηΦη ))( ()( )( − − ) , it is a normalized variance and min max min ′ = ΦηΦ j )( ,ˆ,ˆ( x 0 0 z η /) m , it is a average value of the normalized variance, and m ∑ 1 j = Φ j ,ˆ,ˆ( x 0 0 z ) η = T −Δ i n ∑ 1 = i ⎡ ⎢ ⎣ ˆ( x 0 − x ) Tx i )( / Δ∂∂ η (ˆ z 0 − ) Tx i / Δ∂∂ η 2 ⎤ ⎥ ⎦ shows variance between the field values calculated by using estimated parameters at jth calculation window and )(max ηΦ , )(min ηΦ － 135 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) shows the maximum and minimum values among the whole variance respectively, where n is the number , m is the number of whole calculation of data points and j is the number of calculation window, ,1= m j window, λ is the positive constant, to our mind it is reasonable to take it about 0.1～0.5. 1.3. Estimation of source’s structural index Let the estimates given by equation (7), (8) using the true structural index η of the anomalous , and do the estimates given by false structural index μ to be )ˆ,ˆ( ′ ′ 0 z x 0 source to be )ˆ,ˆ( x 0 z 0 following relationships are established; ˆ x −′ 0 ˆ x 0 = ˆ z −′ 0 ˆ z 0 = ( )( − ημ be cg ) ab c − ( ag )( − ημ ce ) − 2 − 2 (10) (11) = ( ) ημ− H (12) c The distance between two estimates is shown by; 2 ab − 2 r = ˆ( x −′ 0 )ˆ x 0 −′+ ˆ( z 0 )ˆ z 0 where H = be ( − cg ) 2 + 2 − ce ) ag ( 22 ) c ( ab − As shown in equation (12), the closer the structural index given by interpreter to the true one, the shorter distance between the estimate and the true location of source it becomes. Therefore, to estimate the source’s structural index following dispersion values between the estimates are used; r = ˆ|| p i − p 0 || (13) 1 n n ∑ 1 = i ˆ( x ˆ, z ˆ p = i where interval setting calculate structural index and n is the ith estimate vector (i.e. horizontal and vertical location) in the calculation  is an average vector of estimates in ) p = 0 x z ( ) 0 0 0 0 n , i i the calculation interval, x = 0 ˆ ix 0 , z 0 = , n is the number of estimates in the calculation 1 n ∑ 1 = i 1 n ∑ 1 = i ˆ iz 0 interval.  2. Synthetic Example To demonstrate the effectiveness of the method, I performed model calculation by using the magnetic field of which the thin dyke model, which has well-known structural index, makes. First, for the thin dyke model compared the result by using the minimum variance criterion with the result obtained by using the Thompson’s criterion. For the thin dyke model, its horizontal location of top center is give by 50m, its depth to the top center is given by 10m, and half width is given by 1m. The domain of data point ranges form 0 to 100, and data point interval is 1m. During the numerical calculation, data window with seven points was used and changing the structural index from 0.5 to 2.5 with an interval of 0.5m, calculation was carried out. Result of calculation was shown in Fig.1. － 136 － Improvement of Euler Deconvolution to Estimate Parameters of Magnetic Source Fig. 1. For the thin dike model Thompson’s criterion(a) and minimum difference criterion (b) As shown in Fig.1, for the thin dyke model applying the minimum variance criterion works well rather than Thompson’s criterion, in other words, scattering solutions, which do not reflect the true position of source, are further reduced. The result would be more correct when the estimated structural index is close to the true structural index. Next I demonstrated the feasibility of this method which determines the structural index by using minimum dispersion. During the model calculation, the same as above thin dike model was used with the structural index interval 0.1 in the range from 0 to 3 and then considered the relation between the structural indices and the dispersion values. The results are shown in Fig.2. As shown in Fig. 2, in the case of thin dike model, the minimum of dispersion value is found when the structural index is 1.1. Finally, the structural index corresponding to the minimum dispersion is regarded as the closest value and the position estimates by using this index are determined to be a true position. Fig. 2. Structural index-covariance curve for the thin dike model Through the above numerical experiment, we demonstrated that our method is effective to estimate correctly position of causative source and structural index by using observed magnetic anomaly. － 137 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) 3. Application to Real Data To examine the applicability of the present method, I processed the magnetic survey data on an iron deposit. This extrusive sedimentary iron deposit is located at a limb of a syncline which has a strike of northwestern west direction. We implemented magnetic measuring work of 1：5 000 scales on the ground for prospecting the iron deposit. Fig. 3 shows magnetic anomalies obtained on two line of magnetic measurement and the results processing by the method suggesting in this paper. In the calculation, we used a data window of 7 data points. We discriminated the position of the causative body by using the analytic signal of the first vertical derivative and gave coefficient λ 0.5 in the case of applying the minimum difference criterion. a), b) of Fig. 3 is respectively magnetic anomaly and the results of Euler deconvolution on measuring line of 1, 2. Fig. 3. Magnetic anomaly and result of Euler deconvolution on the survey lines of 1 (a)) and 2 (b)) The horizontal position of C5-1 causative body is (905.33 ± 9.67)m, depth is (168.87 ± 12.16)m and structural index is 1.3, and the horizontal position of C5-2 causative body is (140.94 ± 18.16)m, depth is (131.55 ± 15.7)m, a structural index is 0.7 in a) of Fig. 3. The horizontal position of C5-1 causative body is (923.64 ± 7.13)m, depth is (162.84 ± 5.6)m and structural index is 1.1, and the horizontal position of C5-2 causative body is (114.41 ± 12.86)m, depth is (101.3 ± 12.28)m, a structural index is 0.3 in b) of Fig. 3. The above results show the structural index of the C5-1 causative body approximates structural index of the thin dike and variation range of the ones is not wide, and the variation range of the structural index of the C5-2 causative body is wide relatively. This is associated with interference of two neighboring causative body and deep extent of the causative bodies. The obtained result corresponds well to drilling data on two lines. As seen above, obtained result by using the proposed method in this paper correctly reflects position of the magnetic causative bodies. － 138 － Improvement of Euler Deconvolution to Estimate Parameters of Magnetic Source Conclusion  The proposed method in this paper discriminated positions of the causative bodies by using analytical signal of first order vertical derivative of the magnetic anomaly, and constrained calculation interval, thus we can reduce scattering solutions among the Euler solutions. Also the proposed method is capable to remove scattering solutions by applying the minimum This method is capable to estimate the structural index of source by using the minimum dispersion value between the Euler solutions with high precision. difference criterion. References [1] D. J. Fitzgerald et al.; Computers and Geosciences, 30, 461, 2004. [2] V. C. F. Barbosa et al.; Geophysics, 64, 1, 48, 1999. [3] D. T. Thompson; Geophysics, 47, 1, 31, 1982. [4] Wen-Bin Doo et al.; Geophysical Prospecting, 55, 255, 2007. [5] A. Salem et al.; Geophysics, 68, 1952, 2003. [6] M. Bill et al.; 78th Annual International Meeting, SEG, Expanded Abstracts, 794, 2008. [7] L. Roy et al.; Geophysical Prospecting, 48, 559, 2000. － 139 －