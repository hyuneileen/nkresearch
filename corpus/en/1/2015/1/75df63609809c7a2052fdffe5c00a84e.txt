Journal of Kim Il Sung University (Natural Science) Vol. 4 No. 1 Juche104(2015) Neural Immune PD Type Tracking Control for DC Actuating Mechanism Sin Yong Chol, Sin Hye Gyong and Jang Sim Chol Abstract We proposed a new approach of neural immune PD type tracking control combining artificial immune control with neural network. It is assumed that the output of the helper T-cell in artificial immune system is concerned with not only the error of system but also its changing rate, while the output of suppressor T-cell is unknown nonlinear function with respect to the amount and changing rate of antigens and the changing rate of antibodies, which is approximated by the output of neural network. From this, we derived neural immune PD type control law and applied it to the trajectory tracking of DC actuating mechanism. The validity of the proposed method is verified by simulation and the simulation results showed that this method can follow the desired trajectory more rapidly and more accurately compared to the previous method. Key words neural immune control, PD type tracking control  Introduction  The great leader Comrade Kim Jong Il said. “Scientists and technicians should intensify their scientific research for the scientific and technical solutions to the problems arising in making the national economy scientifically-based, and thus put the production and management activities of all branches on a new scientific base.”(“KIM JONG IL SELECTED WORKS” Vol. 10 P. 195) Artificial immune systems (AIS) have been widely used in different fields, such as control, robotics, computer science and multi-agent systems. The immune system is one of the four-nature information processing systems, including brain neural system, genetic system and incretion system, in biological system. Immune system has the ability to defend system against foreign material and the relation between immune factors is differently modeled. Many attempts have been done to apply the above ability of the biological immune to the fields of control and a new control approach, called artificial immune control, has been developed [1－3]. The focus of study on artificial immune control strategies has been concentrated on the solution of the learning problems and adaptability problems in the control system by using immune mechanisms. Many applications using artificial immune control such as immune P controller and immune PID controller have been developed [1]. And the intelligent control methods combining immune control technique with soft-computing technique have been also proposed [5－7]. － 32 － Neural Immune PD Type Tracking Control for DC Actuating Mechanism In most literature, the output of helper T-cell is considered as the term related only to the error of system, while the output of suppressor T-cell is determined as different types of functions[4] (where the system error and the control input are treated as antigen and antibody respectively.).  But in biological immune system the production of antibodies could be affected by the increasing or decreasing rate as well as the amount of antigens. From this point of view, in this paper a new control method, neural immune PD type control approach, is proposed and applied to the trajectory tracking of DC actuating mechanism. 1. Design of the Neural Immune PD Type Control System The general immune control law is presented as follows. )( tu = ,  is system error, where )·(sf and suppressor T-cell respectively and )·(hP )(te ⋅ f h − 1))[ te ))(( (cid:5) (( tuf s teP (( h are functions expressing the outputs of the helper T-cell )·(hf is the inverse function of (1) [1]. )·(hP ))] Based on the biological immune ability, we assume to get more similar model of immune systems as follows. to the changing rate. respect to te ),( (cid:5) tute )( ),( (cid:5) . Assumption 1 The output of helper T-cell is related not only to the amount of antigens but Assumption 2 The output of the suppressor T-cell is the unknown nonlinear function with From these assumptions, we determine the output of helper T-cell as where )(te is the error between the desired trajectory and the actual output of the plant. tu )( h = teP (( h ), (cid:5) ( te )) = teK )( P + (cid:5) teK )( D (2) The output of the suppressor T-cell is as follows (cid:5) tef ),(( tus )( and the resulting law of artificial immune PD type control is rewritten as  tP ( h teK )( = P by using the output of the neural network as )(tus We try to approximate t )( h (cid:5) )( teK D (cid:5) tute ( ),( ),(( tef tu )( s − 1)[ .)) (cid:5) tute ( ( ), )) )] t ( = − + = = (cid:5) f f ⋅ (3) (4) )) where function Nf expresses the output of neural network. tu )( s te (( ), ), = N f (cid:5) tu ( (cid:5) te ( (5) Consequently equation (4) is rewritten as tu )( = s (cid:5) teK )( D tu )( h teK )( P tu )( = − = + − f N te (( ), (cid:5) te ),( (cid:5) tu ( .)) (6) Definition 1 The artificial immune control, in which the output of helper T-cell is constructed as PD type and the output of suppressor T-cell is obtained by neural network which has a function of approximating nonlinear functions as equation (5), will be called neural immune PD type control. The corresponding block diagram of neural immune PD type control system is shown in Fig. 1. － 33 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) Fig. 1. Block diagram of neural immune PD type control system Definition 2 The neural immune PD type control to track the desired second-order dif- )(tdθ will be called neural immune PD type tracking control. ferentialable desired trajectory 2. Neural Immune PD Type Tracking Control of DC Actuating Mechanism The DC actuating mechanism, in which load is linked with DC motor, consists of the electric circuit part and the mechanical part as shown in Fig. 2. Fig. 2. DC actuating mechanism The mechanical part consists of load link and armature link and the motion equation of the load link is presented as ( J c + mr 2 (cid:5)(cid:5) (cid:5) ) + θθ B + mgr cos = τθ (7) and the equation of the armature link is expressed as τ m = J (cid:5)(cid:5) θ mm + B (cid:5) + τθ mm sm = J (cid:5)(cid:5) θ mm + B (cid:5) θ mm + .        (8) τ j From above two equations, the resulting motion equation of the mechanical part is rewritten as τ m = J m + + B m + ⎛ ⎜ ⎜ ⎝ J 2 j ⎞ (cid:5)(cid:5) ⎟ θ m ⎟ ⎠ + mgr 1 j ⎛ ⎜⎜ cos ⎝ θ m j ⎞ =⎟⎟ ⎠ j B 2 ⎞ (cid:5) ⎟ θ m ⎟ ⎠ ⎛ ⎜⎜ cos ⎝ θ m j ⎞ =⎟⎟ ⎠ ⎛ ⎜ ⎜ ⎝ 1 j 1 j = Jj ( (cid:5)(cid:5) (cid:5) B ) θθ + e e + mgr cos( θ .) = J (cid:5)(cid:5) θ me + B (cid:5) θ me + mgr (9) － 34 － Neural Immune PD Type Tracking Control for DC Actuating Mechanism On the other hand, the voltage-current relationship of the armature circuit is expressed as v = iR + L + E .               (10) di dt The dynamic model of the total system combining the electric circuit part with mechanical part is simply expressed as where parameters a , 2 aa , 1 0 a are (cid:5)(cid:5) )( θ t 2 + (cid:5) θ a 1 )( t + a 0 cos θ )( t = )( tv (11) a 2 = j , a 1 = j , a 0 = mgr . e kkRB + tv k t R jk t RJ e k t Then the linear nominal model for equation (11) can be described as  (cid:5)(cid:5) θ 2 (cid:5) ˆ a + θ 1 tv )( t )( t )( = ˆ a (12) where parameters ˆ,ˆ a a 1 2 are the nominal values of parameters a 2 , a 1 . Considering its linear nominal model (12), the dynamic model (11) can be rewritten as (cid:5)(cid:5) (cid:5) θθθ , ) ,( (13) tv )( t )( + + = ˆ a d (cid:5)(cid:5) θ )( t 2 (cid:5) ˆ θ a 1 (cid:5)(cid:5) (cid:5) θθθ ,( , ) d Δ= a (cid:5)(cid:5) θ )( t 2 (cid:5) θ a Δ+ 1 t )( + a 0 cos θ t )( (14) is equivalent disturbance acted upon the system. Based on the above neural immune PD type control law (equation (6)), we design the neural immune PD type tracking control law for DC actuating mechanism as tv )( h (cid:5)(cid:5) [ˆ θ a d 2 (cid:5) teK )( D teK ( P (cid:5) ˆ θ a 1 tv )( s tv )( t )( t )( )] = + + − + = − f N te ),(( (cid:5) ( te ), (cid:5) tv ( )) (15) where where tv )( h = [ˆ a 2 (cid:5)(cid:5) θ d t )( + (cid:5) teK )( D + teK P )]( + (cid:5) ˆ θ a 1 t )( (16) is the output of helper T-cell and )) is the output of suppressor T-cell. And the feedback coefficients tv )( s te ),(( = N f (cid:5) te ),( (cid:5) tv ( (17) P KK , have an influence on the D dynamics of the closed-loop system as well as the convergence of position error and speed error.  The block diagram of neural immune PD type tracking control system proposed above is shown in Fig. 3. expressed as In the DC actuating mechanism of which dynamics is given as the above equation (13), if  accurately estimates and compensates (cid:5) te ( the output of the neural controller te (( (cid:5) tv ( )) ), ), = f tv )( s N equivalent disturbance (cid:5)(cid:5)d θθθ (cid:5) ,( , ) (that is, suppresses), the dynamics of the closed-loop system is (cid:5)(cid:5) )([ˆ2 tea + D (cid:5) teK )( + teK ( P )] = 0 (18) and if the feedback coefficients satisfy the relation the desired dynamics of the closed-loop system and the exponential convergence of the tracking error will be achieved. K 2 = D 4 K P ( K P > ,0 K D > )0 (19) － 35 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) Fig. 3. Block diagram of neural immune PD type tracking control system 3. Design of the Neural Controller and Learning Algorithm The recurrent neural network is used to generate the output of suppressor T-cell, where inputs and outputs of neural cells in the input, hidden and output layers (input cells 3, output cells 1) are determined as + ),1 j ∈ I ks ( j )1 =+ kxw ji i , )( Qj  ∈ (20) ( kx j + )1 = + ),1 j ∈ I ( ks j + , )]1 Qj ∈ ∪= OHQ (21) N ku ( ⎧ j ⎪ ⎨ ∑ ⎪ ⎩ ⎧ ⎪ ⎨ ⎪⎩ ( ks j 1 = [ f i j where I is a set of input cells and Q is a total set of cells in hidden and output layers. The activation function is defined as ⎧ ⎪ 1 ⎨ ⎪ ⎩ ks ( j )]1 + = 1 [ f j − exp[ − Ts ( k + )]1 j + exp[ − Ts ( k + )]1 j as j ( k + ),1 Oj ∈ , Hj ∈ (22) and then we try to define the cost function is as  fk 2 ∑ )(E k kk 1 += 0 ( kJ 1 2 = k ) 0 , f (23) where (cid:5) eK D + = E k )( k )( eK P Learning Algorithm Step 1 Design the structure of the recurrent neural network and initialize parameter values k )( . (initial weights, biases, learning rates and etc). ,1 Step 2 At the discrete time = + k k k , 0 0 (cid:34) , fk − 1 , (cid:5) kv ( ), ke ( ), (cid:5) ke )( are fed to the neural network as input and the outputs of the cells are calculated according to equation (20)－equation. (22)  the error between desired trajectory and (cid:34)+ ,2 Step 3 At the discrete time + = k k , actual trajectory ke )( = θ d k )( − θ k )( 0 ,1 0 k is calculated. fk － 36 － Neural Immune PD Type Tracking Control for DC Actuating Mechanism Step 4 Calculate )(kδ according to equation (24). δ )( k = (24) ⎧ ⎪ ⎪ ⎪ ⎪ ⎨ ⎪ ⎪ ⎪ ⎪ ⎩ p O ⎡ ⎢ (cid:34)(cid:34)(cid:34)(cid:34)(cid:34)(cid:34)(cid:34)(cid:34)(cid:34)(cid:34) ⎢ ⎢ ⎢ ⎣ (cid:5) ( keK D ( keK P ' [) + O ( ) f f f ⎤ ⎥ ⎥ ⎥ )] ⎥ ⎦ = p O ⎡ ⎢ (cid:34)(cid:34)(cid:34) ⎢ ⎢ ⎢ ⎣ δ k O ( f ) ⎤ ⎥ ⎥ ⎥ ⎥ ⎦ ,     k = k f F ⎧ ⎪ ⎨ ⎪ ⎩ O ⎡ p ⎢ (cid:34)(cid:34)(cid:34)(cid:34)(cid:34)(cid:34)(cid:34) ⎢ ⎢ ⎣ (cid:5) keK )( D )( keK P + ⎤ ⎥ ⎥ ⎥ ⎦ ⎫ ⎪ ,)1 ⎬ ⎪ ⎭ T δW ( k + + k 0 <≤+ 1 k k f Step 5 Update weights according to learning rules equation (25). w ( l + )1 = w )( l − δ ( k + )1 (25) 1 − fk ∑ η kk = 0 ⎡ ⎢ ⎣ s )1 ( k + ∂ w )( k ∂ T ⎤ ⎥ ⎦ Step 6 Iterate Step 2－Step 5 until learning converges.  4. Simulation Result The validity of the proposed method is verified by simulation under the parameters ,6.7 The characteristics of tracking progress for desired trajectory and error convergence is shown , Kp=100 and KD=20. 26.0 023 a 1 .0 ,4 = = a 0 a 2 = in Fig. 4. Fig. 4. Simulation results of neural immune PD type tracking control a) Tracking process of desired trajectory, b) Error convergence characteristics 1－desired trajectory, 2－actual trajectory Tracking performance and error convergence results are shown in Fig. 5 according to different values of P KK , D . Fig. 5. Tracking process and error convergence according to P KK , D 1－desired trajectory, 2－ a) Tracking of desired trajectory, b) Error convergence K K = , 3－ , 4－ ,100 ,16 20 ,4 K K K K = = = = 8 P D D P P = 4 , 5－ K = ,1 K D P = 2 D － 37 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) Fig. 6 shows the comparison of the proposed method with the previous one. Fig. 6. Compared results a) Tracking of desired trajectory, b) Error convergence 1－desired trajectory, 2－previous method(immune PID), 3－proposed method(neural immune PD) Fig. 6 shows that the proposed method in the paper can track the target trajectory more smoothly than the previous one. Conclusion  A new neural immune PD type control combining immune feedback control law with neural network is proposed and applied to the trajectory tracking of DC actuating mechanism. Simulation results show that the proposed method can achieve much better tracking of trajectory compared to the previous immune PID control approach. References 18～21, 2007. 132, 2004. [1] Fu Dongmei; Handbook of Research on Artificial Immune Systems and Natural Computing: Applying Complex Adaptive Technologies, Medical Information Science Reference, New York, 262～304, 2009. [2] Lingli Yu et al.; Proceedings of the IEEE International Conference on Automation and Logistics, [3] Guan-Chun Luh et al.; Artificial Immune Systems, 3rd International Conference, ICARIS, 119～ [4] Motohiro Kawafuku et al.; Proceedings of the 1999 IEEE/ASME, International Conference on Advanced Intelligent Mechatronics, 19～23, 1999. [5] K. Takahashi et al.; Proceedings of ’97, IEEE/ASME, International Conference on Advanced Intelligent Mechatronics, 101, 1997. [6] Yang Jian-guo et al.; Jurnal of Dong Hua University, 19, 4, 16, 2002. [7] Albert Ko et al.; Artificial Immune Systems, 3rd International Conference, ICARIS, 91～105, 2004. － 38 －