Journal of Kim Il Sung University (Natural Science) Vol. 4 No. 1 Juche104(2015) A Method for Designing Disturbance Observer considering Internal Model Order Condition Yun Jong Nam Abstract This paper presents an analytic design method for Q-filter satisfying the internal model condition which is one of main structural constraints and validates the accuracy of the proposed method using design example. Key words high-performance robust motion control, disturbance observer, internal model principle Introduction The great leader Comrade Kim Il Sung said. “Developing the electronics and automation industries is an important task in modernizing the national economy.”(“KIM IL SUNG WORKS” Vol. 35 P. 311) DOB has widely been applied to high performance robust motion control because of its high disturbance rejection ability and simple structure[2－5, 9]. But the system's performances depends on the Q-filter in the DOB, design of the filter has been essential in design and analysis of controller, which has attracted much more effort in academic society[6－8]. In the optimal design of DOB, because of the structural constraints such as relative order condition and internal model order condition, numerical computational methods only have been used, but not analytical algorithm[7, 8]. The analytical solution method satisfying the relative order condition was developed by pseudo loop factorization, but it can not solve the design problem including internal model order condition [1]. In this paper, we propose the design method of DOB satisfying given internal model order condition, and then show the validity of the proposed method through design example. 1. Problem Formulation In [1], it was discussed that the evaluation function of DOB for disturbance attenuating performance and robust stabilization as follows. sW C ⋅ γmax , min sQ )( Ω∈ k sQ RH )( ∞∈ γ ⎡ ⎢ ⎣ 1()( −⋅ ( sQ )) )( )( sQsW ⋅ Q ⎤ ⎥ ⎦ ∞ < 1 (1) =Ω k sFsF )( |)({ = sDsN ( /)( ), deg( sD ( )) − deg( sN ( )) ≥ k } (2) and, it can be analytically solved by pseudo controller design problem using pseudo loop factorization － 19 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) ⋅ γ 1()( sW C ~ ( sKsPsW ⋅ +⋅ ~ )( )( 1 − ~ ~ ( )( sKsP ~ )( ( sKsP 1)( )) ~ + 1 − )) ⎡ ⎢ ⎢ ⎣ ⎤ ⎥ ⎥ ⎦ ∞ γmax , min ~ K Π∈ Q ~ ~ sKsP )( )( * ~ * sL )( = , * sQ )( = ~ * sL ( 1)( + ~ * sL ( )) 1 − (4) (3) < 1 of which result satisfies the relative order condition. But the problem for DOB to satisfy the internal model order condition has not yet solved. One of the important performances of DOB based control system is that it is possible to design the DOB so as to entirely remove the effect of special disturbance. For example, if the disturbance  tp 1 q − must be entirely removed in the control system, q is one of the design specifications. From the internal model principle [10, 11], it is clear that the equivalent controller has  integrators in order to remove this disturbance. Thus, the internal model order q should be taken into account. (cid:34)            (5) 1+q td )( tp q + + + = p 1 − 0 q q This paper discusses a design method of DOB satisfying the given internal model order condition. 2. The Internal Model Order Condition in DOB Assume that the minimum realization of )(sQ is as follows. sQ )( = sN )( sM )( = m ∑ j = 0 n ∑ i = 0 b j j ⋅ s i sa ⋅ i , 0≠na , 0≠mb , nm < , kmn = − (6) where n and k are whole and relative order of )(sQ respectively and )(sM and )(sN are Theorem 1 Suppose that the nominal plant has given internal model order q , if and only if )(sPn b = l is bounded on imaginary axis. Then DOB a l mq ≤≤ ,1,0 0, (cid:34) l ( = . q ) , , Proof K pre )(s can be written as[10]. K pre s )( = 1 sQ )( = sM )( sNsM )( )( − = sM )( sD )( , 1 − coprime. where sD )( = s q 1 + ⋅ 1 qi −− + − b j ) ⋅ s j 1 qj −− ⎛ ⎜ ⎜ ⎝ n ∑ sa ⋅ i 1 mi += + ⎞ ⎟ ⎟ ⎠ (7) m ∑ a ( 1 qj += n ∑ j 0 = + q ∑ 0 l = ( a l − b l ) ⋅ l sMs )( , = ⋅ s j . a j Suppose that Then, it is clear that K pre )(s b = l , a l may have 1+q ,1,0 (cid:34) = integration factors at least. Moreover, cancellation .             (8) q l , of factor s between numerator and denominator never appears in (7), since  is not lager than  sQ )( . It implies that integrating order of (cid:34)= ,0 (0 RH )(s ∈ n ) i , a >⇒ i ∞ K pre － 20 － * C )( sQsW ⋅ )( C should includes . But, we have * sQ )( )(sWC n ∑ i = 0 i −⋅ sa i j sb ⋅ j m ∑ j = 0 n ∑ i sa ⋅ i i = has 0 1+q A Method for Designing Disturbance Observer considering Internal Model Order Condition 1+q . It means that K pre )(s has 1+q integrators. On the contrary, from (7), it is clear that if DOB has 1+q integrating factors, then (8) is true. (Proof end) Lemma  The reachable maximum value of internal model order q is the same as the numerator's order m . The proof of lemma is similar to that of theorem 1. This lemma shows the important information of DOB, that is, the higher the numerator's order is, the higher the reachable maximum internal model order is. But, since , the order n should also get higher in order to keep the original relative order. kmn = + Theorem 2 The solution )(* sQ of the internal model order demand q if weighting function of the complex plane. Proof Let )(* sQ be solution of the problem (1). Then 1+q includes  poles at origin point, so as to cancel all the poles at origin point of 1)( −= * sQC ∞H norm optimization problem (1) satisfies given  poles at the origin includes 1+q )(sWC ∈ RH ∞ . Thus, if )(sWC 1+q zeros at origin point sQ )( C = sN )( sM )( − sM )( = (9) It is clear that when the numerator of )(* sQC zeros at origin point, its lowest q term's coefficients are zero. Therefore, (8) is satisfied. (Proof end) 3. The Design of DOB for Realizing Internal Model Order Condition From theorem 2, it follows that only if the weighting function )(sWC is selected to have 1+q integrating factors as follows, then the internal model order specification q can be achieved. sW )( C γ ⋅= sW )( C γ ⋅= (10) 1 q 1 + s )(ˆ sW C )(sWC However, if the has poles on the imaginary axis, the augmented plant of standard problem could not satisfy the preconditions for solution, because of invariant zeros (corresponding to unstabilizable or undetectable states) on the imaginary axis. In order to avoid this difficulty of solving, a sufficiently 0>λ can be introduced. Then, we can use following weighting function instead of (10). small parameter 1 )( sW C γ ⋅= )( sW C γ ⋅= ˆ sW )( C (11) The resultant controller includes 1+q (cid:34)= ,0 , q ) q + 1 λ ) ( s + si i ( −= λ 1 s )( ⋅ poles ~ K = * λ 0, ( s + ) λ q 1 + ~ * sK ,( ) λ .          (12) 0→λ , the solution of standard problem goes to real solution when ~ * sK + )0,( = lim 0 → λ + ~ * ,( sK ) λ = ~ * )( sK 0 ⋅ 1 qs 1 + . － 21 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) Practically, we can sufficiently small real number accuracy, as follows: 0>λ to reach the solution in a sufficiently ~ * )( sK λ = ~ K * λ 0, )( s ⋅ 1 qs 1 + (13) ~ * λsK ) ,( certainly makes the corresponding closed loop internally stable with since it ~ sP )( is real solution of the problem. But it should be checked up whether also makes the closed ~ * sKλ )( loop stable, before it is employed instead of ~ * λsK ) ,( . Theorem 3 There exists sufficiently small real number λ( 0>λ ) such that the closed loop is stable, or equivalently )(* sQ is stable for the specific λ. Proof The solution of optimization problem (1) for weighting function (11) has the form as (12) according to loop shaping theory. Then, we have /()( s ~ K s + ) λ ~ * sL ,( ~ * sL ,( + 1 ) λ = ) λ 1 + * 0, λ ~ * K λ 0, q 1 + ⋅ 1 + q ~ sP )( ~ sP )( ⋅ s /()( s + ) λ * ,( sQ ) λ = .      (14) For simplicity, define ~ sDsN /)( ~ :)( ~ * K = λ 0, ~ sPs )( )( ⋅ .           (15) where ~ sN )( and ~ sD are coprime. Then we have )( where ~ * sD ,( C ) λ = ~ sD ()( ⋅ s + 1 q +λ ) + makes the closed loop stable. If we employ instead of is stable since optimal solution ~* λsK ,( ) , then corresponding Q-filter is * sQ ,( ) λ = ()( ⋅ ~ sD ~ sN )( ~ )( sN 1 q + ) s + λ ~* λsDC . ,( ) ~ * sKλ )( ~ * sQsQ = )( )0,( = = ~ sN )( + ~ sN )( ~ * sD ,( C ) λ ~ )( sN 1 q + ~ sD )( ⋅ s ~ sN )( + ~* λsK ) ,( ~ sN )( ~ sD )( C = By Kharitonov theorem, is stable if the coefficient's values of the error polynomial are restricted to a certain region of coefficient hyperplane or equivalently where ~ sDsD )( = )( ~ C q 1 + ⋅ s + . ~ )( sN ~ sDC )( ) , i.e., )( ~ ~ * λsDsD ) − C C ~ ≠ωjDC 0) ( ,( ( ∞+ , ~ jD ( C ~ , −∞∈∀ω ~ * jD ( C ~ * C sDsDs )( )( ,( ) ω − = = C ) , λω + [ ~ jD ( C ) ω − ) λ = [ s q − ( s + q ]) λ ~ * jD ( C ~ sD )( where stable, δ ~* ≠λωjDC , ( ) , 0 , −∞∈∀ω ( ∞+ ) . Divide (16) by ( ) j ωδ ~ * ( jD C ) , λω ， ≠ 0 1 + )] , λω = ) ωδλω + ( ) j , ≠ 0 ~ * jD ( C is error polynomial. Since ~* λsDC ,( ) , then we have (16) ~* λsDC ) ,( is , −∞∈∀ω ( ∞+ ) (17) ~ sDC )( surround the Nyqist point is stable if and only if the locus of )0,1( − j ( ωδ or equivalently j /) ~ * jD ( C ) , λω , −∞∈∀ω ( , ∞+ ) does not sup ω ( ) j ωδ ~ * ( jD C ) , λω = )( s δ ~ * ,( sD C ) λ k [ s − = k ]) ⋅ ~ )( sD λ ( s + ~ * ,( sD C ) λ ∞ ∞ satisfying (18). (Proof end) It is clear that there exists 0 λλ<< max － 22 － < 1 .     (18) A Method for Designing Disturbance Observer considering Internal Model Order Condition 4. Selection of Weighting Functions in Design of DOB  Based on above-mentioned analysis, we can sum the method of selecting the weighting functions  as follows. Suppose that the order n , internal model order q and relative order and )(sWQ )(sWC k of the Q-filter to be designed are respectively prescribed. 4.1. Selection of )(sWQ )(sWQ restricts as the relative order of )(sQ on high frequencies and its inverse relative order should be the same  so as to satisfy precondition of standard H∞ control problem. It, in ~ sP )( general, has not state modes, i.e., is selected in the form of k-order polynomial to reduce the order  as much as possible. The detailed coefficients of the polynomial should of resultant controller ~ * sK )( be selected considering frequency response for the robust stability and noise rejection demands. 4.2. Selection of The order )(sWC kn of designed ~ * sK )( plant of the standard problem, where in the case that nW + of augmented k nW +  kn is equal to )(sWC k has not its modes. However, one mode of the controller at least gradually is determined by the order . In general, or Wn is the order of )(* sQ )(sWQ vanishes [12] as the suboptimal controller approaches optimal one by γ-maximization, resulting in Wn should be = k , provided that the effect of periodic disturbance in steady state would selected as . Therefore, in order to attain the order demand nk = of n )(* sQ n W =+−= kn , m + n 1 1 1−+ k nW 1 − max )(sWC , then not be taken into account. The highest internal model order that can be realized on this condition is  integrating factors. In this case, n q )(ˆ sWC = Wn in (10) should be selected to be a polynomial whose order is allowed to be Wn at most. The detailed coefficients of this polynomial should be selected considering frequency response of disturbances. should includes 1 =+ n W max = q I 4.3. Implementation of Q-filter When ~ sK )( is solved by step 3 of Q-filter design procedure described in [9], the integrating factors should be taken into account in order to satisfy internal model order demand. Select  to include In integration factors as above mentioned, and then use a positive but sufficiently small  by (11) so as to satisfy preconditions of solving algorithm. real number After solving standard H∞ control problem, the resultant solution  must be replaced by ~* sKλ according to (13) so that DOB can have perfect internal model compensation structure or )( equivalently (8) can be satisfied. Then, the optimal Q-filter is obtained by (4). 0>λ to reconstruct ~ * λsK ,( ) )(sWC )(sWC If )(sWC disturbance in steady state. However, if has at least one integrating factor, the designed DOB can perfectly suppress constant  does not have integration factor at all, the resultant )(sWC DOB can not have servo property that is important performance in motion control system. Tuning free parameter in solving procedure of standard H∞ control problem provides the possibility to attain controller with integral factors. But it is more desirable to reflecting exactly integrator order to be attained in rather than tuning free parameter. )(sWC － 23 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche104(2015) 5. Design Examples Since the comparatively long time delay of plant would make stability of the closed loop system degrade, it should be taken into account when constructing the feedback system. Assume that time delay factor is only unmodeled dynamics or other modeling error is much smaller than that. The plant can be written in the following form of multiplicative perturbed system [13]. )( sP = ( )( IsP n Δ+ ( s )) , Δ )( s = − sTde − 1 (19) where dT is the delay time. In order to ensure the robust stability, It is clear that in the case of sQs )( )( s, the traditional binomial model Δ 2.0=dT < 1 ∞ )(0 sQb should be satisfied. )( sQb 0 = (3 s σ 1) + 2 3 ( s σ ) + (3 s σ ) + (3 s σ 1) + (20) for 065.0=σ increase σ to could not meet this condition(Fig. 1). The only way to ensure robust stability is to  of Fig. 1) so as to shift the frequency response curve to left (see 38.0=σ )(1 sQb [13], but this affects on disturbance suppression performance as shown later. In order to design  by Q-filter satisfying robust stability condition by the proposed method, replace )(sWQ )( sWQ ( = ss + α/)20 so that its inverse could be lower bound of )(1 s−Δ at all the frequencies (see )(1 sWQ − of Fig. 1), i.e., 1 − jWQ ( ) ω 1 − Δ< ( j ) ω at all ω. The optimal filter designed by the proposed method is as * )( sQ = s + 7.910 7.666 2 . s From the frequency response of 3 + )(* sQ 3.203 s + 7.666 7.910 in Fig. 1, it is verified that + s satisfies the robust stability and noise rejection performance. But, as shown in Fig. 2, their disturbance  is lower 6dB than attenuation performances are not equal. The magnitude of  rad/s. It means that the disturbance suppression ability of former is 1 stronger 2 times than later. * sQ− )( 1 sQb− )( 1.0≤ω )(* sQ at 1 Fig. 2. Comparison of disturbance attenuation performances , 2－ 1－ 1 sQb− )( * sQ− )( 1 1 Fig. 1. Analysis of robust stability against time delay perturbation )(1 sWQ − )(0 sQb )(1 s−Δ , 2－ , 3－ 1－ , 4－ )(* sQ , 5－ )(1 sQb － 24 － A Method for Designing Disturbance Observer considering Internal Model Order Condition Conclusion  In this paper, an analytical design method of DOB satisfying internal model order condition has been discussed. Firstly, the relations between weighting function of design problem and internal model structure in DOB were discovered, on the basis of which a structural condition and selecting method of weighting function was proposed. Then, λ-transformation was adopted, so that the optimal design problem with this weighting function can be analytically solved according to the solving algorithm by pseudo loop factorization. Finally, effectiveness of the proposed method was validated through a design example. References [1] Journal of Kim Il Sung University(Natural Science), 3, 1, 15, Juche103(2014). [2] W. S. Huang et al.; IEEE Trans. Ind. Electron., 57, 1, 420, 2010. [3] H. Tanaka et al.; In Proc. IEEE 10th Int. Workshop Adv. Motion Control, 3, 601, 2008. [4] K. Natori et al.; IEEE Trans. Ind. Electron., 57, 3, 1050, 2010. [5] N. Iiyama et al.; In Proc. IEEE 10th Int. Workshop Adv. Motion Control, 3, 687, 2008. [6] E. Schrijver et al.; ASME J. Dynamic System, Measurement, and Control, 124, 539, 2002. [7] C. C. Wang et al.; In Proc. American Control Conference, 6, 3764, 2004. [8] K. Thum et al.; IET Control Theory and Applications, 3, 12, 1591, 2009. [9] K. Ohishi et al.; In Proc. IEEE Int. Conf. on Robot. and Autom., 3, 1792, 1989. [10] B. A. Francis et al.; Automatica, 12, 5, 457, 1976. [11] J. C. Doyle et al.; IEEE Trans. Auto. Control, 34, 8, 831, 1989. [12] K. Glover et al.; SIAM J. Control and Optimazation, 29, 2, 283, 1991. [13] C. J. Kempf et al.; IEEE Trans. on Control Systems Technology, 7, 5, 513, 1999. － 25 －