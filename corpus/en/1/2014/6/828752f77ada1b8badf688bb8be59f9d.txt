김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체103(2014)년 제60권 제6호 Vol. 60 No. 6  JUCHE 103(2014). Study on the Spectrometer Controlled by Computer Using PIC16F877 Jong Chol Jin, Sok Chol and Ho Tong Gil The great leader Comrade Kim Il Sung said: “Therefore, nuclear physicists must intensify their research into atomic energy.” There is few paper on connecting photo spectrometers with computer for decision of radiation dose intensity using microprocessor PIC16F877. In this paper, we made a spectrometer for decision of radiation dose connected to computer by us- ing PIC16F877, and considered how to decide absorbance by means of it. 1. The Composition of Circuit of Spectrometer connected to Computer using In general, the absorbance of any material is proportional to the concentration of that material when transmission length is certain. [1] where  is the absorption coefficient in mol, is density of the material, and  is transmission PIC16F877 length. Based on this equation, the absorbance curve is figured from the values of absorbance of the normal concentration of that material and the concentration of sample is determined from this curve by measuring the sample’s absorbance. Diagram of spectrometry “SPECKOL-ZV” is shown as in Fig 1. As shown in Figure 1 transmission light is con- verted to current signal in photoelectric cell. Con- verting and amplifying this signal into voltage signal, a signal propor- tional to the absorbance is obtained. As the earlier devices does not satisfy the linear- Figure1. Diagram of spectrometer － 70 － Study on the Spectrometer Controlled by Computer Using PIC16F877 ity of amplitude circuit and the measuring data are displayed on a gauge, measurement error is signifi- cant. Furthermore, they should be used in experiments which measures absorbance of according mate- rials, under the condition of known maximum absorption wave of the measured material. Also the disadvantage is that the experiment process and data processing need lots of effort. We manufactured the amplifying circuit to measure the signals of wavelength and luminous in- tensity of the spectrometer at the range of 0~5V and those signals were transformed to digital ones by A-D transforming functionality of PIC. 2. Control device and measurement program. We implemented a control program, called PIC16F877 for absorbance measured data display and data transmission using USART module according to wave by A-D conversion of measured signals and 7 component LED device by using VC++. Algorithms of device control and interrupt service are shown in Figure 2. Figure2. Device control algorithm (a) and interrupt service algorithm (b) Device control program, firstly, reads value of C port control register PORTC, identifies the cur- rent measured values from that and saves A-D converted value of each light intensity read from RA1 pin to corresponding variable if it is set the 0 scales and 100 scales compensation. Also by substituting the value to Timer0 register, timer interrupt is set and then reading and aver- aging the ADC value in Timer0 interrupt routine it is calibrated. Main routine of program transmits wavelength and absorbance value continuously with a certain delay. － 71 － Journal of Kim Il Sung University (Natural Science) No. 6 Juche103(2014) Figure 3. Measurement algorithm. In timer0 interrupt service routine, wavelength and light intensity signal are converted to digital data to calculate the average value Absorbance measuring program of sample using VC++ processes reading data from RS-232 port. Then interface was coded by using Flash8.0 and linked to VC++, so it is equipped with device connection, data processing, data display functionality with sufficient visual effect and user interface rationally. Measurement algorithm is shown in Figure 3. On the interface, the “measure-start” and “measure-end” commands are input from user and send to the main program. To do this, a global value g_State is defined and it calls fs_command() to send data in the start and end button event handler. As shown in Figure3, when running the program firstly, on main window it can allow to experi- ment measuring line generation or measure according to the experiment type. In the case of unknown samples, data of measurement experiment and its number are input and then the program gets into the measurement state. Absorbance measurement of sample can be repeated for several times and after terminating the meas- － 72 － Study on the Spectrometer Controlled by Computer Using PIC16F877 urement, the corresponding measuring line is selected and the concentration in measurement section item is decided . With the data browser, the data of measurement line and measurement of sample can be read and here about the experiment data, time, experimenter and content can be browsed in detail. 3. Sample analysis by using photo spectrometer Using colorimetric analysis of Fe(Ⅲ) by rhodanide method the reliability of device was con- firmed. This method is based on interaction of Fe3 At this time, the maximum absorption wave of ion Fe(Ⅲ) was 489nm. The coloring agent of rhodanide (concentration of SCN- is 0.623%) was prepared and after draw- + and SCN- in acid medium forms red compound. ing the measuring line, the absorbance was measured. (Table1). In order to confirm characteristics of the device, the halotrichite was prepared in order of about . Concentration Table1．Absorbance according to the standard series of Fe(Ⅲ) 1 2 3 4 5 6 7 Absorbance 0.105 0.221 0.348 0.437 0.610 0.657 0.725 The change of absorbance Fe(Ⅲ) decided by obtained measurement value and measuring line is shown in Table2. Table2. The result of absorbance of Fe samples Absorbance 0.364 0.321 0.638 0.684 1 0.382 2 0.591 3.26 3.42 2.86 5.82 5.38 6.25 3.18±0.3 5.82±0.43 The relative aberrations of the above results were 9.4% and 7.4%, respectively. Subsequently, by using above material and measuring by the device connected to computers er- rors were compared. The absorbance of Fe(Ⅲ) ion by spectrometer connected to computer is shown as in Table 3. No. Concentration Fe(Ⅲ) Average value － 73 － Journal of Kim Il Sung University (Natural Science) No. 6 Juche103(2014) Table 3. Analysis results of absorbance of Fe(Ⅲ) ion by spectrometer connected to computer No 1 0.418 absorbance 0.423 0.433 0.562 0.556 2 0.571 concentra- tion Average value 3.81 3.76 3.90 5.11 5.19 5.05 3.82±0.07 5.11±0.07 Relative errors from table 3 are 1.8% and 1.4%, respectively. Thus, it can be proved that the measurement accuracy can be improved by connecting spectrome- ter to computer and conduct quantitative analysis of material in range of relative aberration below 2.5%. 1. We manufactured the circuits for the signal of wavelength sensor and the light intensity ampli- fication of the spectrometer. Then we made the device connected to computer. 2. We verified the characteristics of computer- controlled spectrometer through the analysis of Fe(Ⅲ) ion by rhodanate. 3. The related error in colorimetric analysis of Fe(Ⅲ) by rhodanide method is less than 2.5% Conclusion References [1] 조광원 등; 계기분석, , 14～32, 주체96(2007). － 74 －