Journal of Kim Il Sung University (Natural Science) Vol. 3 No. 1 Juche103(2014) Joint Inversion of Self-Potential(SP) and Magnetic Anomalies by Some Simple Models Ri Il Gyong Abstract We clarified geological hypothesis of joint inversion of SP and magnetic anomalies and proposed geophysical principle and method of joint inversion of SP and magnetic anomalies. I attained effective joint inversion by arranging reasonably elements of two model parameter vectors (parameter vector of magnetic body and parameter vector of SP body) in the different fields for the convenience of solving the inversion and normalizing fields and elements of model parameters with different dimension. The properties of joint inversion are analyzed throughout model experiment on sphere and infinite horizontal dike. The joint inversion reduces uncertainty of inversion and improves its properties of convergence. Key words joint inversion, SP anomaly, magnetic anomaly  Introduction  The great leader Comrade Kim Jong Il said as follows. “Scientists and technicians should work to overcome by their own efforts the problems which require an urgent solution for the development of the national economy of our country, and to introduce the scientific and technical successes of developed countries in accordance with its specific reality.”(“KIM JONG IL SELECTED WORKS” Vol. 10 P. 195～196) SP method is one of the electrical methods, which are effective in prospecting useful ores and groundwater, and magnetic prospecting method is one of the effective methods in prospecting magnetic ores. If we combine and apply several geophysical methods in mineral exploration and environment and engineering survey, we can reduce uncertainty of properties for prospecting target. To analyze several geophysical fields simultaneously which have been attained by applying some geophysical methods at the same time is one of the important methods of reducing uncertainty, which is one of troublesome problems in geophysical prospecting and enhancing its effectiveness. Therefore, it is a trend in development of modern geophysical prospecting technique. A researcher did joint inversion of both dispersive Love and Rayleigh waves on one hand and joint inversion of dipole-dipole, Schlumberger and two electrode sounding data on the other hand to achieve more detailed tectonics[3]. And some investigators [2] carried out joint inversion of 3D gravity and magnetic data and showed great reduction of uncertainty in interpretation of the gravity and magnetic data. Some investigators [5－7] have shown that joint inversion of magnetotelluric (MT) and direct current (DC) resistivity data can resolve thin layer with greater degree of clarity. － 129 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche103(2014) Even the problem of equivalence and occultation in geoelectrical modeling can be handled more efficiently by joint inversion of MT and DC resistivity data. A researcher has shown that even magnetic susceptibility image of the depth geological structures can be obtained by joint inversion of electromagnetic and magnetic data [1]. A researcher derived the relationship between SP anomaly and gravity and magnetic anomaly, illustrated theoretical relationship using measured magnetic and SP data and based on the relationship interpreted first magnetic anomaly and then interpreted SP using information of magnetic anomaly interpretation [4]. He demonstrated that when the sphere body was polarized vertically, the normalized gravity gΔ and SP VΔ anomalies were identical except the sign and when the inclination I of the magnetic polarization and the inclination of electrical polarization are the same, the horizontal  of the SP anomaly are component of the magnetic anomaly HΔ and the horizontal gradient xVΔ also identical, except the sign. And he generalized the object with arbitrary shape and showed that the relationships could be used to compute pseudo-SP anomalies from observed gravity or magnetic anomalies and to interpret the gravity-magnetic and magnetic anomalies data. As seen above, joint inversion of various geophysical data reduces uncertainty and achieves high resolution of interpretation in geophysical prospecting. In this paper we proposed joint inversion method of SP and magnetic anomalies when two anomalies are generated by geological source. We proposed reasonable arrangement method of elements of two parameter vectors in a source which makes different generating fields and the method normalizing two fields and elements of parameter vectors of model parameter with different dimension to realize effective joint inversion. The algorithm that we proposed is similar to quasi Gaus-Newton algorithm. We developed software of joint inversion for SP and magnetic anomalies of the sphere, infinite horizontal cylinder and infinite horizontal dike and estimated the properties of the method throughout model experiment. Our joint inversion reduces uncertainty of inversion and improves convergence properties. An example of joint inversion for SP and magnetic anomalies measured in a region is given. 1. Principle of the Method To interpret simultaneously the geophysical anomalies which are essentially different, the target of the geology should find all of the geophysical anomalies. SP and magnetic anomalies measured above copper mine in “o” region is seen in Fig. 1. This region in the Proterozoic era is covered with thin overburden. There are some copper and gold mine in the region, where minerals of ore dike are copper pyrites, natural gold, iron pyrites, pyrrhotite pyrites, arsenical pyrites and etc. Wall － 130 － Fig. 1. SP anomaly(top) and magnetic anomaly (bottom) measured in “o” region Joint Inversion of Self-Potential(SP) and Magnetic Anomalies by Some Simple Models rocks in the region are mainly limestone, dolomite and schist. x x ≤≤ )15.0 11.0( Mineral with ferromagnetism among sulfide ores is only pyrrhotite pyrites . Magnetic susceptibility of pyrrhotite pyrites is about 0.02～0.15SI, whereas FeS1 + that of copper pyrites and iron pyrites is about 0.002SI and that of arsenical pyrites is below 0.006SI. Because pyrrhotite pyrites are minerals which are always formed in different mineralization steps of magma origin, both SP and magnetic anomalies are generated over ores including copper pyrites and iron pyrites together with pyrrhotite pyrites. Because ores in the region are sulfide ores and include pyrrhotite pyrites with high magnetism than country rocks(average magnetic susceptibility of country rocks is lower than 0.000 5SI), both strong SP and magnetic anomalies are generated. Amplitude of anomaly on the magnetic anomaly map in this region was about 200～400nT at height of 0.5m from the earth’s surface and that of SP measured on the same survey line was about －70～－50mV. Object generating both SP and magnetic anomalies also is coal layer. As well-known, strong SP anomaly is generated in coal layer. Also, it is demonstrated by many investigators that negative anomaly of 10～30nT is generated because magnetic susceptibility of coal in our country is usually lower than wall rocks. There are four important problems in the solution of joint inversion. The first problem is to reasonably arrange elements of two vectors of parameters (one vector of model parameter is vector of model parameter of magnetic body vector and other vector is vector representing SP polarization body.) of the same model for convenience of construction of joint inversion. When one body generates both SP and magnetic anomalies, let’s suppose that magnetic body can be represented by tm parameters and SP polarization body by sm parameters and rm  among tm and sm is repeated. The larger the number of repeated parameters is, the more effective the solution of joint inversion because these parameters are simultaneously constrained by magnetic and SP anomalies. Let’s estimate the total number of parameters as m and express with . And P = )(tP and parameter of SP polarization body as PP ,{ 1 2 mP L } , , when expressing parameter of magnetic body as )( t )(sP , relationships of P =)( s , P P and tmm > U smm > are established. In order to reasonably arrange elements of vectors of parameters of magnetic body and SP polarization body for convenience of construction of joint inversion, I set number of parameters to estimate as m and in the case of magnetic body assign zero to elements of parameters of greater number than tm and in the case of SP polarization body zero to those of smaller number than sm from end of array of parameter elements and arrange repeated elements at the middle place of array of parameter elements. That is, I respectively expressed parameters of magnetic body and parameter of SP polarization body as follows. t )( P t )( P= { 1 , t )( P 2 , s )( P L= ,0{ ,0, L s )( P 1 , , )( t P m t s )( P 2 , ,0, L , L )( s P m S }0, (1) } (2) － 131 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche103(2014) Since t )( P = t )( P { 1 , t )( P 2 , , L t )( P m 1 + 0 , , L t )( P m t ,0, }0, s )( + P = ,0{ ,0, L L ,0, s )( P 1 , s )( P 2 , , L , , L s )( P m S } (3) L )( s P m S PP ,{ = 1 P 2 , , L P m 0 , , L 1 + P m S , L , P m } following relationship is established. PP = t )( s )( P U = PP ,{ 1 2 , , L P m } (4) t s r = − Above relationships, top subscript (t) and (s) express respectively magnetic anomaly and SP anomaly,  is number of total parameter elements of magnetic body and SP polarization body, mmmm + 0m －number of zero elements of parameter of SP polarization body, em －number of zero elements of parameter of magnetic body and relationship m r The second problem in the solution of joint inversion is how to construct object function using is established. 0mm − = e two fields in different dimension. Dimension of SP anomaly is mV, whereas dimension of magnetic anomaly is nT. Therefore, using sum of square of difference between measured field and theoretical field, object function has dimension of , which is contradiction. 2 mV + nT 2 The third problem in the solution of joint inversion is that dimension of elements of model parameter vectors differ also. For example, in the case of sphere, dimension of its depth and horizontal position is meter (m), whereas that of its inclination of electrical polarization is degree (°) and dimensions of dipole moments of SP polarization body and magnetic body also have different dimensions. The fourth problem is that sensitivity matrix of joint inversion is very large compared with the sensitivity matrix of single inversion. To overcome these problems, I constructed object function as follows. ( Φ WP || = ) s )( U [ (obs) − U ( P ||)] + || W 2 ( m ) [ Δ T (obs) Δ− T ( P ||)] α + || 2 ( P ) PPW ( 0 − 2 ||) (5) Then, problem of finding information P of magnetic and SP polarization body from measurements of full magnetic anomaly and SP anomaly results in problem finding model parameter  are respectively theoretical SP anomaly  and P minimizing object function (5). Where )(sW and (PW weight ) and magnetic anomaly corresponding to model parameter P, α is control parameter, (mW respectively normalized matrixes for SP anomaly and magnetic anomaly and matrix for model parameters and those are expressed as follows. (PTΔ (PU ) ) ) W s )( jj = C s )( jj / U ( j )obs , m ) ( W ii = C ) m ( jj / Δ T ( j )obs , W ) P ( kk = C ) P ( kk / P kk ( j = ,1 iN , s = ,1 kN , t = ,1 m ) where sN and tN are respectively numbers of measurements of SP anomaly and magnetic anomaly, (mC respectively covariance matrixes for magnetic anomaly, SP anomaly and model and in case these are not known we take these as unit. )(sC and (PC , ) ) (6) － 132 － Joint Inversion of Self-Potential(SP) and Magnetic Anomalies by Some Simple Models By adding normalized and weight matrixes for SP and magnetic anomalies and model parameters expressed in equation (6), object function becomes that of abstract number with no dimension and as error terms of SP and magnetic anomalies are incorporated to object function as relative errors , portion of those of two anomalies are so equal that phenomena for only one anomaly to crucially affect on solution of inverse problem can be overcome. rm parameters among parameters of anomalous body are common in formulas of SP and magnetic anomalies. Therefore, in step of inversion to find information of anomalous body from two measurements, these parameters are simultaneously constrained by both anomalies. Expanding formulas of SP and magnetic anomalies to Tyler series around initial approximate vector 0P , truncating high order terms for parameter perturbation and minimizing object function kPΔ , following equation is obtained. (PΦ without respect to Ts Tt TP )( )( ) AWWA BWWB k ( PIWW k α k Δ ] T k s )( T k + = + t )( [ ) P ) ( T k where subscript k is iterative number α control parameter, dWW T A k Ts )( s )( = + )(s kd kPΔ parameter perturbation, I unit  respectively data misfit vector between theoretical and measured SP matrix, anomalies and that between theoretical and measured magnetic anomalies in kth iteration, A and B are matrixes of sensitivities. and )(t kd Tt )( dWWB t )( t )( k After solving equation (7) and finding parameter perturbation kPΔ , solution in next step is (7) k s )( k calculated by =+1 P k (PΦ converges to given error limit. this iteration is repeated until object function ,               (8) Δ+ ) P k P k 2. The Method of Joint Inversion of SP and Magnetic Anomalies for Some Models On the basis of the geophysical principle of joint inversion of SP and magnetic anomalies as above mentioned, I established the joint inversion for some simple models. Although this joint inversion is applied to simple models, this method is basis of joint inversion for arbitrary complex geological section and has also practical significance since there are many objects which can be approximated as these models in nature. 2.1. Sphere model SP anomaly U(x) and magnetic anomaly H(x), Z(x) and ΔT(x) over the sphere as seen in Fig. 2 are respectively expressed. Fig. 2. SP polarization body (a) and magnetic body (b) of sphere shape － 133 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche103(2014) xU 2)( = xM [( s − x 0 ) cos θ − h sin θ (] x 2 + 2/32 ) h (9) xH )( x = μ 0 x M 2 ) m + 2/52 ] h [(4 π x − xH )( y = [(4 π x xZ )( = [(4 π x − − 0 μ 0 x ) − 0 M μ 0 2 x ) 0 M 2 m + 2/52 ] h m + 2/52 ] h (2{[ x − x 0 ) 2 2 − h ] cos i s − xh (3 − x sin) i } s 0 {[( x − x 2 ) 0 2 − h sin] i s cot I sin A ⋅′ cos } λ (10) 2 2{[ h − ( x − x 0 2 sin]) i s − xh (3 − x ) cos i } (11) 0 s Δ xT )( = μ 0 x M 2 ) 0 m + [(4 π x − 2/52 ] h 2 2{[ h − ( x − x 0 2 sin]) i s sin I + + (2( x − x 2 ) 2 − h ) ⋅ cos i cos I cos A s xh (3 − x sin2) i cos I cos A −′ (12) 0 s − (( x − x 0 2 + h ) ⋅ sin i cot I cos I sin ′ } A s 0 2 ) −′ 2 2 ρ 1 2ρρ + 2 1 where sM represented as M s = ε 0 a is dipole moment of sphere( 1ρ and 2ρ are respectively resistivities of country rocks and the sphere, 0ε polarization electromotive force, a radius of the sphere), x horizontal position of measurement point, h and 0x depth and horizontal position of the sphere, θ inclination angle, 0μ absolute permittivity of vacuum, I the inclination of the earth’s magnetic field, si effective magnetic inclination, mM magnetic moment of the sphere, A′ magnetic azimuth angle of survey line, arccos(sin =λ . ) If representing parameter of the magnetic sphere as P }0,0, and parameter of the SP polarization sphere as P s )( = ,0{ xh , , , θ 0 M } s , parameter of the magnetic and SP I sin/ m = ( ) si xhM m , { 0 , polarization sphere P is , After finding parameter perturbation , Mθ kPΔ equations system (7) and solving that, update of the parameter is corrected in equation (8). ,{} PPPPP s 1 3 5 by calculating sensitivity matrix, constructing xhM , { =P = } m 2 4 0 , , , , . Iteration is repeated until relative error ε = )obs ( U ( i − ( PU i |/)) U )obs ( i | + ( )obs (| Δ T i Δ− ( PT i /)) Δ T i ( )obs | (13) s N ∑ 1 i = m N ∑ 1 i = is achieved at given limit and control parameter is set as follows. ⎧ ⎨ .0 ⎩ where 0α is initial control parameter, α k = K , 1 − a × 0 001 k , 0 =α 10 k = ,3,2,1 L 001 × a K 0 and 1 k − 0 =K < .0 5.0 . (14) In the cases of following infinite horizontal cylinder and dike also inversion method is equal to that of the sphere except sensitivity matrix. 2.2. Infinite horizontal dike SP anomaly )(xU and magnetic anomaly )(xH , )(xZ and )(xTΔ over the infinite horizontal 2D dike are respectively expressed. － 134 － Joint Inversion of Self-Potential(SP) and Magnetic Anomalies by Some Simple Models lhMxU + )( {( = sin − )( ϕϕα C D ln) + ⋅ α b cos − l ) + ( x − x − l cos α − b ln) ⋅ r C − 0 ( − ϕϕ A ) − r D − h (15) s x − ( − − ( x − x x 0 0 − b ln) r B + ( x − x + b ln) 0 B r A } γ ⋅ ln + sin ) ϕϕϕϕγ B D [( − − − C ( A (16) γ ⋅ ln + cos ) ϕϕϕϕγ B D [( − − − C ( A (17) xH )( = xZ )( = sin α μ 0 M m 2 π sin α μ 0 M m 2 π ⎧ cos ⎨ ⎩ ⎧ sin ⎨ ⎩ r r ⋅ B C r r ⋅ DA r r ⋅ B C r r ⋅ DA ⎫ )] ⎬ ⎭ ⎫ )] ⎬ ⎭ s ⋅ − − = Δ α α sin I i μ 0 sin( )( xT ln)2 i s sin sin ⎧ cos( ⎨ ⎩ M m 2 π r r ⋅ B C r r ⋅ DA where x is horizontal position of measurement point, sM dipole moment of SP polarization body, h and 0x respectively depth and horizontal position of the dike, b half thick of the dike, I the inclination of the earth’s magnetic field, si effective magnetic inclination, mM  magnetic moment of the magnetic dike, Ar , Br , Cr , Dr represented as 2/12 ] b ) − ϕϕϕϕ D si−=αγ (18) ⎫ ] ⎬ ⎭ 2/12 ] α , , 2 i )[ [( [( − + − , b h x x − + − + = = − C A B 2 2 s rA x 0 x 0 rC rD = [( x − x 0 − l cos α + + ( lh + sin α = [( x − x 0 − l cos α − b ) + ( lh + sin α rB 2 b ) 2 h ) + 2/12 ]) , 2/12 ]) respectively distances between vertical line being gone down measurement point M and points A, B, C and D, Aϕ , Bϕ , Cϕ , and Dϕ angles between vertical line being gone down measurement point M and sight line looking points A, B, C and D(Fig. 3). Fig. 3. The infinite horizontal SP polarization dike (a) and the infinite horizontal magnetic dike (b) If representing parameter of the magnetic dike as P ( m = ) αlbxhM m { , 0 , , , , }0, and parameter of the SP polarization dike as polarization dike P is , P = lbxhM , { , , m 0 s )( P = ,0{ , lbxh , , 0 M , α , , , α M } s , parameter of the magnetic and SP . , } PPPPPPP ,{} 1 4 7 = 5 6 2 3 , , , , s 3. Model Experiments I developed software for joint inversion of SP and magnetic anomalies due to the sphere, infinite horizontal cylinder and infinite horizontal dike on the basis of algorithm which I proposed and carried out model experiments for examining the properties. － 135 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche103(2014) In all model experiments, interval between measurement points is 5m and the numbers of those are respectively 30 and therefore total numbers of those (sum of SP measurements and magnetic measurements) are 60. And the inclination of the earth’s magnetic field is 60° and magnetic azimuth angle of survey line varies from 0° to 90°. 3.1. Properties of joint inversion between SP anomaly and different magnetic anomalies In order to estimate the properties of joint inversion in magnetic anomaly and SP anomaly, I carried out joint inversions of SP anomaly and full magnetic anomaly TΔ , of that and magnetic vertical component Z and of that and magnetic horizontal component H. Result of model experiments for the sphere is given in Fig. 4. As seen in Fig. 4, accuracy and convergence properties of joint inversions of SP anomaly and 3 different components of magnetic anomaly are similar. 3.2. Noise effect To apply the solution of the joint inversion to the interpretation of field data, the joint inversion must be able to overcome the effects of random noise. To simulate field environment, we added random noises corresponding to 1, 5 and 10% of anomaly value in each measurement points to theoretical SP and magnetic anomalies for dike model and estimated stability of random noises of the method. The results are seen in the table. Fig. 4. Properties of convergence of inversions of SP anomaly and components ΔT, Z, H of magnetic anomaly for the sphere Parameters 5% True Approx Estimated True Approx Estimated True Approx Estimated 10% Table. Noise stability for the dike 1% ×mM /( 9 − 5 27 75 5 38 1 − )mA10 ⋅ h/m m/0x 2b )(/ oα   m/l 30 3 2 × − )mV10 sM ⋅ 10 Model relative error/% Data relative error/% /( 2 6 40 2 45 60 4 5.0 27.0 75.0 5.0 38.0 30.1 10.0 5 27 75 5 38 30 10 0.047 0.52 2 6 40 2 45 60 4 0.81 2.26 5.0 27.1 75.2 5.10 38.0 29.4 9.9 5 27 75 5 38 30 10 4.7 26.7 74.6 5.2 37.9 31.2 9.3 2 6 40 2 45 60 4 3.27 4.83 As seen in Table, the noise stabilities for the anomalous sphere body and cylinder is very better and in the case of dike that is also fairly better, when random noises are 1% data and model relative errors are respectively 0.52 and 0.047%, when those are 5% those are respectively 2.26 and 0.81% and when those are 10% those are respectively 4.84 and 3.27%. When random noise is 10%, the result of joint inversion for the dike is seen in Fig. 5. Curves at which random noise added, theoretical curves, initial approximation model and true model before － 136 － Joint Inversion of Self-Potential(SP) and Magnetic Anomalies by Some Simple Models the joint inversion are seen in Fig. 5(a) and those after that are seen in Fig. 5(b). Fig. 5. Result of joint invers0ion for dike 1－SP anomaly, 2－magnetic anomaly, 3－inverted SP anomaly, 4－inverted magnetic anomaly 4. Field Example In investigation region, the rocks of Sadangu group(Banchon, Obongsan and Nadong formations) and Jikhyon group(Hoechang and Mulgumsan formations) in Mesoproterozoic era, the Proterozoic Eon and Mukchon group(Machon and Yonsan formations) in Neoproterozoic era, the Proterozoic Eon are developing. The composition of minerals of the ore bodies in the investigation region are mainly copper pyrites, natural gold, iron pyrites, pyrrhotine and arsenopyrite. To elucidate the development properties of the ore bodies in the investigation region, I performed both SP and magnetic field measurements setting two survey networks. Taking account of strike of the geological formations, in the first survey network the strike of survey line set as North-East 30°, whereas in the second network that set as North-East 35°. In two survey networks the length of survey line was 120m, interval between lines 20m and distance between measurement points 5m. In the first network total number of survey lines was 26 and in the second network that was 15. The strikes of the SP and magnetic anomalies is coincided with each other, which are about North-West 305～310° and lengths of horizontal extension of anomalies are about 1 200m. Fig. 6 shows SP and magnetic anomalies(solid lines) measured on No.5 survey line in the second survey network and inverted results. The joint inversion was carried out assuming anomalous body as the dike. As seen in the inverted results(Fig. 6), the thickness, depth, extension, horizontal center position and inclination angle of the dike were respectively 9.8m, 11.9m, 184.6m, 50.7m and 45ﾟ, which were verified by means of drilling. － 137 － Journal of Kim Il Sung University (Natural Science) No. 1 Juche103(2014) Fig. 6. SP and magnetic anomalies(solid line) measured on the No.5 survey line, inverted anomalies(circles) and inverted dike Conclusion  I developed the joint inversion of SP and magnetic prospecting methods which are effective in mineral exploration. The algorithm is similar to quasi Gauss-Newton algorithm. I proposed reasonable arrangement method of elements of two parameter vectors of same source of generating different fields and the method normalizing two fields and elements of parameter vectors of model with different dimension and realized effective joint inversion. The proposed method can be applied to exploration of objects with shapes such as the sphere, cylinder and dike. Although our method is for only simple some models, it is the basis of jointly inverting SP and magnetic anomalies in the complex geological section. Model experiments show that the joint inversion of SP and magnetic anomalies has obvious advantages compared with the solution of single inversion. Those advantages are that the joint inversion has great convergence radius, little uncertainty and high accuracy of the estimation. In the future, this joint inversion must be advanced to the joint imaging method for inverting arbitrary complex geological section. When the number of parameters to estimate is very much (to avoid calculation of sensitivity matrix) or it is difficult to reasonably set initial approximation, it is better to use global optimization algorithm such as GA, SA and NA as joint inversion algorithm. － 138 － Joint Inversion of Self-Potential(SP) and Magnetic Anomalies by Some Simple Models References [1] C. Benech et al.; Geophysics, 67, 6, 1729, 2002. [2] L. A. Gallardo et al.; Geophysics, 68, 3, 949, 2003. [3] A. Hering et al.; Geophysical Prospecting, 43, 135, 1995. [4] H. V. Ram Babu; Geophysics, 68, 1, 181, 2003. [5] K. Vozoff et al.; Geophysical Journal of the Royal Astronomical Society, 42, 977, 1975. [6] S. K. Verma et al.; Journal of Electromagnetic Waves and Applications, 7, 3, 443, 1993. [7] J. Jansky et al.; Geophysical Prospecting, 58, 229, 2010. － 139 －