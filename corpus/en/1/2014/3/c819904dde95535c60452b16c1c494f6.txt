Journal of Kim Il Sung University (Natural Science) Vol. 3 No. 3 Juche103(2014) Proof that the Maximally Localized Wannier Functions  should be Real and Symmetrical Ri Sang Ryol, Ri Su Il and Kim Nam Hyok Abstract We found out the conditions under which Wannier functions should be maximally localized on the phases of the plane wave coefficients using a plane wave basis set, noting the fact that the physical properties of a crystal must not be changed by the point group operations. We concluded that the plane wave coefficients of the wave functions from which the maximally localized Wannier functions are derived should be real and the coefficients of plane waves consisting of the reciprocal lattice points that are symmetrical on the point group (inversion) operations should be equal (sign is equal or opposite). The periodic part of Bloch wave function can be expanded by a symmetrical and real basis set from these results. In this case, the plane wave coefficients of the wave functions automatically become real and the condition of the maximum locality is satisfied. By the use of our results, the calculations of the maximally localized Wannier functions could be carried out more easily. Key words Waninier function, density functional theory  Introduction  The great leader Comrade Kim Il Sung said as follows. “We must develop science and technology quickly in many fields in step with world trends in modern science and in keeping with the present requirements of socialist construction in our country.”(“KIM IL SUNG WORKS” Vol. 41 P. 34) The use of the maximally localized Wannier functions is important for investigating the electronic transport properties of the device with the characteristics of the chemical bonds. In this field, it is important to establish the effective scheme for saving the computational time. It was conjectured that the maximally localized Wannier functions may always be real [1]. But we found the conditions to obtain the maximally localized Wannier functions by the use of the symmetry of a system and proved that when Wannier functions are maximally localized, the coefficients of plane waves consisting of the reciprocal lattice points which are symmetrical under the point group (inversion) operations are equal and real. The proof of this conjecture has not been reported yet [2－7]. The use of single plane waves for calculating the Kohn-Sham wave functions does not explicitly exploit the symmetry of the system. But the computational cost of such a calculation could be drastically reduced by using the symmetrized combinations of plane waves. － 32 － Proof that the Maximally Localized Wannier Functions should be Real and Symmetrical ∑ G ∑ G In this paper, we review the concepts of Bloch’s theorem and Wannier functions briefly and prove that the maximally localized Wannier functions are real and symmetrical. 1. Bloch’s Theorem and Wannier Functions Bloch’s theorem states that in a periodic system each electronic wave function can be written as the product of a cell-periodic part and a plane-wavelike part, ψ n , k )( r = i exp( rk ⋅ u ) n , k )( r (1) The cell-periodic part of the wave function can be expanded using a basis set consisting of a discrete set of plane waves whose wave vectors are reciprocal lattice vectors of the crystal.              (2) i exp( rG ⋅ r )( = u c ) n , k n , k where the reciprocal lattice vectors G are defined by crystal and m is an integer. mπ2=⋅ lG for all lattice vector l of the nψ , k r )( = cn , k G ( ) i exp[ ( rGk ]) + (3) A Wannier function nw ( Rr − ) associated with the unit cell labeled by the lattice vector R is usually defined by a Fourier transform of the Bloch functions of the nth band: w n ( Rr − ) = V 3 )2( π ∫ ψ n , k BZ r )( exp( Rk i ⋅− ) d k (4) 3 where V is the volume of the unit cell and the integration is performed over the entire Brillouin zone. Since the overall phase of each wave function is arbitrary, any Bloch function is subjected to a “gauge transformation” ′→ ψ n ,          (5) [ r )( i exp ψφ n ψ n r )( r )( r )( = ] n k k k , , , which leaves unchanged all physically meaningful quantities. Besides this freedom in the choice of phases for the Bloch functions, there is a more comprehensive gauge freedom coming from the fact that the many-body wave function is actually a Slater determinant: a unitary transformation between orbital will not change the total energy and the charge density of the system. In general, starting with a set of N Bloch functions, we can construct infinite sets of N Wannier functions displaying different spatial characteristics: w n ( Rr − ) = U ψ m , mn k r )( exp( Rk i ⋅− ) d k (6) 3 V 3 )2( π ⎡ ∫ ∑ ⎢ ⎢ ⎣ BZ m ⎤ ⎥ ⎥ ⎦ (kU ) The unitary matrix also includes the gauge freedom on phase factors. Finding the maximally localized Wannier functions means to search the unitary transformation  that transform the Bloch wave functions into the Wannier functions with the narrowest spatial distribution. A measure of the spatial delocalization of Wannier functions is given by the mean square spread Ω , defined as the sum of the second moments of all the Wannier functions in a reference cell: (kU ) =Ω ⎛ ⎜ ⎝ ∑ n 2 r − r n 2 n ⎞ ⎟ ⎠ － 33 － (7) where where ∑ G V Journal of Kim Il Sung University (Natural Science) No. 3 Juche103(2014) where the sum is over a selected group of bands, and r r = = n n 0 r n 0 n (8) 0 r n 0 n (9) 0 n = w n )( r = V 3 )2( π ∫ ψ n , k BZ 3 )( r d k (10) 2. The Maximally Localized Wannier Functions If Wannier functions are maximally localized, the periodic part of the corresponding Bloch wave function should be expanded into the real and symmetrical function. Let us assume that the Wannier functions corresponding to equation (3) are maximally localized. We can write the corresponding Wannier functions as follows: )( r i rG exp( ⋅ ( G = c ) ) (11) w n n , r c n , r ( G ) = 3 )2( π n , r ∫ c BZ ( G ) rk i exp( ⋅ d ) k (12) 3 Inserting equation (11) into (8) and (9), we obtain ′ ) (13) 2 r = n V 6 )2( π ∑ GG , 2 , ( GGI r ′ r = n V 6 )2( π ∑ GG , , ( GGI r ′ ′ ) ( kGG ′−+′− k )] 3 dd r 3 d k 3 k ′ (13a) ( kGG ′−+′− ]) rk 3 dd r 3 k d 3 k ′ (14a) * n 2 cr , , n k ) c (2 =′ ) ( G ( G GGI r ∫∫∫ ∫∫∫ r In (13) and (14), we can write in the case of ( GGI r GGI r GGI r i exp[ i exp[ =′ ) ( G ( G +′ ) −= ′ ) ′ ) * n c c ′ , ) ( c r k k k n , ( ) n k , , , , ′ , 2 k as follows: ( G ϕ ϕ n − ) k , ′−+′− ) rk ⋅ , n ) c ( G ∫∫∫ 2 [ cos ( kGG ∫∫∫ sin[( ( G 2 c r n k , ⋅ cos[ ′ ′≠ GG ′ ( G ) ] 3 dd r ( G ′ sin) 3 3 k ′ d k [ ϕ n k d kGG ′−+′− ]) rk 3 dd r 3 3 k ′ ( G ′ )] ⋅ , kn ′ (13b) GGI r ( , +′ ) ′ , GGI r ( ) −= ) c n , k ′ ( G ) − ϕ n , k ′ , k ( G ′ ) ] ⋅ (14b) On the otherwise ( , 2 r GGI r (2 ) ′= GG 2 c ( G ) is as follows:  ) ) ( G cos ( G c n , k ′ n , k , k ) − ϕ n , k ′ ( G GGI r ( , ( G ) c ( G ) n , k ′ n , k ϕ n , k ( G ) − ϕ n , k ′ [ ϕ n sin[ k ) ] cos[( ( G )] sin[( ′− ]) rk 3 dd r 3 k d 3 k ′ (13c) k ′− ]) rk 3 dd r 3 d k 3 k ′ (14c) where , Gknc ( ) and ) means the absolute value and phase of , Gknc ( ) respectively. All the terms in contain cosine and those in r include sine. Therefore, all the n terms in the mean square spread Ω contain cosine with respect to for any ,n Gk, . From the condition that the derivative is zero, the phases of all the coefficients should have the type of = ∫∫∫ ) −= r c 2 ∫∫∫ , Gknϕ ( 2r n － 34 － Proof that the Maximally Localized Wannier Functions should be Real and Symmetrical , where α is common over all phases and n is any integer. This means that all πα n+ coefficients must be real (positive or negative depending on the value of n ) excepting a common phase α . In other words, if Wannier functions are maximally localized, all coefficients of equation (3) should be real. From now on, we’ll find the maximally localized condition on the different factors thinking that all coefficients are real. Let α be a point group operator. Since the Hamiltonian of the system is not changed by the point group operation, the periodic parts of Bloch wave function can be written as follows: ∑ (15) i rG exp( ⋅ * u λ )( r * λ rα ( G = = u c ) ) ( ) k k k n n n , , , G where λ is an arbitrary complex of which absolute values is 1 and ‘*’ means the complex conjugate. We also obtain u n , k r ( α ) = c n , k ( G ) i exp( rG ⋅ α ) = c n , k ( G ) 1 − i exp( rG ⋅ α ) (16) ∑ G ∑ G From equations (15) and (16), we obtain 1 − G ( α * λ c n , k ) = c n , k G ( ), c n , k 1 − G ( α ) = c λ n , k (17) ) ( and )( rknψ , From equation (17), we find that the maximally localized condition is destroyed as the . Therefore, in the functions that  have the difference of phase factor, Wannier functions corresponding complex coefficients appear in equation (3), unless r k αnψ , are maximally localized. Considering the symmetry to the wave functions with property of a crystal, we confirm that λ must be 1 but not –1(see Appendix). So, the coefficients of plane waves consisting of the reciprocal lattice points that are symmetrical on the point group operations should be equal. 1±=λ 1±=λ We can also easily obtain the same result with the case of the point group operation as the Hamiltonian of a system is not changed by the conjugate operation. As a result, we have obtained the results that all the coefficients of plane waves composed of the reciprocal lattice points that are symmetrical on all of the point group operations of the system should be equal and real( in the case of the inversion operation, these should be equal or opposite). When we only consider the inversion symmetry we can write equation (2) into the type that expand the periodic part of the wave function by the . Combining the plane waves composed of the reciprocal real basis set or cos( rG ⋅ rG ⋅ sin( ) ) lattice points that are point group symmetrical, a real basis set similar to star is obtained [3, 4]. For example, in the case of the zincblende or diamond structure, the real and symmetrical basis set is as follows A r )( = ∑ γβα , , ⎛ cos ⎜ ⎝ 2 π a x α ⎞ ⎟ ⎠ ⎛ cos ⎜ ⎝ 2 π a y β ⎞ ⎟ ⎠ ⎛ cos ⎜ ⎝ 2 π a ⎞ ⎟ ⎠ z γ (18a) － 35 － or Journal of Kim Il Sung University (Natural Science) No. 3 Juche103(2014) A r )( = ∑ sin γβα , , 2 π a ⎛ ⎜ ⎝ ⎞ ⎟ ⎠ 2 π a ⎛ ⎜ ⎝ ⎞ ⎟ ⎠ 2 π a ⎛ ⎜ ⎝ ⎞ ⎟ ⎠ x α sin y β sin z γ (18b) , γβα , where possible commutation on are the positive integers and a is the length of unit cell. The sum is over the , which are taken in the irreducible zone of the reciprocal space.  , the equation Expanding the periodic part of wave function with the real basis set γβα , , )(rmA (3) is written as kψ , n = c n , k ( m ) rk exp( i ⋅ ) A m r )( (19) ∑ m From this we find that the Hamiltonian matrix deriving from the real basis sets is real one. Using the pointed basis sets, the possibility which the Hamiltonian matrix is the complex . The part depending on k in the calculation of Hamiltonian one would come from exp( i rk ⋅ ) matrix elements with the conventional plane wave basis set is only the kinetic energy when in the conventional calculation is the real potential is used. The kinetic energy part, 2 G k + 2 | | replaced by 2 G k + 2 and real. Therefore, all of the s in (19) becomes real and the k,nc extreme condition is automatically satisfied. In other words, if Wannier functions are maximally localized, the corresponding wave functions should be written by (19). If the periodic part of the wave function is expanded by the real and symmetrical basis set, the corresponding Wannier functions are real and symmetrical. The periodic part of the wave function in (19) is symmetrical on k points. For this, it is sufficient to show that the and the parts of Hamiltonian matrix elements for k and kα are equal.  Since ( k k α= ) 2 2 kinetic energy are equal, the Hamiltonian matrix elements are equal. Therefore, we can write as follows: c n , k ( cm ) α= , n k ( m ) (20) Now, we’d like to prove that Wannier functions corresponding to (19) are real and symmetrical. The maximally localized Wannier functions corresponding to (19) are as follows: ∑= (21) A m w n r )( r )( c n r , m where c ( m ) = n , r ( m ) exp( i rk ⋅ ) d k . Using the equation. (20), we obtain 3 c * n , k ( m ) = ( m ) exp( i ⋅− rk ) d k = 3 n , k ( m ) rk i exp( ⋅ ) d k = 3 n , − k V 3 )2( π n , k ∫ c BZ 3 )2( π V V = 3 )2( π ∫ c BZ ∫ c BZ V 3 )2( π n , k ∫ c BZ = V 3 )2( π ∫ c BZ ( m ) i exp( rk ⋅ ) d k = c ( m ) n , k n , k 3 V 3 )2( π ∫ c BZ V 3 )2( π ∫ c BZ ( m ) rk i exp( ⋅ ) d k = c ( m ) n , r n , k 3 － 36 － c n , r α ( m ) = ( m ) 1 − i rk exp( α ⋅ ) d 3 k = ( m ) i exp( rk ⋅ ) d k = 3 n , k α (22) (23) Proof that the Maximally Localized Wannier Functions should be Real and Symmetrical From (22) and (23), we find that the maximally localized Wannier function (21) is real and symmetrical. If Wannier functions are real and symmetrical, these are maximally localized on the above conditions. Let’s consider the wave function written as (19). If one of the coefficients of (21) has the infinite sigma phase δ, we can write w n (24) ) Am m Ai ) δ s exp( r )( r )( r )( )( s + = c c ( n n r r , , ∑ sm ≠ Substituting exp( i δ +≈ 1) i δ , equation. (24) is rewritten as ′ w n r )( ≈ w n r )( ci δ+ As )( s n , r r )( (25) Calculating the mean square spread, we obtain 0≥Ω−Ω′=Ωδ (26) where ′ w n rr )( 2 ′ w n r )( − ′ w n rr )( ′ w n r )( (26a) w n rr )( w n r )( − w n rr )( w n r )( 2 (26b) 2 2 ⎞ ⎟ ⎠ ⎞ ⎟ ⎠ =Ω′ =Ω ⎛ ⎜ ⎝ ∑ n ⎛ ⎜ ⎝ ∑ n 2 δ =Ω c n , r )( As s )( rr c n , r )( As s )( r c n , r )( As s )( rr c n , r )( As s 2 δ − ( ) r 2 4 δ ⎞ ⎟ ⎠ (26c) We can easily check that 0≥Ωδ as follows: c n , r As )( s )( rr c n , r As )( s )( r 2 2 δ − c n , r As )( s )( rr c n , r As )( s )( r 2 4 δ > ⎛ ⎜ ⎝ ∑ n ⎛ ⎜ ⎝ ⎛ ⎜ ⎝ 4 δ > ⎛ ⎜ ⎝ 4 δ = ⎛ ⎜ ⎝ 4 δ = 4 δ > c n , r )( As s )( r 2 cr As )( s )( r − c As )( s )( rr c n , r As )( s )( r n , r n , r 4 δ = c n , r As )( s )( r 2 cr As )( s )( r n , r − 2 c As )( s )( rr c n , r As )( s )( r n , r 2 ⎞ =⎟ ⎠ 2 + 2 2 + c As )( s )( rr c n , r As )( s )( r n , r A s )( r A s )( r ⎞ >⎟ ⎠ c n , r As )( s )( rr c n , r As )( s )( r − 2 c As )( s )( rr c n , r As )( s )( r n , r 2 2 + + c As )( s )( rr c n , r As )( s )( r n , r c n , r As )( s )( r c n , r As )( s )( r ⎞ =⎟ ⎠ c n , r As )( s )( rr c n , r As )( s )( r 2 − 2 r 2 2 + r c n , r As )( s )( r c n , r As )( s )( r ⎞ =⎟ ⎠ c n , r As )( s )( r ( r − r ) 2 c n , r As )( s )( r > 0 where r c= sA s )( rr c n , r sA s )( r n , r and we used the inequality c ( m ) < n , r V 3 )2( π ∫ BZ c n , k 3 ( dm ) k < 1 . From equation (26), we can find that if Wannier functions are real, these are maximally localized. If Wannier functions are not symmetrical (if a basis set is not symmetrical), the complex coefficients appear. So, if Wannier functions are symmetrical, these are maximally localized. － 37 － Journal of Kim Il Sung University (Natural Science) No. 3 Juche103(2014) As a result, we have proved that the maximally localized Wannier functions are real and symmetrical. And we find that the condition of the maximal locality on the phases is automatically satisfied if the periodic part of Bloch wave function is expanded by not only the periodic, but also symmetrical and real basis set. Using a real basis set mentioned above, the computational cost can be also drastically reduced in the conventional band structure calculations. Conclusion  We have proved the conjecture in the case of plane wave expansion, in which the maximally localized Wannier functions should be real. Therefore, the real basis sets can be constructed for periodic part of Bloch’s wave function in the method of plane wave expansion, using the point group symmetry of crystal.  Then, the expansion coefficients automatically become real and the corresponding Wannier functions also become symmetrical and real. References [1] N. Marzari et al.; Phys. Rev., B 56, 12856, 1997. [2] I. Souza et al.; Phys. Rev., B 65, 035109, 2001. [3] U. Birkenheuer et al.; Phys. Rev., B 71, 125116, 2005. [4] O. Painter et al.; Phys. Rev., B 68, 035214, 2003. [5] C. K. Skytaris et al.; Phys. Rev., B 66, 035119, 2002. [6] J. R. Yates et al.; Phys. Rev. B 75, 195121, 2007. [7] N. Marzari et al.; arXiv: 2, 1112.5411v2, 2012. － 38 －