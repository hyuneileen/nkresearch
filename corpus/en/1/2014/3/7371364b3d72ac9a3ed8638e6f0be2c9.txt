Journal of Kim Il Sung University (Natural Science) Vol. 3 No. 3 Juche103(2014) DEM-based Modeling Method of Concentration Process of Surface Runoff Rim Hyon Min Abstract A digital elevation model DEM-based surface runoff modeling is the method to simulate the flow process by heavy rain using DEM grids as a unit. In this method we calculate the flow direction of each grid by using GIS and then analyze the flow in the virtual flow route by the finite volume-based numerical solution of diffusion wave which approximate to St. Venant equations. The results by this model show that this provides the sufficient prediction of the surface runoff process. The surface runoff model based on DEM model is one of the distributed hydrologic models which we consider elements influencing to the generation of the runoff as grid unit, so we can simulate the spatial distribution of runoff change generated by heavy rain in the flood with this method. Key words flood, DEM, GIS, RS Introduction  The great leader Comrade Kim Il Sung said as follows. “We must also take steps to prevent damage caused by floods of rain.” (“KIM IL SUNG WORKS” Vol. 31 P. 39) The runoff phenomenon which occurs in the surface of the river basin area is very complicated process which interact the influence of spatial and temporal variability of climatologic and topographical characteristics. The characteristics to influence the generation of the runoff consists of the area shape (such as area, slope and drainage network), soil and vegetation cover, and underlying geology. The spatial information necessary for simulating the runoff phenomena on the surface of the basin area will be gained by using the information of the remote sensing(RS) and Geographic Information System (GIS) technologies [2, 3]. The modeling of the surface runoff by precipitation can be done in a mathematic way [1, 2, 4, 5]. By regarding past researched modeling, there are two types, lumped parameter model and distributed parameter model. Recently as we can get overall information of the basin area by using remote sensing data, the investigation of the distributed parameter models are intensifying. This distributed parameter model has an advantage of studying the runoff states in overall surface of the basin. The study on distributed hydrological models concentrate on dividing the basins into the grid-based catchments by using DEM, getting the influence factors which influence on the runoff generation by using GIS spatial analysis function and reproducing the runoff phenomena in the real situations. － 117 － Journal of Kim Il Sung University (Natural Science) No. 3 Juche103(2014) When we separate the catchments area into grid unit, there must be existing flat grid area of which slope is zero. This prohibits from applying the kinematics wave approximation. So in this case, in order to get the solution of the kinematics wave approximation, we need the special method. This kind of the obstacles can be overcome by using diffusion wave approximation [4]. The flow direction in overall basin can be calculated by deciding the flow direction of each grid using DEM. Spatially distributed information for model inputs, such as topography, soil, land use and etc. for each grid can be obtained by GIS. The drain direction matrix (DDM) based on DEM may be determined by 8 direction methods [3]. By using a ﬁnite volume-based numerical solution of the diffusion wave which approximate to the St. Venant equations for DEM-derived overland ﬂow and channel ﬂow, we can compute the cell basis procedures such as the ﬂow discharge, depth, and velocity caused by rainfall. That is, we can reveal the runoff generation process in overall basin. 1. Modeling Method of Concentration Process of Surface Runoff We simulate the concentration process of surface runoff in the river basin by calculating the St. Venant equations which are normally used in the examination of water movement with finite volume methods (FVM) [1]. 1.1. Basic equation of flood runoff The catchments procedures of surface runoff in the basin areas are represented as the flow in the regarding cross section after the each element’s rain fall according to some direction and length. At that time the movements of the flood wave is the non-stationary flow changing temporally and spatially, so that we can denote this by St. Venant equations. S 0 − h ∂ x ∂ = u ∂ tg ∂ + uu ∂ xg ∂ + 2 u 2 Rc (1) In the continuity equation, considering unit width and assuming that it evenly rains in the region per unit calculating hour, the continuity equation is as follows: h ∂ t ∂ + ∂ ) hu ( x ∂ r −= f (2) In the equation (1) and (2), 0S is the gradient of the area, h is the depth of the flow(m), u is the average current velocity(m/s), x is the distance in the direction of the flow(m), t is time(s), r is the rainfall rate(mm/s), f is infiltrate rate(mm/s), c is the coefficient of the flow velocity, R is the hydrodynamic radius. And in the equation (3),  is the inertial slope characterized by changing the flow rate by time,  is the inertial slope is the water surface slope, xguu ∂ ∂ / u ∂ t h ∂− ∂ / x ∂ S / 0 characterized by changing of the flow rate by length, characterized by the friction resistance. 2 / 2 Rc u is the friction resistance slope The kinetic equation and continuity equation constitute a set of non-linear partial differential equations, which cannot be solved mathematically without any hypothesis, so in calculating procedure, － 118 － DEM-based Modeling Method of Concentration Process of Surface Runoff we can solve these equations by digital modeling of the flood flow. Namely, we have to discrete the differential equation (integrate equation) by transforming algebraic equation. In the discretization methods, there are many methods such as Finite Difference Method(FDM), Finite Element Method(FEM), Finite Volume Method(FVM) [4]. The previous papers reveal that it is very complicated to calculate, but even the precisions don’t enhance, to account all the terms of St. Venant kinetic equations in solving the flood flow characteristic. Specially in the basins of which flow slope of flow is more than 0.9m/1km, the inertial slope is very smaller than the friction resistance slope and the inertial slope may have opposite signs according to the territorial and temporal properties, so that we can get the sufficient results even though neglecting the inertial terms [4]. Assuming that the flood wave movement is the stationary movement in a very short time in the slopes of the river basin, the first term and the second term of the right side of the equation (1) will be neglected and then the kinetics equation will be the cross-section mean velocity formula of the uniform flow. S 0 − h ∂ x ∂ = 2 u 2 Rc = fS (3) where fS is the slope of the friction. Combining equations (2) and (3) and denoting as vector notations, this is as follows: = G (4) C ∂ t ∂ uh ⎛ ⎜⎜ h ⎝ + F ∂ x ∂ ⎞ ⎟⎟  , ⎠ h 0 ⎛ ⎜⎜ ⎝ ⎞ ⎟⎟  , ⎠ r − f S 0 − fS ⎛ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎠ C = F = G = (5) 1.2. Numerical solution The equations (4) and (5) are the governing equations and constitute the non-linear partial differential equations system, so we can numerically solve this by finite volume method(FVM) [1, 4]. The finite volume method has two advantages because this has combined with the principle accurate property of the weighted residual method and the simplicity of the finite difference methods. First of all, in the FVM, the discretization is conservational. That is, mass, the kinetic moment and energy conserve during discretization. Secondly, the FVM doesn’t require the transformation of the coordination so that complicated geometrical figures will be treated simply. The FVM divided the objects into the finite cells (for ex, polyhedral figure and polygon in the 2 dimensional space) and then discrete the object by the unit of this grid cell. In the catchments simulation of the surface runoff based on the digital elevation model(DEM), considering that the main unit is the grid style-digital elevation model, we can think that this thinking style is same as the ones of the FVM. If we calculate the equation (4) and (5) numerically by FVM for each grid cell covering overall basins, we can get the flux and deep of the flow and the velocity of the flow for all grid cells of the calculating area. － 119 － Journal of Kim Il Sung University (Natural Science) No. 3 Juche103(2014) For one cell, integrating two sides of the equation (4) and then applying Ostogramski formula, the final result is as follows: C ∂ t ∂ ∫ ν ∫ s ∫ ν d ν + ( nF ⋅ ) ds = G d ν (6) where F is the flux of the controlling face and the n is the unit normal vector of the boundary. The first term of equation (6) denotes the integration of temporal change on the grid and the second term is the overall standard flux in the boundary of the grid. Let’s consider the vector C as the constant within one cell. If we discrete equation (6) and apply FVM to one cell, the result is as follows: m A i i C ∂ t ∂ + ∑ j LF i j =⋅ i A i G i j (7) where the iA is the area of ith cells and m is the value which add 1 to the total number of the neighbor lattices, out-flowed to ith cell and here 1 means the out-ward cell． j iL is the width of the incoming flux to ith cell and jth cell’s flux width. By discreting the equation (7), we can predict the ith cells vector C at the unknown time ( t Δ+ t m ∑ 1 j = where t is the value at the known time (t), * is the prediction value to get the value at the unknown time ( ). And tΔ is the step of calculating time. (8) t Δ A i t Δ+ t Δ+ j L i t G F i C C ∗ i − = t i t i ) ( ⋅ j t ⎡ ⎢ ⎢ ⎣ ). ⎤ ⎥ ⎥ ⎦ 1.3. Modeling method of surface runoff After we made the DEM and the DDM of the basin, we can simulate the catchments process of surface runoff by using the equation (8). When we rearrange the equation (8) regarding the deep of the flow, the result is as follows: t Δ A i =∗ h i t h i + Q ( t in , i − Q t ,out i ) (9) Q t ,in i = Q t up, i + t rA ( i i − t f i ) (10) 1 m − ∑ Q 1 j = in is the total inﬂow in cell i at time t; t iQ ,up the in-ﬂow in cell i from adjacent upstream iQ , (11) t ,out t ,up Q = i j where t cells at time t; and t iQ ,out the outﬂow from cell j at time t, t ir and t if is the rainfall rate and the infiltrate value on the ith cells at time t. According to equation (8), the slope of the friction is as follows: S ∗ f S = 0 − ∗ h k ∗ h i − l i (12) In equation (12) il is the routing distance between grid cell centers of i and k, which is equal to the width of cell (L) for cells. As shown in Fig. 1 when the ﬂow is in the orthogonal direction, － 120 － DEM-based Modeling Method of Concentration Process of Surface Runoff 2/L . For cells having ﬂow in diagonal direction the routing distance is equal is equal to l i =′= l i to l i =′′= l i 2/L . The velocity of the flow which comes out from one cell at *time can be calculated as follows: u =∗ i ( h 3/2* ) i ( S 2/1* ) if (13) 1 n i where in is the Manning’s roughness coefficient for ith cell. So the out-come flux from one cell is equal to the multiplex of the unit flux ∗ q ,out and the width of cell L. i q ∗ ,out i = 3/5 ( ∗ h i ) ( S 2/1 ) ∗ if (14) 1 n i Q ∗ ,out i = q ∗ ,out i L (15) Fig. 1. One-dimensional grid discretization for numerical computations for simulation of surface runoff on DEM In the diagonal flux, the flux of the cubic cells will run out at the angle degree 45° and would be divided into two same parts (Fig. 2). So the out-coming flux of ith cells in the diagonal flow, at *time, is equal to followings: ∗ q ,out 2 The final value of the vector C, at time LqLq + 1 ∗ ,out 2 ∗ ,out Q L + = = q 2 i i i qL = ∗ ,out i L (16) 1+t will be computed from the value at t time and the mean prediction value from equation (9) and (15). ⎡ ⎢ ⎢ ⎣ (17) t Δ A i t Δ+ * G i ∑ 5.0 j L i ⎤ ⎥ ⎥ ⎦ F i ⎧ ⎪ C ⎨ ⎪⎩ ⎫ ⎪  ⎬ ⎪⎭ C C * i − = + 1 + t i t i m ) ( * ⋅ j j Fig. 2. Depiction offlow in dia- gonal direction from a cell 1.4. Initial condition and boundary condition The initial condition 0=t , that is dry surface. Q i 0 i ,out where M is the total number of the grid cells of the basin. The boundary condition is (18) 0 h i M ,0 ,1 = = = up =Q 0 , that is the in-flow is zero. At the out come cells of the basin, the following boundary condition is equal to: h = k where k is the index of the out-come grid cell. h k 1+ (19) The above using numerical structure has the same condition as equation (20) (CFL‐Coutant Friedrichs Lewy). ) t Δ gh L ⎞ ⎟ ⎟ ⎠ max + u ( ⎛ ⎜ ⎜ ⎝ 2s/m ). where g is the gravitation acceleration( － 121 － ≤ 1 (20) Journal of Kim Il Sung University (Natural Science) No. 3 Juche103(2014) 2. Parameter Determination The main parameters which influence to the simulation of the catchments of the surface runoff based on DEM are the computing time step tΔ , and Manning’s roughness coefficient n and CN used in calculation of the effect rain fall. And the method to determine these above parameters are as follows. 2.1. Determination method of computing time step tΔ  Because the elevation of each grid cells in the basin are different from each cells and the deep of the water and the friction slope are different from each timing, so the runoff time (the time in which the flow run from each cells to adjacent cells) would be represented differently for each cells. This causes the flux synthesis problem according to the runoff time for each cell while we compute the flood runoff procedures. In this paper, we estimate the effect of the computing step time tΔ to the synthesis of flux in each cell and studied on the reasonable method to determine this time. At a certain ith cell, the deep of the water at the time ⋅Δ , is, from equation (9), the summation ) at the previous time t and remaining rainfall rate of the total inflow rate ( 1+t Qt t in , / i A i ( t h i t ,out t h Δ= i t i / A i Qt ) in itself. ⋅Δ− iτ is the time when the water run out from ith cells at the time t to the adjacent cell(runoff , that is, the runoff is larger than tΔ , at the ith cells, the amount of water, t t τ<Δ i is run out from this cell and the amount of water t h i ⋅Δ− Qt t ,out / A i i t h Δ= i would time). When, t ,out / i A i Qt ⋅Δ remain in its cell. When , that is, the runoff time is smaller than tΔ , then at the ith cell t the amount of water would run out from its cell and the remaining water would be t Δ≤τ i t ,out / i Q A i t ⋅τ i zero ( 0=Δ t ih ). 5, 10 and 15min. For example, let’s assume that at a certain point, 1j , 2j , th 3j cell’s runoff time is respectively If 10=Δt min, then at the 1j , th are no remaining water. Meanwhile, at the th 2j cells, all the water will run out and in these cells, there 3j cell, the amount of water for 10 min will run out and then the amount of water for 5 min will remain. The smaller tΔ is, the better we consider the synthesis of the flux and the remaining water. So we can approach more closely to the real situation. If we make the tΔ larger, it will occur the distortion of the flux, causing the destruction of the continuity condition, because we have to consider that, at the cells in which the runoff time are smaller than tΔ , the water will run over from this to the only adjacent cells in despite of the water can run over to several cells. And the reason also is, that we consider that we synthesis the adjacent cells flux of a certain cell. So we have to set the computing time step smaller than the runoff time of each cells and to do this, the safety condition (20) must be satisfied. － 122 － DEM-based Modeling Method of Concentration Process of Surface Runoff 2.2. Determination method of Manning’s roughness coefficient n and CN The Manning’s roughness coefficient n is the value which represents status of the basin surface and it is very important to determine this value in calculating runoff process. Relatively if n becomes larger, the peak of the flood will be smaller, the presenting time will delay and so the presenting time of the peak of flood will delay. Oppositely, if the n becomes smaller, peak of the flood is larger and its phase will be proceeded. In the paper[6] they reveal experimental value of the Manning’s roughness coefficient n in table 1. Table 1. Experimental value of Maning’s roughness coefficient(n) according to usage of land Division Cultivated land Half cultivated land Natural area Light brush and trees Residential area n 0.075 0.140 0.150 0.650 0.065 We determine the spatially distributed Manning’s coefficient n by the following method. By using GIS, we overlap the drainage direction matrix (DDM) and the usage of the soil together and then we can reveal the fact that every cell belongs to the certain usage of the soil. And then we survey the usage of the soil at the every grid cell and then get the n value for this usage value from the property database. The value CN which is used in computing effective precipitation in SCS model also could be determined by above method. When we operate the overlap operation, we firstly confirm the parameter value by weight mean method, if several subjects of theme map are placed in a cell. if is the area of each subject of the theme map in one cell, iX is the parameter value of each subject in the theme map, X is the mean value of parameter in the grid cell, F is the area of the grid cell, iϕ is the weight rate of each subject of the theme map in one cell. Then the mean value of the parameters in a cell, which was calculated by the weight mean method, will be denoted as follows. Xf 1 1 + Xf 2 + + L Xf n n X = 2 F = 1 F n ∑ = 1 i Xf i i = n ∑ ϕ i = 1 i X i (21) where the weight rate is =ϕ i Ffi / . The experimental values of spatially distributed parameters (for example n, CN) must be calibrated, because these values can’t represent the real hydrological phenomena in overall regime.  That is, the experimental value must be controlled simultaneously and reduce the error between the computed value and the observed value. 3. Computing Flood Runoff and Sensitivity Analysis In order to make the simulation basin area of the digital river system model, closer to the real basin area, it is necessary for the digital elevation model to be smaller. In the mountainous regions the smaller the grid cell is, the shorter the runoff time of the cell is. So when we compute － 123 － Journal of Kim Il Sung University (Natural Science) No. 3 Juche103(2014) the runoff process of the flood, we should set the tΔ smaller than the runoff time of the grid cells, but we can’t set this value too small because the input value, precipitation, would be informed every 3 hours. So under the consumption of allowing that there is some terrestrial distortion, we used digital elevation model with the 1 000m cell size. It is necessary to confirm whether all the basin places in DEM are sunk place or not, by comparing with the topographical map. The elevation of the distorted basin cells should be re-fixed by comparing topographical map. In the real case, at the sunken places, even though this slope is lower than zero, but as increasing the deeps of the water of this cell, when the water surface slope is larger than zero, eventually the water flow to the next cell. 3.1. Computing effective rainfall During the flood in August of 1979, the precipitation value of Piryu River region is shown in table 2. Table 2. Precipitation of the River Piryu during the flood in august 1979 Station Pukchang Maegsan Paeksok Songchon Hoichang Yangdok Recipitation 163 102 230 181 155 218 Under the condition that the precipitation value of the each cell of the basin is known, we can estimate the effective precipitation by the method of calculating the effective precipitation method of SCS model. Here the main problem is to determine precisely the parameter CN which is responsible to the surface status of the basin, such as initial wet regime, vegetation type map, type of soil, the usage of the land and so on. Currently there is lack of the soil regime data for the hydrological considering, so we used the vegetation type map in determining value CN for computing the effective precipitation. From literature [6] and CN’s conversion rate table, we set the CN initial value 83 for the forest regions, 94 for mountainous regions, 91 for the cultivated regions, and then we find the proper value CN that gives the minimum error value between the deep of the runoff and the computed total effective precipitation, controlling this value simultaneously in the basin and calculating effective rain fall. tΔ ’s influence to the process of the runoff. 3.2. Estimation of The computing discharge hydrograph during the flood in August of 1979 is considered with tΔ , on the condition that the Manning’s the change of the peak of flood to the computing step time roughness coefficient n is constant. Table 3 shows the presenting time of the peak flood and its flow rate. In the table 3, we can see that, if tΔ is less than 5 min, the computing discharge hydrograph coincides with the real value and the flux of peak of flood doesn’t change too much, but if tΔ  is larger than 5 min, the flux of the peak of flood decreases and the presenting time is delayed and the runoff hydrograph time is larger. － 124 － DEM-based Modeling Method of Concentration Process of Surface Runoff Because if tΔ is set less than 5 min, the condition that the tΔ should be set smaller than the runoff time of each grid cell in the basin, will be satisfied. But if tΔ is set larger than 5 min, it will occur the distortion of the discharge synthesis, destructing the flow continuity condition in the areas where the runoff time is smaller then computing step time. Table 3. The presenting time of flood peak and its flux rate to tΔ tΔ /min 3 5 15 30 60 Observation rate The flux of the flood peak/(m3·s－1) 982 982 915 693 533 1 070 The presenting time of the flux of the flood peak/min 138 139 225 480 960 120 The relative error of the flood peak/% 8.22 8.22 14.48 35.23 50.19 － 3.3. The estimation of the influence of n to the flood runoff process. We used the vegetation type map to set the Manning’s roughness coefficient value n. And from table 1, we set this value 0.65 for the forest region, 0.14 for the mountainous region and 0.075 for the cultivate regions. And then controlling the n value across the overall regions, we analyze and compare with the computing discharge hydrograph and the real observation value of the flood discharger hydrograph, so that we finally set the n value of the objective regions which are close to the real observation value. In order to analyze the changes of the flood peak according to Manning’s roughness coefficient n during August of 1979, we computed and compared between ones when we set the n as the mean value of the region and ones when we set the n differently for every grid cells by its vegetation rate(table 4). Table 4. The presenting time of the flood peak and its flux according to n (1979.8.1) Computing values/(m3·s－1) Category In the case of n varies from its vegetation rate Observation values /(m3·s－1) In the case of n is the mean value of the region 1 070 1 186 The flux of the peak /(m3·s－1) Presenting time/min 120 Relative error/% － 175 10.84 n 982 139 8.22 n*0.8 1 156 99 8.04 n*1.2 816 195 23.74 Showing the computation results, we can realize that in the case that we used the n differently for every grid cell by its vegetation rate, the result is much closer to the real process rather than in the case we set the n as the mean value of the overall region. And the flux of the flood peak is controlled by the value n. － 125 － Journal of Kim Il Sung University (Natural Science) No. 3 Juche103(2014) Conclusion  The surface runoff model based on DEM model is one of the distributed hydrologic models where we take account of each cell, which influences to the generation of the runoff and using this method, we can simulate the spatial distribution change of runoff formed by the heavy rain in the flood. We computed the distributed hydrologic model by calculating numerically St. Venant kinetic equation by finite volume method (FVM) in the simulation of the catchments process of the surface runoff. References  [1] 종합대학학보(자연과학), 53, 12, 104, 주체96(2007). [2] 종합대학학보(자연과학), 49, 5, 159, 주체92(2003). [4] M. K. Jain et al.; Journal of Hydrology, 302, 107, 2005. [5] 梁钟元 等; 人民黄河, 29, 2, 29, 2007. [6] 詹道江; 工程水文学, 中国水利水电出版社, 163～168, 2000. [3] 김생모; 지리정보체계와 그 응용, 중앙과학기술통보사, 208～210, 주체90(2001). － 126 －