김일성종합대학학보 지구환경과학 및 지질학 주체110(2021)년 제67권 제2호 수치일기예보모형에서 적응시간적분도식의 리용 림창복, 김혁철 일기예보의 신속성을 보장하는데서 수치일기예보모형의 계산시간을 단축하는 문제가 중요하게 제기된다. 수치일기예보모형은 방대한 량의 계산량이 요구되는것만큼 모형의 계산시간을 줄이기 위하여서는 모형의 기능을 최대한 리용하는것이 중요하다. 수치일기예보모형은 보통 고정된 시간걸음을 리용한다. 이때 시간걸음을 계산안정조건 이 만족되도록 결정한다. 그러나 수치일기예보모형을 적분하는 과정의 어떤 시간구간에 대해서는 안정한 시간 걸음을 고정된 시간걸음보다 크게 설정해도 계산안정성을 보장할수 있다. 적응시간걸음 즉 적분과정에 시간걸음이 변하도록 하면 이것은 보통 고정된 시간걸 음보다 큰 값을 가지는데 그러면 동력학모형이 더 빨리 적분되고 물리적과정의 보조변수 화도식을 계산하는 회수가 적어져 모형계산시간이 크게 줄어든다. 수치일기예보모형(WRF)은 시간적으로 변하는 바람마당에 기초하여 시간걸음을 변화 시키는 기능 즉 적응시간걸음의 선택기능을 가지고있다. 론문에서는 WRF에서 리용하는 적응시간적분도식에 대하여 서술하고 그것의 효과성 을 평가하였다. １. WRF의 적응시간적분도식 WRF에서는 룽게－쿠타(RK)의 시간적분도식을 리용한다.[1] WRF의 예보변수를 Φ , 예보방정식계를 ) )ΦR 는 방정식의 나머지항들을 포함하고있다. ( (ΦRΦt = 편도함수, 로 표시하자. tΦ 는 시간에 관한 룽게－쿠타의 시간적분도식에서는 같은 3걸음반복도식(RK3)으로 수행한다. )(tΦ 로부터 tΦ ( Δ+ 까지의 1h 걸음적분을 다음과 ) t t Δ 3 t t Δ + 2 * ΦΦ = t + ΦR ( t ) (1) ** Φ = Φ ΦR ( * ) (2) Φ t t =Δ+ t Φ Δ+ **ΦtR ( ) (3) 여기서 tΔ 는 저주파에 대한 시간걸음(모형시간걸음), 웃첨자 t는 해당 시각을 의미한다.  일반적으로 수치계산에서 모형시간걸음은 이류속도에 대한 선형계산안정조건(CFL조건) t Δ x Δ ΔΔ= tuC x 를 쿠란트수로 표시한다. 을 만족시키도록 결정해야 한다. 여기서는 1≤ u WRF에서는 이류항을 2～6차정확도의 공간계차도식을 선택하여 계산할수 있다. 수치일기예보모형에서 적응시간적분도식의 리용 － 25 － 1차원이류항에 룽게－쿠타도식을 적용한 경우 공간계차전개의 정확도에 따르는 최대 쿠란트수를 표 1에 주었다. 표 １. 공간계차전개의 정확도에 따르는 최대쿠란트수 시간적분도식 중심계차도식 RK2 RK3 공간계차도식의 정확도 3차정확도 불안정 0.88 1.61 4차정확도 0.72 불안정 1.26 ※ RK2는 2걸음반복도식 5차정확도 불안정 0.30 1.42 6차정확도 0.62 불안정 1.08 3차원이류항에 대한 최대쿠란트수는 표 1에 제시한 1차원쿠란트수의 1 배로 되여 3 야 한다. 수치계산의 안정성을 보장하려면 리론적으로 계산한 최대쿠란트수보다 작은 값을 주 는 시간걸음을 리용해야 한다. 결국 3차원모형에서 시간걸음은 다음의 조건을 만족해야 한다. x Δ 0 ⋅ 3 u 0C 은 표 1에 제시한 RK3에 해당한 쿠란트수, maxu 는 모의에서 예상되는 최대바 xΔ 는 그물길이이다. (4) t Δ max max < C 여기서 람속도, 실례로 급기류지대에서 바람속도가 100m/s이라면 5차정확도의 이류도식을 리용할 때 km10=Δx 그물에 대한 최대시간걸음은 80s이다. 대류를 허용하는 수평분해( 실천에서는 보통 계산안정성을 보장하기 위하여 식(룽게－쿠타도식) (4)로 계산한 시 )에서는 대류수직속도가 쿠란트수를 결정한다. km5<Δx 간걸음보다 25% 작은 값을 리용한다. 표 1에서 알수 있는바와 같이 RK3도식에서 시간걸음은 중심시간계차인 경우보다 2배 더 크다. WRF에서 시간걸음은 그물길이(km단위)의 6배로 설정한다. 일기변화에 영향을 주지 않는 고주파(음파)가 식 (4)의 시간걸음 다. 이러한 시간걸음의 제한조건을 극복하기 위하여 분해법을 적용한다. tΔ 를 크게 제한한 분해법에서는 큰 시간걸음(모형시간걸음)안에서 여러번의 작은 시간걸음으로 섭동방 정식을 적분한다. 음파를 적분하는 시간걸음 τΔ 는 최대쿠란트수가 을 만족하도록 설정한다. 여기서 1 2 실천에서는 보통 대신 1 2 1 ≤ cs Δ τ x Δ sc 는 소리속도이다. 2 (5) 을 리용한다. 그러면 음파시간걸음은 다음과 같다. 실례로 음파의 속도가 =sc 300 m/s 이라면 인 경우 s17=Δτ 모형시간걸음과 음파시간걸음의 비는 짝수가 되여야 한다. 실시간모의에서 이다. WRF에서 인  km10=Δx <Δτ (6) x Δ 2 sc km10=Δx － 26 － 종합대학학보 지구환경과학 및 지질학 주체110(2021)년 제67권 제2호 경우 모형시간걸음은 식 (4)로 계산한 80s의 약 70%인 60s로 정할수 있으며 그러면 τΔ 는 이 모형시간걸음의 1/4인 로 설정할수 있다. s15=Δτ 적응시간걸음도식에서는 최대쿠란트수의 목표값 2.1 wu v 을 리용하여 주어진 시각에 계산구역에서 최대쿠란트수( ,( 로 정한다. dC )를 결정 C < 인 경우 시간걸음을 증가시켜 새로운 시간 tC 를 보통 ≤ tC 1.1 ≤ , 바람속도성분 ) 한다. 이것이 목표값보다 작을 때 즉 걸음을 d C t t =Δ n ⎛ ⎜ ⎜ ⎝ if 는 고정된 시간걸음의 증가률인데 보통 ⎞ ⎟ t −Δ⎟ n 1 ⎠ 1min C C + f d , t i (7) 로 결정한다. 여기서 %5≤if 한편 계산구역에서 결정한 최대쿠란트수가 목표값을 초과할 때 즉 로 설정한다. C > 인 경우는 d C t 모형의 계산안정성을 보장하기 위하여 시간걸음을 감소시킨다. 여기서 시간걸음의 감소률 C t =Δ n ⎡ 1max ⎢ ⎣ ⎤ t −Δ⎥ n 1 ⎦ df 의 전형적인 값은 25%이다. 적응시간걸음의 아래우한계값은 초기시간걸음에 의하여 다음과 같이 설정한다. t (8) C − − − f d d d , t t ( C 5.0 C ) 6 x Δ=Δ 5.0 = Δ× t Δ t min t Δ max ( max 이 식에 의하여 적응시간걸음이 지나치게 작아지거나 커지지 않게 한다. = ( t , ΔΔ t Δ× ) min , )max t =Δ min 0.3 Δ t t ２. 적응시간적분도식의 효과성 WRF에서 적응시간걸음의 리용은 리용자정의입력변수를 통하여 조절한다. 적응시간 걸음을 리용하여 모형을 적분하려면 리용자정의입력변수의 &domains변수묶음에서 다음 의 변수들을 설정해야 한다.[2] use_adaptive_time_step=.true. (적응시간걸음을 리용하겠는가?) step_to_output_time=.true. (이미 설정한 모형출력시간에 도달하도록 시간걸음을 조절하 겠는가?) target_cfl=1.2, 1.2, 1.2, (수직쿠란트수가 이 값보다 작으면 시간걸음을 증가시킨다.) target_hcfl=0.84, 0.84, 0.84, (수평쿠란트수가 이 값보다 작으면 시간걸음을 증가시킨다.) max_step_increase_pct=5, 5, 5, (시간걸음을 이전 시간걸음의 몇%만큼 증가시키겠는가?) starting_time_step=－1 (모형의 초기시간걸음 6×dx) max_time_step=－1, －1, －1, (최대시간걸음  3×starting_time_step) min_time_step=－1, －1, －1, (최소시간걸음  0.5×starting_time_step) 이 연구에서는 최근에 개발된 WRFV4.1.2모형을 리용하였다. 적응시간기능을 리용한 모형의 계산시간성능을 평가하기 위하여 고정시간걸음으로 설정한 모형의 실행시간과 적 응시간을 고려한 모형의 계산시간을 대비분석하였다. 계산은 Intel(R) Core(TM) i7－8700 CPU(3.2GB*6)콤퓨터에서 6개의 처리기를 병렬처리하여 진행하였다. 계산구역은 우리 나라를 중심으로 12km그물간격의 수평마디점수가 240×240, 수직층 수치일기예보모형에서 적응시간적분도식의 리용 － 27 － 을 지면으로부터 50hPa까지 35개 층으로 설정하였다. 대비실험을 위하여 모든 실험에서 계산구역과 물리과정들을 같이 선택하였다. 계산실험은 아래와 같이 세가지 방안으로 진 행하였다.(표 2) 방안 1 2 3 표 ２. 계산방안 파라메터 use_adaptive_time_step False True True time_step 72s 72s 72s max_time_step  －1 216s 우의 방안에서 max_time_step를 －1로 주면 모형에 설정된 적응시간걸음방식대로 계 산을 진행한다. 모든 방안에 대하여 2020년 3월 20일 9시부터 3일간(72h) 예보하였다. 그림에서 예견기에 따르는 시간걸음을 보여주었다. 그림. 예견기에 따르는 시간걸음 그림에서 보다싶이 1방안(고정계산걸음방식)의 계산걸음은 72s로서 언제나 같고 2방 안인 경우 초기시간에는 48s정도로 줄어들었다가 점차 96s로 안정되여 계산되며 자료출 력시간에만 72s로 시간걸음이 줄어든다. 3방안인 경우에는 최대시간걸음이 140.4s로서 전 반적으로 계산걸음이 크다. 방안에 따르는 시간걸음수를 보면 표 3과 같다. 표 ３. 방안에 따르는 시간걸음수 방안 평균시간걸음/s 총시간걸음수 총계산시간/min 1 2 3 72 95.2 125.7 3 600 2 722 2 061 111.15 96.32 79.21 1방안에 비한 효과성/% 0 13.4 28.7 표 3에서 보다싶이 적응시간걸음을 리용한 모형계산의 시간걸음수는 고정시간걸음을 리용한 계산시간걸음의 75.6%, 57.2%이며 계산시간은 13.4%, 28.7% 줄어들었다. 적응시간걸음을 리용한 72h예보결과(2, 3방안)들을 고정시간걸음을 리용한 72h예보결 과(1방안)와의 평균절대편차를 계산하였다.(표 4) － 28 － 종합대학학보 지구환경과학 및 지질학 주체110(2021)년 제67권 제2호 표 ４. 적응시간걸음을 리용한 결과와 고정시간걸음결과와의 평균절대편차 물리량 U10/(m·s－1) V10/(m·s－1) T2/℃ TSK/℃ PSFC/hPa Q2/(kg·kg－1) U/(m·s－1) V/(m·s－1) W/(m·s－1) pH T/℃ P/hPa QVAPOR/(kg·kg－1) 3방안 0.214 7 0.229 5 0.258 7 0.434 2 0.090 8 5.9×10－6 0.343 4 0.313 2 0.008 8 7.040 1 0.145 8 2방안 0.152 0 0.164 9 0.192 2 0.368 4 0.057 9 4.3×10－6 0.222 0.208 9 0.006 8 4.222 3 0.100 2 맺 는 말 참 고 문 헌 0.023 7 2.457×10－6 0.037 1 3.416 1×10－6 표 4에서 알수 있는바와 같이 계산걸음이 커질수록 고정된 시간걸음과의 편차가 커지지만 그 값은 물리량값에 비하여 매우 작으며 계산된 물리량들의 마당을 보면 모양이 일치한다. 이것은 적응시간걸음을 리용할 때 고정시간걸음을 리용하는것에 비하여 계산시간을 평균 20%이상 절약하면서도 계산안정성을 보장할수 있다는것을 보여준다. 수치일기예보모형(WRF)에서 적응시간적분도식을 리용하면 계산안정성을 보장하면서도 계산시간을 20%이상 절약할수 있다. [1] W．C．Skamarock; A Description of the Advanced Research WRF Version 3, NCAR Technical Note, 13～27, 2008. [2] Wei Wang et al.; Research WRF 27(ARW) Version 3.9 Modeling System User’s Guide, National Center for Atmospheric Research, 104～185, 2017. 주체110(2021)년 1월 5일 원고접수 Use of Adaptive Time Integration Scheme in the  Numerical Weather Prediction Model(WRF) Rim Chang Bok, Kim Hyok Chol The use of adaptive time integration scheme in the numerical weather prediction model(WRF) reduces more than 20% of the run time, maintaining the numerical stability. Keywords: numerical stability, adaptive time integration scheme, WRF