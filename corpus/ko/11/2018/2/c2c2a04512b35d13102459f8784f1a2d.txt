김일성종합대학학보 지구환경과학 및 지질학 주체107(2018)년 제64권 제2호 전경화상자료기지구축과 전경화상의 3차원실시간묘사 리금수, 길류성, 신영철 론문에서는 3차원전경열람체계의 실현을 위하여 제기되는 전경화상자료기지구축방법 과 전경화상의 3차원실시간묘사에 대하여 고찰하였다. 1. 전경화상자료기지의 자료구조설계 １）전경화상분할 360°전경화상의 시야각도를 보면 수평으로 360°, 수직으로 180°이다.[1, 2] 그러므로 제 작된 전경화상의 크기는 너비:높이=2:1의 비률로 된다. 론문에서는 전경화상의 묘사와 자료기지구축에 편리하게 전경화상의 크기를 2 048× 1 024pixel로 정하고 가로 8등분, 세로 4등분하여 256×256pixel의 쪼각화상 32개 모임으로 구 조화하였다. ２）전경화상자료의 지리공간자료화 표．전경화상의 기본적인 공간속성자료 속성이름 ID photoX photoY angle pitch date addr st_name cnt 자료형 Integer Double Double Float Float DateTime String String Integer 설명 전경화상의 식별번호 촬영점의 X자리표 촬영점의 Y자리표 앞방향 촬영방위각 앞방향 촬영경사각 촬영날자 및 시간 촬영지역의 주소 촬영한 거리이름 린접한 전경화상의 수 Spot[cnt] Object Array 린접한 전경화상정보배렬 전경화상은 지리적위치와 관련될 때 에만 지리정보로 되며 지리정보체계에 서 리용될수 있다. 이로부터 론문에서는 전경화상에 공간속성자료를 추가하여 전 경화상자료를 지리공간자료화하여 지리 정보체계에서 리용할수 있도록 하였다. 전경화상의 기본적인 공간속성자료는 표 와 같다. 이밖에도 건물정보나 건늠길정 보, 주기자료와 같은 다른 자료들이 더 추 가될수 있다. 이렇게 전경화상자료는 공간속성자료에 의해 지리공간자료로 되여 다른 지리정보체계 들과의 결합과 3차원지리적계측을 비롯한 지리적묘사와 공간분석이 가능해지게 되였다. ２. 전경화상분산자료기지구축과 봉사 전경화상자료는 위성화상자료나 수자지도화상, 지형자료와는 대비할수 없을 정도로 많은 용량을 차지한다.[3] １）색인화일에 의한 전경공간자료기지구축 우리는 초대용량자료기지구축과 자료관리에서 나타나는 결함들을 극복하기 위하여 색인화일에 의한 전경화상자료기지구축방법을 새롭게 제기하였다. 즉 화일들을 리용하여 전경화상자료기지구축과 전경화상의 3차원실시간묘사 － 21 － 자료기지를 구축하고 화일들을 구조화하고 색인화하여 검색의 신속성을 보장하면서도 자 료관리를 쉽게 진행하자는것이다. 화일구조화 및 색인화일구축방법은 다음과 같다. 화일들을 구조화한다. 일정한 ID령역에 들어가는 자료들을 ID값에 따르는 순서화를 진행하여 하나의 화일로 묶 고 그 화일의 이름을 ID령역과 관련되게 만든다. 매 자료화일들의 크기가 2GB를 넘지 않도 록 하기 위하여 2 000개씩 묶어서 하나의 화일로 작성한다. 또한 화일들이 많은 경우 화일검 색속도가 떠지게 되므로 등록부들로 갈라 1개의 등록부에 100개의 화일이 들어가도록 한다. 색인화일을 구축한다. 매 자료화일들의 ID들을 순서화하여 순서대로 화일에서의 자료위치만을 4B씩 쓰기한 다. 경우에 따라 추가적인 정보를 함께 쓰기할수 있다. 색인화일작성에서 중요한것은 매 레 코드들의 색인크기가 같아야 한다는것이다. 색인화일로부터의 레코드검색방법은 다음과 같다. 검색ID로부터 색인화일의 등록부이름과 화일이름을 얻는다. 색인화일을 열고 검색ID에서 색인화일의 첫 ID를 덜어 색인화일에서의 색인정보위치 를 계산한다. 색인정보에 있는 자료화일에서의 레코드위치를 리용하여 자료화일로부터 레코드자료를 읽는다. 만일 색인정보에 추가적인 정보가 있는 경우 이것도 검색조건확인에 리용한다. 색인화일을 리용하면 특별한 자료기지봉사프로그람이 없이도 초대용량공간자료봉사를 보다 쉽고 안전하며 편리하게 실현할수 있다. ２）공간색인에 의한 전경화상자료의 공간검색 전경화상자료의 공간검색은 리산적으로 분포된 점대상들에 대한 공간검색으로서 기본 원리는 전체 령역을 일정한 면적을 가진 부분령역들로 나누고 부분령역들에 들어가있는 전 경화상자료들의 위치정보와 ID정보들을 리용하여 공간색인을 작성한 다음 이 공간색인을 리 용하여 공간검색을 진행하는것이다. 공간색인에 의한 전경화상자료의 공간검색공정은 다음과 같다. ① 전체령역을 일정한 령역을 가진 부분령역들로 살창분할한다. 부분령역에 들어가는 전경화상자료의 수가 일정한 한계를 넘지 않도록 하여야 한다. 부 분령역에 들어가는 전경화상자료의 수가 적을수록 공간검색속도는 빨라지게 된다. 이를 위하여 분할하는 살창수를 다음과 같이 계산한다. N = /n 500 (1) 여기서 N은 분할살창의 행수(혹은 렬수), n은 전체 전경화상자료의 수이다. 론문에서는 전경화상자료에 대한 살창분할수를 200으로 정하고 매 부분령역안에 500 개이하의 전경화상자료가 포함되도록 하였다. ② 매 부분령역들에 들어있는 모든 전경화상자료들의 정보들을 묶어 공간색인화일을 작 성한다. 분할된 부분령역들에 들어가는 전경화상자료에는 공간정보로서 X, Y와 함께 ID가 들어 있다. 이 3개의 속성자료를 하나의 자료단위로 하여 하나의 화상자료당 20B(X: 8B, Y:8, ID:4B) － 22 － 종합대학학보 지구환경과학 및 지질학 주체107(2018)년 제64권 제2호 씩 X증가, Y증가순서로 공간색인화일에 저장한다. ③ 검색하려는 위치로부터 그 위치가 들어있는 부분령역의 번호를 얻는다. 검색하려는 위치를 (x, y)라고 할 때 이 점이 포함되는 부분령역의 행렬번호는 다음과 같 이 계산한다. 행번호 렬번호 = = [ INT ( [ INT ( Xx − /() X min Yy − /() Y − X max − Y ] N ) × ]N min ) × (2) min 여기서 Xmin과 Xmax는 전체 령역의 최소X자리표값과 최대X자리표값, Ymin과 Ymax는 전체 령 역의 최소Y자리표값과 최대Y자리표값이다. max min ④ 얻어진 부분령역의 공간색인화일을 리용하여 전경화상자료를 검색한다. 먼저 공간색인화일에 들어있는 X, Y, ID를 리용하여 검색하려는 점 (x, y)까지 제일 가 까운 점의 ID를 얻는다. 다음 얻어진 ID로 색인화일에 의한 전경화상자료검색을 진행하여 실지 화상자료를 얻는다. 와 류사하다. ３. OpenGL에 의한 전경화상의 3차원실시간묘사 전경화상의 3차원묘사원리는 3차원구면우에 화상을 투영하여 묘사하는 구면묘사원리 전경화상의 3차원묘사에서는 3차원구면의 안쪽면에 화상을 투영하고 그것을 구의 중 심에서 바라볼 때의 모양을 묘사한다. 이러한 원리에 기초하여 전경화상의 3차원묘사는 일반적으로 다음과 같이 진행한다. 구면내부에 대한 3각형분할을 진행하여 구면메쉬를 생성한다. 구면내부에 대한 3각형분할은 구면살창분할의 방법으로 진행한다. 즉 위도 －90°부 터 90°까지, 경도 －180°부터 180°까지 순환하면서 등간격으로 각을 등분하여 4각형령역 의 4개 점의 자리표를 계산한 다음 얻어진 4각형을 대각선분할하여 2개의 3각형으로 분 할한다. 이때 위도와 경도로부터 다음의 식을 리용하여 3차원자리표를 계산한다. Rx Ry ×= ×= cos( cos( ) ϕ ) ϕ × × λ cos( ) ) λ sin( Rz ×= sin( ) ϕ (3) 여기서 R는 구의 반경, φ는 위도, λ는 경도이다. 생성된 메쉬들에 투영하려는 전경화상의 투영자리표를 계산하여 화상투영을 진행 한다. 투영자리표는 구면상의 위도, 경도와 1:1대응되며 다음의 식에 의하여 계산한다. /)180 /) (4) ( λ + 90( − 360 180 = = u v ϕ 여기서 u는 화상자리표계의 X축자리표값(u∈(0, 1)), v는 화상자리표계의 Y축자리표값 (v∈(0, 1))이다. 시점을 구의 중심으로 설정하고 3차원메쉬묘사를 진행한다. 구의 중심의 자리표는 (0, 0, 0)이므로 시점자리표도 (0, 0, 0)으로 한다. 전경화상자료기지구축과 전경화상의 3차원실시간묘사 － 23 － 전경화상이 투영된 3차원메쉬묘사는 OpenGL과 같은 3차원묘사엔진을 리용하여 진행한다. 이와 같이 전경화상의 3차원묘사는 3차원묘사엔진을 리용하여 3차원구면묘사의 방법으 로 진행할수 있다. 이 방법을 리용하면 전경화상의 3차원실시간고속묘사가 어려우므로 이 문 제를 해결하기 위하여 보임령역에 의한 부분전경묘사방법을 새롭게 제기하고 실현하였다. 보임령역에 의한 부분전경묘사방법은 한마디로 말하여 화면에 보이는 전경화상만을 적 재하여 묘사하는 방법이다. 앞에서 본바와 같이 전경화상자료는 하나의 큰 화상으로 주어지는것이 아니라 256× 256pixel크기의 쪼각화상 32개로 구성된다. 실험에 의하면 화면에 보이는 쪼각화상의 수는 일반적으로 12개 정도이며 최대로 16 개이다. 따라서 보임령역에 의한 부분전경묘사방법을 리용하면 자료통신량은 절반으로 줄 일수 있고 실시간묘사속도는 2배로 높일수 있다. 맺 는 말 우리는 보임령역에 의한 부분전경묘사방법을 리용하여 종전의 방법보다 자료통신량을 절반이하로 줄이고 실시간묘사속도를 높이였다. [1] 종합대학학보(자연과학), 61, 6, 118, 주체104(2015). 참 고 문 헌 [2] Li Qiang Zhang et al.; Computer & Geosciences, 31, 343, 2005. [3] M. Kelly; Using Google Street View to Audit the Built Environment, Springer, 108～112, 2013. 주체107(2018)년 1월 5일 원고접수 Construction of Panoramic Image Database and Real-time 3D Renderring of Panoramic Image Ri Kum Su, Kil Ryu Song and Sin Yong Chol In this paper, we have studied the construction of Panoramic Image Database and real-time 3D renderring of Panoramic Image. Key words: panorama, real-time 3D renderring