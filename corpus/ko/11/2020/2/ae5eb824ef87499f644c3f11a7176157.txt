김일성종합대학학보 지구환경과학 및 지질학 주체109(2020)년 제66권 제2호 ３차B스플라인에 의한 ２차원자기이상의 도함수계산방법 전광철, 림유성 해석신호법, 국부파수법 등을 리용한 자성원천의 테두리결정법들은 모두 자기이상의 도함수계산에 기초하고있다.[1－3] 그러나 자기이상의 도함수계산과정에 자료속에 들어있 는 고주파의 장애성분들이 증폭되므로 자기이상에 이러저러한 장애들이 포함되는 경우에 는 계산된 도함수값이 정확하지 못하다. 그리고 측정자료들이 균일한 살창망우에서 주어 지지 못하는 경우에 계산오차는 더욱 커진다. 론문에서는 3차B스플라인을 리용하여 장애가 포함된 불균등한 측정망자료로부터 자 기이상의 도함수를 보다 정확히 계산하기 위한 한가지 방법을 제기하였다. １. 방법의 원리 3차B스플라인함수는 보간계산정확도가 높은것으로 하여 과학기술계산에 널리 리용 되고있다.[1] 3차B스플라인을 리용하는 경우 보간함수는 다음과 같다. yxf ,( ) = y x N 1 + N 1 + ∑ ∑ yBxBs )( )( ij j i 0 0 = = j i (1) 이때 직4각형구역 =Ω ,{( yx |) x ∈ [ x 1 , x ], y ∈ [ y 1 , y ]} 은 x방향과 y방향에서 간격이 각각 x i −+ 1 x i = ( x N x − x 1 /() N x )1 =− d , y −+ 1 j = ( x N y − x 1 N y )1 =− h 인 균등한 그물구역으 로 나누어진다고 가정한다. 여기서 i = ,0 xN + 1 , j = ,0 yN + 1 는 보간매듭점들의 번호, jis 는 보간매듭 ( x i y , j ) 에서의 보간곁수, )(xBi 는 3차B스플라인함수로서 다음과 같이 표시된다. N x x j N y /() xB )( i = 1 3 h 3 3 3 − ) x h h − + x i 2 2 xh ( 3 ⎧ ( ⎪ ⎪ ⎪⎪ ⎨ ⎪ ( ⎪ 2 ⎪ 기타,0 ⎪ ⎩ 2 xh ( 3 i x i − + x ) + 3 , x ∈ [ x i − 2 , x i 1 − ] − x i 1 − (3) + xh − x i 1 − 2 ) − (3 x − x i 1 − 3 ) x ∈ [ x i 1 − , x i ] − x (3) + xh i 1 + − x ) 1 + − (3 x i 1 + − x ) 2 x ∈ [ x i , x i 1 + ] (2) , , 3 , x ∈ [ x i 1 + , x i + 2 ] 우와 같은 방법으로 )( yB j 도 표시할수 있다. 그러면 보간함수의 x, y에 관한 1계도함수는 다음과 같이 구할수 있다. f x yx ,( ) = f y yx ,( ) = x y 1 N + N 1 + ∑ ∑ yBsxB )( ij j i 0 0 = = )( ′ i j x y 1 N + N 1 + ∑ ∑ yBsxB )( ij j i 0 0 = = )( ′ j i ⎫ ⎪ ⎪ ⎬ ⎪ ⎪ ⎭ (3) 3차B스플라인에 의한 2차원자기이상의 도함수계산방법 － 107 － 보간함수의 x, y에 관한 2계도함수는 다음과 같이 구할수 있다. )(xBi′ , 여기서 같이 표시된다. )(xBi′′ 는 각각 3차B스플라인함수의 x에 관한 1계, 2계도함수로서 다음과 f xx yx ,( ) = f xy yx ,( ) = f yy yx ,( ) = x y N 1 + N 1 + ∑ ∑ yBsxB )( ij j i 0 0 = = ′′ )( i j y x N 1 + N 1 + ∑ ∑ yBsxB )( ij j i 0 0 = = )( ′ j ′ i y x N 1 + N 1 + ∑ ∑ yBsxB )( ij j i 0 0 = = )( ′′ j i ⎫ ⎪ ⎪ ⎪ ⎪ ⎬ ⎪ ⎪ ⎪ ⎪ ⎭ (4) ′ xB )( i = 1 3 h 2 2 2 − x − + − x i (6 ⎧ (3 ⎪ ⎪ h 3 ⎪⎪ ⎨ ⎪ x ⎪ i + ⎪ 기타,0 ⎪ ⎩ h 3 (3 − − − 2 (6 xh 1 i + 2 x ) , ′′ xB )( i = 1 3 h x h − − x i 2 − x (18 (6 ⎧ ⎪ 6 ⎪ ⎪ 6 ⎨ ⎪ (6 2 + ⎪ ⎪ 기타,0 ⎩ x i x (18 x i − − h 1 + ,) 2 ) , x ∈ [ x i − 2 , x i 1 − ] xh − x i 1 − (9) − x − x i 1 − 2 ) x ∈ [ x i 1 − , x i ] , 2 − x (9) + x i 1 + − x ) , x ∈ [ x i , x i 1 + ] (5) x ∈ [ x i 1 + , x i + 2 ] ,) x ∈ [ − x i 1 − ,) ] , x i 2 − x ∈ x i 1 − , 1 − [ x i x i ] 2 − x ) , x ∈ [ x i , x i 1 + ] (6) x ∈ [ x i 1 + , x i + 2 ] 마찬가지로 3차B스플라인함수의 y에 관한 1계, 2계도함수 )( yB j′′ 도 얻을수 있다. 이므로 다음의 관계식을 리용하여 수직2계도함 )( yB j′ , 원천밖의 공간에서는 ⋅∇ zyxf ,( , 0) = 수를 쉽게 구할수 있다. f zz yx ,( ) [ −= f yx ,( ) + f xx yy yx ,( )] (7) 이와 같이 자기이상을 3차B스플라인함수를 리용하여 표시하면 그것의 미분변환을 리용하여 자기이상의 도함수들을 쉽게 얻을수 있다. 자기이상의 수직2계도함수의 령값은 자성원천의 테두리를 규정짓는데 효과적으로 리용된다. ２. 모형계산에 의한 방법의 특성평가 모형계산에서는 구형자성체가 만드는 자기이상에 장애가 포함되지 않은 경우와 장애 가 각이하게 포함된 경우 론문에서 제기한 방법(간단히 3차B스플라인법)과 주파수령역법 으로 자기이상의 도함수들을 계산하고 그 결과를 비교하였다. 이때 정확도는 다음과 같 은 상대표준편차(%)를 계산하여 비교하였다. ( T 계 i − T 리 i ) 2 E = ( T 계 i max − ( T 계 i ) min 1 N N ∑ 1 = i ) × 100 (8) － 108 － 종합대학학보 지구환경과학 및 지질학 주체109(2020)년 제66권 제2호 iT리 , 여기서 수와 각이한 방법으로 계산하여 얻은 자기이상의 도함수, iT계 는 각각 i번째 관측점에서 리론적인 계산공식으로 얻은 자기이상의 도함 는 각각 리론 , ) ) iT계 ( max iT계 ( min 적인 계산공식으로 얻은 자기이상도함수의 최대값과 최소값, N은 계산자료점의 수이다. 모형계산을 진행할 때 구형자성체는 계산구역 =Ω ,{( yx |) x ∈ ,0[ 100 ], y ∈ ,0[ 100 ]} 의 중심에 놓여있고 수직자화되여있으며 잔류자화는 가지지 않는다고 보았다. 그리고 측정 점사이간격과 탐사선사이간격은 비등간격으로 설정하였다. 자기이상속에 장애가 포함되지 않은 경우와 장애가 각이하게 포함된 경우 주파수령 역법과 3차B스플라인법으로 자기이상도함수를 계산하고 그 정확도를 비교하였다.(표) 표. 장애에 따르는 주파수령역법과 ３차B스플라인법의 상대표준편차(%) 장애/% 0 5 10 15 20 주파수령역법 yTΔ  4.541 4.886 6.399 7.639 10.707 xTΔ  4.541 4.953 6.636 7.817 10.128 zzTΔ 6.244 10.931 22.053 29.118 39.326 3차B스플라인법 yTΔ  1.133 1.104 1.079 1.001 1.081 xTΔ  1.133 1.104 1.079 1.001 1.081 zzTΔ 0.259 0.253 0.247 0.229 0.248 표에서 보는바와 같이 자기이상에 장애가 많이 포함될수록 주파수령역법의 도함수계 산오차는 점점 커지지만 3차B스플라인법에 의한 도함수계산오차는 2%이하로서 비교적 작다. 특히 장애가 20% 포함된 경우 수직2계도함수계산오차를 보면 주파수령역법의 경 우에는 39.326%로서 매우 크지만 3차스플라인법의 경우에는 0.248%로서 매우 작다. 일반적으로 수직2계도함수는 자성원천의 테두리를 반영하므로 우리는 자기이상에 장 애를 20%정도 포함시키고 각이한 방법으로 수직2계도함수를 계산하고 자성원천의 테두 리를 반영하는 정도를 비교하였다.(그림) 그림. 각이한 방법으로 계산한 자기이상의 수직2계도함수등값선도 ㄱ) 주파수령역법, ㄴ) 3차B스플라인법 그림에서 보는바와 같이 자기이상속에 20%의 장애가 포함된 경우 3차B스플라인법으 로 계산하여 얻은 수직2계도함수등값선도에는 구형자성체의 테두리가 명백하게 반영되지 만 주파수령역법으로 계산하여 얻은 수직2계도함수등값선도에는 구형자성체의 테두리가 명백하게 반영되지 않는다. 이것은 3차B스플라인법을 리용하면 자기이상속에 장애가 포함 되는 경우에도 높은 정확도를 가지고 자기이상의 도함수를 계산할수 있다는것을 보여준다. 3차B스플라인에 의한 2차원자기이상의 도함수계산방법 － 109 － 맺 는 말 3차B스플라인을 리용한 자기이상도함수계산방법을 리용하면 불균등한 측정망우에서 얻은 장애가 포함된 자기이상인 경우에도 높은 정확도를 가지고 자기이상도함수를 계산 할수 있다. 그러므로 이 방법은 자기이상도함수를 리용하는 자성원천의 테두리결정방법 들에 효과적으로 응용될수 있다. 참 고 문 헌 [1] Bingzhu Wang et al.; Geophysics, 73, 5, I35, 2008. [2] Bingzhu Wang et al.; Geophysical Prospecting, 60, 1001, 2012. [3] 魏永强 等; 物探与化探, 40, 1, 117, 2016. 주체109(2020)년 1월 5일 원고접수 Calculated Method of Derivative of 2D Magnetic Anomaly by Using Cubic B-Splines Jon Kwang Chol, Rim Yu Song This paper proposed a method that correctly calculated derivative of the magnetic anomaly using cubic B-splines. The derivative computations using cubic B-splines can very correctly calculate derivative of the magnetic anomaly in case of the data involving noise from irregular grid as well. The method can be applied to edge detection of the magnetic sources using derivative of the magnetic anomaly. Keywords: magnetic anomaly, derivative computation, cubic B-spline