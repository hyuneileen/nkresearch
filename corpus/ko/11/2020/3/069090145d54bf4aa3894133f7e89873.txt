김일성종합대학학보 지구환경과학 및 지질학 주체109(2020)년 제66권  제3호 스플라인보간과 시간지연신경망모형의 결합에 의한 월흐름량중장기예보 김정훈, 피성일 물자원의 계획과 리용, 수리구조물의 설계와 관리 등을 과학적으로 합리적으로 진행 하는데서 무엇보다 중요한것은 하천류출계렬의 중장기예보의 과학성을 높이는것이다. 론문에서는 스플라인보간과 시간지연신경망을 결합한 동적인 다층적응신경망에 의한 중장기예보모형을 제기하였다. １．선행연구와 제한성 하천에서의 류출과정은 공간적, 시간적차원에서 비선형성이 강하게 나타나며 끊임없 이 변화된다. 류출과정을 모형화하는데 리용되는 결정론적인 모형들은 자연지리적, 기상 학적특성, 인간활동의 영향 등 많은 인자들이 반영되고 높은 정확도를 가진 충분한 자료 를 요구한다. 이것은 결정론적인 모형의 작성과 리용에서 주요한 제한성으로 된다. 그러나 신경망모형과 같은 검은함모형은 비교적 많지 않은 자료와 간단한 공식에 의 하여서도 입력값과 출력값사이의 련계를 지어줄수 있는것으로 하여 중장기류출예보에 적 지 않게 리용되고있다. 수리구조물설계나 수력발전소의 최량물관리를 비롯하여 많은 공 학적응용의 측면에서 볼 때 3개월이상의 긴 예견기를 가지는 예보자료를 요구하고있는것 으로 하여 류출예보에서는 다계단예보의 정확도를 높이는것이 관건적인 문제로 제기된 다.[1－3] 일정한 예견기를 가지는 다계단예보에서는 일반적으로 관측계렬에 기초하여 예견기 의 첫 시단값을 예측하고 그 값이 다음시단값예측에 리용되게 된다. 그러므로 시단길이 가 길어질수록 예측오차가 축적, 확대되는 《증폭》효과가 나타나며 결과 예보의 첫 단계 에서 비교적 크지 않던 오차도 예견기의 마감단계에서는 매우 커져 예보정확도를 크게 떨어뜨릴수 있다. 이러한 특성은 시계렬의 변동성과 비선형적동태가 심한 하천류출계렬 에서 더 심하게 나타난다. 그러므로 신경망모형과 같은 검은함모형을 리용하여 하천류출계렬의 중장기예보를 진행하는 경우 이러한 문제를 반드시 극복하여야 한다. ２．스플라인보간과 시간지연신경망결합의 간단한 원리 일반적으로 중장기예보에서 입력값과 출력값사이의 귀납관계는 다음과 같이 정의할 여기서 p는 다계단예보의 걸음을 나타내며 s는 입력차원, ptx +ˆ 는 t+p시단의 출력값을 나 ˆ x + = pt ˆ( xF ˆ, x 1 pt −+ pt −+ 2 , (cid:34) , x spt −+ ) (1) 수 있다. 타낸다. 스플라인보간과 시간지연신경망모형의 결합에 의한… － 59 － 식 (1)을 통하여 알수 있는것처럼 예측값 ptx +ˆ 는 관측값뿐아니라 전시단예보값에도 관계된다. 결과 예보정확도는 p가 커짐에 따라 떨어지게 된다. 이것을 개선하기 위하여서 는 유효한 관측값들을 증대시켜야 한다. 3차원스플라인보간함수를 리용하면 관측지점들사이에 표본점들을 더 늘일수 있으며 결과 관측지점들이 가지고있는 유효한 정보가 강조되게 된다.  x 스플라인보간함수를 S(x)로 표시할 때 구간 [a, b]( a < < = x 0 x 1 (cid:34)2 < < x n = b )에서 1계, 2계 미분가능하다. 관측지점사이의 어떤 구간 [ ] 에서 스플라인보간다항식은 다음과 같다. MxS )( = i i 1 − 3 x ) ( x i − h 6 i + M i 3 ) 1 − ( x x − i h 6 i ⎛ ⎜ ⎝ + y i 1 − − 2 h i x ⎞ ⎟ ⎠ x i − h i ⎛ ⎜ ⎝ + y i − i M 6 2 h i 1 − ⎞ ⎟ ⎠ x x − i h i x i , x − 1 i M i 1 − 6 i ( = ,1 n ) (2) 여기서 ′′= xSM ( i i i ), h i = x i x −− 1 i 이다. 스플라인보간함수를 리용하는것과 함께 관측값이 가지고있는 정보를 최대한 리용하 기 위하여 이전시기의 시간지연적응신경망(ATNN)모형의 무게값과 시간지연값을 동적으 로 처리하도록 하였다. 시간지연신경망모형에서 비선형계의 입력－출력관계는 다음의 식에 의하여 규정된다. )( ty M ⎡ = ∑ ωσ ⎢ i ⎢ ⎣ 1 i = ⎤ ⎥ ⎥ ⎦ ( tx i − τ i ) (3) iω 는 신경망무게이며 iτ 는 시간지연, t는 련속적인 시계렬에 대하여 관측시점을 여기서 나타낸다. 론문에서는 시간지연신경망에 스플라인보간을 결합하여 동적으로 파라메터를 교정하 여 해당한 출력값을 얻는 다층적응신경망모형을 제기하였다. 이때 관측계렬이 가지고있 는 장기 및 단기류출성분의 특성에 따라 시간분해능을 조절하여 본질적인 정보가 반영되 도록 하여야 한다. 다층적응신경망모형의 계산알고리듬은 크게 세 단계로 구분할수 있다.(그림 1) X t = ,1 j ∈ ,1[ ln ], = 1 t = ,2 j ∈ ,1[ 111x ], ln = ]2,1[ 121x … … … 11nx 12nx 13nx ∑ 23nx33nx tX ′ 211x 222x 221x 22nx t = ,3 j ∈ ,1[ ln ], = ]3,1[ 321x 311x 322x 323x = ]4,1[ t = ,4 j ∈ ,1[ ln ], SI1 SI2 SI3 SI4 ⋮ SIq Gs 0−′tx 1lN 1−′tx ⋮ 1+−′ tx j 2lN ⋮ ljN Xˆ N + − q … tqc 3tc ⋮ 2tc 1tc q t C 대역별자료 발생단계 신경망입력자료계렬구성단계 신경망출력단계 그림 1. 다층적응신경망모형의 계산알고리듬 － 60 － 종합대학학보 지구환경과학 및 지질학 주체109(2020)년 제66권 제3호 첫 단계에서는 띠염시계렬인 초기관측값계렬을 스플라인보간을 리용하여 여러 대역 의 계렬로 확장한다. 다음단계에서는 이 계렬들을 결합하여 매 예보시단에 따르는 다층 적응신경망의 입력자료계렬을 구성한다. 마지막단계에서 앞선 두 단계의 파라메터들과 시간지연변수, 무게변수들을 다층적응신경망에 의하여 동적으로 조종하며 결과 여러 시 단의 예보값이 얻어지게 된다. , 는 관측계렬에 기초하여 각이한 시간분해능으로 자료 그림 1에서 SI { (cid:34) SI } , , 1 2 qSI 계렬을 발생시키는 스플라인보간함수를 의미한다. 첫 단계에서는 새로운 자료계렬 i = ,1 jq ; = ,1 ln ; = ,1 lq ; ≤ i } 가 추출된다. { xijl 다음단계에서는 식 (4)에 따라 신경망의 입력자료계렬을 구성한다. =′ x 1 t − − t 12 ′ x t x x = t 11 ′ x t − 0 , = (cid:34)(cid:34)(cid:34) ′ x 1 t j +− qtq ( = x 2 +− )1 q x t 22 j = )1 qq ( + 2 , t [ p +∈ ,1 n ] (4) 여기서 j는 파생되는 계렬의 길이를 나타낸다.  마감단계에서는 시단별예측값을 출력한다.  ˆ x , pt + ˆ( xF = ˆ, x pt pt 1 −+ −+ p , τ > ˆ, x pt −+ p , ≤ pt 1 −+ τ 2 τ , 2 τ (cid:34) ,0 = (cid:34) , = ,0 , ˆ, x t 1 + 1 − j ˆ x pt −+ 1 − j ) τ ˆ x pt + = ˆ( xF ⎧ ⎪ ⎪ ⎨ ⎪ ⎪ ⎩ ′ x t , (cid:34) , ′ x pt −+ τ ) (5) 여기서 xˆ 는 신경망의 출력값을 의미한다. 적응신경망모형의 활성함수는 시그모이드함수 )( xf = − 1 을 선택하였다. 2 −xe 1 + ３．월흐름량계렬을 리용한 정확도검증 ㅎ지점의 월흐름량계렬(1953년－2003년)에서 1988년 1월부터 2003년 12월까지의 제 한된 관측계렬을 리용하여 스플라인보간을 리용한 다층적응신경망모형의 월흐름량예보계 산실험을 진행하였다. 이때 관측계렬을 그대로 리용하는 시간지연신경망모형과 비교분석 을 진행하였다. 예보모형들의 예보결과검토는 2000년－2003년의 월흐름량관측자료에 기초하여 진행 하였다. 2와 같다. 다층적응신경망(SATNN)과 시간지연신경망(TDNN)에 의한 월흐름량예보결과는 그림 다층적응신경망에 의하여 얻어낸 예보계렬과 관측계렬사이의 상관분석을 하면 상관 곁수가 0.922 5이며 시간지연신경망으로 얻어낸 예보계렬과 관측계렬사이의 상관곁수는 0.919 4이다. 이것은 다층적응신경망의 예보결과가 실제관측계렬에 더 잘 맞는다는것을 보여준다. 또한 예보상대오차는 다층적응신경망인 경우 10.3%, 시간지연신경망인 경우 12.6%이다. 스플라인보간과 시간지연신경망모형의 결합에 의한… － 61 － ) 1 ‐ s · 3 m ( / 량 름 흐 월 4 500 3 500 2 500 1 500 500 0 ■ ∘ ■ ∘ ∘ ■■ ∘ ■ ∘ ∘ ∘∘∘ ■■ ∘ ■ ∘ ∘∘ ■ ∘∘ ■ ∘∘ ■■ ■ ∘ ■■ ∘ ∘∘ ■ ■ ■ ∘ ■ ∘ ∘∘ ■ ∘ ∘ ■ ■ ∘ ∘ ■■■ ■ ∘∘ ∘ ∘ ■ ∘ ■ ∘ ■ ■ ∘ ) 1 ‐ s · 3 m ( / 량 름 흐 월 4 500 3 500 2 500 1 500 △ ■ 500 △△△ ■ ■ ■ △ 0 ■ △ △ ■ △ ■ ■ △ △ ■ △ ■ △ ■ ■ △ ■ △ △ ■ △ ■ ■ △△ ■ ■ △ △ △ △ ■ △ △ ■ ■ ■ △△ △△ ■ ■ ■ △ ■ △ △ ■ ■ ■ △ △ ■ △ △ ■ ■ △ 2001.12. 2002.12. 2003.12. 2001.12. 2002.12. 2003.12. ㄱ) ㄴ) 그림 2. 다층적응신경망(ㄱ))과 시간지연신경망(ㄴ))에 의한 월흐름량예보결과 ■－관측값, ∘, △－예보값  맺 는 말 얻어진 결과는 스플라인보간과 결합된 다층적응신경망모형이 중장기수문시계렬예보 에 효과적으로 리용될수 있다는것을 보여준다. 계산정확도가 높아진것은 이 모형이 관측 값들이 가지고있는 유효한 정보를 《증폭》시키며 또한 오차의 축적과 전파를 감소시키기 때문이라고 볼수 있다. 참 고 문 헌 [1] J. Zhang ; J. Hydrology, 294, 118, 2002. [2] O. Kisi; J. Hydrology, 361, 48, 2008. [3] P. C. Nayak; Journal of Hydrology, 392, 52, 2014. 주체109(2020)년 4월 5일 원고접수 Long-Term Forecast of Monthly Mean River Discharge by Combining Spline Interpolation and Time-Delayed Artificial Model Kim Jong Hun, Phi Song Il The present study suggested applying a new indirect multi-layer-adaptive artificial model combined with dynamic spline interpolation to long-term hydrologic prediction along with an example forecasting the monthly river discharge. Keywords: long-term hydrologic prediction, river discharge, spline interpolation