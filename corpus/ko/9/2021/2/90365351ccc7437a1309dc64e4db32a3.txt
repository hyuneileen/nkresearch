김일성종합대학학보 화 학 주체110(2021)년 제67권 제2호 한소편콤퓨터에 의한 X선회절분석기조종의 한가지 방법 허철학, 류혁철, 리수범 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《인민경제 모든 부문의 생산기술공정과 생산방법, 경영활동을 새로운 과학적토대우 에 올려세우기 위한 연구사업도 강화하여야 합니다.》(《선집》 증보판 제11권 138페지) X선회절분석기에 의한 시료의 상정성 및 상정량분석, 결정립자크기분석 등에서는 X선회절분석기의 주사속도와 주사걸음을 임의로 조종할 필요성이 많이 제기된다. 현 재 리용되고있는 X선회절분석기(《Rigaku Miniflex》)는 제작초기에 그 주사속도와 주 사걸음이 각각 2°/min, 0.02°로 고정되여있었다. 따라서 시료분석시간이 오래고 측정정 밀도도 높일수 없었으며 한걸음당 주사시간도 임의로 조종할수 없는 제한성을 가지고 있었다. X선회절분석기의 주사속도와 주사걸음을 임의로 조종할수 있는 하나의 효과적인 방 도는 한소편콤퓨터를 리용한 걸음전동기의 합리적인 구동모듈을 개발하는것이다.[1–4] 지 금 생산공정과 기계수단의 현대화에서 걸음전동기구동모듈을 개발리용하는것은 하나의 세계적추세로 되고있다. 걸음전동기는 인민경제의 자동화, 무인화를 실현하는데 널리 쓰 이고있는 중요한 요소이다. 걸음전동기의 리용에서 중요한것은 걸음전동기의 류형에 맞 게 그 구동회로와 프로그람을 합리적으로 작성해주는것이다. 우리는 X선회절분석기의 주사속도와 주사걸음을 효률적으로 조종할수 있는 한소편 콤퓨터 PIC16F877A를 리용한 X선회절분석기의 4상걸음전동기조종에서 제기되는 몇가지 문제들에 대한 해결방도들을 제기하였다. １. X선회절분석기용걸음전동기의 류형과 그 구동론리 및 구동특성값들의 결정 X선회절분석기에 내장된 걸음전동기는 단극성, 단권선의 사보용걸음전동기인 동시에 영구자석형4상걸음전동기로서 독립적인 4개의 려자권선을 가지고있다. 걸음전동기의 이 4개의 상을 ㄱ, ㄴ, ㄷ, ㄹ라고 할 때 걸음전동기구동임풀스가 1개 씩 발생할 때마다 걸음전동기의 상들을 ㄱ, ㄴ, ㄷ, ㄹ순서로 선택하면서 일정한 지연시 간을 주면 걸음전동기가 한걸음씩 돌아가도록 되여있다. 만일 걸음전동기의 상들을 ㄹ, ㄷ, ㄴ, ㄱ순서로 선택하면서 일정한 지연시간을 주면 걸음전동기는 반대로 한걸음씩 돌 아간다. 이때 걸음전동기의 매 상들의 지연시간은 X선회절분석기의 주사방식에 따라 서 로 다르게 설정해주어야 한다. 순차주사방식은 걸음전동기를 정지시킴이 없이 일정한 속도로 련속 구동시키면서 한 걸음에 한번씩 계수하는 주사방식으로서 이 방식에서는 주사속도에 따라 결정되는 임풀 스간격을 정확히 보장해주어야 한다. 계단주사방식은 걸음전동기를 한걸음씩 구동시킬 때마다 일정한 시간 정지시키고 그 시간동안에 계수하는 주사방식으로서 이 방식에서는 주사속도가 같은 경우 순차주사방식 － 88 － 종합대학학보 화학 주체110(2021)년 제67권 제2호 에서보다 임풀스간격을 보다 짧게 주어야 한다. 그것은 걸음전동기를 한걸음 구동시킨 다음 계수까지 할수 있는 시간을 보장하여야 하기때문이다. 또한 이 방식에서는 걸음전 동기의 회전속도가 주사속도보다 빨라야 한다. 그것은 계단주사방식에서 걸음전동기를 주사속도로 회전시킨다면 계수시간을 보장할수 없기때문이다. 일반적으로 걸음전동기의 회전속도가 빠를수록 계수시간이 길어지므로 cps값이 안정해진다. 계단주사방식에서 걸음전동기의 정지시간은 주사속도와 주사걸음에 의해 결정된다. 만일 주사속도를 2º/min으로, 주사걸음을 0.02º로 선택하는 경우 1min당 주사걸음수는 20º/0.02º = 1 000개로 되며 따라서 한 주사걸음에 배당되는 시간은 1min/1 000 = 60ms로 된다. 결국 걸음전동기를 0.02º만큼 이동시킨 후 일정한 시간동안 정지해있으면서 X선회 절세기를 계수하는 작업을 60ms안에 다 끝내야 한다. 이때 가장 안정하면서도 큰 X선회절세기를 얻자면 이 60ms동안에 걸음전동기의 정 지시간이 차지하는 몫을 최대한 늘여야 하며 그러자면 걸음전동기를 주사속도보다 더 빠 른 속도로 회전시켜야 한다. 이것을 실현하기 위한 가장 합리적인 방도는 걸음전동기의 특성을 고려하여 주사속도에 관계없이 걸음전동기의 회전속도를 허용가능한 최대속도로 고정시키는것이다. 다시말하여 걸음전동기의 구동임풀스간격을 허용가능한 최소값으로 고정시키는것이다. X선회절분석기에 내장된 걸음전동기의 임풀스간격은 프로그람명령실행시간을 고려 하여 최소 4～5ms를 보장해야 한다. 4ms이하에서는 걸음전동기가 불안정하게 회전한다. 이로부터 우리는 걸음전동기의 구동안정성을 보장하면서도 걸음전동기의 회전속도를 최 대로 높이기 위하여 걸음전동기의 구동임풀스간격을 걸음전동기가 안정하게 회전할수 있 는 지연시간구간의 최소값인 5ms로 고정하였다. ２. X선회절분석기용걸음전동기의 구동알고리듬과 몇가지 구동특성값들의 결정 X선회절분석기용걸음전동기조종체계는 상위콤퓨터에 있는 주조종프로그람과 하위에 있는 한소편콤퓨터에 기초한 걸음전동기구동모듈의 련동체계로 구성되여있다. 걸음전동기구동모듈의 동작알고리듬은 그림 1과 같다. 구동모듈의 소편으로는 한소편콤퓨터 PIC16F877A 를 리용하였다. 이 소자의 초기화단계에서는 한소편콤퓨터의 초 기상태를 설정하는것과 함께 구동모듈의 스위치값들 을 읽어들여 걸음전동기의 조종상수들과 전류값 등을 결정한다. 입구신호대기에서는 상위프로그람에서 내려보내 는 걸음전동기의 방향신호와 동작신호들을 대기한다. 걸음전동기의 방향신호와 동작신호가 들어오면 그에 맞게 걸음전동기를 구동시키고 계수한 후 계수 값을 상위프로그람에 송신하고 다음동작신호를 대기 한다. 이와 같이 걸음전동기는 상위프로그람에서 준 조 그림 1. 걸음전동기구동모듈의 동작 알고리듬 한소편콤퓨터에 의한 X선회절분석기조종의 한가지 방법 － 89 － 종신호에 따라 걸음전동기를 조종하는 하위프로그람에 의하여 동작하게 되여있다. 걸음전동기구동에 필요한 주요특성값들은 다음과 같이 설정 및 계산한다. 걸음전동기구동임풀스간격(ms) 한걸음당 임풀스개수 DTPerPuls = 5 여기서 ScanStep는 주사걸음, INPer0p01은 0.01º이동에 필요한 임풀스개수이다. 1º 이동하면서 계수하는데 걸리는 시간(ms) INPerStep = ScanStep∗INPer0p01 여기서 ScanSpeed는 주사속도이다. 한걸음 이동하면서 계수하는데 걸리는 시간(ms) TPerDo = (60∗1000)/ScanSpeed 한걸음당 정지시간(ms, 계단주사방식에서는 이 시간에 계수함.) DTPerStep = TPerStep－(INPerStep∗DTPerPuls) TPerStep = TPerDo∗ScanStep ３. X선회절분석기조종체계의 구성과 그 효과성평가 우에서 보여준 특성값들과 걸음전동기구동모듈의 동작알고리듬에 기초하여 걸음전동 기를 임의로 조종할수 있는 한소편콤퓨터를 핵심으로 한 X선회절분석기조종용결합기판 을 제작하고 그에 해당한 상위 및 하위조종프로그람들을 작성하였다. 상위조종프로그람 은 VB로, 하위조종프로그람은 MicroC PRO for PIC로 작성하였다. X선회절분석기조종체계는 분석기본체에 들어있는 걸음전동기와 분석기조종용결합기 판 그리고 X선회절분석기조종콤퓨터로 구성되여있다. X선회절분석기조종체계의 구성에서 조종용결합기판은 X선회절분석기와 조종콤퓨터 를 결합시키는 기능을 수행한다. 즉 X선회절분석기조종콤퓨터에서 내려오는 걸음전동기조 종신호를 받아 X선회절분석기에로 보내여 걸음전동기를 조종하는 기능과 함께 X선회절분 석기에서 내보내는 X선회절세기신호를 받아 조종콤퓨터에로 올려보내는 기능을 수행한다. 하위조종프로그람은 조종용결합기판에 설치되여있으면서 조종콤퓨터에서 실행되는 상위조종프로그람에서 출구하는(걸음전동기의 조종에 필요한) 신호를 받아 X선회절분석 기본체의 걸음전동기에로 출구하여 측각기를 회전시키는 기능과 시료에 의하여 발생되는 X선회절세기신호를 계수관으로부터 받아 조종콤퓨터의 상위조종프로그람에 올려보내는 기능을 수행한다. 상위조종프로그람은 조종콤퓨터에 설치되여있으면서 걸음전동기의 조종에 필요한 신 호를 조종용결합기판에서 실행되는 하위조종프로그람에로 출구하는 기능과 조종용결합기 판의 하위조종프로그람에서 올려보내는 신호(시료에 의하여 발생되는 계수값)를 받아들 여 측정도형표시구역에 표시하여 시료의 X선회절도형을 그리는 기능을 수행한다. 우리가 개조한 X선회절분석기조종체계를 도입한 X선회절분석기에서 주사걸음을 0.04º로 고정하고 2와 8º/min의 주사속도로 15～25º(2θ)에서 측정한 Al(OH)3을 주성분으로 하는 시료의 X선회절도형은 그림 2와 같다. 그림 2에서 회절도형 1과 4는 주사속도만 다를뿐 다른 측정조건들은 다같은 상태에 서 얻어진 도형들로서 그 어떤 려파나 평활화처리도 하지 않은것들이다. 그리고 회절도형 2와 3은 회절도형 1에 대한 려파 및 평활화처리를 각각 1, 2회 진행하여 얻은 도형들이다. － 90 － 종합대학학보 화학 주체110(2021)년 제67권 제2호 그림 2. Al(OH)3을 주성분으로 하는 시료의 X선회절도형(주사걸음 0.04°) 1－주사속도 8º/min, 평활화하지 않은것, 최대값 511cps, 2－주사속도 8º/min, 평활화회수 1, 최대값 483cps, 3－주사속도 8º/min, 평활화회수 2, 최대값 464cps, 4－주사속도 2º/min, 평활화하지 않은것, 최대값 481cps 회절도형 1과 4에서 19º근방에 있는 최대봉우리의 회절세기는 각각 511, 481cps로서 이것은 주사속도를 8º/min으로 높여도 회절세기가 그리 크지 않은 경우에는 주사속도가 봉우리의 회절세기에 큰 영향을 미치지 않는다는것을 보여준다. 회절도형 1에 대한 려파 및 평활화처리를 1회 진행하여 얻은 도형인 회절도형 2에서 최대봉우리의 회절세기는 483cps로서 회절도형 4의 최대봉우리세기 481cps와 거의 근사 하며 회절도형의 모양도 거의 같다. 주사속도 8 및 2º/min으로 측정할 때 걸린 시간은 각 각 1.5, 5min이다. 이 경우 측정구간과 주사걸음은 각각 15～25º(2θ), 0.04º이다. 이로부터 8º/min의 주사속도로 측정한 후 회절도형에 대한 려파 및 평활화처리를 1회 진행하면 2º/min의 주사속도로 측정한것과 거의 같은 회절도형을 얻으면서도 측정시간을 원래의 분석시간의 1/3이하로 단축할수 있다는것을 알수 있다. 또한 이 조종체계로는 최 소 0.001 25°의 분해능을 요구하는 미세한 걸음구동도 실현할수 있다. 이 미세구동방식은 겹친봉우리들의 모양을 관찰하거나 봉우리들의 반치폭을 결정할 목적으로 회절봉우리들 의 모양을 정밀측정할 때 효과적으로 리용할수 있다. 맺 는 말 한소편콤퓨터 PIC16F877A를 리용하여 4상걸음전동기를 구동하는데 필요한 특성값들 을 결정하고 그에 맞게 걸음전동기조종기판을 제작하고 상위 및 하위조종프로그람들을 작성함으로써 X선회절분석기의 주사속도와 주사걸음을 임의로 조종할수 있게 하였으며 계단주사까지도 진행할수 있는 현대적인 X선회절분석기측정조종체계를 실현하였다. 참 고 문 헌 [1] 김정학 등; DSP에 의한 전동기조종, 공업출판사, 269～291, 주체101(2012). [2] Sevil A. Ahmed et al.; IFAC－PapersOnLine, 49, 29, 247, 2016. [3] Efraim Rotem et al.; Microelectronics Journal, 46, 1225, 2015. [4] Nathan Schemm et al.; IEEE Sensors Journal, 10, 7, 2010. 주체110(2021)년 1월 5일 원고접수 한소편콤퓨터에 의한 X선회절분석기조종의 한가지 방법 － 91 － One Method of the XRD Analyzer Control by Single–Chip Computer Ho Chol Hak, Ryu Hyok Chol and Ri Su Bom Using the single–chip computer PIC16F877A, we produced the control board to drive the four–phase step motor, and developed up– and down–control programs. As the result, the scan mode, the scan speed and the scan step of XRD analyzer could be freely controlled. Keywords: XRD, single–chip computer, step motor