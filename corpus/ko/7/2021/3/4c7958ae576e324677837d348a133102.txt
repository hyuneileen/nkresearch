김일성종합대학학보 수 학 주체110(2021)년 제67권 제3호 위성화상에서 무리짓기와 기하학적특징에 의한 구름검출방법 리정환, 김만수 우리는 중분해능위성화상에서 구름을 검출하기 위한 한가지 수학적방법을 연구하였 다. 선행연구[1]에서는 스펙트르특징을 리용하여 초보적인 구름령역을 검출하고 다시 국 부2진패턴, 기하학적특징들을 리용하여 최종구름령역을 검출하는 한가지 알고리듬을 제 기하였으며 선행연구[2]에서는 입력위성화상을 여러개의 블로크들로 분할하고 적응턱값 방법을 리용하여 초보적인 구름령역을 검출한 다음 블로크내에서 그라디엔트의 평균과 동시발생행렬의 2차모멘트를 계산하고 훈련된 지지벡토르기계(SVM)를 리용하여 초보적 인 구름령역이 구름인가 아닌가를 판정하였다. 선행연구[3]에서는 구름에 대한 확률모형에 기초하여 구름을 검출하였으며 선행연구 [4]에서는 3개의 SWIR대역과 2개의 LWIR대역, 보임빛대역의 화상들을 리용하여 구름을 검출하는 한가지 알고리듬을 제기하였다. 선행방법들은 구름과 구름이 아닌 령역에서의 색특징의 차이가 명백한것을 념두에 두었으며 많은 대역의 빛성분들을 구름검출에 리용한다. 지어 위도 및 경도정보들을 참 고로 리용하므로 보임빛대역과 적외선대역만 주어진 위성화상에서의 구름검출방법으로는 합당치 않다. 론문에서는 구름검출을 안정하게 하기 위하여 무리짓기에 기초한 구름 및 구름이 아 닌 령역의 분할방법, 기하학적특징들인 프락탈차원과 산줄기류사성척도를 제기하였으며 이것들을 리용하여 위성화상에서의 구름을 검출하기 위한 한가지 방법을 제기한다. 먼저 구름후보령역의 생성에 대하여 보자. 입력화상을 64×64크기의 부분블로크들로 분할하고 매개 블로크에서 4 096개의 4차 들을 추출하며 k평균무리짓기알고리듬을 리용하여 이 특징벡토 원특징벡토르 르모임을 무리짓는다. 알고리듬에서 무리의 최대개수는 7이라고 가정한다. 여기서 , , irbgr 두 무리(령역)의 중심벡토르를 들은 각각 적색, 록색, 청색, 근적외선대역의 밝기값들이다. 라고 하고 류사성척도를 irbgr , ,( ), g ( ) ) , , , , , , , r 2 b 2 ir 2 2 b 1 ir 1 d = max f ⎛ ⎜ ⎜ ⎝ ⎛ ⎜⎜ ⎝ r 1 r 2 ⎞ ⎟⎟ , ⎠ f ⎛ ⎜⎜ ⎝ g 1 g 2 ⎞ ⎟⎟ , ⎠ f ⎛ ⎜⎜ ⎝ b 1 b 2 ⎞ ⎟⎟ , ⎠ f ⎛ ⎜⎜ ⎝ ir 1 ir 2 과 같이 정의한다. 여기서 xf )( = x , ⎧ ⎨ /1 ⎩ x xx , ≥ < 1 1 이다. 정의된 류사성척도 d 가 어떤 턱값보다 작으면 두 무리는 류사한 무리로 판정하고 gr ,( 1 1 ⎞ ⎟ ⎟ ⎠ ⎞ ⎟⎟ ⎠ 하나로 합친다. 우리는 턱값을 1.2로 정한다. 이 합치기를 린접블로크들의 무리짓기된 부분령역들에 대하여 진행하여 전체 화상을 색정보가 류사한 몇개의 부분령역들로 분할한다. 매개의 부분령역들에 대하여 령역안에 그 령역의 밝기값보다 큰 령역이 존재하거나 이웃한 부분령역들의 밝기값보다 크지 않은 령역은 배경령역이라고 판정한다. 배경령역으로 판정된 령역들을 리용하여 입력화상에 대한 배경곡면을 생성한다. 위성화상에서 무리짓기와 기하학적특징에 의한 구름검출방법 － 25 － 매 64×64블로크에 배경령역으로 판정된 무리가 존재하면 그 블로크내에서 배경령역 으로 판정된 무리들중 평균밝기값이 제일 큰 무리를 그 블로크에서의 배경이라고 보고 그 무리의 중심벡토르를 현재블로크의 배경색으로 결정한다. 다음 배경령역으로 판정된 무리가 존재하지 않는 블로크에 대하여서는 주변의 배경 령역이라고 판정된 블로크들에서의 배경색들을 선형보간하여 그 블로크에서의 배경색을 결정한다. 이렇게 생성된 배경은 불련속성을 가지게 된다. 배경화상은 그 점의 근방에서 평면으로 볼수 있으므로 매 블로크들을 중심으로 하는 11×11개의 블로크들의 배경색들이 평면을 이룬다고 보고 그 평면의 방정식을 구한다. 즉 ∑ 는 블로크에 를 구한다. 여기서 이 최소로 되는 , cba ,(( yxI yxI ,( ax by 2) − − − c ) ) , , yx 서의 밝기값이다. 판정한다. 이때 얻어진 방정식 z = ax + by + c 를 리용하여 매 블로크들의 색벡토르들을 갱신한다. 다음 이 배경령역의 밝기값보다 밝은 입력화상의 모든 부분을 구름후보령역이라고 다음으로 구름후보령역의 판정에 대하여 보자. 검출된 구름후보령역에 대한 새로운 산줄기류사성척도평가방법을 제기한다.  화상의 매개 점에서 산줄기류사성은 다음과 같이 계산한다. 먼저 입력화상 I 에 대하여 라쁠라시안 IΔ 를 계산한다.  ,1 ⎧ ⎨ ,0 ⎩ g Δ 의 세선화화상을 G 라고 하자. 여기서 이다. 다음 th 0 ≥ < xg )( x x ( I = ) 그러면 화상 G 는 산줄기에서 정점들을 포함하는 어떤 선정보를 나타낸다고 볼수 있다. 화상 G 의 값이 1인 화소에서 외경이 15이고 내경이 4인 고리를 생각하고 그림과 같이 극자리표변환을 리용하여 직4각형으로 변환한 다음 수직방향으로 평균하여 벡토르 v 를 구한다. 벡토르 v 에 대하여 령교차률을 계산하고 령교차률이 4이상이면 주어진 화소가 산줄기의 후보점으로 된다고 판정하고 그 화소에서의 산 줄기류사도를 다음의 식으로 계산한다. C fork = ⎛ ⎜ ⎜ ⎝ 1 ∑ n )(1 v v mk ≥ )( k ⎞ ⎟ ⎟ ⎠ ⎛ ⎜ ⎜ ⎝ 1 ∑ n )(1 v v mk < )( k ⎞ ⎟ ⎟ ⎠ 그림．극자리표변환 v k )( ∑ k n 여기서 n 1 = k |{# v nmk )( }, ≥ = k |{# v mmk )( }, < = 2 이다. 다음 련결성분에서 산줄기의 점으로 판정된 모든 화소에서의 산줄기류사성척도의 평 균값을 1C 이라고 하고 이 값을 주어진 련결성분의 산줄기류사도라고 한다. 선행연구[1]에서는 련결령역의 경계의 복잡성을 특징짓는 량으로서 프락탈차원을 계 산하고 그것을 구름령역판정에 리용하였다. l )4/ log( log( s ) 련결성분의 프락탈차원은 C = 2 2 과 같이 계산된다. － 26 － 종합대학학보 수학 주체110(2021)년 제67권 제3호 이와 같이 계산된 련결성분에 대한 프락탈차원 2C 와 산줄기류사성척도 1C 이 조건 를 만족시키면 그 련결성분은 구름령역이 아니라고 판 이거나 ,36.1 15.1 C > > 2 C 1 구름후보령역에서 프락탈차원과 산줄기류사성척도를 리용하여 구름이 아닌 련결성분 을 제거하고 남은 령역에 대하여 안내려파[1]를 진행하여 최종구름령역을 검출한다. 론문에서 제기한 방법에 대한 실험결과와 선행연구결과들을 비교하면 다음의 표와 5.12 >C 정한다. 같다. 검출정확도/% 선행연구[1]의 방법 선행연구[2]의 방법 선행연구[3]의 방법 우리의 방법 64.1 78.9 82.5 83.1 표．비교결과 표에서 보는바와 같이 실험결과는 론문에서 제기한 방법이 선행한 방법들보다 검출 정확도가 높다는것을 알수 있다. 참 고 문 헌 [1] Zhiwei Li et al.; Remote Sensing of Environment, 191, 342, 2017. [2] Pengfei Li et al.; Neurocomputing, 169, 34, 2015. [3] K. G. Karlsson et al.; Remote Sensing of Environment, 158, 126, 2015. [4] Jianjie Wang et al.; Remote Sensing of Environment, 227, 1, 2019. 주체110(2021)년 3월 5일 원고접수 Cloud Detection Method by Using the Clustering and Geometrical Features in Satellite Images Ri Jong Hwan，Kim Man Su We proposed a new method for cloud detection in satellite image by using the clustering and geometrical features, such as the similarity of mountain ridge and fractal dimensionality. The experiment shows that the proposed method improves the accuracy of cloud detection. Keywords: cloud detection, clustering, satellite image processing