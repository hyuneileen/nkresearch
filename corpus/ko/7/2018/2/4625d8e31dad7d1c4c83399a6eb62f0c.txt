김일성종합대학학보 수 학 주체107(2018)년 제64권 제2호 열쇠속성을 고려한 PKCS#11표준의 형식적모형 김진성, 김종학 우리는 공개열쇠암호화표준의 한가지인 PKCS#11의 형식적모형에 대하여 연구하였다. 선행연구[1]에서는 항대수와 규칙기반서술언어로 PKCS#11에 대한 형식적모형을 처음 으로 제기하였지만 PKCS#11의 안전성에 대한 결과는 주지 못하였다. 선행연구[2]에서는 FOLTL모형에 의해 PKCS#11이 안전한것으로 되기 위한 한가지 충분조건을 밝혔지만 관리 자를 신뢰하는 조건에서만 안전하다는 문제가 있으며 선행연구[3]에서는 열쇠의 자료만을 고 찰했기때문에 열쇠의 속성을 함께 반출하는 경우의 안전성은 론의할수 없다. 론문에서는 열쇠속성을 함께 반출하는 경우의 안전성도 고찰할수 있는 새로운 형식적 모형을 제기하고 그것에 기초하여 PKCS#11의 안전성에 대하여 연구하였다. １．열쇠속성을 고려한 형식적모형 론문에서 견본(Template)은 선행연구[3]에서의 정의를 그대로 리용하며 값(Value)은 아 래와 같은 문법으로 정의한다. ,( vv 여기서 T 는 견본, V 는 원자 상수 및 새로운 값들의 모임, Tv; 는 열쇠자료와 속성자료를 V∈val T∈T venc vdec ; Tv val ,( v :: = v v | , , ′ |) ′ |) 결합한것을 의미한다. 로 도입한다. 열쇠속성을 고려하기 위하여 값과 견본의 쌍으로 이루어진 대상(Subject)의 개념을 새 sub = ( val , T ) , V∈val , T∈T sub 를 원자값대상이라고 부르고 대상 s 는 아래의 문법으로 정의한다. | ss ,( sub enc ′ |) ′ ) :: = s 여기서 enc =′ ) ss ,( ( ⎧ ⎨ ( ⎩ 우에서 정의한 대상을 리용하여 식과 기억, API함수, 공격자모형, API안전성을 선행연 ′′ ′′ ( ( ; ), venc Tv ′′ ′′ ( ( ; ), venc Tv ′ ), ), φ ′ ), φvTv ) ;( ) φ ) φ 이다. ,( ss venc = ≠ s s =′ ) dec , ( , 구[3]와 동일한 방법으로 정의할수 있다. dec ′′ , Tv vdec ,( ss ′′ ), ,( vv ２．형체계를 리용한 안전성해석 형에 기초한 안전성해석방법은 보안API들에서의 암호학적연산들에 대한 정보흐름속성 을 분석하기 위하여 제안되였다.[3] 식과 명령들의 형을 결정하기 위하여 형결정환경 Γ 를 다음과 같이 도입한다. 환경 Γ 에서 식 e 의 형이 τ로 된다는것을 Γ e⊥ 로 표시한다. τ: τ(cid:54)x:Γ ( x :변수, τ:형) － 100 － 종합대학학보 수학 주체107(2018)년 제64권 제2호 ] [ ] ] [ Γ ⊥ τ: [  , var enc sub e Γ Γ Γ e⊥ 는 다음의 규칙에 의하여 결정된다.  Γ x )(Γ τ = x : Γ τ ⊥ x e : Data Γ  Un: ⊥ ⊥ xe Γ Un:) ,( enc ⊥ x e : Γ  Wrap : ⊥ xe Γ ,( enc Un:) ⊥ x e Γ Γ : Any  ⊥ ⊥ e x Γ Un:) ,( enc ⊥ 다음으로 API의 형을 결정하자. 환경 Γ 와 방책 T 에서 명령 c 가 형완정성을 가진다는것을 ′ ′≤   : τττ e : ⊥ τ x : Data ⊥ ,(dec Γ ⊥ x : Γ ⊥ Γ ⊥ Γ ⊥ Γ unwrap wrap Any Un: any any enc dec dec [  , [  , [ ⊥ Γ − − ] ] [ [ ] ] ] , Un: e Γ  ⊥ xe Un:) e Γ  Wrap ⊥ xe Any ,(dec :) x e Γ : Any  ⊥ e x :) Any ,(dec ⊥ Un: Un: Γ T⊥ 로 표시하며 다음 c [ ]API 의 규칙에 의하여 판단한다.  ΓA  a ∈∀ Γ ⊥ Γ  c ⊥ T Γ ⊥ T LUB : = T ⊥ c;c T ,( x )(Γ Γ ⊥ checktmp ] = x seq Γ [ ] [ T 1 2 1 ⊥ A c a T [  , assign 2 [  , getobj ] ] )(Γ x Γ )(Γ x = Γ ⊥ T τ : τ Γ  e ⊥ = x : e = ⊥ T Any  y Γ Un: ⊥ )( getobj y x : = x T )(Γ Un  ∈ = x genkey : ⊥ = : ⊥ τ Γ ] T ] T T [  , genkey impkey [ T )( T ΓUn  Γ ⊥ T Γ  ) T checkTempl x )(Γ = y Un: ⊥ ) ,(ate Ty : y y   Attr( ) T ⊥ = τ importkey x : )( y = (cid:34) x Un  Γ Γ ⊥ 1 x Γ ⊥ λT 1 ′⊆ 인 견본 T ′ 들에 대한 모든 형들의 최소웃경계를 나타낸다. 즉  T 가 주어졌다고 하자. 여기서 sub 는 원자값대상, ρ는 형이다. e Un: return ΓUn  x c ′⊥∧′⊆ T Γ ⊥ Γ ⊥ ∈′∃′ T function x k (cid:34) LUB ′ }: τ ⊥ , |{ τ ⊥ T T ,( [  , : , ρ ∪ T T T T = , c ] ] ) T : k [ return LUB TT ,( ) 는 T 넘기기 θ : (cid:54)sub θ에 의하여 대상이 형식완정성을 가진다는것은 식의 형결정규칙과 동일한 규칙들로 판 보조정리 １ 이고 S 는 원자값대상들의 모임이며 sub S ⇒∈ ( θ sub ) = Un 이라고 단한다. 할 때 s ∈ S )(K HT⊥θ s θ ⊥⇒ Un: 이다. e M↓ 라고 하면 보조정리 ２ s Γ e⊥ 이 보조정리들은 공격자지식 τ: , : τ )(K S 와 식 e 의 구조에 관한 귀납법으로 증명할수 있다. s⊥⇒ θ ⊥T 이다. M θ ,Γ 다음의 정리는 형완정성을 가지는 API함수는 실행시에 형완정성을 보존하며 기억과 손 잡이지도는 형식완정성을 그대로 보존한다는것을 보여준다. 이고 cH,M, Γ T⊥ 라고 할 때 정리 １ T⊥θ HM, ,Γ c 〈 〈→〉 c,H,M ′ ′ 〉′ 이면 다음의 결 과들이 성립된다. ′ ⊥⇒≠′ c c Γ ε T ⊇′∃ ⊥′ ,Γ Tθθθ ② ① ′ H,M ′ 다음의 정리는 형완정성을 가지는 API는 안전하다는것을 보여준다. 정리 ２ 증명 먼저 A Γ T⊥ 이면 API A는 안전하다. ,H 일 때 S S 〉 〈 ,H 0 0 〈→〉 * A 열쇠속성을 고려한 PKCS#11표준의 형식적모형 － 101 － , θθ ∃ ⊥ T H, Ss ∈∀ , θ ⊥ s Un: (1) 임을 증명한다. 이것은 보조정리들과 변환의 길이에 관한 귀납법으로 증명할수 있다. 다음 API안전성에 대한 정의인 식 (1)이 성립된다는것을 증명하자. sub ∉ S ),K( sub H: 에서 기밀대상이므로 ~ (cid:54)subθθ = [ ]Data ~ 로 정의하면 θ 에 대해서도 식 (1)이 그대로 성립된다. S 변환 ′ ,H ,H S 〈 〈→〉 * A 〉′ 에 대하여 식 (1)의 증명과 같은 론의를 적용하면 ~ sub θ ) ( = ′ ( θ sub ) = Data 이므로 / sub⊥′θ Un: 이고 보조정리 1로부터 sub ∉ ′ )K(S 이므로 ~ ⊇′∃ θθθ , ⊥′ T ,H ′∈∀′ s S , θ ⊥′ s Un: (2) API안전성에 대한 정의인 식 (2)도 성립된다. H 에서 신뢰할수 있는 대상인 sub 가 가질수 있는 형은 Wrap, TData, Seed뿐이다.  따라서 이고 ∈⇒∈ TS TA )K(S 이므로 / sub⊥θ Un: 이다. 따라서 과 보조정리 1로부터 sub sub ∉ 이다.(증명끝) ′ )K( S S )K( ∉ ∪ sub ∉ ′ )K(S ３．PKCS#11의 안전성고찰 우에서 정의한 형식적모형에 기초하여 PKCS#11의 안전성에 대하여 고찰하자.  보안방책 T 가 아래의 조건을 만족시킨다고 하자. }{}, TD =⇒∈ 이 조건을 만족시키는 T 에서의 형결정환경 Γ 를 } ,{ , DES  , h _(Γ ) Un = T =⇒∈ Data (Γ UWSA , TW }{, ∈T ,{ key T T = ) , Un 로 정의하면 C_Encrypt, C_Decrypt, C_WrapKey, C_UnwrapKey함수들이 형완정성을 가진다는것을 알수 있다. 이 4개 함수가 모두 형완정성을 가지므로 API의 형결정규칙 [API]에 의해 이 함수들로 이루어진 API는 형완정성을 가지며 정리 2로부터 API는 안전하다. 참 고 문 헌 [1] S. Delaune et al.; In Proceedings of the 21st IEEE Computer Security Foundations Symposium, IEEE Computer Society Press, 331～344, 2008. [2] S. B. Fröschle et al.; Lecture Notes in Computer Science, Springer, 34～78, 2011. [3] M. Centenaro et al.; Type-Based Analysis of PKCS#11 Key Management, DAIS, 122～156, 2012. A Formal Model for PKCS#11 Standard Considering Key Attributes 주체106(2017)년 12월 5일 원고접수 Kim Jin Song, Kim Jong Hak We suggested a new formal model which takes account of key attributes for PKCS#11 standard, which could consider a security even in case of exporting key attributes with key values and showed a sufficient condition for security of PKCS#11. Key words: PKCS#11, key attribute