김일성종합대학학보 (수 학) 가보르웨블레트를 리용한 한가지 안정한 눈상태식별방법 주체107(2018)년 제64권 제1호 리원호, 김만수 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《수학, 물리학, 화학, 생물학과 같은 기초과학부문에서 과학기술발전의 원리적, 방법론 적기초를 다져나가면서 세계적인 연구성과들을 내놓아야 합니다.》(《조선로동당 제7차대회에 서 한 중앙위원회사업총화보고》 단행본 40페지) 우리는 카메라로부터 들어온 화상을 리용하여 눈상태 다시말하여 눈을 떴는가 감았는 가를 판정하는 알고리듬을 연구하였다. 최근 세계적으로 콤퓨터프로그람을 리용하여 사람의 눈상태 즉 눈을 떴는가 감았는가 하는것을 식별하는 방법에 대한 연구가 광범하게 진행되고있다. 눈상태를 식별하는것은 운전수가 운전도중 피로하여 눈을 감았을 때 자동적으로 경보 신호를 내는 체계, 콤퓨터사용자들의 눈이 피로하지 않도록 눈을 자주 깜빡이도록 하는 체 계, 손전화나 판형콤퓨터에서 눈깜빡임을 통한 입력 등 넓은 응용분야를 가진다. 선행연구[1]에서는 신경망을 리용하여 눈상태를 식별하였다. 이 방법은 훈련된 화상과 류사한 모양의 눈에 대해서는 식별이 잘되지만 다른 형태의 눈에 대해서는 식별률이 대폭 떨어진다. 선행연구[2]에서는 두눈의 위치를 찾은 다음 화소의 밝기값에 의하여 눈섭과 눈의 위 치의 거리를 계산하여 눈을 떴는가, 감았는가 하는것을 판정한다. 선행연구[3]에서는 동화상의 린접한 두 프레임에서 검출된 눈령역의 화소준위에서의 상 관곁수를 계산하여 눈을 추적한다. 그리고 상관곁수가 일정한 턱값보다 작으면 눈을 깜빡 인것으로 판정한다. 선행연구[2, 3]의 방법들은 화상에 잡음이 있거나 조명변화가 있는 경우를 비롯하여 여 러가지 환경변화에 안정하지 못한 결함을 가지고있다. 론문에서는 실시간적이면서도 안정한 눈상태식별을 위하여 가보르웨블레트곁수와 배 경자료기지를 리용한 알고리듬을 제기하였다. １．가보르웨블레트를 리용한 특징추출 눈상태식별은 크게 3단계 즉 얼굴검출과 눈검출, 눈상태식별로 이루어진다. 얼굴검출단계에서는 AdaBoost방법을 리용하여 얼굴령역 4각형을 얻어낸다. 이 얼굴령역에서 가보르웨블레트곁수들을 계산하고 SVM을 리용하여 눈의 정확한 위 치를 찾는다. 눈상태식별은 특징추출과 대조의 2단계로 이루어진다. 특징추출은 다음과 같이 한다. － 26 － 종합대학학보(수학)   주체107(2018)년  제64권  제1호 추정된 두눈의 위치를 리용하여 얼굴화상의 크기와 방향을 표준화한다. 오른쪽눈주위 의 화상은 좌우반전시킨다. 다음 눈위치를 중심으로 하여 가로 7줄, 세로 11줄의 격자점들 에서 가보르웨블레트곁수들을 계산한다. 가로줄간격은 2화소, 세로줄간격은 3화소로 한다. 여 기서 리용하는 가보르핵함수는 다음과 같다. ψ , νμ yx ,( ) = exp − 2 k ν 2 σ ⎡ ⎢ ⎢ ⎣ k ν ( 2 x + 2 2 σ 2 y ) ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ ⎢ ⎣ exp( ik ( x cos ϕ μ ν + y sin ϕ μ )) − ⎛ ⎜ exp ⎜ ⎝ − 2 σ 2 ⎞ ⎟ ⎟ ⎠ ⎤ ⎥ ⎥ ⎦ k ν = , k max = k max f ν ν 4 2 f ν = π 2 , ⋅= μϕ μ μ = ,0 ,7, ν = 9,8,7,3,2,1 L π 8 , 2 = πσ 여기서 f 는 시누스파의 주파수를 나타내고 μ는 방향첨수이며 σ는 가우스함수의 폭이다. 주파수는 에 해당한 6개를 리용한다. 9,8,7,3,2,1=ν yxμψ ,( ) 정의의 두번째 부분 − 2 k ν 2 σ ⎛ ⎜ exp ⎜ ⎝ − k ν ( 2 x + 2 2 σ 2 y ) ⎞ ⎟ ⎟ ⎠ ⎛ ⎜ exp ⎜ ⎝ − 2 σ 2 ⎞ ⎟ ⎟ ⎠ 은 직류성분으로서 핵함수의 평균이 령으로 되게 하기 위한것이다. 화상의 점 ( x 0 , y 0 ) 에서 2차원가보르려파기는 다음과 같이 정의된다. J ( x , 0 y 0 ) = , νμ ,( yxI ) ψ ( x 0 , νμ − , yx 0 − y ) dxdy ∫ 여기서 xI ,( y ) 는 화소 x 의 세기이며 특징량으로 ,( y ) J νμ , ( x 0 , y 0 ) 의 절대값을 리용하므 로 한 점에서 가보르웨블레트곁수 68 =× 48 개를 얻는다. 그리고 주파수별로 가보르웨블레트곁수들을 표준화하여 그 점에서의 특징량으로 취한 다. 즉 μ = ,0 ,7, ν = 9,8,7,3,2,1 에 대하여 L νμξ , yx ,( ) = | J , νμ yx ,( |) | J ( x 0 , m , ν 2 y 0 |) 8 ∑ m 1 = 로 놓는다. 한쪽눈에서 르웨블레트곁수들로 구성된 다음의 11 7 × 개의 점을 취하므로 두눈에서는 154개의 점에서 계산한 가보 154 ×× 68 차원벡토르를 그 눈의 특징량으로 한다. ξ = { ξ νμ , ( x 0 + ,3 yj + |)2 i μ = ,1 0 L ,8, ν = ,9,8,7,3,2,1 | j |,5| ≤ i }3| ≤ 여기서 ( x 0 , y 0 ) 은 눈중심의 자리표이다. 다음으로 눈을 뜬 얼굴화상 200장과 눈을 감은 얼굴화상 200장을 준비하고 두눈의 위 치를 수동적으로 지적하여 우와 같은 방법으로 특징량을 추출하여 배경자료기지를 구축 한다. 가보르웨블레트를 리용한 한가지 안정한 눈상태식별방법 － 27 － ２．눈상태식별과 실험결과 식별단계에서는 입력된 얼굴화상에서 추출한 특징량을 배경자료기지의 특징량들과 비 교하여 어느쪽 화상들과 더 류사한가를 판별하는 방법을 리용한다. 대조류사도는 두 특징량의 스칼라적으로 한다. 즉 입력화상에서 추출한 특징벡토르가 일 이고 배경자료기지의 k 번째 특징벡토르가 k )( η = ) ) , , , , k k )( )( , ( ηη 2 1 k )( η N L Nξ =ξ , ( ξξ L 1 2 때 류사도는 s ηξ ,( k )( ) = k )( ηξ i i N ∑ i 1 = 152 =N ×× 이다. 로 계산된다. 여기서 86 속도를 높이기 위하여 대조를 2단계로 나누어 진행한다. 1단계에서는 154개의 점들가운데서 고정된 30개의 점들을 선택하여 3개의 주파수에 해 당하는 가보르웨블레트곁수들만으로 구성된 부분특징벡토르를 리용하여 대조를 진행한다. 그 러므로 이때 리용하는 류사도는 다음과 같다. s 1 ηξ ,( )( k ) = ∑ )( k ηξ i i j j , M = 30 ×× 38 M j 1 = 대조결과 량쪽 자료기지(눈을 뜬것과 감은것)에서 각각 류사도가 가장 높은 60개의 특 2단계에서는 1단계에서 선택된 60×2개의 특징벡토르와 모든 점, 모든 주파수를 리용 대조결과 량쪽 자료기지에서 각각 류사도가 가장 높은 10개의 특징들을 선택하여 다 징벡토르들만 선택한다. 하여 대조를 진행한다. 음과 같이 그 류사도를 평균한다. 10 s k ( ,( ηξ o i ) ,) S c = ( ,( ηξ c s l j ) ) 1 10 10 ∑ j 1 = S o = 1 10 ∑ i 1 = jl ( cη () ik ( oη () 여기서 =j 감은 화상자료기지에서 ξ와의 류사도가 가장 높은 10개의 특징벡토르들이다. 는 각각 눈을 뜬 화상자료기지와 눈을 )10, )10, ,2,1 ,2,1 와 =i L L S > 이면 눈을 뜬것으로 판정하고 S S < 이면 눈을 감은것으로 판정한다. S o c o c 론문에서 제기한 방법과 선행한 방법들을 리용하여 400장의 얼굴화상자료기지(그중 눈 을 뜬것 200장, 눈을 감은것 200장)에서 눈상태를 식별한 결과를 표에 주었다. 편차(화소) 알고리듬 [1] [2] [3] 론문의 방법 표. 눈상태식별결과 눈을 뜬 화상 눈을 감은 화상 73% 81% 85% 97% 61% 86% 79% 99% － 28 － 종합대학학보(수학)   주체107(2018)년  제64권  제1호 이 방법은 특징량으로서 화소의 밝기값이 아니라 가보르웨블레트곁수를 리용하므로 환 경변화에 안정하며 배경자료기지와의 대조를 통하여 식별을 진행하므로 각이한 형태의 눈 에 대하여 다같이 우수한 성능을 보여준다. 참 고 문 헌 [1] Weston Sewell et al.; ACM Conference on Human Factors in Computing Systems, 241～265, 2010. [2] P. Suvarna et al.; International Journal of Recent Technology and Engineering, 1, 3, 1023, 2012. [3] D. Jayanthi et al.; International Journal of Engineering and Advanced Technology, 2,1, 867, 2012. 주체106(2017)년 8월 10일 원고접수 A Robust Method for Identifying Eye State using Gabor Wavelets Ri Won Ho, Kim Man Su We investigate a robust method for identifying eye state using Gabor wavelets and background database. First, Gabor wavelet coefficients are calculated at fixed grid points around two eye centers, forming the feature. Then this feature is matched against those calculated from face images in the background database and whether the eye is open or closed is determined. The proposed method is faster and more robust, and accurate than precedent methods. Key words: eye state identification, Gabor wavelet