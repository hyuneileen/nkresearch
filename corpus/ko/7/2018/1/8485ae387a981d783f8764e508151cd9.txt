김일성종합대학학보 (수 학) 주체107(2018)년 제64권 제1호 얼굴인식과 자동턱값결정방법에 기초한 안정한 운전수피로검출방법 리정환, 원영준 운전수의 피로는 교통사고를 일으키는 중요한 요인으로서 실시간으로 운전수의 피로 상태를 정확히 판정하는것은 교통사고를 줄이는 효과적인 방법으로 된다. 운전수의 생물학적특성에 기초한 운전수피로검출방법은 정확도는 비교적 높으나 복잡 한 검측설비들을 필요로 하고있고 운전수에게도 불편을 주는 결함을 가지고있다.[2] 콤퓨터화상처리기술에 기초한 운전수피로검출방법은 운전수의 여러가지 특징(실례로 머 리의 기울어짐정도, 눈까풀의 닫김상태, 하품상태 등)을 분석하여 운전수의 피로상태를 결 정한다. 선행연구[1]에서는 지지벡토르기계를 리용하여 얼굴화상을 분석하고 눈상태와 머리의 자 세를 추정하며 그에 기초하여 운전수의 피로상태를 결정한다. 그러나 이 방법은 외부빛의 영 향에 민감하며 운전수에 따라 성능이 차이나는 결함이 있다. 최근 많은 론문들에서는 운전수의 피로상태를 판정하기 위하여 PERCLOS(the percentage of eye closure)를 리용하고있는데 여기서 중요한것은 홍채를 정확히 검출하는것과 함께 눈 의 상태를 결정하는 즉 닫긴 상태인가, 열린 상태인가를 판정하는 턱값을 안정하게 계산하 는것이다. 선행연구[3]에서는 항상 일정한 턱값에 의하여 PERCLOS를 계산함으로써 운전수에 따 라 성능이 안정하지 못한 결함을 가지고있다. 론문에서는 근적외선얼굴화상에 대하여 얼굴인식과 자동턱값결정방법에 기초하여 PERCLOS를 안정하게 계산함으로써 외부빛과 운전수의 개별적특성에 안정한 운전수피로 검출방법에 대하여 고찰한다. １．얼 굴 인 식 얼굴인식은 크게 얼굴검출 및 눈검출, 특징추출, 대조부분으로 나누인다. 먼저 하르특징에 기초한 Adaboost를 리용하여 얼굴검출을 진행한다.  다음으로 선형판별특징과 지지벡토르기계에 의한 방법을 리용하여 검출된 얼굴령역에 서 눈의 위치를 계산한다. 우의 검출결과를 리용하여 두눈의 위치를 (50, 50), (100, 50)으로 하고 크기는 150× 150 12× 개 으로 얼굴화상을 표준화한다. 그 화상에 대하여 국부히스토그람동등화를 진행하고 12 의 고정된 표본점에서 5개의 주파수와 16개 방향에 대하여 2차원가보르웨블레트곁수를 계 산한다. 점 에서 가보르곁수계산공식은 y ( ) , x 0 0 Coef , θ ( x 0 , f y 0 ) = ,( GyxI ) , θ ( x 0 f − , yx 0 − y ) dxdy ∫ － 22 － 종합대학학보(수학)   주체107(2018)년  제64권  제1호 여기서 가보르핵함수는 G f , θ ( x 1 , x 2 ) = ⋅ exp( ( xi 1 cos θ + x sin ) θ f ) − 2 1 2 2 πσ ⎛ ⎜ exp ⎜ ⎝ − 2 ) ( 2 x 1 2( + x 2 σ 2 ) ⎞ ⎟ ⎟ ⎠ ⎛ ⎜ ⎜ ⎝ ⎛ − ⎜ exp − ⎜ ⎝ f 2 2 σ 2 ⎞ ⎟ ⎟ ⎠ ⎞ ⎟ ⎟ ⎠ yx 는 화상에서 점의 자리표, θ는 가보르핵함수의 방향, f 는 주파수, σ 는 분산 ,( 이고 이며 σ 와 f 사이에는 다음의 관계가 성립한다. ) 이때 tW 는 가보르핵함수의 창문크기이다.  매 표본점에서 계산된 80개의 가보르웨블레트곁수를 리용하여 80차원의 정규화된 크 기벡토르 Wt = 2 ≈ σ 2 π f vec = ( 2 1 , v 1 v + v 2 2 , 2 + , L + L v ) 80 2/12 ) v 80 ( v 을 계산한다. 여기서 kv | = Coef k (| k = ,2,1 L )80, 이다. 얼굴대조는 두 화상의 대응하는 12 × 개의 매 표본점쌍에서 80차원의 정규화된 벡토 르사이의 상관거리를 계산한다. 그 류사도가 일정한 턱값보다 크면 두 얼굴은 같은 얼굴이 라고 결정한다. 12 ２．PERCLOS계산 및 피로상태판정 우의 얼굴검출알고리듬에서 계산된 각각의 눈을 중심으로 하는 360× 크기의 화 상 2개를 결정하고 그 매개 화상에서 경계화상을 계산한 다음 하프변환을 리용하여 홍채 와 우, 아래눈까풀을 검출한다. 240 검출된 홍채와 눈까풀경계정보를 리용하여 PERCLOS를 계산하고 피로상태를 판정 먼저 홍채경계와 우, 아래 눈까풀에 의하여 둘러막힌 령역의 전체 홍채령역에서의 백 한다. 분률을 계산한다. ∫∫ dxdy 1 D R π 2 iris P = ⋅ 100 Perclos n 0= tn 여기서 D 는 홍채와 우, 아래눈까풀에 의하여 둘러막힌 령역이다. 매 프레임에 대하여 pTh 는 얼굴인식결과에 따라 이미 등록된 운전수 에 대해서는 그의 턱값을, 등록되지 않은 운전수에 대해서는 자동턱값결정방법에 의하여 결 정된다.)이면 그 프레임은 열린 눈이라고 판정하고 일정한 시간안에 열린 눈의 프레임수 ) ( 0n (여기서 pTh P > 의 백분률을 계산한다. 계산된 PERCLOS가 일정한 턱값 )( 1t 보다 작으면 피로상태, 턱값 ( 2t 보다 작으면 졸 ) 얼굴인식과 자동턱값결정방법에 기초한 안정한 운전수피로검출방법 － 23 － 음상태로 판정한다. 실험에서 1t 과 2t 는 0.4, 0.3으로 설정하였다. PERCLOS를 계산하기 위한 자동턱값결정방법은 다음과 같다. 운전수가 피로하지 않은 정상상태의 N 개의 프레임에 대하여 우에서 제기한 방법대로 ( PPP 1 3 ,2 , , , L P N ), P ∈i ,0[ ]100 을 계산하고 그것의 히스토그람 hist 를 계산한다. K 0 = min ,1 100 = k ⎧ ⎪ k ⎨ ⎪⎩ | 100 ∑ ki = hist CNi )( ⋅< 1 ⎫ ⎪ ⎬ ⎪⎭ ThD 이때 = 실험에서는 0 CK ⋅ C = 1 2 ,2.0 C 2 = 25.0 로 설정하였다. 로 감긴 눈을 판정하는 턱값을 결정한다. ３．알고리듬의 구체적인 실현과 실험결과 우에서 제기한 얼굴검출 및 눈검출방법에 의하여 얼굴령역과 눈의 중심을 결정한다.  360× 크기의 눈주위화상을 결정하고 그 매개 눈 그다음 검출된 2개의 눈에 대하여 240 화상에서 홍채의 경계와 눈까풀경계를 검출한다. 계산된 홍채경계와 눈까풀경계에 의하여 둘 러막힌 령역의 전체 홍채령역에서의 백분률을 계산하고 두눈에 대하여 평균값을 계산한다. 매개 프레임에서 우의 백분률을 계산하고 일정한 시간내에서 PERCLOS를 계산한다. 실험 에서는 PERCLOS를 계산하기 위한 시간간격을 10s로 설정하였다.(1s당 15개 프레임 즉 150 개의 프레임을 리용하였다.) 여기서 PERCLOS를 계산할 때 얼굴인식을 진행하여 등록자(이 미 등록된 운전수)이면 그 등록자에 해당한 턱값을, 등록자가 아니면 자동턱값결정방법에 의 하여 계산된 턱값을 리용한다. 이때 새로운 등록자의 얼굴특징정보에 결정된 턱값을 첨부 하여 새로운 등록자를 보관한다. 실험에서 자동턱값결정에 리용되는 프레임수는 약 5min동안 들어오는 프레임수로 하 였다. 실험에서는 프로그람시작 7min후 얼굴인식을 진행하고 그 결과에 따라 PERCLOS계 산을 안정하게 진행하게 하였다. PERCLOS가 0.4보다 작으면 현재 운전수는 피로한 상태 로 보고 황색경보, 0.3보다 작으면 졸음상태로 적색경보를 보내준다. 실험은 각이한 조명조건밑에서 서로 다른 크기의 눈을 가진 사람 20명에 대하여 손전 화촬영기를 리용하여 만든 자료기지에서 진행하였다. 실험결과는 론문에서 제기한 방법이 선 행한 방법들보다 외부빛이나 운전수의 개별적인 특성에 안정하다는것을 보여준다. 방법 방법 1(선행연구[1]) 방법 2(선행연구[3]) 제기한 방법 정확도/ % 81.85% 93.26% 98.63% 참 고 문 헌 [1] P. Avinash et al.; International Journal of Engineering Science and Computing, 6, 9, 2481, 2016. [2] S. Arun et al.; Review, Sensors, 12, 16937, 2012. [3] 刘志强 等.; 重庆理工大学学报, 10, 11, 2016. 주체106(2017)년 8월 10일 원고접수 － 24 － 종합대학학보(수학)   주체107(2018)년  제64권  제1호 A Robust Driver Fatigue Detection Method based on the Face  Recognition and the Adapted Threshold Determining Method Ri Jong Hwan, Won Yong Jun In this paper, we propose a driver fatigue detection method that can detect fatigue states robust to environmental influences and individual characteristics of drivers by calculating PERCLOS based on the face recognition and the adapted threshold determining method. Key words: pattern recognition, face recognition, fatigue detection