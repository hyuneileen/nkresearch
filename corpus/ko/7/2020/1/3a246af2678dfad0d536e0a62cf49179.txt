김일성종합대학학보 수 학 주체109(2020)년 제66권 제1호 개선된 거리기준을 리용한 화상손상회복의 한가지 방법 김일철, 김철훈 화상손상회복은 수자식효과, 화상복원, 화상부호화와 전송 등에서 광범히 응용되고있 는것으로 하여 많은 연구가 진행되고있다. 선형결합으로 추정하는 방법을 제안하였다. 선행연구[1]에서는 목적블로크를 국부블로크일치성제한밑에서 후보블로크들의 성김 선행연구[2]에서는 결과화상의 인위적인 효과를 검출하기 위한 깨진마당정의에서 1 개의 화소를 복원하는데 리용된 두 블로크사이의 거리를 비례곁수로 리용하여 정확도를 높였다. 론문에서는 목적블로크의 후보블로크들을 얻기 위하여 무게를 고려한 블로크들사이 의 거리를 새롭게 제기하고 그에 기초하여 블로크성김표현을 리용한 화상손상회복방법을 제안하였으며 계산실험을 통한 성능평가를 진행하였다. 먼저 개선된 거리기준을 리용한 화상손상회복알고리듬에 대하여 론의하자. 화상 I 에서 복원하려는 령역을 Ω 라고 하고 화소 p 에 중심을 둔 블로크를 pψ 로 표시한다. ( pN 를 ) pψ 의 크기보다 크게 설정된 p 에 중심을 둔 창문이라고 하고 pψ 의 원천 창문을 pN ( s {) = p j : p j ∈ pN ( ), ψ jp } Ω⊂ 로 정의한다. 목적블로크를 주변령역과 잘 일치되게 회복하자면 후보블로크들을 목적블로크로부터 가까운것으로 선택해야 한다. 이러한 관점에 기초하여 SSD거리에 따르는 블로크류사도에 중심점들사이의 거리에 따르는 무게를 결합하여 블로크성김표현을 리용한 화상손상회복방법을 갱신할수 있다. ∑ , ( ψψ q p +− qp ψ q )( v SSD ||) − = d v ( ) 2 || ψ p )) I Ω− v ∩ψ ( ∈ p ( 여기서 N { 1} =ψ qq 은 자리표 v 에서의 pψ 의 화소값이다. 중심점들사이의 유클리드거리 k 에 대한 무게함수는 α 를 5 000, 10 000, 15 000, 20 000로 놓고 여러 화상들에서 실험을 진행한 결과 이다. kW )( 2 −= exp( − 2 αk / ) 10=α 000 인 경우에 결과가 제일 좋았다. 후보블로크들을 얻기 위한 블로크들사이의 거리를 무게를 결합하여 d new = kWd )( SSD 와 같이 새롭게 정의한다. 새로운 거리기준으로 원천령역에서 목적블로크와 류사도가 가장 큰 N 개의 후보블 N 들의 1차결합으로 근사된다. 다시말하여  { 1} =ψ qq 을 얻는다. pψ 는 N { 1} =ψ qq 로크들의 모임 ˆ ψ p = N ∑ ψα q q 1 = q 다음 pψ 의 결여된 화소들은 pψˆ 의 대응되는 화소들로 채워진다. 개선된 거리기준을 리용한 화상손상회복의 한가지 방법 － 57 － pψˆ 의 결합곁수들 (cid:71) ,{ ααα 1 2 = , (cid:34) , Nα } 은 국부블로크일치성제한[1]을 만족시키면서 0l －노름이 최소화되도록 하기 위하여 다음의 최량화문제의 풀이로 귀착된다. min{|| (cid:71) }|| 0α , ˆ pD ψψη T || = − 2|| < ε 1α  = i (1) N , ∑ i 1 = p = D 여기서 ⎤ ⎥ ⎥ ⎥ ⎦ 설정한다. p 는 pψ 에서 알려진 화소들을 추출하는 행렬, P 는 pψ 에서 결여된 화소들을 이고 β 는 균형을 맞추는 상수로서 0.25로 ψω , pp p ( ) p ψ p ∑ pNp ⎡ ⎢ ⎢ ⎢ ⎣ ψ T ⎡ ⎢ ⎣ ⎤ ⎥ ⎦ β β = p p ∈ , s j j j 추출하는 행렬이다. ω = exp( − pd ( , pp j 2 σψψ /) p , p p j /) pZ ( ) 은 블로크류사도이다. d 는 평균 두제곱거리이고 = 1 이 되게 하는 표준화상수이며 σ 는 5로 설정한다. ( pZ 는 ∑ ) ω pp , ) ( pNp ∈ j j s 최량화문제 (1)을 풀기 위해 탐욕법을 리용한다.  후보블로크들의 모임 { = ψ Q N 1} qq = 에서 비령원소들을 점차적으로 1개씩 선택한다. m 번째 단계에서 m 개의 비령후보블로크들을 선택하였다고 하면 즉 이라고 하면 이 단계에서 성김표현은 mS = , { ψψ q q 1 2 , (cid:34) , ψ } mq m ˆ ψ p = ψα i iq m ∑ i 1 = (2) 다음단계인 1+mqψ 을 선택한다. 국부블로크일치성이 제일 좋은 블로크가 새로운 비령원소로 선택된다. 즉 1+m 단계에서 남은 후보블로크 mSQ − 들에서 새로운 후보블로크 { ψ q m 1 + } = ({min m SQ −∈ ψψη q q 1 , 2 ψ , (cid:34) , , ψψ m q )} = min SQ −∈ ψ m ψψαψα m T − + 1 + i q i ⎧ ⎪ ⎨ ⎪ ⎩ D ⎛ ⎜ ⎜ ⎝ m ∑ i 1 = ⎞ ⎟ ⎟ ⎠ 2 ⎫ ⎪ ⎬ ⎪ ⎭ 매 후보블로크 mSQ −∈ψ 에 대하여 식 (2)의 결합곁수들은 다음의 최량화로부터 구 해진다. min (cid:71) α ⎧ ⎪ ⎨ ⎪ ⎩ D ⎛ ⎜ ⎜ ⎝ m ∑ i 1 = ψψαψα m T − + 1 + i q i α i = 1 ⎞ ⎟ ⎟ ⎠ 2 ⎫ ⎪ , ⎬ ⎪ ⎭ m ∑ i 1 = 그람행렬을 G = T 1 T () T 1 − X ( ψ T 들로 이루어진 행렬이고 1은 단위렬벡토르이다. 로 정의한다. 여기서 X 는 렬벡토르 ψ T X − ) 1qDψ  { , D ψ , D ψ q (cid:34) , 2 다음의 식으로 근사풀이를 구한다. } ψ D mq , G T 1 국부블로크일치성제한이 만족되거나 η 가 증가할 때까지 매 단계에서 블로크선택절 (3) G = (cid:71) α 1 − 1 1 − 1 차를 반복한다. 이상의 알고리듬을 종합하면 다음과 같다. － 58 － 종합대학학보 수학 주체109(2020)년 제66권 제1호 ① 원천지역에서 블로크류사성척도 newd 를 리용하여 목적블로크 pψ 와 가장 류사한 N 개의 후보블로크들의 모임 Q { = ψ N 1} qq = 을 찾는다. mS , = = m ,0 ε ② ∅= | ψ p ③ 다음의 과정을 반복한다. m 매 후보블로크 20 × | 로 설정한다. (cid:71) 1차결합곁수 α m SQ −∈+1ψ 를 계산한 다음 에 대하여 식 (3)을 리용하여 블로크모임 mS ψ∪ { 1+m 을 선택하며 η가 감소하면 m m SQ −∈+1ψ 증가하면 반복과정에서 탈퇴하고 다음단계로 넘어간다. ψ∪ { = S S mq 1 + 에 대하여 식 (1)의 η가 최소로 되는 블로크 } m 1 + m }, mm = + ;1 εη< 이거나 η가 mS ψ∪ { } 의 1+m ④ pψ 의 결여된 령역을 성김1차결합 ∑ i iq ψα 에 대응되는 화소들로 복원한다. m i 1 = 론문에서 제기한 방법의 효과성을 검증하기 위하여 5개의 실험화상들에 대하여 론문 에서 제기한 방법과 선행연구[1]에서 제기한 방법의 결과를 비교하였다. 5개 화상에 대하여 계산공식 1 XY 1 i = 화상과의 평균두제곱오차를 계산한다. 여기서 MSE = X Y ∑∑ ( I i , j − O i , 2 ) j 1 = iI , 는 원화상의 i 화소의 밝기값, X 는 화상의 높이값, Y 는 화상의 너비값이다. ,( 화소의 밝기값, i ,( ) ) j j j j 에 따라 원화상과 회복된 iO , 는 복원된 화상의 j 신호 대 잡음비를 공식 PSNR = 10 log 에 따라 계산한다. 255 255 × MSE 10 화상 피라미드 Barbara의 부분 1 Barbara의 부분 2 Barbara의 부분 3 House 표．계산결과 선행방법[1] 론문의 방법 39.505 1 34.792 9 40.586 2 44.774 9 43.969 6 47.331 9 39.690 8 43.616 4 46.930 0 51.575 7 계산결과는 표와 같다. 표에서 보는바와 같이 5개의 화상들에 대하여 론문에서 제기한 방법은 선행연구[1]의 방법보다 원 화상에 더 류사한 결과를 얻었다. 참 고 문 헌 [1] Z. Xu et al.; IEEE Trans. Image Process, 19, 5, 1153, 2010. [2] P. Buyssens et al.; IEEE Trans. Image Process, 24, 6, 1809, 2015. A Method for Image Inpainting Using Improved Distance Metric 주체108(2019)년 9월 15일 원고접수 Kim Il Chol, Kim Chol Hun In this paper, we propose an image inpainting method using the patch sparse representation with an improved distance metric by combination weight. Keywords: patch sparse representation, image inpainting