김일성종합대학학보 수 학 주체109(2020)년 제66권 제4호 서술자와 국부구조에 기초한 특징점대조를 위한 한가지 반복알고리듬 박광호, 리철균 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《최신과학기술에 기초하여 나라의 경제를 현대화, 정보화하기 위한 투쟁을 힘있게 벌려야 합니다.》(《선집》 증보판 제22권 22페지) 론문에서는 화상대조, 대상검출, 대상추적, 화상결합 등 여러 화상처리 및 인식분야 에서 널리 리용되고있는 화상에서의 특징점대조방법에 대하여 연구하였다. 화상대조를 비롯한 화상처리응용들에서는 특징점에 기초한 방법들을 많이 리용하고 있다. 이 방법들은 화상의 척도변환, 회전 및 위치변환, 비선형이지러짐, 일부분의 오손 및 가리워짐 등의 영향에 안정한 우점을 가지고있으며 일반적으로 특징점검출, 특징점서술 자구성, 특징점대조의 3개의 단계로 실행된다. 특징점검출 및 특징점서술자구성의 대표적 인 방법은 척도불변특징변환(SIFT)방법과 고속안정특징(SURF)방법[4, 5]이다. 화상의 특징점대조를 위한 많은 방법들이 연구되였는데 특징점의 국부근방에서 특징 점들사이의 호상관계를 특징으로 하여 대조를 진행하는 국부성보존대조방법들은 비선형 이지러짐에 안정한것으로 알려져있다. 선행연구[1, 2]에서는 국부성을 보존하는 특징점대조방법들을 제기하였으며 선행연구 [3]에서는 특징점대조를 위한 그라프대조방법을 제기하였다. 그러나 선행연구[1, 2]에서 리용하는 국부구조는 매 특징점의 최근방에로의 소속관계 로서 이것은 특징점모임에 대응하지 않는 특징점이 많은 경우에 대조성능이 낮아지며 선 행연구[3]에서 제기한 그라프대조알고리듬은 속도가 느린 부족점을 가지고있다. 론문에서는 SURF특징점모임의 대조를 위하여 특징점서술자와 국부구조를 반영하는 한가지 고속반복알고리듬을 제기하고 실험을 통하여 그 효과성을 검증하였다. SURF방법에 의하여 검출된 매 특징점들에는 특징점의 위치, 방향, 척도 그리고 서술 자정보가 대응된다. 론문에서는 대조하려는 2개의 화상으로부터 각각 얻어진 다음과 같 은 2개의 특징모임이 주어져있다고 가정한다. x i y j x θ i y θ j (1) x i y j PX PY F x (cid:34) (cid:34) Y ( M M |) |) ,1 ,1 F X = = = = = = } { { } v v s s ( j i , , , , , , , , y y x j i i j 여기서 는 각각 두 화상에서 얻은 특징점들의 자리표이며 R∈y x , i θθ j 2 는 특징점 R∈v y j n 은 특징점서술자벡토르를 표시한다. x MM , y 는 2 i YX , R∈j x s , i 들의 방향, R∈y x v , j i 특징모임에서 특징점의 개수이다. 는 척도, s 론문에서는 두 서술자들사이의 거리가 어떤 턱값보다 작으면 두 특징의 쌍을 후보대응 쌍으로 놓고 이 쌍을 후보대응쌍모임에 넣는다. 즉 || v x i − v y j 2|| < th 1 이면 쌍 ( PX i PY , j ) 를 후보대응쌍모임에 넣는다. 결과 얻어지는 후보대응쌍모임은 다음과 같이 표시할수 있다. － 76 － 종합대학학보 수학 주체109(2020)년 제66권 제4호 x i 두 대응쌍이 량립된다는것은 두 대응쌍이 거의 같은 변환에 의하여 대응된다는것을 (cid:34)= ,1 , P { k (2) PX th 1 PY )} |) N C < − = = v v y j k || || ( ( 2 , i j 의미한다.  P = i ( PX 이다. , i PY i ) 와 P = j ( PX , j PY ) 가 2개의 대응쌍이라고 하자. 여기서 j s PX i = ( X , m PX = Y ( ′ m , j x θ m x θ m , , ′ , x m x m , ′ s v x m x m v ,) PY i = ( y , n y θ n , s y n , v y n ) ), ′ PY j = ( y , n ′ y θ ′ n , s y ′ n , v y ′ n ) 두 대응쌍사이의 량립성을 평가하기 위하여 그림에서 보여준 량들을 계산한다. 그림. 두 대응쌍사이의 량립성을 평가하기 위하여 리용되는 특징량들 그림에서 1α 은 벡토르 i XX 와 특징점 iX 에 대응하는 방향 x j iθ 사이의 각이고 1L 은 특징점 iX 와 두 각 1, αα 2 jX 사이의 거리이다. 사이의 거리는 다음과 같이 계산된다. d d ) = , ( αα 2 1 ( παα 2 ) 1 , ⇒> d 1 ( , αα 2 1 mod(| )2|, παα 2 − ) = 2 ( ααπ 2 − d 1 , ) (3) 1, ββ 2 두 각 두 대응쌍사이의 량립성은 대응하는 특징점들사이의 척도비와 길이, 그사이의 각들 도 같은 방법으로 계산한다. 사이의 거리 1 ββd , 2 ) ( 을 리용하여 정의한 다음의 거리에 의하여 평가한다. d com : = ααλ 2 d (( 1 1 , ) + d , ( ββ 2 1 )) + + λ 2 (| LL / 2 1 − ( s x i / s y i + s x j / s y j |2/) + | LL / 1 2 − ( s y i / s x i + s y j / s x j |)2/) + (4) + λ 3 |( s x i / s y i − s x j / s y j | + | s y i / s x i − s y j / s x j )| 이 거리가 작으면 작을수록 두 대응쌍사이의 량립성이 보다 좋다는것을 의미한다. 다시말하여 두 대응쌍의 량립성은 그 두 대응쌍들이 모두 정확한 대응쌍으로 될수 있는 정도를 나타낸다. 후보대응쌍모임의 매 대응쌍에 대하여 대응쌍을 구성하는 매 특징점들의 국부근방들 사이의 류사성을 평가하여 그 대응쌍이 실지 정확한 대응쌍으로 될 가능성을 평가하고 그 가능성이 높은 대응쌍들을 모아서 초기대응쌍모임을 구성한다. 주어진 대응쌍들의 모임이 식 (2)와 같이 표시되고 이제 국부구조의 대조를 진행하 서술자와 국부구조에 기초한 특징점대조를 위한 한가지 반복알고리듬 － 77 － x i y i 여야 할 대응쌍이 ( PX i PY , i ) 라고 하자. x i y i 첫번째 화상과 두번째 화상에서 특징점 iX 와 iY 의 근방을 다음과 같이 정의한다. || < Con {: = R ∈ N X X X < − } || s s 2 ⋅ ⋅ | Con 1 i (5) 웃식에서 Con N 1, Con 2 2 R {: Y || } ∈= < 는 근방의 크기를 결정하는 상수들이다. Con 1 Con Y i Y − < || s s 2 ⋅ ⋅ | 먼저 후보대응쌍모임에서 대응쌍의 첫번째 특징점이 근방 쌍들(그 개수를 xT 라고 표시)과 대응쌍 산하고 이 거리가 턱값 com 후보대응쌍모임에서 대응쌍의 두번째 특징점이 근방 ( th 보다 작은 대응쌍의 개수를 i PY , i PX ) y x iN 에 속하는 모든 대응 사이의 량립성을 평가하는 거리를 계 xN 라고 표시하자. 마찬가지로 iN 에 속하는 모든 대응쌍들에 대 x i 2 y i 하여 우와 같은 조작을 진행하여 그 개수를 각각 y NT , 라고 하자. y 최종적으로 대응쌍 ( PX i PY , i ) 에 대한 국부구조의 류사도는 다음과 같이 계산된다. ( TN / x x TN / y y ) + 2 Sim L = Loc ⋅ 100 (6) 우의 국부구조류사도가 턱값 th 보다 같거나 크면 이 대응쌍은 정확한 대응쌍일 가능성이 높다고 보고 초기대응쌍모임에 포함시킨다. 우에서 구성한 후보대응쌍모임에서 정확한 대응쌍의 모임을 얻어내야 한다. 얻어진 정확한 대응쌍들의 모임은 다음의 성질들을 만족시켜야 한다. 첫째로, 정확한 대응쌍모임의 매 대응쌍에 대하여 두 특징점에 대응하는 서술자들은 서로 류사하다. 둘째로, 정확한 대응쌍들을 될수록 많이 포함하여야 한다. 셋째로, 정확한 대응쌍들의 모임의 임의의 2개의 대응쌍은 높은 량립성을 가져야 한 다. 다시말하여 그것들사이의 량립성을 표현하는 거리 comd 은 될수록 작아야 한다. 정확한 대응쌍들의 모임을 표시하기 위하여 론문에서는 성분들이 0과 1값을 가지는 을 리용한다. ip 의 값이 1이면 i 번째 후보대응쌍은 Np (cid:34) p 1 ) 2 , , N 차원벡토르 p 정확한 대응쌍으로 된다. P = ( , i 번째 대응쌍의 두 특징점에 대응하는 서술자벡토르들사이의 거리를 id 로, i 번째 후보대응쌍과 j 번째 후보대응쌍사이의 량립성을 표현하는 거리를 ijd 로 표시하자. 정의 식 (4)로부터 d = 라는것을 알수 있다. d ij ji 그러면 정확한 대응쌍을 구하는 문제를 다음과 같은 최량화문제로 정식화할수 있다. arg min P ( Pf ) N ⎛ ⎜ = ∑ ⎜ ⎝ 1 = i ⎛ ⎜ λ ⎜ ⎝ N ∑ i 1 = ⎞ ⎟ ⎟ ⎠ N N ∑∑ i 1 = j 1 = dp i i + N − p i + dpp j i ij (7) ⎞ ⎟ ⎟ ⎠ 여기서 }1,0{∈ip 이다. 문제 (7)은 조합최량화문제로서 풀이를 구하기 어려우므로 론문에서는 문제 (7)에서 풀이의 성분들이 ]1,0[∈ip 이 되도록 문제를 완화시켜 고찰한다. 이제 문제 (7)을 풀기 위한 한가지 반복도식을 유도하자. 현재 얻어진 근사풀이를 = (cid:34) Q q ) ( , , , q 1 2 Nq 이라고 하고 다음과 같은 대리함수를 정의한다. － 78 － 종합대학학보 수학 주체109(2020)년 제66권 제4호 ~ Pf ( :) = N ∑ i 1 = ⎛ ⎜ λ ⎜ ⎝ N ∑ i 1 = ⎞ ⎟ ⎟ ⎠ N N ∑∑ i 1 = j 1 = dp i i + N − p i + dpp j i ij + c ( p i − q i ) 2 − ( p i − q i () p j − ) dq j ij N N ∑∑ i 1 = j 1 = N ∑ i 1 = ijd 들을 원소로 하는 N 차행렬을 D 라고 표시하면 상수 0>c 은 − DcI 0> (8) 을 만족하 도록 정한다. 그러면 함수 ( ) ~ Pf 는 다음의 성질을 만족한다. ~ Qf ( ~ Pf ( ( Qf ( Pf P ), = ≥ ) ) ) R∈∀ 이제 다음과 같은 최량화문제를 생각하자. P =′ arg min P ~ Pf ( ) ~ Pf ( ) ~ Qf ( ) ≤ = Qf ( ) Pf ( ≤′ ) ~ Pf ( =′ ) arg min P 가 성립한다. 함수 ~ Pf 를 정돈하면 ( ) N (9) dqq j i ij = −− λ 2 cq i i + 2 dq j ij + c ~ Pf ( ) = λ cN + N N ∑ ∑∑ − 2 q i i 1 = j 1 = ⎛ ⎜ ⎜ ⎝ ⎛ ⎜ ⎜ ⎝ N i 1 = N i 1 = = λ cN + ∑ ∑∑ + 2 q i 2 dq i ij N N i 1 = j 1 = ⎞ ⎟ ⎟ ⎠ + ⎞ ⎟ ⎟ ⎠ N ∑ i 1 = ⎛ ⎜ dp i ⎜ ⎝ N ∑ i 1 = ⎛ ⎜ ⎜⎜ ⎝ ⎛ ⎜ dp i ⎜ ⎝ N ∑ j 1 = N ∑ j 1 = −− λ 2 cq i i + 2 dq j ij + 2 cp i 이다. 우의 식에서 첫항은 상수항이므로 최량화문제의 풀이에 영향을 주지 않는다. 두번 째 항은 변수들이 완전히 분리되여있으므로 자리표별로 최량화문제를 풀어서 전체 최량 화문제의 풀이를 구할수 있다. 다음의 최량화문제를 보자. p =′ i arg min p i ⎛ ⎜ ⎜⎜ ⎝ ⎛ ⎜ dp i ⎜ ⎝ i −− λ 2 cq + 2 i dq j ij + cp 2 i (13) N ∑ j 1 = ⎞ ⎟ ⎟ ⎠ ⎞ ⎟ ⎟⎟ ⎠ 우의 최량화문제는 2차함수의 최량화문제이므로 정류점을 구하는 방식으로 쉽게 구 할수 있다. λ − d i − 2 dq j ij N ∑ j 1 = 2 c =′ p i q i + (14) 우의 론의로부터 론문에서는 특징점대조를 위한 다음과 같은 알고리듬을 제기한다. ① 두 특징점모임으로부터 특징점서술자들을 리용하여 후보대응쌍모임을 구성한다. ② 매 2개의 후보대응쌍들에 대하여 량립성을 표현하는 거리 comd 을 계산한다. ③ 특징점들의 국부구조의 대조를 리용하여 초기대응쌍모임을 구성한다. ④ 반복알고리듬의 초기화를 진행한다. i 번째 후보대응쌍이 초기대응쌍모임에 속하 ip 들을 원소로 하는 N 차원벡토르를 0P 이라 10 =ip 이 아니면 으로 놓는다. 이 0 00 =ip 면 ⎞ ⎟ ⎟ ⎠ ⎞ ⎟ ⎟ ⎠ (10) (11) N ∑ i 1 = 2 p i = ⎞ ⎟ ⎟⎟ ⎠ (12) 서술자와 국부구조에 기초한 특징점대조를 위한 한가지 반복알고리듬 － 79 － 고 놓는다. 반복회수 k 를 설정한다. ⑤ 다음의 계산을 k 회 반복한다. N ∑ j 1 = c 2 λ − d i − 2 k dp i ij 1 + k p i = k p i + 1 + 1 + k p i k p i 0 ⇒< 1 ⇒> = 0 1 + k p i k 1 + p i = 1 1 + 0 ⇒< 1 + = 0 p p k i k i k 1 + 1 ⇒> 1 ≤+ ) k p i k 1 + p i k = 1 i ( = ,1 (cid:34) , N ) (15) 우의 반복과정이 끝나면 이때 얻어지는 벡토르에서 그 성분의 턱값 2th 보다 큰 성분 에 대응하는 대응쌍들을 정확한 대응쌍으로 놓는다. 식 (15)에서 이 없다면 앞에서의 론의로부터 라는것이 나온다.  1 ≤+ k k 아래에서는 식 (15)에 의하여 계산하여도 ) 이를 위하여 다음과 같은 보조함수를 정의하자. Pf ( Pf ( Pf ( Pf ( ) ) 이 성립한다는것을 보여준다. ~ Pf ( 2 ) = N ∑ i 1 = ⎛ ⎜ λ ⎜ ⎝ N ∑ i 1 = ⎞ ⎟ ⎟ ⎠ N N ∑∑ i 1 = j 1 = N ∑ i 1 = dp i i + N − p i + dpp j i ij + ( pc i i − q i ) 2 − ( p i − q i () p j − ) dq j ij N N ∑∑ i 1 = j 1 = ci ≥ 를 만족시키는 상수들이며 벡토르 c qQ ( = 1 , q 2 , (cid:34) , Nq ) (16) 은 어떤 고정 여기서 ic 들은 된 벡토르이다. 이때 다음의 결과가 성립한다. 보조정리 최량화문제 P =′ arg min P ~ 2 Pf ( ) (17) 의 풀이 P′ 에 대하여 Pf ( ≤′ ) Qf ( ) 가 성립한다. 정리 반복도식 (15)에 의하여 계산된 벡토르렬 { kP 에 대하여 } Pf ( k 1 ≤+ ) k Pf ( () k = ,1,0 (cid:34) , K − )1 (18) 가 성립한다. 론문에서는 특징점대조성능을 평가하였다. 이를 위하여 우리는 물체들을 정면에서 찍은 표준화상과 여러 각도에서 찍은 검사화 상들로 이루어진 3개의 자료기지를 리용하였는데 자료기지 1은 화상이 선명한 일반자료 기지이며 자료기지 2는 1에서보다 화상이 선명하지 못하여 특징점모임선택에서 대응하지 않는 특징점쌍이 많이 나타나지 않는 자료기지이고 자료기지 3은 특징점쌍이 보다 많은 자료기지이다. 론문에서 제기한 방법의 효과성을 평가하기 위하여 선행연구[1, 2]에서 리용하는 국 부구조를 리용한 방법(1), 선행연구[3]에서 제기한 그라프대조알고리듬을 리용한 방법(2),  론문에서 제기한 방법을 비교하였다.(표) 그리고 성능은 정확도, 재생정도, 시간의 세가지 기준으로 평가하였다. 여기서 정확 － 80 － 종합대학학보 수학 주체109(2020)년 제66권 제4호 도는 검출에서 정확한 대응개수/선택한 대응개수이며 재생정도는 정확한 대응개수/후보 모임에서의 정확한 대응개수이다. 파라메터조절에서 정확도를 올리면 재생정도가 떨어지 게 되여있으며 성능은 정확도와 재생정도가 동시에 개선되여야 한다. 자료기지 자료기지 1 자료기지 2 자료기지 3 표. 계산결과 방법 1 방 법 방법 2 론문의 방법 (95.89, 98.59, 9.1ms) (90.23, 75.59, 8.7ms) (96.34, 99.07, 50ms) (96.26, 97.11, 1 357ms) (92.8, 90.12, 1 129ms) (99.2, 92.95, 30s) (96.75, 99.23, 10ms) (95.83, 98.01, 9.3ms) (99.3, 99.21, 34ms) 표에서 볼수 있는바와 같이 론문에서의 방법은 다른 방법들보다 성능이 일반적으로 개선되였다. 특히 초기특징점대응이 선명하지 않은 자료기지에서 성능이 크게 개선되였으 며 초기특징점들이 매우 많이 선택되는 자료기지 3에서도 시간이 크게 갱신되였다. [1] Jiayi Ma et al.; Locality Preserving Matching, IJCAI, 4492～4498, 2017. 참 고 문 헌 [2] Yefeng Zheng et al.; IEEE Transactions on Pattern Analysis and Machine Intelligence, 28, 4, 643, [3] Lorenzo Torresani et al.; Feature Correspondence via Graph Matching:Models and Global Optimization, 2006. ECCV, 596～609, 2008. [4] Edouard Oyallon, Julien Rabin; Image Processing On Line, 5, 176, 2015. [5] I. Rey Otero, M. Delbracio; Image Processing On Line, 4, 370, 2014. 주체109(2020)년 6월 5일 원고접수 An Iterative Algorithm for Matching Key-points Based on Descriptor and Local Structure Pak Kwang Ho, Ri Chol Gyun In this paper, we proposed a new iterative algorithm for key-point matching based on descriptor and local structure and showed its effectiveness through experiments. We also proved that this iterative algorithm converges to the local minimum solution. Keywords: image matching, key-point