김일성종합대학학보 수 학 주체109(2020)년 제66권 제4호 비선형비부값스펙트르무리짓기에서 핵함수의 한가지 구성방법 김진성, 강성혁 우리는 자료처리에서 많이 리용되고있는 비부값스펙트르무리짓기에 대하여 연구하였다. 선행연구[1－3]에서는 비부값행렬분해의 목적함수에 정규화항을 추가하는 방법으로 무리짓기의 성능을 개선하였으며 선행연구[4]에서는 핵에 기초한 방법으로 선형비부값스 펙트르무리짓기를 비선형인 경우로 확장하였다. 그러나 이 방법들에서는 류사도행렬을 표본벡토르들사이의 내적에 의해 정의하거나 또는 핵에 의해 일반화하여 정의하는 경우 에도 어떤 핵함수를 리용해야 하는가에 대해서는 밝히지 못하였다. 론문에서는 여러개의 핵함수를 리용하여 주어진 자료에 적합한 새로운 핵함수를 구 ( = X 성하기 위한 방법과 그것을 리용한 비선형비부값스펙트르무리짓기알고리듬을 제기한다. ix R∈ 을 표본벡토르, W 를 류사도행렬 이라고 하자. 즉 ijW 는 ix 와 jx 사이의 류사도이다. 일반성을 잃지 않고 ix 의 모든 성분 들이 0 이상이며 표본들을 k 개의 무리로 가른다고 하자. 을 표본자료행렬, R) ∈ (cid:34) nx nm × x 1 x m 2 , , , D 를 ∑ D ii = W ij 인 대각선행렬로 정의한다. n j x i 1 = ) : ( Φ Φ (cid:54) x i 는 표본벡토르를 고차원특징공간으로 넘기는 넘기기로서 이라 고 하고 Φ 에 대응한 핵함수를 K 라고 하면 고차원공간에서의 표본벡토르들사이의 류사 T 도행렬은 로 정의된다. ) Φ=〉 Φ ix ( Φ〈= 0) ≥ Φ= (T W , Φ Φ Φ X X ), x x x ( ) ) ( ( ( ) ( ) ) ( , xKW = i ij j x i x i j j ( = H ||, h k 한 n 차원지시자벡토르라고 하자. h 2 h 2 h 1 h 1 ||/ ||/ (cid:34) ||, , ||/ h k ||) 를 지시자행렬, lh 을 무리 lCl ( (cid:34)= ,1 , k ) 에 대 비선형비부값스펙트르무리짓기를 위해서는 다음의 최량화문제를 풀어야 한다.[1, 4] min ,0 ≥ 여기서 H 는 RCut를 리용할 때의, Z 는 NCut를 리용할 때의 무리지시자행렬이다. min ,0 IHH = W − WD IZZ = HH ZZ D (1) , − || || H H ≥ T T − 2/1 − 2/1 2T || F 2T || F 류사도행렬 W 는 핵함수 K 의 선택에 따라 달라진다. 또한 최량화문제 (1)의 목적함 수값은 W 가 얼마나 잘 분해될수 있는가 하는것을 나타낸다고 할수 있다. 특수한 경우 목적함수값이 0 으로 되면 무리지시자행렬로부터 본래의 류사도행렬을 완전히 재구성할수 있으며 이것은 이때의 W 에 무리짓기에 필요한 자료의 특성이 모두 반영된것으로 생각할수 있다. 그러므로 최량화문제 (1)의 목적함수값이 작아질수록 핵함 수 K 가 무리짓기에 보다 효과적이라고 할수 있다. 이로부터 론문에서는 여러개의 핵함수들을 결합하여 무리짓기에 보다 효과적인 핵함 수를 구성하기 위한 방법을 제기한다. sK (cid:34) 2 , , 를 핵함수들, 그것에 대응한 류사도행렬을 KK , 1 이때 새로운 핵함수 K 를 다음과 같이 구성한다. (cid:34)2 + α s + αα 2 K 11 α 2 s K α i (cid:34) α α , K K ,1 = + + + + = ≥ 1 s WW , 1 2 , (cid:34) 라고 하자. , sW ,0 i = ,2,1 (cid:34) , s 비선형비부값스펙트르무리짓기에서 핵함수의 한가지 구성방법 － 31 － K 에 대응한 류사도행렬은 + 이처럼 류사도행렬을 결합하기 위해서는 먼저 iW 들을 표준화하여야 한다. 표시를 간단히 하기 위하여 하나의 핵함수에 의하여 얻어진 류사도행렬 iW 를 W 로 (cid:34)2 + W α 2 sW s W 11 α α W + = 로 된다. 표시하고 이것을 표준화하자. =′ WW ij ij 쉽게는 pp i / j 은 표준화를 위한 상수들이다. 형태의 표준화방법을 생각할수 있다. 여기서 p 1 , p 2 , (cid:34) , >np 0 이때 새로 얻어진 류사도행렬 W ′ 도 핵함수에 의해 얻어진 류사도행렬로 된다. p p 1 2 할수 있다. 들을 잘 선택하면 류사도행렬이 특이한 성질을 만족하도록 표준화 >np (cid:34) 0 , , , 방법 １ 또한 류사도행렬의 모든 원소들의 합이 1이 되도록 하는것은 아주 쉬우며 더우기는 으로 선택하면 대각선원소들이 1이 되게 할수 있다. Wp = ii i ≤≤ 1, n i 류사도행렬에서 행의 원소들의 합과 렬의 원소들의 합이 모두 1이 되게 할수도 있다. 이것은 다음의 정리로부터 알수 있다. 정리 W 를 대각선원소가 정수인 비부값대칭반정값행렬이라고 하자.  그러면 이 존재하여 >np 는 행의 원소들의 합이 1인 대칭반정값행렬로 된다. =′ WW ij ij (cid:34) p 1 0 p 2 , , , / pp i j 로 정의되는 새로운 행렬 W ′ W 이고 0≥k 에 대하여 kW 가 대각선원소가 정수인 비부값대칭반정값행 렬이면 d k i : = 이고 kD 는 k ii k i D = 인 대각선행렬이며 d W k 1 + = : ( D ) k − 2/1 k − 2/1 DW ( k ) 이 증명 W =:0 n k W ij ∑ j 1 = k W = ( 라고 하면 k k − − 2/1 EW ( 1+kW 도 대각선원소가 정수인 비부값대칭반정값행렬이다. 으로 표시된다는것은 분명하다. 여기서 E E . ) kW 는 대칭반정값행렬이며 k 가 증가함에 따라 행의 원소들의 합은 1로 수 가 성립되며 1 k − DD 2 (cid:34)− 2/1 D = ) 0 k k = P E k 렴하게 된다. 그리고 대각선행렬 P 와 첨수모임 T 가 있어서 그러면 lim ∈∞→ , Tk k 또한 P 의 대각선원소들을 p 1 , p 2 np , (cid:34) 이라고 하면 정리의 결론이 성립된다.(증명끝) , 방법 ２ 정리의 증명과정에서 제시한 방법대로 류사도행렬 W 를 행의 원소들의 합이 1에 충분히 가깝도록 표준화할수 있다. WW , 1 2 sW , , (cid:34) 들을 우의 방법들로 표준화한다. 류사도행렬 RCut를 리용한 스펙트르무리짓기에서는 류사도행렬의 균형을 맞추기 위하여 방법 1 로, NCut를 리용한 스펙트르무리짓기에서는 방법 2로 표준화하는데 정리의 증명과정에서 알수 있는바와 같이 이렇게 하면 표준화후에도 그전의 목적함수와 류사하다고 할수 있고 계산에도 아주 편리하다. 류사도행렬들을 표준화하고 최량화문제 (1)에 대입하면 다음과 같다. (||min α W 11 + W α 2 2 + (cid:34) + W α s s ) − HH 2T || F , T IHH = , αα + 2 1 + (cid:34) + α s = ,1 H , α ≥ 0 (||min α W 11 + W α 2 2 + (cid:34) + W α s s ) − ZZ 2T || F , T ZZ = I , αα + 2 1 + (cid:34) + α s = ,1 Z , α ≥ 0 min (cid:34) , , , αα 1 2 α Hs min (cid:34) , , , αα 1 2 여기서 α s = Z ( ααα 2 1 , , (cid:34) , sα ) 이다. 이와 같이 류사도행렬들을 표준화하면 RCut와 NCut의 최량화문제는 동일하게 된다. － 32 － 종합대학학보 수학 주체109(2020)년 제66권 제4호 (||min FYs , min (cid:34) , , , αα 1 2 이 문제를 푸는 대신 정규화파라메터 W α 2 2 W α s s W 11 YF α (cid:34) − + + + α ) || 2 F , FY = YI , T = F , α 1 + (cid:34) + α s = ,1 YF , , α ≥ 0 >γμ , 0 을 리용하여 다음의 문제를 풀자. min (cid:34) , , α s , αα 1 2 , FY , ≥ 0 (|| α W 11 + W α 2 2 + (cid:34) + W α s s ) − YF || 2 F 2/ + + ααμ 1 2 + ( + (cid:34) + α s 2 − )1 2/ + γ (|| FY − I || T + || Y − F || 2 F 2/) L , ( α FY , :) = (|| α W 11 + W α 2 2 + (cid:34) + W α s s ) − YF || 2/ + 2 F 2 F 2 F + γ 우리는 선행연구[4]에서와 류사하게 국부최소점을 구하기 위하여 다른 변수들은 고 ααμ 1 2 2/) α s FY (|| F Y − + + + + + − − || || || (cid:34) ( I T 2 F 2 2/)1 정하고 α와 Y , F 에 대하여 차례로 갱신하는 방법을 리용한다. =iη ) − + − + + + )] (cid:34) α i α s (tr[ (tr/[ WK i WK i ααμ 1 2 그라디엔트하강법을 적용하면 다음과 같이 갱신된다. (tr{[ YFK ( ηαα = i i i i 0≥iα 이 만족되도록 갱신하기 위하여 선행연구[4]에서와 류사하게 매 갱신에서 ( ααμ 1 2 (tr[ = αα i 로 설정하면 다음과 같은 갱신규칙을 얻는다. (tr/[] + μ α s ) + α s 마찬가지로 Y 와 F 에 대한 갱신규칙을 다음과 같이 얻는다. Y 2 ] γ ij T 0>iη 은 상수) (2) (3) ααμ 1 2 [ WF T F 2 γ T T WY [ YFK i WK i F ij F ij Y ij Y ij (cid:34) (cid:34) μ ( ] ij ]} , )] )] + + + + + + + + + + = = ) ( ) ) T T T i [ YFF + ( γ F FY ) + Y γ ] ij T YFY [ + ( γ FYY ) + F γ ] ij 이로부터 무리짓기를 위한 알고리듬은 다음과 같다. ① 기초핵함수로 리용할 핵함수 , ② 기초핵함수들을 리용하여 류사도행렬들을 계산하고 RCut를 리용하는 경우에는 (cid:34) 들을 선택한다. KK , 1 sK 2 , 방법 1로, NCut를 리용하는 경우에는 방법 2로 표준화한다. (cid:34) 라고 하자. WW , 1 2 를 우연적으로 초기화한다. 이렇게 얻어진 류사도행렬들을 ③ ④ 반복회수에 이를 때까지 갱신규칙 (2), (3)을 반복한다. icss 번째 무리에 소속시킨다. ⑤ 라면 ix 는 arg= FY , css i sW Y ij ,α , , max j 론문에서 제기한 핵함수구성방법의 효과성을 확인하기 위하여 핵함수를 개별적으로 리용하는 경우와 여러개의 핵함수를 우에서 제기한 방법으로 결합하여 리용하는 경우의 무리짓기성능을 비교하였다. 실험에는 Dermatology, Glass, Soybean, Vehicle, Zoo라고 부르는 5개의 UCI자료를 리용 알고리듬의 성능을 평가하기 위하여 선행 연구[4]에서와 같이 무리짓기의 정확성을 평가 자료 표본수 무리수 하는 척도 ACC (δ g , i (map c i )) n 를 리용 n ⎛ = ∑ ⎜ ⎜ ⎝ =1 i ⎞ ⎟ ⎟ ⎠ 한다.(표 1) 표 １．Dermatology, Glass, Soybean, Vehicle, Zoo자료 Dermatology Glass Soybean Vehicle Zoo 366 214 47 846 101 표본벡토르의 차원수 33 9 35 18 16 6 6 4 4 7 한다. 여기서 ic 는 무리짓기알고리듬을 적용했 을 때 표본 ix 가 속하는 무리번호, ig 는 실지 자료에서 ix 가 속하는 무리번호이다. 비선형비부값스펙트르무리짓기에서 핵함수의 한가지 구성방법 － 33 － 기초적인 핵함수로는 보통의 내적으로 정의된 핵과 가우스핵을 리용한다. 즉 2 σ 을 리용한다. xx ,( T xx exp( ′− x =′ ) =′ ) , K − x || || ) / 2 ′ ,2 σ ,( xxK 1 선행연구[4]의 결과와 비교하기 위하여 σ 는 선행연구[4]에서와 꼭같은 값으로 설정 으로 고정시키며 갱신회수는 300으로 정한다. 한다. 또한 = μ 10 = 그림에서 보는바와 같이 갱신회수가 ,100 γ 300이면 수렴성이 뚜렷이 나타난다. 무리짓기의 결과는 초기화에 의존하 므로 선행연구[4]에서와 같이 독립적으로 256번 초기화하여 ACC 를 계산하고 평균 하여 성능을 평가한다. 론문에서 제기한 핵함수구성방법으로 NCut를 리용했을 때와 RCut를 리용했을 때의 결과와 선행연구[4]의 결과를 보여 주었다.(표 2, 3) 그림. Dermatology자료로 실험할 때의 갱신회수에 L α , ( 따르는 목적함수 의 변화 FY , ) 표 ２．NCut를 리용한 경우의 결과 표 ３．RCut를 리용한 경우의 결과 자료 Dermatology Glass Soybean Vehicle Zoo 보통의 내적/% 74.7 46.3 69.1 37.6 64.7 가우스 핵/% 87.5 50.2 75.8 43.7 80.3 결합핵 /% 89.4 54.3 77.4 48.7 81.4 자료 Dermatology Glass Soybean Vehicle Zoo 보통의 내적/% 73.4 46.0 73.1 39.3 67.3 가우스 핵/% 86.2 52.8 78.5 43.1 65.8 결합핵 /% 88.7 55.9 84.7 51.4 76.9 우의 결과로부터 론문에서 제기한 핵함수구성방법을 적용하면 개별적인 핵함수를 리 용할 때보다 더 좋은 무리짓기결과를 얻는다는것을 알수 있다. 참 고 문 헌 [1] H. Zha et al.; Advances in Neural Information Processing Systems, 14, 105, 2002. [2] H. Lu et al.; Pattern Recognition, 47, 418, 2014. [3] R. Shang et al.; Pattern Recognition, 55, 172, 2016. [4] D. Tolic et al.; Pattern Recognition, 82, 40, 2018. 주체109(2020)년 6월 5일 원고접수 A New Method to Construct Kernel Function for the Nonlinear Non-negative Spectral Clustering Kim Jin Song, Kang Song Hyok We propose a constructing method of kernel function appropriate to the given data and algorithm for solving the nonlinear non-negative spectral clustering using it and verify its effectiveness by experiments. Keywords: spectral clustering, kernel function