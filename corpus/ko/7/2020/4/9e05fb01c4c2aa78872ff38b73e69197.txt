김일성종합대학학보 수 학 주체109(2020)년 제66권 제4호 잡음특성을 리용한 블로크정합－３차원려파잡음제거방법의 개선 김성준, 리광일 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《정보기술, 나노기술, 생물공학을 비롯한 핵심기초기술과 새 재료기술, 새 에네르기 기술, 우주기술, 핵기술과 같은 중심적이고 견인력이 강한 과학기술분야를 주타격방향으 로 정하고 힘을 집중하여야 합니다.》 우리는 정보기술 및 인공지능분야에서 중요한 문제로 제기되는 수자화상의 잡음제거 방법에 대한 연구를 진행하였다. 론문에서는 가법적백색가우스잡음에 의해 손상된 화상의 회복문제에 대하여 고찰하 려고 한다. 잡음으로 손상된 화상은 다음과 같이 표현된다. xz )( = xy )( η+ x )( (1) 여기서 Xx ∈ 는 화상령역 X ⊂ 에 속하는 2차원공간자리표이고 y 는 원래의 잡음이 2Z 없는 화상이며 η는 백색가우스잡음(AWGN)이다. 즉 η x ,0(N~)( 2σ ) 이다. 이미 여러가지 화상잡음제거방법[1]들이 제기되였다. 현재 화상잡음제거를 위한 연구 에서는 블로크정합과 3차원려파를 리용한 잡음제거방법(BM3D방법)이 높은 성능으로 하 여 널리 쓰이고있다.[2] 이 방법은 화상령역에서 주목하는 블로크에 대하여 그 블로크와 류사한 블로크들을 찾아 3차원구조를 만들고 그우에서 잡음제거를 진행한다. 이 방법을 갱신하기 위한 연구들이 진행되는 과정에 선행연구[4]에서 소개된 방법들을 비롯하여 여 러가지 개선방안들이 나왔는데 이 방법들의 특징은 매 단계의 중간공정 즉 3차원변환령 역에서의 줄이기공정을 갱신한다는것이다. 블로크정합과 합치기부분도 잡음제거성능에 큰 영향을 주지만 이 부분들을 개선하기 위한 연구는 많이 진행되지 못하였다. 그 효과성을 검증하였다. 우리는 정합단계와 합치기단계를 개선하기 위한 방법들을 제기하고 실험을 통하여 관측화상 z 에서 점 x 를 왼쪽웃구석점으로 하는 고정된 크기 표시하겠다. 블로크정합단계에서는 화상내에서 주목하는 블로크( 진행하여 류사한 블로크들의 왼쪽웃구석점자리표들의 모임 S 1 1 NN × 블로크를 xZ 로 RxZ 로 표시)와의 대조를 Rx ⊆ 를 확정하게 된다. X 구체적으로 RxS 는 S x R { ∈= | ZdXx ( , x R Z x ) τ< match } (2) 이다. 여기서 d 는 두 블로크사이의 거리척도이며 matchτ 는 거리 d 의 최대값이다. 선행연구[2]에서는 주목하는 블로크와 류사성을 판정하려는 블로크사이의 거리를 유 클리드거리로 정의하고 그 값이 적당한 턱값보다 작으면 류사하다고 보았다. 그러나 선행연구[3]에서 알수 있는바와 같이 유클리드거리를 리용하면 상대적으로 큰 σ와 1N 에 대하여 그룹화가 정확히 진행되지 못하게 된다. 이를 극복하기 위해서 선 행연구[2]에서는 다음과 같은 거리척도를 도입하였다. 잡음특성을 리용한 블로크정합－3차원려파잡음제거방법의 개선 － 53 － Zd ( 1 x 1 , Z x 2 ) = 1 − N 1 ⎛ τγ ⎜ 2 ⎝ ( Z D x 1 ), σλ 2 γ th D 2 log( 2 N 1 ) ( Z D x 2 ), σλ 2 γ th D 2 log( 2 N 1 ) ⎞ ⎛−⎟ τγ ⎜ 2 ⎠ ⎝ ⎞ ⎟ ⎠ 2 (3) x 1 여기서 x 2 같은 고정턱값화연산자, τ 2 ∈ X D , , D 2|| 는 2차원우니타르변환, thr 2λ 는 이때 고정된 턱값파라메터이다. | λλλ > ⎧ ⎨ 기타,0 ⎩ ,( λλγ |, thr thr = ) (4) || ⋅ 는 2L －노름이다. 또한 γ 는 다음과 기준블로크 점으로 하는 해당 블로크들을 RxZ 와 시험블로크 xZ 에 대하여 원화상에서 Rx 와 x 를 각각 왼쪽웃구석 RxY , xY 라고 표시했을 때 초기가정으로부터 다음과 같은 사실이 성립한다. Z x R − Y x R , Z − x Y x ,0(N~ 2σ ) (5) 이때 두 블로크의 해당한 원신호가 보다 류사할수록 두 관측블로크사이 차 의 분포특성은 정규분포 레이블레(KL거리)거리가 보다 작게 된다. 그러므로 두 관측블로크 x 2σ 과 보다 류사하게 되며 따라서 두 분포사이 쿨베크－ RxZ 와 xZ 사이의 거리 2,0(N Z Z − ) x R 에 다음과 같은 거리를 고려하였다. d ∫−= )(ˆ xp xp )( xp ln)( dx (6) 여기서 xp ( ), )(ˆ xp 는 각각 Z − 와 정규분포 Z x x R 2,0(N 2σ 의 확률밀도함수이다. 또한 ) )(xp 와 )(ˆ xp 를 바꾼 거리를 더하여 거리가 대칭성을 만족시키도록 하였다. d 2 −= xp ln)( ⎛ ⎜⎜ ⎝ ∫ )(ˆ xp xp )( dx + ln)(ˆ xp ∫ xp )( )(ˆ xp ⎞ ⎟⎟ ⎠ dx (7) 위해 포텐샬함수를 리용하여 이 거리를 계산하려면 블로크의 확률분포를 추정해야 하는 문제가 제기되는데 이를 2 1N 개의 표본점들로부터 확률밀도함수를 추 RxZ 와 xZ 의 해당한 원신호들이 보다 류사할수록 두 관측블로 2σ 을 따르는것과 − 로 정의되는 블로크내 화소들은 정규분포 − 내의 2,0(N 정하였다. 한편 두 블로크 크사이 차 Z Z Z Z ) x x R x R x 동시에 독립성도 만족하게 되므로 두 블로크의 차에 적당한 2차원우니타르변환을 적용하 고 그것의 엔트로피를 계산하여 그 값이 클수록 대조에서 합격될 확률이 높아지도록 하 였다. 이와 같이 거리척도 가 작을수록, 엔트로피가 클수록 블로크정합의 효과성이 보다 좋아지게 된다. d 1, d 2 다음과 같은 사실을 리용하여 합치기단계에서 3차원배렬의 매 블로크에 적응성있는 무게들이 부여되도록 하였다. 추정된 3차원배렬에서 임의의 블로크를 선택하여 xE 로 표시하자. Z − 와 정규분포 2σ 사이 KL거리가 작을수록 이 블로크에 부여되는 무게 ,0(N ) x E x 는 보다 커야 한다. x x E Z − 의 엔트로피가 클수록 이 블로크에 부여되는 무게는 상대적으로 커야 한다. 우의 해석에 기초하여 xE 에 다음과 같은 무게가 부여되도록 하였다. － 54 － 종합대학학보 수학 주체109(2020)년 제66권 제4호 n p ⎞ ⎟ ⎟ ⎠ Ent m KL 여기서 xw 는 알고리듬의 잡음제거단계에서 계산되여 합치기단계에서 개별적블로크들에 부여되는 무게, Ent는 우에서 계산된 엔트로피값을 나타낸다. 실험에 의하면  5.0=p 일 때 잡음제거성능이 개선되였다. ,5.0 (8) m w ,1 = = n ⋅ x ⎛ ⎜ ⎜ ⎝ 아래와 같이 정의되는 신호대잡음비(PSNR)를 계산하여 제기한 방법의 결과를 분석 하였다. 신호대잡음비를 다음공식에 따라 계산한다. PSNR 10= log 10 (9) 2 255 MSE 여기서 MSE는 두 블로크사이의 평균두제곱오차를 나타낸다. 두 실험화상에 대하여 여러 잡음제거방법들과 비교한 실험결과를 보여주었다.(표) 표. 실험결과 화상 1 2 DCT 28.155 2 31.318 8 DCT_B 28.208 5 31.453 7 DCT_BA 28.298 1 31.490 8 PCA 28.195 6 31.588 9 PCA_B 28.302 6 31.744 3 PCA_BA 28.307 9 31.748 4 여기서 DCT, PCA는 각각 리산코시누스변환(DCT), 주성분분석을 리용하여 변환을 진 행할 때의 BM3D방법들이고 DCT_B, PCA_B는 매 방법의 블로크정합단계를 개선했을 때 의 BM3D방법이며 DCT_BA, PCA_BA는 매 방법의 합치기단계를 개선했을 때의 BM3D방 법을 표시한다. 우의 표에서 볼수 있는바와 같이 각이한 특성을 가진 화상들에 대하여 잡음제거를 진 행한 결과 론문에서 제기한 방법이 전반적으로 잡음제거성능을 높인다는것을 알수 있다. [1] 종합대학학보 수학, 65, 1, 121, 주체108(2019). 참 고 문 헌 [2] K. Dabov et al.; Image Process.: Algorithms and Systems, 6064, 14, 1, 2006.  [3] K. Dabov et al.; IEEE Trans. Image Process., 16, 8, 2080, 2007. [4] R. Singh et al.; IEEE Trans. Image Process., 6, 5, 7, 2017. 주체109(2020)년 6월 5일 원고접수 An Improvement of Block Matching-3-dimensional Collaborative  Filtering Method Using the Property of Noise Kim Song Jun, Ri Kwang Il We proposed a modified block matching-3-dimensional collaborative filtering method using the property of noise. The experimental results demonstrate that the proposed method improves denoising performance. Keywords: block matching, filtering, similarity measure