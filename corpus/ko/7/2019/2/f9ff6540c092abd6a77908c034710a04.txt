김일성종합대학학보 수 학 주체108(2019)년 제65권 제2호 역방향확률미분방정식을 리용한 아시아식선택권의  한가지 수치풀이방법 허승룡, 김천을 론문에서는 역방향확률미분방정식을 리용하여 아시아식선택권에 대한 한가지 근사도 식을 제기하였다. 한다.[1, 2] 하자. 각이한 선택권의 가격들은 역방향확률미분방정식의 풀이에 의하여 표시된다.[1－4] t 시각에서의 무위험자산을 0 tS 이라고 하고 리자률을 tr 라고 하면 다음의 식이 성립 또한 다음의 확률미분방정식에 의해 표시되는 d 개의 위험자산 i ( = ,1 d ) 가 있다고 S i t dS 0 = t 0 dtrS t t dS i t = ,σ ji t d i t + ∑ ⎛ ⎜ i dtbS t ⎜ ⎝ 라고 하고 1 = j j dW t ⎞ ⎟ ⎟ ⎠ b t − 1 r t λσ= t t 를 만족시키는 tλ 가 존재 , ) = b t , d b t ( 1 b t i t σσ = t 그리고 (cid:34) , 한다고 하자. 이때 t 시각의 전체 자산 tY 는 0 dS t 0 t i dS t i t = ∑ ∑ dY t i π t i π t Y t − S S , j ) ( d d = i ( 1 = Yr t t σπ=: t t i 1 = + + σπ t t 로 놓으면 우의 식은 dt ) t + ⎛ ⎜ ⎜ ⎝ λσπ t t 이다.[1, 2] tZ ⎞ ⎟ ⎟ ⎠ dW t 률미분방정식으로 표현된다. = ( σπ t t dW t + dtb t ) + ( Y t − π t )1 dtr t = − dY t −= dtYr tr − Z λ t t dt − dWZ t t 로 되며 역방향확 종점조건은 유럽식선택권인 경우 Y ϕ= T ( T S ) 이고 산수평균아시아식선택권인 경우 이며 회고선택권인 경우 Y T =ϕ 2 ( min Tt 0 ≤≤ S t ) 또는 Y T = ϕ 2 ( max Tt 0 ≤≤ S t ) 이다.[1, 2] 아시아식선택권에 대한 수치풀이도식들에 대하여서는 선행연구[1]에서 비교적 상세히 론 Y T = ⎛ ⎜ /1ϕ ⎜ ⎝ T 0 ∫ dtST t ⎞ ⎟ ⎟ ⎠ 의되였다. 산수평균아시아식선택권과 관계되는 일반적인 정역방향확률미분방정식은 다음과 같다.[1, 2] X ⎧ ⎪ ⎪⎪ ⎨ ⎪ Y ⎪ t ⎪ ⎩ = X 0 + t ,( Xsb ) ds + s ,( dWXs s ) s t ∫ 0 t ∫ σ 0 = ⎛ ⎜ ϕ ⎜ ⎝ 1 T T ∫ 0 ⎞ ⎟ ⎟ ⎠ T ∫ t dtX t + Xsf ,( , s Y s , Z s ) ds − dWZ s s T ∫ t (1) 식 (1)에서 종점조건이 정방향풀이의 범함수로 표시되므로 비마르꼬브형정역방향확률 － 46 － 종합대학학보 수학 주체108(2019)년 제65권 제2호 미분방정식으로 볼수 있다. 마르꼬브형정역방향확률미분방정식인 경우 역방향확률미분방정식의 풀이의 t 시각에 서의 값이 정방향풀이의 t 시각에서의 값에만 의존하므로 유한차원공간분할을 리용하여 강근사도식을 얻어낼수 있다. 비마르꼬브형인 경우에는 공간분할을 리용할수 없으며 역방향성분의 수치풀이가 정 방향풀이의 모의에 따라 달라지는 약근사도식[3]을 리용한다. 그러나 식 (1)의 역방향성분 에서 종점조건이 정방향성분의 적분에 관계되는 특수한 점을 리용하면 그것과 동등한 마 르꼬브정역방향확률미분방정식을 얻을수 있다. 이것은 식 (1)에 대하여 강근사도식을 얻 을수 있다는것을 말해준다. (, 를 완비확률토대, ( tF －위너과정이라고 하자. 를 1차원 tWW ( = , F P , Ω tF )) ) ) ( 0 ≥ t 방정식 (1)에 대하여 다음과 같은 가정을 준다. 0≥M 이 있어서  ① 어떤 상수 y xtb ,( xt ,( tb ,( σ σ |) − − + ) ) | | t ,( xMy |) ≤ | − y | ② ϕ,f 는 립쉬츠성을 만족시키는 비우연가측함수이며  | t |)0,0,0,( |)0( ϕ K ≤ + f | 이다. 이다. 반마르팅게일에 관한 부분적분공식을 리용하면 ⎞ ⎟ ⎟ ⎠ dtX t ,[ Xt 1 T 1 T tdX ⎛ ⎜ ⎜ ⎝ TX T ] 0 ∫ ∫ − − = T T T 0 0 t t = 1 T T ∫ 0 ) ( dXtT − + x 0 = t ,( Xtb ) dt + t σ dWXt ) ,( t t + x 0 T ∫ 0 tT − T = T ∫ 0 tT − T t ∫ 0 t ∫ σ 0 1 T T ∫ 0 의 풀이는 마르꼬브성을 만족시킨다. 환에 의해 마르꼬브형으로 바꾸어보자. 다음과 같이 기호약속을 하자. 이다. 일반적으로 X t = x 0 + ,( Xsb ) ds + s ,( dWXs s ) s 의 형태를 가지는 확률미분방정식 방정식 (1)의 종점조건에서 X 2 t = dtX t 가 우와 류사한 형태로 표시되므로 변수치 X 1 t : = X , t X 2 t : = x 0 + ,( Xsb ) ds + s σ ,( dWXs s s ) t ∫ 0 sT − T t ∫ 0 sT − T X t = ( X 1 t , X T2 ,) t x = ( x 1 , T ,) x 2 ,( xtb 1 :) = ,( xtb 1 ), ,( xtb 2 :) = xsb ,( 1 ) = xtb ,( :) xtb ,( ( 1 zyxt ,( , :) = f , f ), xtb ,( 2 xt ,( 1 , zy , ), ψ x :)( = ( σ 1 x ( ϕ ) 2 )), σ xt ,( :) = xt ,( ), σ 2 xt ,( )) tT − T 그러면 식 (1)은 다음과 같은 동등한 마르꼬브형정역방향확률미분방정식으로 쓸수 있다. 역방향확률미분방정식을 리용한 아시아식선택권의 한가지 수치풀이방법 － 47 － t t t s 0 0 ) + + = X X ∫ ds ∫ σ Xsb ,( ⎧ ⎪ ⎪⎪ ⎨ ⎪ Y ⎪ t ⎪ ⎩ 이때 다음의 정리가 성립한다. 정리 １ 정역방향확률미분방정식 (2)의 풀이를 Xsf ,( ( ψ Y s ∫ X Z + = ) ) T T 0 , , s s t T ∫ t dWXs ,( s s ) 0( ≤≤ Tt ) (2) ds − dWZ s s 0( ≤≤ Tt ) tZ ]1,0[) ∈t 은 정역방향확률미분방정식 (1)의 풀이로 된다. 이제 가정 ①, ②를 리용하여 식 (2)의 특징량들에 대하여 성립하는 결과들을 보기로 ( X 1 t , X 2 t , ZY , t t ) ∈t ]1,0[ 라고 하면 ( X 1 t Y , t , 하자. 가 성립한다. 정리 ２ b , f ψσ , , 는 립쉬츠련속이며 다음의 식 | f |)0,0,0,( t + | ψ |)0( | = f |)0,0,0,( t + | ϕ |)0( ≤ K 정리 2로부터 마르꼬브형정역방향확률미분방정식 (2)에 대하여 풀이의 유일존재성을 위한 표준적인 조건들이 성립하며 비선형헤이만－카스공식에 의하여 식 (2)의 풀이는 다 음과 같이 표시된다. 여기서 xtu ,( ) t 는 다음과 같은 반선형포물선형편미분방정식의 풀이이다. t t t = ,( Xtu ), Z ∇= ,( Xtu ) σ ,( Xt ) Y t 2 2 ) ) ) + ∑ xtb ,( i xtu ,( ∂ t ∂ xtu ,( ∂ x ∂ i ⎧ ⎪⎪ ⎨ ⎪ ⎪ xTu ,( ⎩ 만 일 식 (2)에 서 확 산과 정 이 시공 간 점 σ i 1 = Rx ∈ ∑ x ()( xt ,( 1 2 ψ ji , = + 1 = ) ) 2 i Z t ∇= Xsu ,( xt , s ) σ Xs ,( xt , s ) 로 표시할수 있다. T ) σ j xt ,( ) ∂ ) 2 xtu ,( xx ∂∂ i j + f uxt , ,( , u ⋅∇ σ 0) = xt 에서 시 작된다 면 ,( ) xt , Y s = Xsu ,( xt , s ) , t Δ kn , = t kn + txt , ( F s 이제 론문의 기본목적인 수치도식을 유도하자. 시간구간 T t ,0[ , T 의 분할 WW − t ] =, t t n W t n 0 , < t = (cid:34)0 < W W = t kn , kn + N = − W t n − t n 에 대하여 −+ 1 으로 정의하자. t n t n == NTh / 라고 하고 ≤≤ Ts ) 를 시공간점 xt 로부터 출발한 확산과정 ,( ) { Xx + t r ≤≤ s } 에 의 하여 생성된 −σ 모임벌이라고 하고 E [ X :] = [ XE | xt , s xt , F s ], x [ XE t :] = [ XE | F t ] 로 정의한다. 마르꼬브형정역방향확률미분방정식에 대한 근사도식으로서 잘 알려진 C－N도식[4]을 에 대하 이 주어졌을 때 ,1 (cid:34)− 0,1, = Nn ( t ) σ ), X X X Z = = N N N N N ( ) , 리용하자. n 여 X ,1+ Y Y n , Z ( ψ n ψ x N 을 다음과 같이 구한다. − X r , t xt , X ⎧ ⎪ ⎪ ⎪ Y ⎨ ⎪ ⎪ ⎪ ⎩ 1 2 n 1 + n = X + ( , Wt ρ n n 1, ) 1 2 1 2 n = X E t n n [ Y n 1 + ] + tfh ( , n X n , Y n , n Z ) + n X hE t n [ tf ( n 1 + , X n 1 + , Y n 1 + , Z n 1 + )] (3) n hZ −= X hE t n n [ Z n 1 + ] + n X E t n 1 n + WY [ n 1, ] + n X hE t n [ tf ( n 1 + , X n 1 + , Y n 1 + , n 1 + WZ n ) ] 1, 1 2 1 2 － 48 － 종합대학학보 수학 주체108(2019)년 제65권 제2호 여기서 정방향근사는 약2차테일러형도식[3]을 리용하였다． 즉 Wt , ( ρ n n 1, ) = n hb + σ n W n 1, + n n σσ x 2 W ( n 1, − h ) + + 1 2 ⎡ n + σσ ⎢ t ⎣ n b n x + b n n σ x + 2 n ) ( σσ n xx hW n 1, + n b [ t + n bb n x + ( σ n 2 ) b n xx 2 h ] 1 2 1 2 1 2 ⎤ ⎥ ⎦ 이다. 실지 수치결과를 얻기 위하여서는 공간분할과 조건부수학적기대값근사를 진행하여 야 한다. 다음과 같은 공간분할을 도입하자. D h : = D ,1 h × D ,2 h D hj , {: = x i j | j x i = il , j l j > i (0 = ,0 ± ,1 (cid:34)± ,2 )} 가측함수 g 에 대하여 WgE ([ n 1, )] = ⎛ ⎜ xg ⎜⎜ ⎝ ∫ R − 2 h x 2 e 1 2 π ⎞ ⎟ ⎟⎟ ⎠ 1 π ∫ R dx = g 2( xeh ) dx 2 − x 이고 이것을 가우스－에르미뜨구적법에 의하여 근사시키면 ([ WgE n 1, )] ≈ gw j 2( ah j ) (4) 1 π L ∑ j 1 = 이다. 여기서 L 은 근사에 리용된 표본점들의 수이고 a j ( j = ,1 L ) 들은 L 차에르미뜨다항 식 )(xH L 의 뿌리들이며 jw j ( = ,1 L ) 들은 대응하는 무게곁수들로서 다음과 같이 표시된다. w j = L 1 + 2 L ! ( ′ aH ( L j π 2 )) x = ( x 1 , x 2 ) ∈ lD 에 대하여 비선형헤인만－카스표현을 리용하면 다음과 같은 식들을 얻는다. x YE [ t n n 1 + ] = x YE [ t n n 1 + n 1 + )] = YE [ n 1 + ( x + ( Wt , ρ n n 1, ))] ( X n 1 + n WYE n 1 + [ x t n 1, ] = YE [ ( x + WWt ( ρ n n n )) 1, , 1, ] x fE [ t n t ( n 1 + , X n 1 + , Y n 1 + , Z n 1 + )] = x fE [ t n t ( n 1 + , X n 1 + , Y n 1 + , n 1 + WZ n ) 1, ] = = x fE [ t n = x fE [ t n ( 1 ρρρ= 2 , ) 를 구체적으로 쓰면 ρ 1 Wt ( , n n 1, ) = n hb + n W σ n 1, + n n σσ x 2 W ( n 1, − h ) + 1 2 n 1 + n 1 + 1 2 n 1 + n 1 + t ( , n 1 + x + ( Wt , ρ n n 1, ), Y ( x + ( Wt , ρ n n 1, )), Z ( x + ( Wt , ρ n n 1, )))] t ( , n 1 + x + ( Wt , ρ n n 1, ), Y ( x + ( Wt , ρ n n 1, )), Z ( x + ( Wt , ρ n n 1, ))) W n 1, ] + 1 2 ⎡ n n + σσ ⎢ t ⎣ b n x + b n n σ x + 2 n n ) ( σσ xx hW n 1, + n b [ t + n bb n x + n ( σ ) 2 b n xx 2 h ] ⎤ ⎥ ⎦ 1 2 역방향확률미분방정식을 리용한 아시아식선택권의 한가지 수치풀이방법 － 49 － T ρ 2 Wt , ( n n 1, ) = hbtT ) ( n − + tT ( − n n W ) σ n n 1, + tT ( − ) 2 n n σσ x 2 W ( 1, n n − h ) + 1 2 tT ( − n n ) − σσ t n + tT ( − 2 n σ ) b n x n + tT ( − 2 ) b n n σ x n + ( tT − 3 () 2 n n ) σσ xx n hW n 1, + 1 2 ⎤ ⎥ ⎦ [( n ) btT − n t n − b + ( tT − 2 ) n bb n x n + ( tT − 3 () n σ ) 2 b n xx 2 ] h n ⎡ ⎢ ⎣ + 1 2 1 2 이다. 이로부터 + x + ρ 2( ha () j = ,1 L ) 에서 Y ( i 부수학적기대값들을 식 (4)에 의하여 근사시킬수 있다. 이므로 이 점들에서 일반적으로 2(ρ ∉ + x ) n 1 + , Z n 1 + ha i D l ) 의 값들을 얻으면 식 (3)에서 조건 Y ( n 1 + , Z n 1 + ) 의 값은 공간살창점들 에서 Y ( n 1 + , Z n 1 + ) 의 값들에 의한 보간다항식을 구성하는 방법으로 얻는다. 이때 보간다항 식의 차수는 3≥r 으로 준다．그리고 에르미뜨다항식의 차수는 2≥L 로 준다． 따라서 반리산도식 (3)과 공간리산화를 통하여 임의의 시공간점 t ( n , x i j ) 에서 ZY ,( ) 의 근사값을 구할수 있다. 반리산도식 (3)에서 정방향성분은 2차의 수렴성을 가지는 약2차테일러형도식을 리용 하고 역방향성분도 2차의 수렴성을 가지는 C－N도식을 리용하였다. 이때 정역방향확률미 분방정식에 대한 수치도식 (3)도 2차의 수렴성을 가진다. 참 고 문 헌 [1] P. Boyle et al.; Mathematics and Economics, 42, 189, 2008. [2] P. Chol Kyu et al.; arXiv:1808.01564v1 [math.NA], 2018. [3] E. Gobet et al.; The Annals of Applied Probability, 15, 3, 2172, 2005. [4] W. Zhao et al.; Sci. China Math., 60, 5, 923, 2017. 주체107(2018)년 12월 5일 원고접수 A Numerical Scheme for Asian Option through Backward Stochastic Differential Equation Ho Sung Ryong, Kim Chon Ul In this paper, we propose a numerical scheme for Asian option through backward stochastic differential equation and give the error analysis. Key words: backward stochastic differential equation, Asian option