김일성종합대학학보 수 학 주체108(2019)년 제65권 제2호 ２진화상워터마킹체계에서 견고성개선의 한가지 방법 김윤복, 김진성 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《새로운 과학기술분야를 개척하기 위한 사업도 전망성있게 밀고나가야 합니다.》 (《선집》 증보판 제11권 138페지) 워터마크정보의 부호화 및 복호화는 워터마킹체계의 견고성을 높이기 위한 중요한 수단으로서 선행연구[1]에서는 DWT에 의한 워터마킹에서 BCH부호를 리용한 방법을, 선 행연구[2]에서는 중첩부호를 리용한 방법을, 선행연구[3]에서는 터보부호를 리용하는 방법 들을 제기하였다. 그러나 이 방법들에서는 삽입하는 정보부호렬을 독립인 우연량렬이라고 보았으며 정보부호들사이의 상관성이 있는 경우는 고려하지 못하였다. 론문에서는 삽입하는 워터마크정보가 2진화상인 경우 린접한 화소점들에서 화소값들 의 상관이 크다는것을 리용하여 워터마킹체계의 견고성을 높이기 위한 한가지 복호화방 법을 제기하고 그것의 효과성을 워터마크삽입알고리듬[4]을 리용하여 검증하였다. １．２진워터마크화상의 중첩부호화 2진워터마크화상의 중첩부호화는 다음과 같은 방법으로 진행한다. iI ,( ∈j }1,0{) 2차원화상 : ),1( = ,1 (cid:34)= 를 1차원으로 변환하여 다음과 같은 W 를 얻는다. (cid:34) (cid:34) = )(kw 에 대하여 1 부터 8 까지의 상태 nmw ,1 (cid:34)= +⋅− (1) iw (( j () state k 와 4개 비트로 이루어진 부호단어 nm × 크기의 2진워터마크화상이라고 하자. nm × )을 kw )( ),2( iI ,( iI ,( )( ( W , , )1 m w w )) ,1 × = = n n k ) ( ( ) ) j j i j , , , , )(kc 를 다음과 같이 대응시킨다. state :)1( = key, key (cid:34)= ,1 8, state k :)( = kw A ( ,1)( + state ( k − ))1 ( k = ,2 (cid:34) , nm × ) kc :)( = kwB ( ,1)( + state ( k )) 여기서 A는 상태이행행렬, B는 부호행렬로서 다음과 같다. :A = ⎛ ⎜⎜ ⎝ 75317531 86428642 ⎞ ⎟⎟ ⎠ :B = 0000 1111 ⎛ ⎜⎜ ⎝ 1100 0011 1010 0101 0111 1000 1101 0010 1110 0001 0100 1011 0110 1001 ⎞ ⎟⎟ ⎠ 즉 2진워터마크화상의 매 화소값 부호화되며 화상의 부호화결과는 C = c ),1(( c ),2( (cid:34) , nmc ( × )) 이다. iI ,( j ) 는 이행행렬 A 와 부호행렬 B 에 의하여 4bit로 2진화상워터마킹체계에서 견고성개선의 한가지 방법 － 65 － nm × ∑ k 1 = ′ b , 3 b|l l ２．화소값들의 상관을 고려한 Viterbi복호화 두 중첩부호사이의 거리는 일반적으로 아래와 같은 하밍거리를 리용한다.[2] , CCd ( =′ :) d H (( kc ), ′ ( kc )) (2) 여기서 kc )( = b ( 1 , b 2 , b 3 , ), b 4 : H d ′ )( kc = kc (( ), , ′= ′ bb , ( 1 2 ′ kc ( {| = )) 일 때 ′ ) b 4 ′≠ b l l ( = |)}4,3,2,1 워터마크검출알고리듬에 의하여 검출된 중첩부호를  ′ ( C nmc × ′=′ : c ( ′ ),2( ),1( (cid:34) c , )) 이라고 하자. 미에서 C′ 와 가장 가까운 부호 를 찾기 위한 알고리듬이다. * C : = arg (min CCd , ′ ) C Viterbi복호화방법은 동적계획법으로 가능한 모든 부호 C 들중에서 하밍거리 (2)의 의 워터마크정보가 2진화상인 경우 린접한 화소점들에서의 화소값들은 높은 상관성을 )(kw′ 라고 하면 )(kc′ 가 나타내는 비트를 가진다. 즉 검출된 중첩부호 C′ 에서 ′ kw )( 이 성립될 가능성이 크다고 볼수 있다. kw ( )1 = − 이로부터 론문에서는 하밍거리 (2)대신 린접한 부호비트들사이의 이행확률을 고려한 다음과 같은 거리를 도입한다. (ˆ CCd , =′ :) nm × ∑ k 1 = − log )( |wkwP ( ( k − ))1 ⋅ d (( kc ), ′ ( kc )) (3) H 여기서 vuP ( | ) 는 1−k 째 비트값이 v 일 때 k 째 비트값이 u 로 될 확률이다. 거리 (3)을 리용한 Viterbi복호화방법은 다음과 같다. s W ),1(( 은 정보부호렬이고 nmw ),1( (cid:34) w )) S = = ( ( : : , (cid:34) , nms ( × )) × 은 W 의 중첩부호렬, C k : = c ),1(( (cid:34) , Wkc )), ( k 은 W 의 상태렬이며 는 (cid:34) : , kw ( ),1( w )) = ( k , : j = = )) (cid:34) :) c ),1(( 또한 * iC ,( k ksC )(| C nmc ( × 각각 WC, 의 부분렬이라고 하자. ,( {:) iA j = k (ˆmin arg ) iAC j ,( ∈ ,(* iWk iFk ,( j 는 ,(* 이때 iWk ① 초기상태 key , 최대반복회수 maxN ,(* iCk j ) 그리고 CCd , kwi )( , iF ,( k , , :) = = = ′ k ) ) ) ) j j j k 는 k 째 상태가 i , } j (ˆ * iCd ,( k Cj ), 라고 하자. ′ k ) kw =)( j 인 kC 들의 모임이며 에 대응한 정보부호렬이라고 하자. 들은 다음과 같은 알고리듬에 의하여 계산된다. ) j +∞←Δ 에 대한 변화량 ε 을 설정한다. F , ,( iFk , +∞← ← ,0 N F ( u|P })1,0{ 인 동안 아래의 처리를 반복한다. ,(5.0 u ∈ v v ) >Δ εF min ← ② ③ NN < ,(* iW 0 ,max j ) =∅= i ( ,1 (cid:34) ;8, j = )1,0 － 66 － 종합대학학보 수학 주체108(2019)년 제65권 제2호 ④ iF ,(0 j :) = i ( = ,1 (cid:34) ;8, j = )1,0 j j = ≠ key key ,0 ⎧ ⎨ ∞+ ⎩ to1 , ⑤ For k = m × n For state = 8to1 For bit = 1to0 Fk ( state, )bit = f i ( * , * j ) f i ( i ,( * , j = ) * =j ) arg |) ,( iAj min =+ )1 j } state ,{( i f i ,( j ) ( state, )bit = * iW ( ( − 1 k * , * j ), )bit F k − 1 i ,( j ) − log( P ( bit j| )) ⋅ iBd ,( ( j + ,)1 H ′ ( kc )) *       W k      End      End    End  * * ⑥ i ( , j :) = * , * i ( * nm× min F − * =Δ FF min F F = = NN 1+  ⑦ 복호화된 arg (cid:34) = ,1 ,8, min = j i 1,0 F × nm i ,( j ) , F * : = F * , i ( * j ) nm× 이라고 하면 복호화된 정보부호 렬 *W 은 * WW = * j ) 로 계산된다. *W 로부터 ( vu|P ) 를 계산한 다음 ③으로 간다. 2진워터마크화상 I ′ 는 우의 알고리듬에 의하여 복호화된 비트렬 W * = * w ( ),1( (cid:34) , nmw × ( )) * 에 식 (1)의 반대과정을 적용하여 얻을수 있다. ３．성 능 평 가 우리는 워터마크삽입알고리듬[4]과 선행연구[1－3]의 부호화, 복호화방법들, 선행연구 [2]의 부호화와 론문의 복호화방법을 결합하였을 때 검출되는 워터마크의 견고성을 평가 하는 방법으로 론문에서 제기한 복호화방법의 효과성을 검증한다. m n ∑∑ i 1 = j 1 = | iI ,( j ) ′− I i ,( j |) nm ⋅ 워터마킹체계의 견고성은 BER = ⋅ 100 에 의하여 평가한다. 여 기서 I 는 원래의 워터마크화상이고 I′ 는 검출된 워터마크화상이다. Lena화상과 Babbon화상에 대하여 이전의 중첩부호화와 Viterbi복호화방법[2], BCH 부호를 리용한 부호화와 복호화방법[1], 터보부호를 리용한 부호화와 복호화방법[3]과 론문에서 제기한 중첩부호화와 복호화방법들을 각각 적용한 경우 잡음추가공격, 려파 공격, 압축공격, 척도변환공격을 비롯한 여러가지 공격에 대한 BER를 평가한 결과는 표와 같다. 2진화상워터마킹체계에서 견고성개선의 한가지 방법 － 67 － 표．각이한 공격에 대한 비트오유률(BER) Lena 화상 Babbon 화상 방법[2] 방법[1] 방법[3] 방법[2] 방법[1] 방법[3] 2.8 3.0 2.5 4.5 7.5 12.7 2.9 6.9 론문의 방법 1.4 0.3 1.0 2.0 2.0 0.0 0.0 3.4 7.9 7.0 3.2 13.3 14.6 0.4 0.0 16.4 23.2 18.5 11.9 11.6 30.0 30.6 0.6 36.0 3.6 3.2 8.8 3.3 2.6 15.7 6.6 3.1 론문의 방법 1.3 0.9 0.4 3.3 4.6 0.0 0.0 8.4 가우스잡음추가(0.003) Salt&pepper잡음추가(0.05) Speckle잡음추가(0.005) 중간대역려파기( 33× ) 위너려파기( 33× ) JPEG압축(50) JPEG압축(75) 축소－확대(512－256－512) 10.4 3.5 7.7 7.0 6.0 0.1 0.0 10.2 27.3 20.1 23.1 16.9 11.4 2.3 0.0 17.4 우의 결과로부터 론문에서 제기한 복호화방법을 리용하는 경우 이전의 복호화방법들 보다 BER가 훨씬 작아진다는것을 알수 있다. 참 고 문 헌 [1] N. Nigam et al.; Int. J. Comput. Appl., 110, 37, 2015. [2] J. R. Hernandez et al.; In Proc. SPIE Conf. on Security and Watermarking of Multimedia Content II, 3971, 24, 2000. [3] S. Pereira et al.; In IEEE Int. Conf. on Image Processing, 3, 671, 2000. [4] F. Ernawan et al.; Electronic and Computer Engineering, 9, 2, 111, 2015. A Method for Improving the Robustness in Binary Image Watermarking 주체107(2018)년 12월 5일 원고접수 Kim Yun Bok, Kim Jin Song We propose a decoding method using characteristic of the binary watermark image to improve the robustness of the binary image watermarking system and verify its effectiveness. Key words: decoding, binary watermark image