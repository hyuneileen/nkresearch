김일성종합대학학보 수 학 주체108(2019)년 제65권 제3호 화상해석에 의한 실시간품질관리에 대한 연구 김 경 희 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《새 제품개발과 질제고에 힘을 넣어 세계적수준의 다양한 경공업제품들을 더 많이 생산하여야 합니다.》 론문에서는 화장품을 만드는 유화기에 촬영기를 설치하여 현장조종실의 콤퓨터에 배 합물화상을 실시간적으로 현시하고 화상해석특성값에 관한 실시간관리도를 해석하여 배 합공정의 이상증상을 제때에 판단하는 방법에 대하여 연구하였다. 화장품은 여러가지 물성 및 유성원료들을 일정한 비률로 유화기에서 혼합하여 만든 것이며 유화과정은 온도 및 유화속도 등에 따라 여러 단계로 이루어진다. 유화 및 균질화과정은 그림 1과 같다. 그림 1. 유화 및 균질화과정 유화과정의 단계별이행은 운전공이 육안으로 유화기안의 유화상태를 확인한 후 유화 정도와 온도에 따라 교반속도를 낮추는 방식으로 진행된다. 배합과정에 유화물의 상변화를 사람의 눈으로 보고 판단하여 조종하므로 잘못 판단 할 가능성이 있다. 그것은 유화시간이 대체로 40～50min정도 걸리는데 유화과정을 감시하 는 사람이 작업시간과 환경에 따라 유화기안의 유화물의 상을 다르게 볼수 있기때문이다. 또한 화장품의 종류별로, 유화과정의 단계별로 최적조건(온도, 교반속도, 진공도)을 확정하는것이 필요하다. 현재는 화장품의 종류에 무관계하게 유화과정의 매 단계별 온도 조절방식과 교반속도조절방식, 진공도조절방식이 비슷하지만 화장품의 종류에 따라 유화 과정의 조종방법이 세분화되여 최량화되여야 한다. 선행연구[1]에서는 유화과정을 향장학적, 유기화학적으로 해석하였지만 화상을 통한 해석방법에 대하여서는 고찰하지 못하였다. 선행연구[2]에서는 정규성가정이 만족되지 않고 관측값들이 독립이 아닐 때 슈와르츠 관리도가 명백히 관리한계밖의 점들을 찍게 되며 따라서 관리도로부터 잘못된 결과를 얻 게 된다는것을 해명하였으며 선행연구[3, 4]에서는 자기상관된 자료를 가지고 관리도를 그 리는 방법을 제기하였는데 이 방법은 시계렬을 적당한 ARIMA모형으로 먼저 적합시키고 잔차에 대하여 관리도를 그리는것이다. 이 방법의 약점은 ARIMA모형의 차수를 동정하는 데 시간이 걸리므로 실시간자료해석을 요구하는 현장에서 쓸수 없다는것이다. 우리는 배합 전 과정에 유화물의 질상태를 실시간적으로 감시하고 평가할수 있는 품질 특성값을 화상해석에 의한 농담의 개수로 정하고 그것에 대응한 관리도를 그려 화상해석 － 4 － 종합대학학보 수학 주체108(2019)년 제65권 제3호 에 의한 실시간품질관리를 진행하는 방법에 대하여 연구하였다. 여기서 문제로 되는것은 품질특성값이 독립, 동일분포하는것이 아니라 자기상관되는 시계렬관측값들이라는것이다. 그러므로 론문에서는 화상해석을 통하여 실시간적으로 얻어진 농담의 개수시계렬에 서 경향성을 추정하여 제거하는 방법으로 관리도를 그려 실시간 품질을 관리하는 방법을 새롭게 연구하였다. 실시간적으로 빨아들인 화상을 해석하여 배합물의 질상태를 판정하는 수학적알고리 실시간적으로 현시되는 동화상의 명암부분을 해석하여 교반날개부분과 배합물을 구 분하여 교반주기를 자동적으로 탐색한다. 교반시간이 경과하는데 따라 달라지는 교반주기를 자동탐색하고 그것에 따라 프레임 듬은 다음과 같다. 을 선별한다. 먼저 캐니(Canny)연산자에 의하여 화상을 해석한다. RGB값으로부터 그레이화상을 얻은 다음 그림 2와 같이 4개의 단계로 구성되여있는 륜곽검출연산자인 캐니연산자를 리용한다. ㄱ)         ㄴ)           ㄷ)          ㄹ) 그림 2. 4개의 단계로 구성되여있는 캐니연산자 ㄱ) 가우스평활화, ㄴ) 쏘벨연산자, ㄷ) 비극대점제거, ㄹ) 리력턱값화 먼저 잡음의 영향을 적게 받도록 하기 위하여 화상을 다음과 같은 가우스연산자에 1a ∙  1b ∙  1c ∙ 2a ∙  b ★  2c ∙ 3a ∙  3b ∙  3c ∙ 그림 3. 그라디엔트방향 계산을 위한 점모임 의하여 평활화한다. ,(g yx ) = exp( − ( x 2 2 + y 2/() σ 2 )) 쏘벨연산자는 그라디엔트방향을 탐색하는 연산자이다. 그림 3에서와 같이 ★로 표시되는 2차원평면의 한 점 b 에 는 그 점주위의 ∙으로 표시되는 서의 그라디엔트방향 x bb , ( y ) 8개 점의 값들에 의하여 다음과 같은 공식으로 주어진다. b x = ( a 1 + 2 a 2 + a 3 − c 1 − 2 c 2 − c 3 ,8/) b y = ( a 1 + b 2 1 + c 1 − a 3 − b 2 3 − c 3 ,8/) b = b 2 x + b 2 y 비극대점제거는 일정한 근방내에서 륜곽세기가 가장 큰 점들만을 남기는 처리이다. 즉 륜곽세기에 대하여 마루를 이루는 점들만을 남기며 이것은 륜곽방향정보를 리용하여 수행된다. 3×3근방에 대하여 고찰점의 물매가 륜곽의 방향에 수직인 선을 따라서 근방내의 다 xP , 에서의 물매의 크기 른 점들의 물매보다 크다면 그 점을 극대점으로 한다. 즉 점 y yxM ,( ) 가 점 1M 과 2M 에서의 물매크기보다 크면 고찰점은 국부최대값으로 된다. 이때 불련속근방이 고찰되므로 1M 과 2M 는 고찰점의 륜곽세기 xM , yM 와 륜곽의 방향으로부터 구해지게 된다. 화상해석에 의한 실시간품질관리에 대한 연구 － 5 － 캐니연산자에서는 륜곽검출의 정확성을 보장하기 위하여 2개의 턱값 즉 상위턱값과 하위턱값을 리용한 리력턱값화를 진행한다. 실천에서 리력턱값화는 다음과 같은 알고리듬에 의하여 진행된다. ① 하위턱값보다 륜곽세기가 큰 극대점들을 륜곽후보로 한다. ② 륜곽후보점들에 대하여 련결성분을 구한다. ③ 매 련결성분에 대하여 륜곽세기가 상위턱값보다 큰 극대점이 하나라도 있으면 그 련결성분은 륜곽점들로 된다. 매 련결성분에 대하여 륜곽세기가 상위턱값보다 큰 극대점이 하나도 없으면 그 련결 성분은 륜곽점으로 되지 않으며 제거한다. 리력턱값화와 단일턱값화의 비교결과는 그림 4와 같다. 그림 4. 리력턱값화와 단일턱값화의 비교 ㄱ) 상위턱값=40, 하위턱값=10일 때 리력턱값화, ㄴ) 턱값=40일 때 단일턱값화, ㄷ) 턱값=10일 때 단일턱값화 단일턱값화에서는 턱값이 크면 륜곽점들이 적게 얻어지며 턱값이 작으면 륜곽점들이 너무 많이 얻어지게 된다. 그러나 리력턱값화에서는 륜곽의 련결성분을 고려하여 적당히 륜곽점들이 얻어지게 된다. 얻어진 륜곽화상에서 농담의 개수를 계산하여 시간에 따라 실시간적으로 유화물의 균질도를 보여주는 특성곡선을 그린다. 이 균질도곡선모양을 보면 시간에 관하여 감소하 는 경향성을 나타낸다. 즉 이 시계렬은 독립인 표본우연량렬로 볼수 없으며 시간에 관한 상관성을 가진다고 볼수 있다. 표준값이 주어지는 경우 표준조작법에 따라 유화물배합과정을 정확히 준수하고 배합 물의 유화과정을 화상으로 빨아들인 다음 우에서 서술한 알고리듬에 따르는 화상해석에 의한 표준특성값곡선을 그린다. 표준값이 주어지지 않는 경우 표준조작법이 현장조건과 차이날수 있기때문에 제품검 사에서 합격으로 판정된 제품에 대응한 화상특성곡선으로부터 단순이동평균선을 그려 실 시간관리도의 중심선(평균곡선)을 얻는다. 단순이동평균선은 선형경향을 가지는 경우 경향성을 정확히 반영한다.  그런데 유화과정을 보면 농담의 개수는 시간에 따라 선형으로 감소한다. 평활화방법은 다음과 같다.  특성곡선 tX 가 다음과 같이 표시된다고 하자. Ym + t t 0=tΕY 인 정규분포에 따른다고 가정한다. X = t 여기서 tY 는 잡음성분으로서 (1) － 6 － 종합대학학보 수학 주체108(2019)년 제65권 제3호 q 를 부아닌 옹근수라고 하고 량쪽이동평균 W t = 2( q 1)1 −+ 를 식 (1)로 정의된 과정 { tX 에 대하여 고찰하자. } 이때 −≤≤+ 1 t qn q 에 대하여 tm 는 구간 q tqt [  , − + q ] 에서 거의 선형이고 오차항의 평균은 거의 0 이라고 가정하면 W t = 2( q + )1 m t + j + 2( q + )1 1 − ≈ m t + j 이다. q ∑ j −= X q t + j q ∑ j −= Y t q 따라서 우의 이동평균에 의한 추정값은 다음과 같다. ˆ m t = 2( q + )1 1 − , q t −≤≤+ qn 1 (2) 1 − ∑ j −= q q ∑ j −= X q t + j tX 가 t > 혹은 n 0≤t 에 대하여 관측되지 않으므로 t tn − −> qn 혹은 t ≤ 에 대하여 식 q (2)를 리용할수 없다. 그러나 대신 한쪽 이동평균 t ( = ,2,1 (cid:34) , q ) 혹 ˆ m t = ∑ j = 1( ) − αα 0 j X t + j t 1 − 은 ∑ ˆ m = t 1( ) − αα 0 j = j X t − j t ( qn +−≤ ,1 (cid:34) , n ) 를 리용할수 있다. 이 추정은 α 의 값에 그리 민감하지 않다. 경험적으로는 α의 값을 0.1～0.3사이에서 주는것이 좋다. 또한 특성곡선 tX 로부터 평균이동범위를 계산한다. 이동범위는 매개 측정값에서 다 음번 측정값을 던 차의 절대값으로서 매 시점에서 관측값이 하나밖에 주어지지 않는 경 우 변동범위 tR 를 대신한다. 표준편차는 ˆ =σ 로 계산한다. 여기서 R = tR 이다. 정 R d 2 1 n n ∑ t 1 = 규분포의 3σ법칙에 리용한 웃, 아래한계선을 ˆ m t ˆ3 ± σ = ˆ m t ± /3 dR 2 에 따라 그린다. 배합과정에 그려지는 특성곡선이 이 관리도의 한계선을 벗어나면 이상신호를 발생시 키고 배합조종인자(교반속도, 유화기온도, 진공도)들이 정상인가를 따져보고 비정상인 경 우 대책을 세운 다음 다시 배합을 진행한다. [1] 강환일 등; 화장품발명, 국가발명국, 67～195, 주체100(2011). 참 고 문 헌 [2] D. C. Montgomery; Introduction to Statistical Quality Control., 1, 6, 330, 2009. [3] B. Dobson; Quality Engineering, 7, 4, 757, 1995. [4] L. C. Alwan; Engineering International, 4, 2, 167, 1991. On the Real-Time Quality Control by Image Processing Kim Kyong Hui 주체108(2019)년 3월 15일 원고접수 In this paper, we study the scientific method to control the quality of cosmetics in real-time by image processing. Key word: real-time quality control