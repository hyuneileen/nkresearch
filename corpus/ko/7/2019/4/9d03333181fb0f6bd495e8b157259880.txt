김일성종합대학학보 수 학 주체108(2019)년 제65권 제4호 얼굴화상의 기미검출에서 지지벡토르기계의 특징을 합리적으로 선택하기 위한 한가지 방법 김광천, 리명철 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《우리는 과학기술을 발전시키는데서 남들이 걸은 길을 따라만 갈것이 아니라 단계를 뛰여 넘어 비약적인 발전을 이룩하여야 합니다.》 론문에서는 얼굴화상에서 기미를 검출할 때 오유률을 증가시키는 머리칼령역에 대한 판정오차를 줄이기 위한 방법을 연구하였다. 우리는 기미령역을 판정하는데 지지벡토르기 계(SVM)를 분류기로 리용하였으며 분류기의 판별성능을 높이기 위하여 특징을 합리적으 로 선택하는 한가지 방안을 제안하였다. 선행연구[1]에서는 기미를 포함하는 피부령역과 기미가 없는 피부령역을 판단하는 데 SVM분류기를 리용하였으며 특징으로는 회색준위동시발생행렬(GLCM)에 기초한 피 부질평가를 위한 통계량들을 리용하였으나 머리칼이 없는 얼굴의 특정령역에서의 기 미검출에 대하여 론의하고 머리칼령역이 기미검출에 미치는 영향에 대하여 론의하지 못하였다. 선행연구[2]에서는 려파기출력화상에 대하여 턱값판정방법을 리용하여 2진화상처 리를 진행하고 련결성분의 크기에 기초하여 기미여부판단을 한다. 그러나 이 방법은 화상의 미세한 변화에도 큰 영향을 받으며 특히 머리칼령역이 기미로 잘못 검출되는 것과 같은 오유가 있다. 여기서도 얼굴령역에 머리칼이 없는 얼굴화상자료기지에 대 하여 성능평가를 진행하고있다. 우리는 머리칼이 얼굴령역의 일부를 가리우거나 드리우는데 대한 제한을 주지 않은 상태에서 기미령역을 검출하는 방법을 연구하였다. 이때의 문제점은 머리칼부분이 기미령 역으로 잘못 판단되는것이다. 기미판정에서의 오유는 기미령역을 기미가 없는 령역으로 판단하는 1종의 오유와 기 미가 없는 령역을 기미령역으로 판단하는 2종의 오유가 있다. 우리는 머리칼이 있는 얼굴령역에 대하여 두가지 종류의 오유를 모두 감소시키면서도 2종의 오유를 감소시키는데 더 큰 비중을 두고 성능을 높이기 위한 방법을 연구하였다. 우리는 선행연구[2]의 방법과 류사한 방법으로 기미후보를 얻지만 턱값판정조건을 약 화시켜 상대적으로 많은 후보를 얻은 다음 SVM분류기로 후보가 기미령역인가를 판정하 는 방법을 제안하였으며 이때 기미없는 머리칼령역이 기미령역으로 판정되는 오유를 줄 일수 있는 특징선택방법을 제안하고 실험결과를 주었다. 우리는 SVM분류기를 학습시키기 위한 자료를 머리칼과 기미가 있는 령역 1G , 머리 칼이 있고 기미가 없는 령역 2G , 머리칼이 없고 기미가 있는 령역 3G , 머리칼과 기미가 없는 령역 4G 와 같이 4가지로 세분하였다. 이 4가지 표본들중에서 1G , 3G 과 2G , 4G 를 판별하는 분류기를 만들어야 한다. 얼굴화상의 기미검출에서 지지벡토르기계의 특징을 합리적으로 선택하기 …  － 43 － 특징은 선행연구[1]에서와 같이 피부특성을 나타내는 통계적특징을 밝기, Cr, angleA의 색공간에서 구한 42개 특징중에서 기미가 없는 머리칼령역이 기미로 판단되는 오유를 줄 이는데 좋은 특징들만을 선택하여 리용하였다. 특징은 2G 와 3G 에 대하여 무리안에서는 변동이 작고 무리사이에는 변동이 큰 특성을 가지는것을 우선적으로 선택하는 방법으로 정하였다. i 번째 특징의 무리 X 와 무리 Y 에 대한 ∪ YX X ) ( YX , ) iF )( = ( ( x i −F 득점[3]은 Y ( 2) ( x x ) ( i i ( 2) Y ) ( σ i − 2) ) + + ) − ( x i ( ( σ i X ∪ YX 2) ) 과 같이 계산한다. 여기서 ) ( X ix 와 ( X ) iσ 는 각각 무리 X 에서 i 번째 특징의 평균과 표준 편차이고 YX ∪ 는 무리 X 와 Y 의 합이다. (cid:34)= ,1 )4, | = G n k ( | 실례로 k 의 평균은 각각 다음과 같이 계산된다. k 라고 놓았을 때 무리 1G 의 평균과 표준편차, 무리 1 GG ∪ 2 ( G 1 ) x i n 1 ⎛ 1 ⎜ = ∑ ⎜ n 1 ⎝ 1 = j ⎞ ⎟ ⎟ ⎠ 1 n 1 n 1 ∑ j 1 = ⎛ ⎜ ⎜ ⎝ ) G ( x 1 ij , ( σ i G 1 ) = ) ( G ( x 1 ij − ( x i G 1 2) ) , x i ( ∪ GG 2 1 ) = ) G ( x 1 ij + ) 2 G ( x ij ⎞ ⎟ ⎟ ⎠ 1 + n 1 n 2 n 1 ∑ j 1 = ⎛ ⎜ ⎜ ⎝ n 2 ∑ j 1 = ⎞ ⎟ ⎟ ⎠ 우리는 특징을 합리적으로 선택하기 위하여 표본들을 4가지로 세분한 기초우에서 득 점을 계산하였다. 오유률을 분석해보면 2G 에 속하는 령역을 기미로 잘못 분류하는것이 많은 비중을 −F 득점을 리용하여 새로운 득점을 차지하므로 2G 와 기미를 나타내는 1G , 3G 사이의 ( 과 같이 계산한다. 여기서 1w 과 2w 는 2G , 1G 에 대한 iFF iFw )( )( 2 득점과 2G , 3G 에 대한 득점에 각각 어느 정도의 무게를 주겠는가를 나타내는 무게곁수 이다. iFw )( 1 GG , 3 2 , GG 1 2 + = ) ( ) 론문에서는 2G 와 3G 을 잘 분리하도록 하는데 보다 큰 의의를 부여하고 최적의 1w 과 2w 를 찾을 때 2w 를 1w 보다 크게 설정하였다. 이 득점에 기초하여 42개의 특징으로 부터 n 개의 특징을 선택하는 방법은 다음과 같다. ① 검사자료에서 계산된 특징으로부터 득점계산을 진행하고 감소순서를 정한다. ② 순서화된 특징들에 대하여 앞에서부터 몇개를 취한것들중에서 분류성능이 가장 )(iFF 를 계산하고 특 (cid:34) 에 kg , 2 라고 하면 최종특징 높은것을 선택한다. 다시말하면 검사자료에서 특징 if 로부터 득점 징들을 득점의 감소순서로 순서화한것을 42 대하여 4겹교차확인을 진행하고 정확도를 ka 라고 한다. 라고 하며 특징 arg= (cid:34) g 1 g 1 g g g a n 2 , , , , , k min k 으로 g 1 , g , 2 (cid:34) 을 선택한다. , ng 이때 매 특징의 득점은 계산된 후 크기비교에만 참가하므로 전체를 1w 로 나누고 과 같이 를 리용하면 특징득점은 w 만을 가지고 iwF )( iFF )( GG , 2 1 iF )( GG , 3 2 = + ) ( ( ) 우의 방법으로부터 특정한 w 에 대한 최적의 특징모임을 얻으며 w 를 일정한 범위에 서 변화시키면서 오유가 최소로 되는 무게곁수를 얻는다. 세분을 진행하지 않고 기미와 기미가 아닌 무리에 대한 −F 득점[3]을 리용할 때와 2 / www = 1 계산하면 된다. 비교하자. － 44 － 종합대학학보 수학 주체108(2019)년 제65권 제4호 N + 분류의 정확도는 ACC = ( N + N /() N ) , 1종의 오유는 ERR_A = N f 13 / N 으로 t 24 24 13 = N N f ERR_B 계산되며 2종의 오유는 24 t 24 / 서 1G , 3G 에 속하는 표본의 개수 즉 니라고 판별된 표본의 개수이고 그리고 24N 는 기미가 아닌 표본의 개수로서 데 기미로 판별된 표본의 개수이고 13 로 계산된다. 여기서 13N 은 기미표본의 개수로 13fN 은 실지로는 기미인데 기미가 아 13tN 은 실지로 기미인데 기미로 정확히 판별한 개수이다. 24fN 는 실지로 기미가 아닌 24tN 는 기미가 아닌것으로 정확히 판별된 개수이다. 그런데 론문에서는 기미가 아닌 머리칼령역이 기미령역으로 판별되는데 주목하고있 2fN 는 으므로 2종의 오유는 로 평가한다. 여기서 n + 와 같다. 2 n + 과 같다. 1 ERR_B_alt 이고 N f 2 / n 3 | = G | = N N = 13 n n 2 2 2 2 4 실지로 기미가 아닌 머리칼령역인데 기미로 판별되는 개수이다. 실험결과를 비교하면 표와 같다. 표．비교결과 제안한 방법 선행방법[3] ACC 0.839 0.775 ERR_A 0.242 0.251 ERR_B_alt 0.204 0.330 표에서 보는바와 같이 론문에서 제안한 방법은 선행연구[3]의 방법보다 분류의 정확 도가 더 높고 2종의 오유가 줄어든다는것을 알수 있다. 참 고 문 헌 [1] C. Y. Chang et al.; Dermatological Sciences and Applications, 3, 28, 2013. [2] C. C. Hsieh et al.; Journal of Computers, 10, 1, 12, 2015. [3] C. Y. Chang et al.; Pattern Recognition, 43, 10, 3494, 2010. 주체108(2019)년 6월 10일 원고접수 A Method to Select Features of Support-Vector-Machine Reasonably for Spot Detection from Facial Images Kim Kwang Chon, Ri Myong Chol We select features from gray level co-occurrence matrix reasonably to get higher classification accuracy when we detect spots from facial images including hair by Support-Vector-Machine. Key words: spot detection, feature selection