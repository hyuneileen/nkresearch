김일성종합대학학보 수 학 주체108(2019)년 제65권 제1호 근사최대공약수문제에 기초한 한가지 공개열쇠암호체계 곽위성, 김철은 우리는 량자콤퓨터로도 풀수 없는 첨단암호로서 안전성이 근사최대공약수문제의 계 산복잡성에 기초한 한가지 공개열쇠암호체계를 연구하였다. 씨인수분해문제나 리산로그문제의 곤난성에 의거하고있는 RSA암호나 타원곡선암호들 을 비롯한 공개열쇠암호들이 량자콤퓨터에 의한 단축공격법으로 쉽게 풀린다는데로부터 최 근 안전성이 담보되는 새 세대 암호를 개발하기 위한 연구가 본격적으로 진행되고있다.[4] 현재 널리 연구되고있는 새 세대 암호들중 실용화의 측면에서 주목을 끌고있는것은 암복호화알고리듬이 단순한 옹근수모둘연산들로 정의되고 암호문들에서의 문자렬검색을 비롯한 다양한 연산을 안전하게 보장하는 공개열쇠암호체계이다. 이런 암호체계의 안전성은 근사최대공약수(AGCD)문제의 계산복잡성에 의거하고있다.  AGCD문제는 어떤 씨수 혹은 몇개의 씨수들의 적의 근사공배수가 여러개 주어졌을 때 그것들의 공약수를 계산하는 문제로서 현재 오유동반학습(LWE)문제보다 더 어려운 문제로 알려져있다. 선행연구[1]에서 처음으로 제기된 AGCD문제에 의거하면서 옹근수연산으로 정의되는 공개열쇠암호체계는 1bit단위로 암, 복호화가 진행된다는 결함을 가지고있다. 선행연구[2, 3]에서는 AGCD변종문제(주어진 근사공배수들중에 근사값이 0인 수가 1개 끼워있는 경우의 AGCD문제)에 기초하여 한번에 여러bit들을 처리할수 있는 다중비트공개 열쇠암호체계를 제기하였지만 안전성의 기초로 되는 AGCD변종문제의 계산복잡성이 AGCD문제보다 떨어지므로 량자콤퓨터에 의하여 비공개열쇠의 일부를 쉽게 알아낼수 있 다는 약점을 가지고있다. 론문에서는 AGCD문제에 안전성의 기초를 두고있으면서 옹근수연산으로 정의되는 공개열쇠암호체계에 대한 선행연구들에서 나타난 결함들을 극복할수 있는 새로운 다중비 트공개열쇠암호체계를 제기하였다. 우선 몇가지 기호들을 약속하자. ϕ←a 는 분포 ϕ에 따르는 우연량의 표본값을 선택한다는것을, 서 원소 a 를 평등우연적으로 선택한다는것을, 그런 옹근수가 2개 있다면 큰수를 선택한다는것을 의미한다. a ← 는 모임 A 에 ][x 는 x 에 가장 가까운 옹근수로서 만일 A CRT p ,1 (cid:34) , p k ( a 1 , (cid:34) , a k ), a i 는 반열린구간 의 수로서 씨수 ,1 (cid:34)p , ⎡ −∈ ⎢ ⎣ p i 2 , p i 2 ⎞ ⎟ ⎠ ⎡ ,0 ⎢ ⎢ ⎣ k ∏ i 1 = ip ⎞ ⎟ ⎟ ⎠ ,1 (cid:34) 로 되는것을 의미한다. 중국나머지정리에 의하면 이 a ka , kp 로 나눈 나머지가 각각 런 수는 항상 유일존재한다. 즉 CRT p ,1 (cid:34) , p k ( a 1 , (cid:34) , a k ) = 1 − ˆ(ˆ ppa i i i mod p i mod T , ∏ : = T ip , :ˆ p i = ⎞ ⎟ ) ⎟ ⎠ k i 1 = T p i = k ∏ j 1 = p j p i ⎛ ⎜ ⎜ ⎝ k ∑ i 1 = 근사최대공약수문제에 기초한 한가지 공개열쇠암호체계 － 101 － η－비트씨수 p ,1 (cid:34) , 들에 대하여 다음과 같은 분포를 정의하자. Φ ( ρ p 1 , (cid:34) , p k {:) = CRT p 1 , (cid:34) , r 1 , (cid:34) , r k |) r i D ( , ργ p 1 , (cid:34) , p k :) = x = q ∏ p i qr ←+ Z ∩ { ∩ Z ← [ γ 2 ,0 ρρ )}2,2( − ) ∏ r , p i Φ← ( ρ p 1 , (cid:34) , p k }) kp ( p k D , , ργ ( p 1 , j (cid:34) , p k :) = = y = CRT { 정의 분포 p 1 , (cid:34) , 0,( (cid:34) [, p ,]2/ (cid:34) , 0) + q j p k ∏ p i qr ←+ D (cid:34)ργ ( 1 p , , , kp ) 와 평등분포 ∩ZU ( Z ∩ [ γ 2 ,0 ))2,0[ ) , 을 구별하는 문제를 ∏ Φ← ( ρ p i γ r p 1 , , p (cid:34) })  , ( ) γηρ , k −−k AGCD판정문제, 분포 제를 −− k , ( , j) , γηρ ) ( , , −− k γηρ 라는것을 쉽게 알수 있다. 즉 면 j) D p ( 1 AGCD판정문제라고 부른다. , , ργ (cid:34) p ) , , k j 와 평등분포 ∩ZU ( ))2,0[ 을 구별하는 문 γ AGCD판정문제와 AGCD판정문제는 동등한 판정문제 ( , , , γηρ AGCD판정문제의 다항식시간판정기가 존재하 ( , ) −− k γηρ −− k j) , , , ( , γηρ 따라서 LWE문제의 AGCD문제에로의 귀착관계를 고려하면 AGCD문제의 다항식시간판정기도 존재하며 그 거꿀도 성립된다. ) ( , γηρ −− k −− k , AGCD판정 문제는 량자콤퓨터로도 풀기 어렵다는것을 알수 있다. 이제부터 λ는 보안파라메터, ρ는 오유항의 길이, η는 비공개열쇠(씨수)의 길이, γ 는 암호문의 길이, τ 는 공개열쇠로 주어지는 근사공배수의 개수, k 는 비밀열쇠개수(통보 문공간의 차원수)로 약속한다. 이 파라메터들사이에는 다음과 같은 관계가 성립된다고 가정한다.[2] 먼저 입력값이 생성알고리듬 2 2ηγ ≥ , ) λ log/ λρ≥ , (( ) − Ω≥ +≥ λγτ ρηλ γ 이고 출력값이 비공개열쇠 sk 와 공개열쇠 pk 인 열쇠 , , , , k, τγηρλ ) kτγηρλ ,( KeyGen , , , , ,1 (cid:34) 를 선택하고 kp p ,0 (cid:34)=i p )들을 선택하고 필요하면 번호를 다시 매겨 에 대하여 보자. 로 놓는다. ,{: p = 1 , ( 2 + τ, (cid:34) kp sk , D 2 } , x i 걸음 １ η－비트홀씨수 걸음 ２ (cid:34)ργ← ( 1 p 가 되도록 한다. } , max{ x , , τx x 0 1 에 대하여 걸음 ３ ,1 (cid:34)=∀ , k 1,{ (cid:34) ) j , , k , 0x 이 τ(cid:34) 의 부분모임 jS 를 우연선택한다. }, : y = ⎛ ⎜ ⎜⎜ ⎝ , τx } 입력값이 공개열쇠 pk , k 차원평문벡토르 (cid:34)= ,{: x 0 (cid:34)= ,{: y 1 걸음 ４ CRT ,0( [, (cid:34) ky (cid:34) , , , X Y p p 1 } p , , j j j k ,]2/ (cid:34) )0, + x i ∑ Si ∈ j ⎞ ⎟  mod ⎟⎟ ⎠ x 0 } YX pk = ,{: m (cid:34) ( 1 km , ) 에 대하여 보자. =m , m 의 암호문 c 인 암호화알고리듬 (Enc mpk , ) 걸음 １ 모임 1,{ τ(cid:34) 의 부분모임 S 를 우연선택한다. }, ( }1,0{∈im )이고 출력값이 걸음 ２ c : = ⎛ ⎜ ⎜ ⎝ k ∑∑ x + j Sj ∈ i 1 = ⎞ ⎟ ⎟ ⎠ ym i i mod x 0 =m 다음으로 입력값이 비공개열쇠 sk , 암호문 c 이고 출력값이 k 차원평문벡토르 m (cid:34) , ( 1 걸음 sk 에 대하여 보자. )인 복호화알고리듬 }1,0{∈im (cid:34) m , = km =m ( ] )2 mod ] 2, mod /2[, /2([ (Dec pc (cid:34) c ) ( ) ) , , , k pc 1 m 1 k ⎛ ⎜ ⎜⎜ ⎝ ⎞ ⎟ ⎟ ⎠ ∑ Sj ∈ k ⎛ ⎜ ∑ ∑ m i ⎜ ⎝ c = St ∈ 1 = i i － 102 － 종합대학학보 수학 주체108(2019)년 제65권 제1호 복호화알고리듬 보조정리 １ k 차원평문벡토르 , ) c (Dec sk 의 정확성에 대하여 론의하자. m (cid:34) }1,0{∈im ( 1 , Ri 가 성립된다. 에 대하여 어떤 옹근수 iQ 와 조건 + =m ]2/ km = c ) ( , | , i k 임의의 ,1 (cid:34)= 옹근수 iR 가 존재하여 k 증명 c = ⎛ ⎜ ⎜ ⎝ ∑∑ x + j ym i Sj ∈ i 1 = i i + pmRQp [ i i i ⎞ ⎟ ⎟ ⎠ mod = x 0 i )의 암호문을 c 로 표시하면 τ k (2| ≤ + 2(1) − )1 을 만족시키는 ρ = m i CRT p 1 , (cid:34) , p k ,0 (cid:34) , ⎛ ⎜ ⎜⎜ ⎝ k ∑ i 1 = ⎛ ⎜ ⎜ ⎝ ⎛ ⎜⎜ ⎝ p i 2 ⎡ ⎢ ⎣ , ⎤ ⎥ ⎦ k (cid:34) 0, ⎞ ⎟⎟ ⎠ ⎞ ⎟ +⎟ ⎠ ⎛ ⎜ ∑ ∑ m i ⎜ ⎝ ⎞ ⎟ ⎟ ⎠ 이 존재하여 웃식은 다음의 식과 같다. ⎞ ⎟  mod ⎟⎟ ⎠ ∑ St ∈ Sj ∈ + 1 = x x x 0 i j t i 이때 적당한 옹근수 F 와 kG ≤ =+ τττ ( + k )1 CRT p 1 , (cid:34) , p k , (cid:34) , m i , (cid:34) , m k ⎛ ⎜⎜ ⎝ m 1 ⎡ ⎢ ⎣ p 1 2 ⎤ ⎥ ⎦ p i 2 ⎡ ⎢ ⎣ ⎤ ⎥ ⎦ p k 2 ⎡ ⎢ ⎣ ⎤ ⎥ ⎦ ⎞ +⎟⎟ ⎠ F ∏ p i + k ⎛ ⎜ ∑ ∑ m i ⎜ ⎝ St ∈ 1 = i i ⎞ ⎟ ⎟ ⎠ ∑ Sj ∈ x t + x j − Gx 0 x j (cid:34)ργ← ( 1 p D , , , p k ) 이므로 어떤 jiq 와 ρρ−∈jir )2,2( 이 존재하여 x j = qp i ji + r ji 가 성립되며 따라서 c ≡ r ti + r ji − Gr 0 i mod p i 이다. m i p i 2 ⎡ ⎢ ⎣ ⎤ +⎥ ⎦ k ⎛ ⎜ ∑ ∑ m i ⎜ ⎝ St ∈ 1 = i i ⎞ ⎟ ⎟ ⎠ ∑ Sj ∈ ⎞ ⎟ ⎟⎟ ⎠ R i : = r t + r j − Gr 0 으로 놓으면 c ≡ mR + i i mod p i 이므로 어떤 옹근수 ⎛ ⎜⎜ ⎝ ⎡ ⎢ ⎣ ⎞ p ⎤ i 2 ⎟⎟ ⎥ ⎦ ⎠ iQ 가 있어서 [ i pmRQp i i + + i i ]2/ 가 성립된다. iR 의 웃한계를 구해보면 | R i | = r t + r j − Gr 0 ≤ k ⎛ ⎜ ∑ ∑ m i ⎜ ⎝ St ∈ 1 = i i ⎞ ⎟ ⎟ ⎠ ∑ Sj ∈ k ⎛ ⎜ ∑ ∑ m i ⎜ ⎝ St ∈ 1 = i i ⎞ ⎟ ⎟ ⎠ ∑ Sj ∈ r t + r j + | Gr 0 τ k (2| ≤ + 2(1) − )1 ρ 이므로 보조정리가 증명된다.(증명끝)  ,{ 1 p 보조정리 ２ 비공개열쇠 옹근수 (Dec i , , : ) c i , + = = (cid:34) ]2/ [ i 가 성립된다. ( ))1 kτ pmRQp i i ) ( sk c m 1 정리 １ ρη mpk ) , >− ρη + km >− + 은 평문 m 으로 복호화된다. 4 (Enc 증명 log( log( ( kτ ))1 + + + 4 : c = = (cid:34) sk 를 줄 때 임의의 kp } , 에 대하여 k 차원2진벡토르 i ,1 (cid:34)= , k 에 대하여 | R i , m (cid:34) , ( 1 | p < i km 2/14/ − 와 ) 이면 일 때 평문 =m : ( m (cid:34) , 1 , km ) , }1,0{∈im 의 암호문 ρη >− log( ( kτ + 4 ⇔ 가 성립된다고 가정하면 다음의 식이 성립된다. ρη − 2 kτρ (22 η kτρ (228/2 > 2/14/ − ⇔ 2 1 η − (16 τ (2 τ k ⇔ 2/1 2)1 4))1 + log( )1 + = + − + > > + ( τ 2 ρ k + k ))1 + 2 1 η − 4/ > )1 ⇔ (2 τ k + 2)1 − 2/1 > + 2)(1 − 1) 이 성립되므로 우의 마지막부등식으로부터 부 ⇔ ρ 한편 2 1 η − 등식 2/14/ − > (2 τ k + 2)(1 ip 가 η비트옹근수이고 ip 보조정리 1로부터 임의의 i )1 ρ (2 τ k ρ − 이 나온다.  1) 12 − > η ,1 (cid:34)= 이므로 k , | Ri (2| τ k ≤ + 2(1) − )1 을 만족시키는 옹근수 iR 가 존재하여 c = ρ ρ k + (2 τ 2(1) )1 <− 에 대하여 어떤 옹근수 iQ 와 조건 2/14/ − ip 이 성립된다. (2| Ri k ≤ τ [ i ]2/ pmRQp i i + + | i i 이다. + 1) 근사최대공약수문제에 기초한 한가지 공개열쇠암호체계 － 103 － + 2(1) ρ )1 <− p i 2/14/ − 이므로 보조정리 2에 의하여 (Dec sk , c m=) 이 성립 | (2| τ ≤ R i 된다.(증명끝) k 보조정리 ３[1] 분포 x 1 , (cid:34) , x τ , xs i i x 0 ′ x 1 , (cid:34) , ←′ x τ Z , s 1 , (cid:34) , s τ ← x 0 ⎧ ⎛ ⎪ ⎜ ⎨ ⎜ ⎪⎩ ⎝ ⎛ ⎜ ⎜ ⎝ τ ∑ i 1 = ⎞ ⎟  mod ⎟ ⎠ ⎞ ⎟ ⎟ ⎠ ⎫ ⎪ }1,0{ ⎬ ⎪⎭ 과 평등분포 xU Z 의 확률거리는 ) ( 1 +τ 0 x τ 2/2/0 보다 작다. 정리 ２(안전성정리) 론문의 공개열쇠암호체계는 ) ( , γηρ , −− k AGCD판정문제를 풀 AGCD판정문제를 풀기 힘들다는 기본가정으로부터 공개열쇠 pk 기 힘들다는 가정밑에서 CPA 안전하다. −− k ( , ) γηρ 증명 , γ )2,0[ 와 ∩Z 우에서 평등우연적으로 취하여 만든 거짓공개열쇠 , (cid:34) =′ }} {{ kp x , ′ (cid:34) τ , x ′ ,{}, y 1 ′ ky ′ 0 는 계산구별불가능하다. +≥ λγτ 한편 가정 2 + 2 와 보조정리 3으로부터 분포 ⎧ ⎛ ⎪ ⎜ ⎨ ⎜ ⎪⎩ ⎝ ( , , , ′ x 1 (cid:34) ′ x τ ⎞ ⎟  mod ⎟ ⎠ xU Z 사이의 확률거리는 λ−2 보다 작다. ←′ x τ ∑ ⎛ ⎜ ⎜ ⎝ (cid:34) ′ x 1 ′ x i Si ∈ x ) 0 , , ⎞ ⎟ ⎟ ⎠ 1 +τ 0 , S ← ,1{ 2 (cid:34) , } τ Z x 0 ⎫ ⎪ ⎬ ⎪⎭ 와 평등분포 따라서 분포 ′ xx 10 , (cid:34) , ←′ x τ Z x 0 , S ← ,1{ 2 (cid:34) }, τ 와 평등분포 U ∩Z ( 0,[ 0x )) ⎧ ⎛ ⎪ ⎜ ⎨ ⎜ ⎪⎩ ⎝ ′∑ x i Si ∈ ⎞ ⎟  mod ⎟ ⎠ ⎫ ⎪ ⎬ ⎪⎭ 의 확률거리도 λ−2 보다 작다. 이로부터 공격자가 실지 암호문과 평등우연적으로 선택된 우연수를 정확히 구별할 확률은 λ−2 보다 작다.(증명끝) 참 고 문 헌 [1] M. V. Dijk et al.; Fully Homomorphic Encryption over the Integers, Springer, 24～43, 2010. [2] J. S. Coron et al.; Batch Fully Homomorphic Encryption over the Integers, Springer, 315～335, 2013. [3] J. S. Coron et al.; Scale-Invariant Fully Homomorphic Encryption over the Integers, Springer, 311～328, 2014. [4] D. J. Bernstein et al.; Post-Quantum Cryptography, Springer, 1～10, 2009. A New Public-Key Cryptosystem Based on the AGCD Problem 주체107(2018)년 9월 8일 원고접수 Kwak Wi Song, Kim Chol Un We present a new public-key cryptosystem over integers that its security is based on decisional AGCD problem. Our cryptosystem is tolerant of quantum attacks and has the advantage of existing cryptosystems that the length of cipher texts is short. Key words: public-key cryptosystem, AGCD problem