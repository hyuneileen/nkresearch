김일성종합대학학보 물리학 주체109(2020)년 제66권  제2호 최소２제곱법에 기초한 위상풀기방법 박일준, 김철수 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《첨단과학기술분야에서 세계적경쟁력을 가진 기술들을 개발하기 위한 투쟁을 힘있게 벌려야 합니다.》 첨단측정기술의 하나인 수자홀로그라피간섭법은 변형, 변위, 온도 등과 같은 물리적 량들을 정밀하게 측정하는데 널리 리용되고있다.[1] 위상풀기는 수자홀로그라피간섭법을 비롯한 모든 간섭측정방법에서 간섭무늬해석의 마지막공정으로서 반드시 거쳐야 할 단계 이다. 홀로그라피간섭무늬에는 레이자스펙클과 광학계의 결함들에 의한 잡음이 불가피하 게 포함되는데 이것은 위상풀기에 큰 난관을 조성하며 이를 극복하기 위하여 푸리에변환 법, 유리점인도방법, 려파에 의한 위상풀기 등 각이한 알고리듬들이 제기되였으나 계산속 도가 느리므로 실시간측정에 리용할수 없는 결함이 있다.[2－4] 론문에서는 잡음견딜성이 강하고 풀기속도가 매우 빨라 실시간측정에 리용할수 있는 한가지 화상처리수법인 최소2제곱법에 의한 위상풀기알고리듬을 제기하였다. １. 최소２제곱법에 의한 위상풀기알고리듬의 원리 일반적으로 위상풀기는 π2mod 화상의 위상비약점들을 찾아 그 점들의 위상에 π2 를 더해주거나 덜어주는 방법으로 진행한다. 즉 위상풀기는 이웃화소들사이의 위상차 가 π 를 넘는 위상비약점들을 찾는 문제에 귀착된다. 이러한 위상풀기를 다른 측면에 서 고찰하자. π2mod 위상, )(rφ 를 풀이된 위상이라고 할 때 그것들사이에는 다음과 같은 )(rψ 를 관계가 성립한다. ψ ([ rWr )( φ = )] = φ r )(2)( rk π − (1) = rk )( )(rk 는 φ r ]2/)([ π 에 의하여 결정되는 함수로서 위상비약부분마다 옹근수값 여기서 을 가지는 계단모양의 함수이다. 따라서 위상비약항인 는 )( )(rk 가 상수값을 가지는 부분에서 0이고 위상비약점들에서는 π2 근방의 값을 가지는 함 수로 된다. rkπ 의 그라디엔트 2 )2( 2 ππ k∇ Wr )( 여기서 W[…]는 위상묶기연산자, ∇ 는 그라디엔트연산자이다. 식 (2)를 만족시키는 함수 )(rφ 는 식 (2)의 량변을 일정한 경로 C 에 따라 적분하는 방법으로 구한다. (2) [ ∇= ( ψ φ ∇ )] r φ )( r = φ 0 + ∫ ∇ [ W ( ψ r )] dr (3) 합리적인 적분경로 C 를 선택하는 문제는 C π2mod 위상무늬가 잡음이 많이 섞이지 않 은 경우에는 간단하지만 잡음이 많이 섞인 경우에는 쉽지 않으며 여러가지 문제점들이 제기된다. 위상풀기는 식 (2)를 만족시키는 함수 )(rφ 를 찾는 문제 즉 다음과 같은 최소2제곱 － 4 － 종합대학학보 물리학 주체109(2020)년 제66권 제2호 문제에로 귀착된다. ||min φ W [ ∇ ( ψ r )] ∇− φ r ||)( (4) 최소2제곱법은 정확도가 높고 효과적인 알고리듬이지만 사전에 자료의 평활화를 하 여야 하고 연산과정에 발생한 오차가 전체 화상으로 전파되는 결함이 있다. 론문에서는 이런 결함을 극복하기 위한 한가지 방도로서 둥그리기에 의한 최소2제곱 법알고리듬을 제기하였다. 여기서는 π2mod 위상 그자체가 아니라 식 (1)의 위상비약항에 해당되는 rkπ 를 취급하는 방식으로 이전의 최소노름법에서 나타나던 오유퍼짐현상을 2 쉽게 극복할수 있다. )( 이제 식 (1)의 량변에 그라디엔트를 취하고 π21/ 을 곱하면 다음과 같은 식을 얻을수 있다. 1 2 π 1 2 π ψ =∇ k∇−∇ φ (5) 량변에 옹근수연산자를 적용하면 1 ⎡ ⎢ 2 π ⎣ )(rk 가 옹근수값함수이므로 ⎤ =⎥ ψ ⎦ 1 2 π ⎡ ⎢ ⎣ ∇ 로 된다. 여기서 함수 서 다음의 식이 성립한다. kφ ∇−∇ (6) ⎤ ⎥ ⎦ k∇ 도 역시 옹근수값만을 취하며 따라 1 2 π ⎡ ⎢ ⎣ ∇ ⎤ =⎥ ψ ⎦ 1 2 π ⎡ ⎢ ⎣ ∇ ⎤ k∇−⎥ φ ⎦ (7) 이 식에서 )(rφ 는 련속위상무늬를 나타내는 함수이므로 이웃한 임의의 두 점사이의 위상차는 그 절대값이 π 를 넘지 않으며 따라서 위상무늬구역 Ω 의 임의의 점 r 에 대 하여 | ∇ φ |)( r < , π Ω∈∀ r (8) 이며 이 성립한다. 이로부터 1 2 π 1 2 ⎡ ⎢ ⎣ 1 2 π ⎤ ∇φ =⎥ ⎦ <∇φ (9) 0 (10) k =∇ k k ⎡ ⎢ ⎣ x y ⎤ −=⎥ ⎦ ⎡ ⎢ ⎣ 1 π2 ∇ ⎤ ψ ⎥ ⎦ (11) 이라는 결과가 얻어지며 이것을 식 (7)에 대입하면 다음의 식을 얻을수 있다. 여기서 xk , yk 는 함수 k 의 가로 및 세로방향그라디엔트이다. 함수의 그라디엔트를 알고 그로부터 본래의 함수를 얻어내는 과정은 식 (4)에서 보 )(rψ 에는 위상잡음에 대한 정보가 포함되며 )(rk 는 잡음의 )(rk 를 다룰 때 오유의 발생확률을 낮출수 있다는것을 중 어느 한 여준 최소노름과정과 비슷하다. 이것은 위상풀기과정에 오유를 발생시키는 주요한 요인으로 된다. 그러나 영향을 많이 받지 않으며 이것은 의미한다. 또한 임의의 값을 가질수 있는 )(rk∇ 는 값만을 가질수 있으므로 자료량이 적고 잡음의 영향을 적게 받는다. π2mod 위상 와는 달리 }1 ,0 ,1{ − )(rψ∇ + 최소2제곱법에 기초한 위상풀기방법 － 5 － 간섭측정에서 얻는 위상자료는 수자화상처리장치를 통하여 받는 자료이므로 표본화 위상, 풀이된 련속위상, 위상비약항에 해당한 함수 는 직4각형구역 Ω 에서 정의된 행렬모양의 함수로 된다. 이제부터 표시를 된 행렬이다. 이때 r )( ), ,φψ 간단히 하기 위하여 독립변수 r 를 생략하겠다. π2mod rk )( r ( 일반적으로 크기가 NM × 인 행렬형식의 리산함수 f 의 그라디엔트는 다음과 같다. f =∇ f x ∂/∂ f y ∂/∂ ⎡ ⎢ ⎣ ⎤ =⎥ ⎦ ⎡ ⎢ ⎣ f f x y ⎤ =⎥ ⎦ T fL x fL y ⎡ ⎢ ⎢ ⎣ ⎤ ⎥ ⎥ ⎦ (12) 여기서 xL , yL 는 가로 및 세로방향으로의 리산미분연산자행렬이며 첨자 T는 행렬의 전 위를 나타낸다. xL = ⎡ ⎢ ⎢ ⎢ ⎢ ⎣ − 1 1 11 − ⎤ ⎥ ⎥ ⎥ ⎥ 11 ⎦ − (cid:37)(cid:37) , yL = ⎡ ⎢ ⎢ ⎢ ⎢ ⎣ − 1 1 11 − ⎤ ⎥ ⎥ ⎥ ⎥ 11 ⎦ − (cid:37)(cid:37) ( N ) N 1 ×− ( M ) M 1 ×− (13) 따라서 이다. k =∇ k k ⎡ ⎢ ⎣ x y ⎤ =⎥ ⎦ T ⎡ ⎢ ⎢ ⎣ kL x kL y ⎤ ⎥ ⎥ ⎦ −= 1 π2 ⎡ ⎢ ⎣ ∇ ⎤ ψ ⎥ ⎦ (14) 함수의 그라디엔트로부터 본래의 함수를 구하는 문제는 노름최소화문제로 풀수 있다. 우리의 경우 함수가 행렬로 주어졌으므로 행렬에서 많이 리용하는 노름인 프로베니우스 의 프로베니 노름(Frobenious norm)을 리용하여 이 문제를 풀어야 한다. 행렬 A = ( ) NMija × 우스노름은 다음과 같이 정의한다. ~ k 에 근사한 함수를 k 된다. 1 2 N || || M A ⎛ ⎜ = ∑∑ ⎜ ⎝ ~ 을 구하는 문제는 다음의 노름최소화문제에 귀착 로 놓으면 k (15) ⎞ ⎟ ⎟ ⎠ ija 1 = 1 = F 2 | | j i || k x − ~ T Lk x || 2 F + || k y − ~ kL y || 2 F (16) 우의 노름최소화식에서 k , 는 식 (14)로부터 얻어지는 값이고 x k y ||(cid:34) 는 프로베니 F|| 우스노름을 의미한다. ~ 식 (16)에서 구하려는것은 k ~ 이므로 식 (16)을 k ~ 놓아서 푼다. 행렬 k 렬은 구해야 하는 위상비약항에 해당한 함수로 된다. 이 함수 k 는 옹근수값함수이므로 에 관하여 미분하고 그것을 0으로 은 식 (16)의 노름최소화요구를 만족시키는 행렬이며 따라서 이 행 ~ round k ( ) k = (17) 로부터 문제의 요구에 부합되는 함수 k 를 구한다. 위상풀기의 마지막단계는 식 (1)로부 터 π2mod 위상에 위상비약항 kπ2 를 더하여 진행한다. = kπψφ 2+ (18) － 6 － 종합대학학보 물리학 주체109(2020)년 제66권 제2호 ２. 수자홀로그라피간섭무늬의 해석 론문에서는 우선 2차원가우스함수모양의 위상분포로부터 π2mod 위상을 만들고 여기 에 잡음을 추가하여 얻은 위상무늬에 우의 방법을 적용하여 위상을 푸는 방식으로 알고 리듬의 효과성을 검증하였다. 그림 1의 ㄱ)는 크기가 256× 화소인 2차원가우스분포형 π2mod 위상이며 그림 1의 ㄷ)는 잡음이 추가된 위상, 그림 1의 ㄴ)는 그에 대응한 π2mod 위상이다. 256 ㄱ)                           ㄴ)                           ㄷ) 그림 1. 2차원가우스분포형위상(ㄱ))과 그에 대응한 회색화상(ㄴ)), 잡음이 추가된 π2mod 위상(ㄷ)) 잡음이 섞인 π2mod 위상에 앞에서 언급한 알고리듬을 적용하고 그것을 초기모의위 상무늬와 대비하면 이 알고리듬이 충분한 정확도를 보장하고있으며 잡음제거에서도 효과 적이라는것을 알수 있다.(그림 2) ㄱ)                            ㄴ) 그림 2. 초기모의위상무늬(ㄱ))와 π2mod 위상의 풀기결과(ㄴ))의 비교 모의위상무늬에 추가된 잡음의 최대값은 π 로서 대부분의 위상풀기알고리듬에서 위 상그라디엔트평가에 리용되는 턱값과 같다. 이렇게 잡음수준이 대단히 높은 모의위상무 늬에 대해서도 위상풀기가 정확하게 진행된다는것은 실험들에서 주어지는 간섭무늬에 이 알고리듬을 충분히 적용할수 있다는것을 보여준다. 최소2제곱법에 기초한 위상풀기방법 － 7 － 표에 각이한 알고리듬들의 위상풀기화상처리시간을 보여주었다. 이 측정은 MATLAB2015를 리용하여 진행하였다. 표. 각이한 알고리듬들의 위상풀기화상처리시간 알고리듬 연산시간/s 병렬식잡음면역 4.58 경로추적법 0.82 MATLAB표준함수 0.02 RLS 0.14 표에서 보는것처럼 MATLAB표준함수에 의한 화상처리시간은 다른 모든 방법들 에 비하여 확고하게 빠르지만 잡음면역성이 거의 없는것으로 하여 실천적인 의의가 없다. 론문에서 제기한 알고리듬의 화상처리시간은 경로독립법의 한가지 류형인 병렬 식잡음면역알고리듬보다 훨씬 빠르며 지어는 경로추적법보다도 빠르다는것을 알수 있다. 이것은 최소2제곱법에 의한 위상풀기방법이 속도의 측면에서 실시간적인 요구 를 거의 만족시킨다는것을 의미한다. 그림 3에 테두리가 고정된 압전박막에 일정한 세기의 직류전압을 걸어주면서 기록한 π2mod 위상의 실험자료와 위상풀기결과를 보여주었 π2mod 위상을 풀어 련속위상을 얻어내야 미소변형에 대한 측정이 완결되였다고 볼 2중로출홀로그라피간섭무늬에 대한 다. 수 있다. 실험자료에 대한 위상풀기시간을 비교하여보면 병렬식잡음면역알고리듬은 6.983s, 경 로추적법은 3.846s 걸리는데 비하여 최소2제곱법에 의한 알고리듬은 0.478s밖에 걸리지 않는다. ㄱ)                               ㄴ) 그림 3. π2mod 위상의 실험자료(ㄱ))와 위상풀기결과(ㄴ)) 둥그리기에 의한 최소2제곱법알고리듬은 종전에 제안되였던 알고리듬들에 비하여 여 러가지 우점을 가지고있다. 그것은 다음과 같다. ① 이 알고리듬에서는 려파기를 리용하지 않으므로 위상정보를 외곡시키지 않으며 측정대상의 미세한 부분의 정보도 정확히 측정할수 있다. ② 위상그라디엔트평가를 바로 이웃한 점들과만 진행하므로 무늬가 매우 조밀한 경 우에도 위상풀기가 가능하다. ③ 여러개의 위상무늬렬을 분석하여 정보를 얻어내야 하는 경우에도 적용할수 있다. ④ 단한번의 처리를 통하여 전체 구역에서의 위상풀기를 진행하므로 속도가 아주 빠 르고 계산시간이 짧은 우점이 있다. － 8 － 종합대학학보 물리학 주체109(2020)년 제66권 제2호 맺 는 말 간섭무늬로부터 얻어지는 π2mod 위상을 풀기 위한 한가지 방도로서 최소2제곱법에 의한 위상풀기알고리듬을 제기하였다. 이 알고리듬은 둥그리기와 최소2제곱법에 기초한 것으로서 간단하고 효과성이 높은 알고리듬이다. 이 알고리듬으로는 π2mod 위상 그자체 가 아니라 위상비약항에 해당되는 부분만을 취급하는 방식으로 이전의 최소노름법에서 나타나던 오유퍼짐현상을 쉽게 극복할수 있으며 위상정보의 외곡을 막을수 있다. 또한 무늬사이간격이 매우 조밀한 경우에도 적용할수 있을뿐아니라 여러개 화상의 동시처리와 실시간처리에서 효과적이다. 참 고 문 헌 [1] U. Schnars et al.; Digital Holography, Springer, 41~98, 2005. [2] Y. T. Zhang et al.; Optics and Lasers in Engineering, 50, 619, 2012. [3] O. Dalmau et al.; Optics and Lasers in Engineering, 69, 13, 2015. [4] J. S. Rigoberto et al.; Optical Engineering, 53, 2, 2014. Phase Unwrapping Method Based on Least-Squares 주체108(2019)년 12월 5일 원고접수 Pak Il Jun, Kim Chol Su A kind of least-squares unwrapping algorithm is presented as a method for retrieving π2mod phase from wrapped format data. It is a simple and efficient algorithm based on rounding procedure and least-squares minimization. Instead of processing the gradient of the wrapped phase, this algorithm extracts the gradient of phase jumps function and processes it so that the undistorted phase details can be obtained, and can solve several problems such as residue-spreading encountered in original least-squares algorithm. And it also can be applied to dense fringes and used to process several maps simultaneously, so it is effective in real-time measurements. Keywords: phase unwrapping, least-squares