김일성종합대학학보 물리학 주체110(2021)년 제67권  제3호 Geant4를 리용한 방사선CT장치의 특성량평가 강춘일, 리기성 위대한 수령 동지께서는 다음과 같이 교시하시였다. 《우리는 원자력기술을 개발하고 원자력발전소를 건설하기 위한 문제를 자체의 기술, 자체의 힘으로 자력갱생하여 완성하여야 합니다.》(《전집》 제62권 459페지) 공업용CT는 금속과 같이 치밀한 재질로 된 대상물의 내부결함이나 물질의 내부변화 상태를 측정하는 CT로서 항공우주, 기계, 전자 등 여러 공업부문에서 널리 리용되고있다. 특히 여러 나라들에서 기계설비들의 안전운영, 생산공정의 자동측정 등에 정밀도가 높은 공업용CT를 적극 개발리용하고있다.[2, 3] 론문에서는 섬광검출기묶음을 리용한 γ -CT를 제작하는데서 제기되는 공간분해능을 비롯한 CT의 특성량들을 립자수송모의프로그람 Geant4의 모의계산을 통하여 평가하였다. １．CT모의를 위한 Geant4클라스설계 공간분해능을 비롯한 CT의 특성량들을 몽떼까를로방법으로 평가하기 위하여서는 먼 저 CT와 같은 기하학적모형을 작성하고 립자수송과정을 모의하여 검출기에 기록되는 립 자의 에네르기와 세기 등을 평가하여야 한다. Geant4는 C++언어를 리용하여 객체지향프로그람작성방법으로 립자들의 물질통과과 정을 정확히 모의하기 위하여 개발한 검출기모의도구로서 거의 모든 에네르기구간에서 중성자, γ 선, 대전립자는 물론 각종 소립자들의 물질통과과정을 모의할수 있는 힘있는 몽떼까를로모의프로그람이다.[1] Geant4는 기하정의, 물질정의, 물리적모형선택, 자리길모의, 사건처리, 실행조종과 관 련된 수천개의 C++클라스들로 이루어지며 사용자는 이것들을 리용하여 모의계산을 진행 하기 위한 사용자코드를 C++언어로 작성하여야 한다. Geant4는 각이한 에네르기구간에서 립자의 종류에 따르는 여러가지 물리적모형들을 포함하고있으므로 정확한 모의계산을 진 행하기 위해서는 입사립자의 종류와 에네르기를 잘 고려하여 모형들을 선택하여야 한다. 모의조건은 다음과 같다. 검출기: CsI(1.4mm×2.6mm×4.0mm) 검출기수: 256개, 검출기간격: 0.2mm 원천: 원천에서 검출기묶음을 바라보는 각: 120°(원천과 검출기사이거리는 196mm) 1회회전각: 1° 부채속CT에서는 화상재구성을 위하여 360°의 회전이동을 보장해야 하므로 총회전걸 (661.7keV) Cs 137 음수는 360회로 된다. 로 이루어진 원기둥시편 시편: 4가지 물질(철, 알루미니움, 테플론, 폴리에틸렌)의 6가지 원기둥요소(총 24개) － 114 － 종합대학학보 물리학 주체110(2021)년 제67권 제3호 기하설계, 물질정의, 호상작용과정정의, 원천립자발생, 자료분석을 위해 사용자클라스 들의 이름과 기능을 작성하였다.(표) 사용자클라스 DetectorConstruction PhysicsList RunAction SteppingAction EventAction 표. CT−γ 모의코드의 클라스들 기초클라스 기능 G4VUserDetectorConstruction 모의기하, 물질정의 G4VUserPhysicsList G4UserRunAction G4UserSteppingAction G4UserEventAction 물리적과정정의 원천립자발생 실행조종 호상작용과정계산 축적에네르기계산 PrimaryGeneratorAction G4VUserPrimaryGeneratorAction Geant4에서는 Inventer, Qt, OpenGL을 비롯한 여러가지 그라프체계들을 리용할수 있 지만 Qt사용자대면부를 리용하였다. 시편은 철, 알루미니움, 테플론, 폴리 에틸렌으로 구성된 24개의 원기둥요소와 그것을 둘러싼 직경 100mm, 두께 1.6mm 의 철원통으로 이루어진 원기둥시편이 다.(그림 1) 수직방향에서의 분해능을 평가하지 않고 검출기의 높이가 2.6mm라는것을 고려하여 시 편의 높이를 10mm로 설정하였으며 모의공간은 중심에 원천이 놓인 480mm 12mm × 크기의 직6면체로 설정하였다. 480mm × Geant4에서 모의기하는 기하학적모양 을 결정하는 기하모형(G4Box, G4Tubs 등) 작성, 물질자료를 포함하는 론리모형(G4 LogicalVolume)작성, 다른 기하모형과 련 결하는 물리모형(G4VPhysicalVolume)작성 단계로 설계한다. 그림 1. 시편의 구조 수값의 단위는 mm임. γ -CT모의에서는 γ 선과 물질과의 호상작용과정이 중요한 역할을 한다. γ 선과 물질 과의 모든 호상작용과정들은 걸음의 끝에서 일어나므로 이 과정들은 불련속과정으로서 G4VDiscreteProcess를 통하여 실행되며 물리적모형들은 G4VEmModel을 통하여 실행된다. 물리적과정에는 γ 선과 물질과의 호상작용과정들인 빛전기효과, 콤프톤산란, 쌍발생, 전 자와 물질과의 호상작용과정들인 다중산란, 이온화, 제동복사, 양전자와 물질과의 호상작 용과정들인 다중산란, 이온화, 제동복사, 쌍소멸과정들을 포함시켰다. 원천은 점원천을 리용하였는데 립자의 에네르기는 137Cs원천에서 나오는 661.7keV로 설정하였으며 CT검출기묶음을 바라보는 립체각으로 편기시켜 발생시켰다. CT의 회전에 따르는 기하변화는 Geant4의 마크로명령에 새로운 명령(rotAngle)을 추 가하여 계산과정에 마크로화일을 통하여 직접 변화시킬수 있도록 하였다. Geant4의 마크 로명령기능을 리용하면 코드를 수정하지 않고도 모의기하와 원천립자, 호상작용과정을 비롯한 모의조건들을 변화시키면서 계산을 동적으로 진행할수 있는 우점이 있다. 계산에서 γ 량자의 절단에네르기는 20keV, 전자의 절단에네르기는 50keV로 설정하였 다. 100keV 전자들의 주행거리가 요드화나트리움에서 0.09mm이고 알루미니움에서 0.12mm Geant4를 리용한 방사선CT장치의 특성량평가  이라는것을 고려할 때 이 절단에네르기들은 계산결과에 큰 영향을 주지 않는다고 볼수 있다. － 115 － CT모의에서는 검출기에 기록되는 립자의 개수만 기록하면 되지만 산란립자들의 영 향을 분석할수 있도록 에네르기스펙트르형태로 자료를 보관하였다. 스펙트르에서 매 통 로의 에네르기간격은 10keV로 설정하였다. 화일에는 256개의 검출기에 흡수되는 γ 선의 에네르기스펙트르가 표형태로 보관된다. 모의과정에 립자호상작용의 매 단계마다 UserSteppingAction함수가 호출되여 매개 검출기 에 축적되는 에네르기를 계산한다. ２．계산결과 및 특성량평가 5 10,10,10 １）모의계산 원천의  방사능에 따르는 재구성화상의 질을 평가하기 위하여 전체  립자수를 개로 설정하고 256개의 검출기에 흡수되는 γ 선의 에네르기를 스펙트르형태 710 개 립자에 대 로 기록하였다. 시편의 회전은 0～ o 한 모의시간은 2min 30s였다. 기록수에 따르는 모의결과는 그림 2와 같다. o1 간격으로 진행하며 360 범위에서 7 6 그림 2. 기록수에 따르는 모의결과 ㄱ)－ㄷ)는 립자수가 각각 10,10,10 인 경우 5 6 7 이때 립자수에 따르는 검출기당 평균기록수는 각각 32.7, 327.4, 3 273.1개이며 상대 오차는 17.5, 5.5, 1.7%였다. ２）화상재구성 화상재구성은 MATLAB의 화상처리도구에서 부채속화상재구성함수인 ifanbeam함수를 리용하여 려파역투영방법으로 진행하였다. 려파기는 기정값인 Ram-Lak려파기를 리용하였 다. 모의자료에 기초하여 화상재구성을 위한 자료를 다음의 식에 의하여 계산한다. )( sP −= ln )( ηημ d )( sI )0( I s ∫= 0 )(sI 는 시편을 통과하여 검출기에 기록된 기록수, )0(I 은 시편을 통과하지 않 여기서 은 상태에서의 기록수, )(ημ 는 시편매질에서의 흡수곁수이다. 기록수에 따르는 화상재구성결과는 그림 3과 같다. 그림 3에서 립자수가 작을 때 밀도와 직경이 큰 Fe시편들만이 뚜렷하게 보이며 기록 수가 증가할수록 밀도가 작은 시편들과 직경이 작은 시편들이 점차적으로 검출된다는것 － 116 － 종합대학학보 물리학 주체110(2021)년 제67권 제3호 을 알수 있다. 립자수가 물질들의 0.5mm 시편들은 검출되지 않았다. 710=N 인 경우에 모든 Fe시편들이 검출되였으나 밀도가 작은 그림 3. 기록수에 따르는 화상재구성결과 ㄱ)－ㄷ)는 그림 2와 같음. ３）결과분석 및 특성량평가 흡수곁수변화 표준시편에 리용된 4가지 물질들의 γ 선(661.7keV)에 대한 흡수곁수는 다음 과 같다.[4] μ 231.8)PE( = ⋅ 10 − 3 1 − mm ( μ Teflon 328.1) = 10 − 2 1 − mm ( μ )Al = .2 026 ⋅ 10 mm ⋅ 2 − − 2 1 − 1 − μ 766 .5)Fe( = 10 ⋅ 재구성화상에서  철시편들의  중심을  지 나는 절단선에서의 흡수곁수변화는 그림 4 와 같다. mm 그림 4에서 보는바와 같이 0.5mm보다 큰  원기둥요소에서의  흡수곁수들이  비교적 정확히 계산되였다는것을 알수 있다. 그림 4. 철시편들의 중심을 지나는  절단선에서의 흡수곁수변화 물질의 종류에 따르는 흡수곁수의 변화 는 직경이 12mm인 시편들의 중심선을 지나는 절단선에서의 흡수곁수변화를 통하여 알 수 있다.(그림 5) 그림 5. 12mm 시편들의 중심선을 지나는 절단선에서의 흡수곁수 Geant4를 리용한 방사선CT장치의 특성량평가  재구성화상의 불확정도평가 재구성화상의 불확정도는 다음식으로 평가할수 있다. － 117 － N p ∑ j 1 = ′− ( μμ j j 2) N p R = 여기서 pN 는 화상점들의 전체 개수, jμ 는 재구성화상의 j 번째 점에서 흡수곁수, jμ′ 는 시편화상의 전흡수봉우리자료로 계산한 결과는 j 번째 점에서 흡수곁수이다. 전체 기록수로 계산한 결과는 2107.1 − ⋅ 이다. =R =R 3105.5 − ⋅ , 완 공간분해능평가 모의계산자료를 리용하여 제작하려는 γ -CT의 공간분해능을 평가하였 다. 그림 1에서 밀도가 큰 철시편들의 중심을 지나는 절단선에서의 흡수곁수변화로부터 1mm 직경의 철시편들의 흡수봉우리에 대응한 가우스함수의 반폭으로부터 결정되는 선 퍼짐함수를 계산하였다.(그림 6) 재구성화상과 시편의 크기를 비교하면 1개 화소에 0.29mm가 대응되며 가우스함수맞 였다. 이로부터 γ -CT의 공간분해능은 1.2mm정 mm)15.0 20.1( ± 춤에 의한 공간분해능은 도라는것을 알수 있다. 측정시간평가 화상재구성모의자료들을 리용하면 γ -CT의 분해능을 보장하기 위한 원 천의 방사능을 계산할수 있으며 반대로 원천의 방사능이 주어진 경우 합리적인 측정시간 을 결정할수 있다. 원천에서 검출기묶음을 바라보는 립체각은 Ω = ≈ 03.0 [sr]이다. S 2 R ≈ 256 ⋅ 6.26.1 ⋅ 2 196 원천의 방사능이 710 개 의 립자가 검출기에 입사하는 시간은 일 때 107.3 ⋅ Bq 9 7 10 9 ≈ s13.1 , 360개의 투영자료를 ⋅ π 4/03.0 107.3 ⋅ 얻는데 걸리는 시간은 약 408s정도이다. 이로 부터 회전이동시간과 측정대기시간, 측정자료 전송시간을 무시하면 그림 3의 ㄷ)와 같은 화 상을 얻는데 약 7min이 걸린다. 이외에도 전체 기록수에 대한 화상재구성 과 완전흡수봉우리기록수에 대한 화상재구성 결과를 분석하여 CT에서 산란선들의 영향을 알수 있다. 맺 는 말 그림 6. 1mm 철시편에서 흡수곁수(점)와  가우스함수맞춤(실선)변화 여러가지 물질과 크기로 된 표준시편에 대한 Geant4모의계산을 진행하고 립자수 에 따르는 재구성화상의 변화와 γ -CT특성량들을 평가하였다. 모의자료와 재구성화상분 석을 통하여 256개의 CsI섬광검출기( )를 리용한 CT장치의 공간 mm4.1 분해능이 약 1.2mm이라는것을 계산하였다. mm0.4 mm6.2 × × － 118 － 종합대학학보 물리학 주체110(2021)년 제67권 제3호 참 고 문 헌 [1] A. Bieberle et al.; Nuclear Instruments and Methods in Physics Research, A 572, 668, 2007. [2] E. Milhoretto et al.; Applied Radiation and Isotopes, 68, 951, 2010. [3] J. B. Kim et al.; Nuclear Instruments and Methods in Physics Research, A 693, 203, 2012. [4] L. Njejimana et al.; IEEE Transactions on Nuclear Science, 60, 5, 3633, 2013. Characteristics Evaluation of Radiation CT Device Using Geant4 주체110(2021)년 3월 5일 원고접수 Kang Chun Il, Ri Ki Song We performed the Geant4 simulation calculation on the standard sample of various materials and sizes, and evaluated the changes of reconstructed images with the number of particles and the γ -CT characteristics. The spatial resolution of the CT device using 256 CsI scintillation detectors is about 1.2mm.  Keywords: γ -CT, Geant4