김일성종합대학학보 물리학 주체108(2019)년 제65권 제4호 FPGA를 리용한 수자식다통로분석기에 대한 연구 홍성국, 강호, 김유철 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《선진과학기술을 받아들이기 위한 사업을 적극적으로 벌려야 하겠습니다.》(《선집》 증보판 제15권 499페지) 최근 ADC의 속도와 분해능이 높아지고 수자신호처리기술이 비약적으로 발전하는데 따라 직접 앞단의 임풀스신호를 받아 수자신호처리를 하여 임풀스진폭측정 및 분석을 진 행하는 완전히 수자화된 분석기가 개발되였다.[3] 론문에서는 광대역고속집적회로연산증폭기와 흐름관식ADC, 론리조종 및 자료처리가 일체화된 FPGA를 리용하여 개발한 수자식다통로분석기를 고찰하였다. １．수자식다통로분석기의 구성방법 수자식다통로분석기는 전처리부분(예비증폭기, 완충정합단)과 방사선신호파형수자화 부분(ADC, FPGA)으로 되여있다.(그림 1) 그림 1. 수자식다통로분석기구성도 수자식다통로분석기에서는 상사식다통로분석기와는 달리 전처리부분에서 간단히 증 폭, 성형을 하고 기본처리(성형려파, 기준선회복, 중첩제거, 진폭수집 등)를 FPGA에서 진 행한다. ADC에서 나온 수자자료들은 FPGA의 자료림시기억단에 기억시켰다가 임풀스실시간 기록단으로 들어간다. 임풀스실시간기록단의 Pipe, WriteEnable부분블로크가 결합되여 우연 임풀스신호를 기록하며 LengthCounter부분블로크는 매개 임풀스표본점길이를 기록하는 기 능을 수행한다. 임풀스의 진폭과 자료길이에 대한 정보를 Nios II CPU프로그람핵에 보내여 려파성형, 기준선회복, 진폭수집 등의 기능을 수행한다. FPGA를 리용한 수자식다통로분석기에 대한 연구 － 105 － CPU의 임풀스처리속도가 실시간요구에 도달하지 못하면 임풀스자료기억 FIFO 1과 임풀스자료길이기억 FIFO 2 둘중의 하나에 쓰기충만중단이 일어나며 중단처리프로그람은 자료쓰기와 임풀스기록기능을 림시정지시킨다. CPU는 FIFO의 자료를 다 처리한 다음 임 풀스기록기능을 다시 수행한다. １）려파성형 합성성형법으로 실현한 임풀스성형구성도는 그림 2와 같다. 합성성형법을 리용하여 수자신호를 성형할 때 2개의 병렬통로를 거친다. 첫번째 통로(A)에는 프로그람조종수자지 연단( am 는 평탄부파라메터), 곱하기회로가 있다. 두번째 통로(B)에도 동일하게 지연, 성형, 곱하기회로가 있지만 2개 통로의 응답이 차이나며 마지막신호출구는 더하기회로에서 얻는다. 지연단, 성형단에서 장성, 하강, 평탄 부 및 곱하기회로의 증폭곁수를 조절할수 있다. ak 는 장성면과 하강면파라메터, ad ), 성형단( 그림 2. 합성성형법으로 실현한 임풀스성형구성도 이 성형단의 출구는 오목곡률과 볼록곡률을 가지며 2개의 성형단의 응답은 장성면과 bm 로 표시하며 적당한 지 bd 를 선택하고 각이한 장성면과 평탄부를 설정한 다음 2개의 성형기출구를 합 하강면에 대해 대칭으로서 연단 bk 로 표시한다. 평탄부는 am , ad , ak , 성하여 각이한 성형출구를 얻을수 있다. 임풀스성형방법을 리용하여 다른 방법들과 비교검사를 진행하였다. 검사를 진행하기 위하여 수은접점발진기를 예비증폭기＋완충정합기＋분석기에 련결하고 고찰하려는 구역 의 시작점을 성형기의 턱으로 설정하였다. 리상적인 성형기는 장치의 잡음형태에 의존한 다. 고찰하려는 구역에서 인 사다리형성형을 리용하였다. MSPS 10 /1 = = f s T s 상사식다통로분석기와 수자식다통로분석기의 출구스펙트르는 그림 3과 같다. 설정된 통로번호는 2 800이다. 수자식성형방법은 잡음억제와 탄도결손, 신호처리속도를 고려한 평 그림 3. 상사식성형방법(ㄱ))과 수자식성형방법(ㄴ))을 리용한 경우 출구스펙트르 － 106 － 종합대학학보 물리학 주체108(2019)년 제65권 제4호 탄부가 매우 좁은 사다리형성형방법이다. 수자식성형방법의 경우에 반폭은 6.8이고 상사 식성형방법을 리용한 경우에 반폭은 9.8로서 1.5배 개선되였다.[1] ２）기준선회복 수자식기준선회복방법은 임풀스신호표본값과 린접하고있는 기준선표본값으로부터 삽 입값을 리용하는 방법으로 임풀스신호속의 기준선표본값을 구한다.(그림 4) 그림 4에서 P 는 임풀스신호표본값의 앞에 있는 기준선표본값, Q 는 임풀스신 호표본값의 뒤에 있는 기준선표본값, M 은 신호표본값개수, K 는 임풀스신호속의 기준선표본값이다. 임풀스신호표본값에 대한 기준선평가는 P 와 Q 의 함수이며 다음과 같이 표시할수 있다.[2] 그림 4. 삽입법표시도 [ˆ KnI + ] = P 1 − α i ∑ Q 1 − ∑ β j inI [ ] +− nI [ ++ Mj + ]1 (1) j 여기서 α 와 β 값을 구하여 임풀스신호의 영향을 려파제거할수 있다. 이때 출구는 다음 = = 0 0 i 과 같이 변화된다. ][ nI = ][ nB + B (2) P 와 Q 의 값이 클수록 삽입값계산결과가 더 정확하다. P 와 Q 의 최대값과 신호임 풀스의 계수속도, 수자신호표본화주파수는 서로 련관되여있다. 분할법과 삽입법을 리용한 기준선평가결과는 그림 5와 같다. 삽입법에서는 포물선려 ) 파기를 리용하고 임풀스주위의 20개의 표본점들에 대해 삽입과정을 전개하였다.( = QP 0= 이 방법의 우점은 온도에 따르는 증폭기의 편의점변화 또는 극령보상의 질이 높지 못한데로부터 생기는 기준선표류를 제거하기 위해 2차적으로 기준선회복기를 리용할 필 요가 없는것이다. 다음으로 기준선측정을 임풀스가 나타날 때 진행하므로 기준선평가값이 항상 정확하며 알고리듬을 리용하면 기준선측정과정에 기준선평균값을 자유롭게 변화시 킬수 있다. 그림 5. 분할법(ㄱ))과 삽입법(ㄴ))을 리용한 기준선평가결과 그림 5에서 보는바와 같이 삽입법은 분할법과 비교할 때 반폭이 7.8배 개선되였다. FPGA를 리용한 수자식다통로분석기에 대한 연구 － 107 － ３）진폭수집 진폭수집방법에서는 표본값크기를 직접 비교하는 방법으로 임풀스진폭의 최대값을 얻는다. 측정임풀스진폭값은 리산화된 표본값들이므로 실지임풀스진폭의 최대값에 대응하 는 시간과 측정임풀스진폭의 최대값에 대응하는 시간은 서로 차이난다. 따라서 이 두 값 을 최대로 접근시켜 진폭의 정확도를 높인다. 임풀스겹침식별은 봉우리부분겹침인 경우에 두 신호를 모두 제거하고 꼬리부분겹침 인 경우에 계수률교정방법으로 진행하였다.[3] 계수률교정방법을 수자신호처리기에서 간단히 실현할수 있으며 체계의 불감시간과 겹침제거에 의한 계수률손실을 교정할수 있게 한다. 개발한 수자식다통로분석기의 기본특성량들은 진폭변환비트수 8～14bit, 표본화속도 최대 40MSPS, 미분비선형성오차 ±0.07%이하, 적분비선형성오차 ±0.1%이하, 신호대잡음비 73dB, 장시간안정성 ±0.1%이다. ２．수자식다통로분석기를 리용한 Co 60 원천의 γ선에네르기스펙트르측정 수자식다통로분석기의 특성을 확증하기 위하여 섬광검출기 NaI(Tl)를 리용하여 표준 60 에 대해 측정을 진행하였다.(그림 6) 그림 6에서 보는바와 같이 스펙트르의 γ 선원천 Co 마지막에 있는 2개의 큰 봉우리(1.17, 1.33MeV)는 빛전자흡수와 다중산란 즉 γ 선의 에네 르기가 완전히 흡수된 결과에 생긴것이다. 대부분의 동위원소에 대하여 역산란봉우리에 해당하는 에네르기는 70～400keV에 놓 인다. 이밖에 전자의 루실현상과 X선이 스펙트르모양에 보충적인 영향을 준다.(경계효과)  측정한 에네르기스펙트르자료들은 선행연구자료[1]들과 잘 일치하였다. 그림 6. 섬광검출기 NaI(Tl)를 리용하여 측정한 Co 60 원천의 γ 선에네르기스펙트르 맺 는 말 잡음억제와 탄도결손, 신호처리속도를 고려한 평탄부가 매우 좁은 사다리형성형방법은 상사식성형방법과 비교할 때 반폭이 1.5배 개선되였다. 기준선회복법은 리론적으로 기준선 회복을 실현하는 제일 좋은 방법으로서 분할법과 비교할 때 반폭이 7.8배 개선되였다. － 108 － 종합대학학보 물리학 주체108(2019)년 제65권 제4호 참 고 문 헌 [1] 종합대학학보 물리학, 64, 3, 131, 주체107(2018). [2] 종합대학학보 물리학, 64, 1, 132, 주체107(2018). [3] Y. Moline et al.; IEEE Transactions on Nuclear Science, 62, 2, 480, 2015. 주체108(2019)년 6월 5일 원고접수 Study on the Digital Multichannel Analyzer Using FPGA Device Hong Song Guk, Kang Ho and Kim Yu Chol As a result of applying the digital trapezoidal shaping of which the width of the flat-top was very narrow with considering the effects on noise suppression, ballistic deficit and signal processing rate, half width was improved by 1.5 times above the analog shaping’s. Our applied baseline restoration method, being extremely good at baseline restoration theoretically, has improved in energy resolution by 7.8 times as compared with the shared baseline method. Key words: trapezoidal shaping, baseline restoration