김일성종합대학학보 물리학 주체108(2019)년 제65권  제4호 초음파화상에서 웨블레트잡음제거와 적응위너 려파기를 결합한 얼룩잡음제거방법 김 경 일 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《과학연구기관들과 과학자, 기술자들은 우리 나라의 실정에 맞고 나라의 경제발전에 이바지할수 있는 과학기술적문제를 더 많이 풀어야 하겠습니다.》(《선집》 증보판 제13권 173페지) 오염된 화상의 잡음제거는 화상처리에서 나서는 일반적이며 중요한 문제이다. 초음파 화상을 비롯한 화상들은 흔히 화상자료를 얻고 전송하며 변환하는 과정에 얼룩잡음과 같 은 여러가지 잡음에 의하여 오염된다. 얼룩잡음은 초음파화상에서 고유한 잡음이며 초음 파화상의 질을 떨어뜨려 의학부문에서 병진단을 어렵게 한다. 특히 초음파화상에 존재하 는 얼룩잡음은 화상의 분할과 특징추출, 식별과 같은 화상처리를 복잡하게 한다. 그러므 로 얼룩잡음제거는 초음파화상을 리용한 병진단능력과 수중목표식별능력을 높이는데서 매우 중요하다. 대표적인 얼룩잡음제거방법들은 평균려파기와 비평균중간려파기, 위너려 파기와 같은 공간령역려파방법들이다.[1] 최신화상잡음제거방법들은 웨블레트령역에서 진행한다.[1－3] 웨블레트리론은 신호와 화상처리, 통신체계들, 생물학적화상처리, 레이다, 공기음향학, 리론수학, 조종체계와 같은 많은 분야에서 리용되고있다. 웨블레트변환은 국부특징들과 예리한 변두리특징을 보존하 는 특성을 가진다. 웨블레트변환은 공간과 주파수령역에서 좋은 국부특성을 제공하기때문 에 초음파화상에 존재하는 얼룩잡음을 제거하고 화상의 특성을 잘 보존한다. 그러나 공간 령역기술들은 변두리들이 선명하지 못하고 중요한 화상정보들이 손실되는것과 같은 일부 문제들이 있다. 그리하여 초음파화상의 얼룩잡음제거는 화상의 정보손실을 최소로 하고 얼룩잡음을 최대로 낮추는 방법을 찾을것을 요구한다. 론문에서는 웨블레트잡음제거방법과 적응위너려파방법을 결합한 초음파화상의 얼룩 잡음제거방법을 제기하고 초음파화상의 얼룩잡음제거성능을 고전적인 방법들과 비교하여 평가하였다. １．웨블레트잡음제거와 적응위너려파방법 론문에서는 초음파화상의 정보손실을 최소로 하고 얼룩잡음을 최대로 낮추기 위하여 공간려파와 웨블레트변환에 기초한 잡음제거방법들을 결합하였다. 원천초음파화상 nmIU ( , ) 에 얼룩잡음 nmN , ( ) 이 섞인 초음파화상 IUSP ( nm , ) 은 다음 과 같이 표시한다. I USP ( nm , ) = nmNnmI ) + U ( ( , , ) (1) 초음파화상에서 웨블레트잡음제거와 적응위너려파기를 결합한 얼룩잡음… － 55 － 여기서 nm, 은 각각 초음파화상화소행렬자료의 행과 렬번호이다.  IUSP 초음파화상잡음제거의 목적은 으로부터 얼룩잡음을 제거하고 원천초음파 을 얻는것이다. 웨블레트잡음제거와 공간려파를 결합한 초음파화상잡음 nm , ) ( ) 화상인 nmIU ( , 제거방법은 다음과 같은 단계로 이루어진다. 단계 1: 초음파화상자료를 띠염웨블레트변환한다. 단계 2: 띠염웨블레트변환자료를 턱값처리한다.  단계 3: 적응위너려파방법을 리용하여 적응려파한다. 단계 4: 웨블레트턱값처리하고 공간려파한 곁수들을 가지고 거꿀띠염웨블레트변환하 여 얼룩잡음제거한 초음파화상을 얻는다. １）웨블레트잡음제거방법 웨블레트려파기는 얼룩잡음과 가우스잡음을 잘 제거한다. 잡음섞인 초음파화상의 띠 염웨블레트변환곁수들중에서 값이 작은 곁수들은 잡음을 나타내고 값이 큰 곁수들은 화 상의 정보를 반영한다. 상세화부분대역에 있는 값이 작은 곁수들을 웨블레트턱값처리기술 을 리용하여 수정하며 한편 근사화부분대역에 있는 값이 큰 곁수들은 변경하지 않는다. 턱값처리기술에서는 턱값과 턱값함수의 선택이 중요하다. 일반적인 웨블레트잡음제거방법은 다음과 같다. 먼저 잡음섞인 초음파화상자료를 띠염웨블레트변환한다. nmΨ , j 번째 분해준위에서 웨블레트함수는 다음과 같다. 을 웨블레트함수라고 하면 ) ( j 번째 분해준위에서 초음파화상자료 Ψ 2 nmj ( , ) = nm , j ⎞ ⎟ ⎠ 1 j Ψ⋅ 2 IUSP ( j ⎛ ⎜ 2 ⎝ nm , (2) 2 의 띠염웨블레트변환은 다음과 같다. ) nmW ( , ) = I USP ( nm , *) Ψ 2 j ( nm , ) = ⋅ I USP ( nm , *) Ψ (3) 1 j 2 ⎛ ⎜ ⎝ nm , j j 2 2 ⎞ ⎟ ⎠ 여기서 nmW ( , ) 은 초음파화상의 띠염웨블레트변환곁수, *은 중첩적분연산자를 의미한다. 다음 띠염웨블레트변환자료의 상세화부분대역곁수들에 턱값을 적용하여 턱값처리한다. 론문에서 리용한 턱값함수는 Soft턱값함수이다. ˆ nmW ( , soft ) = ) + ( nmWT , , ) (4) , ( nmW ⎧ ⎪ ( nmW ⎨ ⎪ ⎩ ,0 , ) − nmWT ( , , ) ≥ T T −≤ |) T < | ( nmW , 여기서 nmW ( , ) 과 (ˆ nmW , ) 은 각각 초음파화상의 띠염웨블레트변환곁수와 턱값처리한 띠 염웨블레트변환곁수이며 T 는 턱값(일반턱값)이다. T log2σ= L (5) median [{ =σ n n ( .0 nmnmW , :) }, 674 5 ∈ HH ] (6) 여기서 L은 전체 화소수, nσ 은 잡음의 표준편차, HH 는 초음파화상의 잡음부분대역 이다. 제거한 화상을 얻는다. 다음 턱값처리한 웨블레트곁수들을 가지고 거꿀띠염웨블레트변환을 진행하여 잡음을 － 56 － 종합대학학보 물리학 주체108(2019)년 제65권 제4호 ２）적응위너려파방법 적응위너려파기는 비평균적응공간려파기이다. 이 려파기는 중간려파기와 달리 잡음의 종류에 관계없이 일반적인 잡음제거에 합리적이다. 적응위너려파기는 평균려파기의 한 종 류이며 화상을 적응적으로 처리한다. 즉 화상의 변동이 크면 작게 평활화하고 변동이 작 으면 크게 평활화한다. 적응위너려파기는 초음파화상의 매개 화소주위의 평균값 μ와 변동 2σ 을 다음과 같 이 추정한다. μ = I η ∈ ∑ 1 MN , nm 1 MN , nm ∑ ( , nm ) (7) USP 2 USP ( , nm ) − 2 μ ] (8) NM × 이며 nma , ( ) 은 면 η를 둘러싼 복원 [ I η ∈ 여기서 려파하려는 국부이웃면 η의 크기는 = 2 σ 하려는 모든 화소이다. 적응위너려파기는 다음과 같이 실현한다.  v 2 σ 2 − 2 σ I WF ( nm , ) += μ [ I USP ( nm , ) − ] μ (9) 2v 은 잡음변동이다. 만일 잡음변동이 주어지지 않으면 위너려파기는 추정한 전체 여기서 국부변동의 평균값을 리용한다. ２．실 험 결 과 웨블레트잡음제거와 적응위너려파기를 결합한 초음파화상의 얼룩잡음제거방법의 성 능을 고전적인 잡음제거방법들과 비교하여 평가하였다. 모의실험에 리용한 원천초음파화상은 초음파화상입력장치(《Sonix OP》)로 얻은 복부 초음파화상이며 splab.cz/en/download/database/ultrasound에서 내리적재하였다. 여러가지 얼룩 잡음제거방법들의 성능을 평가하기 위하여 초음파화상에 여러가지 준위의 얼룩잡음을 추 가하고 MATLAB R2017a를 리용하여 모의실험을 진행하였다. 모의실험에 리용한 초음파화 상은 크기가 164 × 이며 8bit회색척도화상이다. 웨블레트잡음제거에 리용한 모웨블레트 는 ‘sym4’이며 분해준위는 2이다. 208 초음파화상의 얼룩잡음제거에 대한 고전적인 방법들과 론문에서 제기한 방법의 잡음 제거성능을 정량적으로 평가하기 위하여 각이한 준위의 얼룩잡음들을 초음파화상에 추가 하고 그것의 얼룩잡음제거성능평가값들을 고찰하였다.(표) MSE값이 작을수록 그리고 PSNR, ISNR값이 클수록 초음파화상의 얼룩잡음을 효과적 으로 감소시키며 CoC값이 클수록 초음파화상의 특징보관능력이 좋다. 표에서 보는바와 같이 각이한 얼룩잡음준위에서 웨블레트잡음제거와 적응위너려파를 결합한 방법의 MSE가 가장 작고 PSNR, ISNR, CoC값이 가장 높다. 이것은 웨블레트잡음 제거와 적응위너려파를 결합한 방법이 다른 잡음제거방법들보다 성능이 제일 좋다는것을 보여준다. 초음파화상에서 웨블레트잡음제거와 적응위너려파기를 결합한 얼룩잡음… － 57 － 표. 여러가지 잡음제거방법들의 성능평가 잡음 준위 잡음제거방법 성능평가지표 PSNR ISNR CoC MSE 97.55 98.30 평균려파 중간려파 위너려파 1 365.11 277.19 1 354.69 275.07 150.66 883.91 179.48 0.05 웨블레트잡음제거 113.68 1 171.50 237.88 웨블레트+평균려파 101.09 1 317.42 267.50 웨블레트+중간려파 웨블레트+위너려파 평균려파 중간려파 위너려파 93.63 57.96 183.40 167.27 1 422.28 288.80 2 297.78 466.57 726.13 796.12 147.44 161.65 283.50 469.74 95.38 0.10 웨블레트잡음제거 226.95 586.78 119.15 웨블레트+평균려파 142.74 932.94 189.43 웨블레트+중간려파 136.32 976.91 198.36 웨블레트+위너려파 106.84 1 246.43 253.09 평균려파 중간려파 위너려파 262.89 232.51 506.58 572.76 404.18 329.49 0.15 웨블레트잡음제거 327.13 407.09 웨블레트+평균려파 179.49 741.96 150.66 웨블레트+중간려파 174.92 761.31 154.59 웨블레트+위너려파 153.21 869.18 176.49 평균려파 중간려파 위너려파 310.55 295.31 428.83 450.95 512.55 259.82 0.20 웨블레트잡음제거 421.78 315.74 웨블레트+평균려파 217.20 613.12 124.49 웨블레트+중간려파 215.08 619.16 125.72 웨블레트+위너려파 190.21 700.13 142.16 102.86 116.30 66.90 82.66 87.07 91.57 52.76 64.11 135.50 135.22 134.14 134.99 135.30 135.44 136.09 135.06 134.79 132.86 134.04 135.12 135.33 135.86 134.66 134.45 132.19 133.48 135.04 135.31 135.70 134.36 133.83 131.07 132.55 134.81 134.99 135.48 이와 같이 웨블레트잡음제거와 적응위너려파를 결합한 초음파화상의 얼룩잡음제거방 법은 고전적인 방법들보다 잡음제거성능이 개선되였다. － 58 － 종합대학학보 물리학 주체108(2019)년 제65권 제4호 초음파화상에서 웨블레트잡음제거와 적응위너려파기를 결합한 얼룩잡음제거방법을 제기하고 그것의 잡음제거성능을 고전적인 방법들과 비교하여 평가하였다. 모의실험결과 들은 다른 고전적인 방법들보다 새로운 방법의 잡음제거성능이 얼룩잡음제거와 변두리보 관에서 좋다는것을 보여주었다. 맺 는 말 참 고 문 헌 [1] D. Bhonsle et al.; International Journal of Pure and Applied Mathematics, 118, 18, 1109, 2018. [2] R. Bouchouareb et al.; International Journal of Bio-Science and Bio-Technology, 6, 6, 29, 2014. [3] R. Vanithamani et al.; International Journal of Engineering and Technology, 5, 6, 5098, 2014. 주체108(2019)년 6월 5일 원고접수 Despeckling Method Combined Wavelet Denoising  and Adaptive Wiener Filter in Ultrasound Images Kim Kyong Il We proposed the despeckling method combined wavelet denoising and adaptive wiener filter in ultrasound images, and evaluated its denoising performance compared with the classical methods. Simulation results show that the denoising performance of new method was better than other classical methods in terms of despeckling and edge preservation. Key words: ultrasound image, wavelet denoising, spatial filtering, speckle noise