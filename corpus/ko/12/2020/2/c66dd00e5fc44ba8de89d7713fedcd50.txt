김일성종합대학학보 정보과학 주체109(2020)년 제66권  제2호 시각전위마당을 리용한 동적환경에서의 운동방향결정방법 최진혁, 현성규, 주대성 시각수감부가 설치된 이동로보트 등과 같은 자행체가 임의의 동적환경에서 이동하는 경우 장애물회피경로작성문제가 제기된다. 카메라를 리용하여 자행체의 이동경로를 결정 하면 대체로 이동공간에 대한 사전지식이 없이 장애물들과 충돌하지 않으면서 목적지까 지 갈수 있는 국부경로들이 동적으로 선택되여야 한다. 선행연구[1, 2]에서는 장애물이 움직이지 않는 정적대상이라고 볼 때 시각전위를 리 용한 장애물검출과 회피문제를 고려하였지만 장애물이 움직이는 동적대상에 대하여 시각 에 기초한 장애물회피의 신속성을 보장하는 문제를 원만히 해결하지 못하였다. 론문에서는 정적 및 동적대상이 장애물로 선정되는 경우 합리적인 장애물검출 및 회 피경로결정방법을 제안하였다. １．계층형광학흐름에 기초한 시각전위마당 자행체가 환경지도를 가지고있다면 타당한 경로작성은 전위마당법을 리용하여 진행 할수 있다. 그러나 실환경에서는 자행체에 환경지도가 없을수도 있으며 환경이 시간에 따라 변할수도 있다. 자행체에는 환경정보를 얻는 수감부로서 교정되지 않는 일반카메라 가 설치되여있다고 가정한다. 선행연구[3]에서는 화상쌍으로부터 광학흐름마당계산과 대상의 기하학적구조를 리용 하여 평면구역에서의 자행체의 이동조종을 진행하였다. 공간에서 화상평면에 평행인 카 메라중심을 지나는 평면구역이 주평면으로 되며 그 구역은 화상의 가장 큰 부분에 해당 된다. 장애물들이 없으면 지평면은 관측된 화상에서 주평면에 대응되며 주평면에서는 화 상의 전위마당이 론의된다. 지평면의 광학흐름과 사영변환은 화상에서 안전구역과 장애 물구역을 검출할수 있게 한다. 광학흐름마당은 카메라로부터 입력된 화상렬에서의 명백한 움직임이다. t시각에 화상 의 농담값 I(x, y, t)에 대하여 광학흐름벡토르 (u, v)는 uI x + vI y + I t 0= 을 만족시킨다. 주평면들은 벽, 바닥, 천정과 같은 평면구조들로서 5개 방향으로 인식된다. 왼쪽, 오 른쪽, 정면, 우, 아래 즉 SS ,{ 1 령역별에 따르는 광학흐름농담기둥도표를 작성하면  Hist 이다. (cid:34) = S S } [ ] f f f f , , , , , 2 5 top left bottom right r = 4/7( ≤ π 로 구성되며 기본방향은 v right < ,4/ ππ 4/ ≤ v < 4/3,4/3 ππ ≤ v < 4/5,4/5 ππ ≤ v left top bottom < )4/7 π =Γ max( f right , f , f t lef , f top bottom ) − (1) N Hist 4 와 같이 정한다. － 62 － 종합대학학보 정보과학 주체109(2020)년 제66권 제2호 화상에서 주평면은 자행체의 작업공간에서의 평면구역으로서 화상의 가장 큰 부분을 차지하며 최소한 화상의 절반을 차지한다. 화상에서 주평면이 자행체가 움직일수 있는 지평면에 해당된다고 보면 주평면의 검출은 작업공간에서의 이동조종을 위한 실행령역을 검출할수 있게 한다. 자행체에 설치된 카메라의 광축이 지표면과 사귀기때문에 자행체는 지표면에서 움직인다. 주평면에서 광학흐름의 기하학적속성을 론의하자. 33 × 행렬 H는 외부평면의 두 화 상들사이의 사영변환으로서 P =′ tnRKHHP = + ( (2) , T1), T ) − 1 K T)1, ′ =′P 는 2개의 린접한 화상들에서 대 과 같이 표시된다. 여기서 응되는 점들의 동차자리표들이다. 카메라의 이동이 적다고 가정하면 카메라의 내부파라 메터행렬과 회전 및 평행이동변환행렬로부터 계산된 행렬 H는 아핀변환 A에 의해 근사 화될수 있다. yx=P ,( ′ , yx 와 ( 아핀변환에 대한 주평면이동의 근사화를 그림 1에 보여주었다. 그림 1. 아핀변환에 대한 주평면이동의 근사화 그림 1에서 ㄱ)는 이동의 사영변환이고 ㄴ)는 화상평면에 대한 아핀변환이다. A = (3) ba d e 00 ⎛ ⎜ ⎜ ⎜ ⎝ c f 1 ⎞ ⎟ ⎟ ⎟ ⎠ 계층광학흐름마당의 검출을 피라미드변환에 기초한 다중분해능광학흐름계산알고리듬 을 리용하여 진행한다. 준위 i에서 화상의 피라미드변환 0 i I ,( yx ) = ,( yxI ), I yxiI ,( 1 + ,( yx ) ) 는 다음과 같이 표시된다. = ∑ ( i xIa αβ iN , βα ∈ − ) y βα − , (4) 여기서 iN 는 33 × 근방이고 αβa 는 근방화소들의 무게파라메터들이다. 즉 αβa = α ±= ,1 (5) ,4/1 ,8/1 ,16/1 ⎧ ⎪ ⎨ ⎪ ⎩ ,0 βα = ,0 βαβ = ,0 = 0 = 1 ±= α ±= ,1 β ±= 1 이다. 시각전위마당을 리용한 동적환경에서의 운동방향결정방법 － 63 － 아핀변환에 의해 추정된 아핀곁수들을 리용하여 계산된 평면흐름과 광학흐름사이의 정합에 기초한 주평면검출알고리듬이 매 층에서 실행될 때 화상렬에서 피라미드층 l의 광학흐름마당 광학흐름 tyxd ,( ), (DPD: Dominat Plane Detection)이라고 하면 계층형주평면검출알고리듬은 다음과 같다. 로부터 장애물을 검출한다.  로부터 주평면 를 검출하기 위한 알고리듬을 주평면 tyxu l ), ,( tyxu ,( ), l ≤≤ 최대층개수 자료: 1 , I I 0, l l t t + ltyxd ), 0≠l 3 결과: ,( 1 l: = 최대층개수 2 while  do ( Iu l :), ,( tyxd ( Iw ; 1 5      6 l 1 − I : + = t 1 l −= l : 4 = u l t l t : , I l t + = l 1 − 1 t + , 1 ; ) ( DPD u )l ; u t )l t ; 7 end 피라미드의 l번째 층의 장애물령역을 로부터 lO 이라고 하면 피라미드변환의 기하학적성질 O 과 같은 포함관계를 가진다. 이 관계는 주평면들사이에도 성립한다. O ⊃ ⊃ 0 (cid:34)1 ⊃ lO (6) 0 D ⊃ D (cid:34)1 ⊃ ⊃ lD (7) lD 에 대하여 주평면 를 만족시킨다. 이러한 계층관계는 광학흐름계산을 위한 피라미드에 기초한 화상들의 계층 표현으로부터 자동적으로 얻어진다. 결과적으로 높은 층의 화상들에서는 장애물들의 대 역적인 구성을 얻고 보다 낮은 층들에서는 장애물들의 구체적인 구성을 얻는다. 이고 화상의 전체 령역 R에 대하여 ϕ= l O ∩ l ∪ D O D R = l l ２．장애물회피를 위한 자행체의 이동방향결정 를 평활화한다.  그라디엔트벡토르마당 이동조종을 위한 시각전위는 화상순서렬로 관측된 공간의 출현모형으로부터 계산된 에서 장애물구역으로부터의 인 가 두값화상렬이고 가우스합성적연산으로 다. 그라디엔트벡토르마당을 리용하여 주평면화상 공적인 반발힘을 생성한다. 주평면사영 txd ),( txd ),( txd ),( txg ),( 는 장애물들로부터의 반발힘이고 평면흐름마당 ),(ˆ u x t 는 목적지까지의 인공반발힘이다.  ),(ˆ u x 가 카메라의 움직임을 표현하므로 전위마당 t 평면흐름 ),(ˆ u x t 와 그라디엔트벡토르마당 − 움직임을 표현하므로 화상의 장애물구역에서 평면흐름마당 화상에 장애물이 존재하지 않으면 전위마당은  ),(ˆ x u t txg ),( x ),( t −= p 는 평면흐름마당 의 합으로 된다. 그러나 평면흐름마당이 주평면의 txp ),( ),(ˆ u x 가 령으로 설정된다.  t (8) － 64 － 종합대학학보 정보과학 주체109(2020)년 제66권 제2호 와 같이 계산되며 이로부터 자행체는 평면흐름마당에 따라 움직인다. 자행체의 방향과 목적지까지의 방향각을 )(tdθ 라고 하면 목적지까지의 조종힘은                      (9) + t )( = ),(ˆ )(ˆ x x u t u cos d t )(ˆ xru )(ˆ xtu 와 와 같이 표시된다. 여기서 θ d 는 평면흐름마당의 순수한 평행이동과 회전이다.  ),(ˆ ud x 는 자행체가 장애물들이 없는 작업공간에서 목적지를 향해 이동할 t ru 때 자행체에 설치된 화상렬로부터 생성된 리상흐름이다. 순수한 광학흐름마당 는 자행체의 속도가 일정할 때 계산된다. 광학흐름 sin)(ˆ x u r tu 와 θ d t )( 자행체를 목적지까지 안내하기 위한 조종힘은 다음과 같다.  g ⎧ ⎨ g ⎩ ,(ˆ x u t d  ), d x 0),( d t = pd x 의 평균을 리용하여 조종힘 x t ),( − x ,( t ), 전위마당 x ),( t x ),( t t ),( 255 = = p d )(tp 를 정의한다. (10) )( tp = 1 A ∫ p d ,( yx T) ∈ A x ),( t dxdy (11) 여기서 |A|는 자행체에 설치된 카메라로 찍은 화상에서 주목하는 령역의 크기이다. 자행 체에 조종힘이 가해지면 평행이동과 회전의 속도로 변화되는데 조종힘 )(tp 의 각도를 리 용하여 속도들사이의 비률을 결정한다. 전위마당에서의 이동조종을 그림 2에 보여주었다. 그림 2. 전위마당에서의 이동조종 시각전위마당을 리용한 동적환경에서의 운동방향결정방법 － 65 － 그림 2에서 ㄱ)는 이동조종력이고 ㄴ)는 이동조종력과 y축사이의 각이며 ㄷ)는 )(tθ 를 리용하여 결정된 t시각에서 자행체의 이동 )(tT 와 회전각 )(tR 이다. 카메라가 자행체의 앞면에 설치되여있다고 가정하면 )(tp 와 y축사이의 각 )(tθ 가 자 행체의 전진방향으로 된다. tθ )( = arccos (12) t시각에 자행체의 위치를 X t = )( ( tYtX ), ( ( 라고 하면 (cid:5) tX )( 2 (cid:5) tY )( 2 + = tT ( ), tan 1 − = tR )( (13) 와 같은 관계가 성립된다. 따라서 조종법칙은 (cid:5) tYtR ), )( (cid:5) tX )( tT )( cos = ( = tT sin)( tR )( (14) > < tp y ( ), tp| ||y| )( T)) (cid:5) tY )( (cid:5) tX )( 와 같다. 리용할수 있다. 장애물이 이동하는 대상인 경우 국부최소값이 없는 자유마당인 라쁠라스전위마당을 경계조건은 구역내의 장애물들사이의 최단거리보다 작은 임의의 정수값들의 모임으 로서 목표점이나 목표구역에서는 령인 값을 가진다. ３．실험 및 결과분석 자행체에 대한 이동조종실험을 세가지 형태로 진행하였다. 즉 목적지에로의 전진, 로 선을 따라 이동, 주어진 대상의 회피이다.  주평면검출을 위하여 층의 최대개수를 면 l번째 층에서 검출된 장애물화상은 3=L 으로 설정하고 실험을 진행하였다. 그러 l ,( yxD ) = l ,( yxd l max( ) × ,( yxd 255 )) (15) 와 같이 표시된다. 여기서 dl(x, y)는 l번째 층에서의 d(x, y)이다. 하나의 장애물이 있는 환경에서 장애물은 출발지로부터 목적지까지의 경로를 분할하 게 된다. 목적지와 자행체방향사이의 각 )(tdθ 는  XtX ( ), 와 같이 계산된다. 여기서 D는 어진다. dθ t )( [ − ∠= 0=t 일 때 목적지의 자리표로서 자행체의 초기위치로 주 (16) )],0( t )( t )( D X X = D D D 자행체의 이동조종과 경로작성문제에 대하여 최종목적은 매 점에서의 조종력 x(cid:5) 와 구성공간 W에서 시작점 s와 끝점 d까지의 경로 C를 결정하는것이다.  t ≤≤ WPCd = tx 0|)({ xs , )0( )1( }, C ,1 = = = x ( ) (17) 이동조종 N은 (cid:5) xWfNx ), = ( ( ), (cid:5) x = CxWfS ), ( ( , ) (18) 와 같이 표시된다. 여기서 f는 촬영화상들과 같은 W의 명백한 특징이고 만일 f(W)가 W의 시각정보이라면 시각이동과 시각사보조종이 각각 존재하게 된다. 실험환경과 운동방향결정을 그림 3에 보여주었다. － 66 － 종합대학학보 정보과학 주체109(2020)년 제66권 제2호 그림 3. 실험환경과 운동방향결정 지표면검출의 오유평가를 다음의 표에 보여주었다. 표．지표면검출의 오유평가 흐레임번호 M90(e(t)/%) M80(e(t)/%) M70(e(t)/%) 1 2 3 23.1 14.4 10.5 24.2 13.1 11.7 20.33 12.3 10.2 표에서 M90, M80, M70은 각각 지표면검출률이 90, 80, 70%정도인 촬영화상렬을 의미 한다. 여기서 t시각에 아핀변환행렬 A에 대한 아핀곁수추정오차는 te )( = | A − 1 t + A t 2 | (19) 과 같이 표시된다. 광학흐름과 시각전위마당을 리용한 시각수감부가 달린 자행체의 이동조종실험을 진 행한 결과 제안된 이동조종알고리듬이 장애물들을 회피하면서도 환경지도에 대한 정보를 요구하지 않는다는것을 알수 있다. 특히 자행체이동의 변화에 로바스트적이다. 자행체의 시각전위마당을 리용한 동적환경에서의 운동방향결정방법 － 67 － 이동조종에서 기본은 목적지까지의 방향정보만을 리용하므로 출발지로 돌아오는것도 마 찬가지이다. 이때 이동조종체계는 출발지와 목적지의 위치를 보관하고있어야 한다. 시각전위마당을 리용한 이동조종알고리듬이 로보트의 조종에 능히 적용될수 있으며 동적환경에서의 실험을 통하여 그 정확성을 검증하였다. 맺 는 말 참 고 문 헌 [1] Yoav Golan et al.; IEEE Robotics and Automation Letters, 2, 3, 1280, 2017. [2] Cansen Jiang et al.; IEEE Robotics and Automation Letters, 1, 1, 324, 2016.  [3] Suman Raj et al.; IEEE Robotics and Automation Letters, 1, 1, 423, 2016. 주체109(2020)년 2월 5일 원고접수 A Method on Determinating Direction of Movement in Dynamic Environment by Using Visual Potential Field Choe Jin Hyok, Hyon Song Gyu and Ju Tae Song This paper presents an algorithm for navigating autonomous robot, using the visual potential field, from a captured image sequence on environment in which there is static or dynamic obstacle. Keywords: vision-based navigation, visual potential field, optical flow