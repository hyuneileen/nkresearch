김일성종합대학학보 정보과학 주체109(2020)년 제66권  제2호 웨브수집모형에 기초한 최량화된 수집일정작성방안 권세흔, 한금철 위대한 수령 동지께서는 다음과 같이 교시하시였다. 《새로운 과학분야를 개척하며 최신과학기술의 성과를 인민경제에 널리 받아들이기 위한 연구사업을 전망성있게 하여야 합니다.》(《전집》 제72권 292페지) 웨브수집기는 검색엔진이 사용자들에게 낡은 정보를 현시하지 않도록 국부자료기지 에 보관된 자료들을 재수집하여야 한다. 선행한 방법들[1, 2]에서는 관측된 페지들의 갱신빈도수에 따라 페지들을 재수집하는 방법과 중요도에 따라 페지들을 재수집하는 방법을 제안하였다. 그러나 이 방법들에서는 국부자료기지의 무효성척도를 고려하지 못하였다. 론문에서는 국부자료기지의 무효성척도를 고려한 웨브자료수집일정작성방법을 제안 하고 통합검색체계의 수집기에 적용하였다. １．웨브수집모형 제안한 웨브수집모형은 그림과 같다. 봉사기 1         봉사기 2    …   봉사기 N 그림. 제안한 웨브수집모형 그림에서와 같이 N 개의 봉사기와 m 개의 수집스레드가 있다고 할 때 K 는 N 개의 Ki ∈ 에 있는 웨브페지들의 모임, iWj ∈ 인 모든 페지의 용량이 jp 는 iW 는 웨브봉사기 Ki ∈ 는 체계에 있는 모든 페지들의 모임, 웨브봉사기들로 이루어진 모임, W ∪= , 한편 전체 재수집시간을 일정한 시간주기로 분할하고 페지내리적재는 어떤 시간주기 iW 라고 정의한다. 내에서 진행하게 된다. － 80 － 종합대학학보 정보과학 주체109(2020)년 제66권 제2호 그리고 매 주기의 시작에서 m 개의 스레드는 m 개 웨브페지들을 수집하게 된다. 이때 시간주기 t 의 시작시에 페지 s j 로 하는데 어떤 페지가 내리적재되였을 때 그 페지의 무효성척도는 0이고 선택되지 않은 다른 페지들의 무효성 척도는 주기가 끝난 다음 1만큼 증가하여 s j j 의 무효성척도를 로 된다. 1)( +t )(t 그러므로 웨브수집일정작성방법은 매 수집주기에서 페지들의 전체적인 무효성척도를 최소로 하는 봉사기 Ki ∈ 와 페지 iWj ∈ 를 결정하는 문제에 귀착된다. 이때 페지수집시간이 페지용량에 비례하기때문에 수집처리속도를 높이기 위해 해당 한 시간주기에서 용량이 작은 페지를 선택할수 있지만 무효성척도를 감소시키기 위해 용 량이 큰 페지가 내리적재되여야 하는 경우도 있다. 따라서 처리시간을 고려하면서 무효 성척도를 최소로 하는 수집일정방법문제가 제기된다. 여기로부터 론문에서는 단일봉사기와 단일스레드인 경우의 수집일정작성방법을 론의 하고 다중봉사기, 다중스레드로 확장하였다. ２．단일봉사기와 단일스레드방식에서의 최량화된 수집일정작성방안 1대의 웨브봉사기에서 봉사하는 웨브페지들의 모임을 W 라고 하고 1+T 개의 수집주 기들이 있다고 할 때 )(tg 를 어떤 시간주기 t 에 따르는 봉사기의 평균응답시간이라고 하면 단일봉사기에 단일스레드인 경우를 고찰하므로 어떤 시간주기 t 에서는 1개의 스레 t 에서의 일정작성방법을 드가 1개 웨브페지만을 내리적재하게 되며 따라서 시간주기 j 가 내리적재되 tx )( Wj ∈ 로 정의할수 있다. 여기서 )(tx j 는 주기 t 에서 페지 tx ( j )) = , ( 면 1 아니면 0으로 되며 따라서 다음의 식이 성립하게 된다. tx j ,1)( =∀= t ,0 (cid:34) , T − 1 ∑ Wj ∈ 한편 시간주기 1+t 에서의 페지 j 의 무효성척도를 이전 시간주기로부터 계산해보면 다음과 같은 식이 성립한다. (1) s j t ( )1 =+ 1)( = tx j tx j t ,1)( + 0)( = ,0 ⎧ ⎪ ⎨ ⎪⎩ t ( s j j x =∗ T ∑ ∑ Wj t 0 = ∈ s j min x ∗ 이 식을 주기에 대하여 전개하면 s + )1 = ( s 1)(1)( t + − j tx ( j )) 로 된다. 따라서 문제는 전 반적인 페지무효성척도를 최소화하는 방안 tx (( )) , t = ,0 (cid:34) , T − 1 을 얻는것으로 된다. )( t (2) 매 주기 t 의 시작점에서 전체 무효성척도를 추정해야 하므로 마지막일정작성은 1−T 주기의 시작에서 작성되고 페지내리적재는 1−T 주기의 마감점에서 끝나며 주기 T 의 시작점에서 전체 무효성척도계산이 진행되는것으로 보아야 한다. 전체 페지의 무효성 척도를 식 (1)로부터 고찰하면 다음과 같다. s j ( t + )1 = )( t + (| W )1| −− s )( t (3) j t )(* ∑ Wj ∈ s j ∑ Wj ∈ 여기서 j 는 주기 )(* t 식 (3)을 1−= Tt 1+t 에서 0으로 된 즉 t 주기에서 내리적재된 페지를 나타낸다. 을 리용하여 변경하면 다음과 같은 식이 얻어진다. 웨브수집모형에 기초한 최량화된 수집일정작성방안 － 81 － ∑ )( Ts j = ∑ s j )0( + (| WT )1| −− T 1 − ∑ s ′ )( t j t )'(* Wj ∈ 이로부터 임의의 주기 t Wj ∈ －，T (cid:34)= ,0 1 0 에 대하여 다음의 식이 성립한다. t =′ 결정변수 )(tx 를 리용하면 식 (4)로부터 다음의 식이 얻어진다. )0( + (| Wt )1| −− s j ′ t )(* ′ )( t (4) s j )( t = ∑ Wj ∈ s j ∑ Wj ∈ s j )( t = ∑ Wj ∈ s j ∑ Wj ∈ T t 1 − ∑ t =′ 0 t 1 − ∑ ∑ t =′ 0 Wj ∈ )0( + (| Wt )1| −− ′ )( stx j j ′ )( t (5) 식 (5)로부터 전체 무효성척도 ∑ ∑ s )( 를 구하면 다음과 같다. j t T ( + )1 ∑ s j )0( + t 0 = ∈ Wj )1 TT ( + 2 (| W )1| −− ′ )( stx j j ′ )( t (6) T t 1 − ∑∑ ∑ t = 0 t =′ 0 Wj ∈ Wj ∈ 식 (6)이 최소로 되자면 T t 1 − ∑∑ ∑ t = 0 t =′ 0 Wj ∈ ′ )( stx j j ′ )( t 가 최대값을 가져야 한다. 그런데 처리시간을 최소로 해야 한다는 점을 고려하면 다음의 식이 성립한다. max x * T t 1 − ∑ ∑ ∑ t = 0 t =′ 0 Wj ∈ T 1 − ∑ ∑ t 0 = ∈ Wj ′ )( stx j j )( t −′ )( tgptx )( (7) j j )0(2( s j − gp j ))0( x )0( + j ( s j )1( − gp j ))1( x j )1( (8) 식 (7)의 구조적인 의미를 음미해보자. 2=T 일 때 식 (7)을 전개하면 max x * ∑ 로 되고 Wj ∈ 2>T 일 때에는 ∑ Wj ∈ ∑ Wj ∈ max x * ∑ Wj ∈ + ∑ Wj ∈ ( Ts j )0( − gp j ))0( x j )0( + (( T − )1 s )1( − j gp j ))1( x j )1( + (cid:34) + ( ( Ts j )1 −− Tgp j ( − ))1 ( Tx j − )1 (9) 로 된다. 식 (9)로부터 수집일정작성방법은 어떠한 시간주기 t 에서 재수집해야 할 페지를 선 택하는 문제에 귀착되며 시간주기 t 에서의 페지선택은 다른 시간주기들과는 독립이라는 것을 알수 있다. 따라서 수집일정작성방법에서는 시간주기 t 에서의 페지선택 )(tx 를 다 음의 식이 최대로 되도록 결정하면 된다. (( ) stT − )( t − )) txtgp )( ( j j j ∑ Wj ∈ 우의 식과 ∑ j tx 1)( = Wj ∈ 로부터 다음과 같은 식이 성립한다. － 82 － 종합대학학보 정보과학 주체109(2020)년 제66권 제2호 j t )(* = arg ((max Wj ∈ stT ) − t )( − j tgp ( j )) 이 식은 매 시간주기 t 에서 봉사기의 평균응답시간 )(tg 가 주어질 때 재수집해야 할 페지선택은 s j 와 )(t jp 값에 의하여 결정된다는것을 보여준다. ( ∈∀ 결과적으로 수집일정작성방법에서는 모든 페지들의 용량이 같은 특수한 경우 j 를 선택하며 모든 페지들 , pWj s j 가 최대인 페지 이 같은 무효성척도를 가지는 경우에는 용량이 최소인 페지 ) 수집기는 무효성척도 j 를 선택한다. j = )(t p ３．모 형 확 장 ① 다중봉사기, 단일스레드일 때의 모형확장 1>N 개의 웨브봉사기들의 모임 K 를 고려할 때 매 봉사기들은 평균응답시간 )(tg j )이 웨브봉사기로부터 페 값을 가지게 되며 매 시간주기 t 에서 오직 1개 스레드만( 지를 내리적재하게 되므로 수집일정작성방법은 모든 봉사기들의 전체 무효성척도가 최소 인 방안 을 구하는 문제로 된다. 1=m * x = ( tx (cid:34) ,0 ), T = − 1 t , 1 Wj = ∈ i 매 시간주기 t 에서 어떤 봉사기의 웨브페지를 내리적재하는 스레드는 1개이므로 다 = 0 i t T N min x * ∑∑ ∑ s j )( t (10) 음의 식이 성립한다. ∑ ∑ Ki ∈ ∈ Wj i tx j ,1)( =∀= t ,0 (cid:34) , T − 1 (11) 우의 방법과 류사한 방법으로 식 (10)을 전개하면 식 (12)가 성립한다. t 1 − N T Wj i 앞에서 언급한 방법과 류사하게 다중웨브봉사기인 경우의 수집일정작성방법도 페지 1 = ∈ = 0 0 t t i =′ max x * ∑∑∑ ∑ ′ )( stx j j ′ )( t (12) 재수집시간을 최소로 하는 측면을 고려해야 한다. 따라서 다중봉사기를 위한 수집일정작성방법은 다음과 같다. 우선 봉사기들의 모든 페지들의 무효성척도가 같은( Ki ∈∀ , ∈∀ sWj , i j )( t = s ) 경우 수 집기는 )(tgp i j 가 최소인 봉사기 i 와 페지 j 를 선택하며 모든 페지들의 용량이 같은 경우 ( ∈∀ Ki , ∈∀ pWj , i j = p )에는 다음으로 봉사기들의 모든 페지들의 용량이 같은( )(tg j 가 최소인 봉사기에서 페지를 우연적으로 선택한다. Ki ∈∀ ∈∀ ) 경우에는 = p , s j )( t − )( tg i 가 최대인 봉사기 i 와 페지 j 를 선택하며 t 주기에서 = )( tg 이면 s j )(t pWj i , )( tg j j 가 최소인 페지를 선택한다. ② 다중봉사기, 다중스레드일 때의 모형확장 수집기가 1>m 개의 스레드를 리용하므로 매 시간주기 t 에서 m 개의 페지들을 재수 집해야 한다. 이 경우 식 (11)로 다음의 식이 성립하게 된다. ∑ ∑ Ki ∈ Wj ∈ i tx )( j = m , t =∀ ,0 (cid:34) , T − 1 (13) 웨브수집모형에 기초한 최량화된 수집일정작성방안 － 83 － 따라서 다중봉사기와 다중스레드인 경우의 수집일정작성방법에서는 매 시간주기 t 의 시작점에서 다음의 식이 최대인 m 개의 봉사기－페지쌍을 선택한다. ) ( stT − )( t − j )( tgp j i ４．실험 및 성능평가 제안한 방법을 통합검색체계에서 수집해야 할 홈페지 10개를 대상으로 하여 적용하 였다. 실험을 진행한 후 웨브페지수집자료기지의 페지평균무효성척도는 표와 같다. 표. 웨브페지수집자료기지의 페지평균무효성척도 페지평균무효성척도/min 제안한 방법 선행방법[1] 선행방법[2] 526.5 897.7 235.4 표로부터 제안한 방법이 웨브페지수집자료기지의 페지평균무효성척도를 선행방법[1] 보다는 2.24배, 선행방법[2]보다는 3.81배 제고하였다는것을 알수 있다. 이미 수집된 페지들의 무효성척도를 고려한 최량화된 재수집일정작성방안을 제안하 고 실험을 통하여 통합검색체계의 수집기의 성능을 검증하였다. 맺 는 말 참 고 문 헌 [1] Q. Tan et al.; ACM Trans. Inf. Syst., 28, 4, 1, 2010. [2] S. U. Khan et al.; Cluster Comput., 16, 1, 65, 2013. 주체109(2020)년 2월 5일 원고접수 Optimal Web Page Download Scheduling Policy Based on the Web Crawling Model Kwon Se Hun, Han Kum Chol We proposed an optimal scheduling method to minimize the total staleness of pages in the repository of a web crawler and proved its efficiency through the experiments with the integrated search system. Keywords: crawling, staleness, scheduling policy