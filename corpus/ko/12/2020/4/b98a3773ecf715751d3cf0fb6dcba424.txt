김일성종합대학학보 정보과학 주체109(2020)년 제66권  제4호 신경망을 리용한 넓은 시야각렌즈의 비선형이지러짐교정방법 최춘화, 김진옥 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다.  《첨단돌파전을 힘있게 벌려야 나라의 과학기술전반을 빨리 발전시키고 지식경제의 토대를 구축해나갈수 있습니다.》 지난 시기 넓은 시야각렌즈로부터 얻은 화상에서 생기는 비선형기하학적이지러짐을 제거하기 위하여 다항식에 의한 방법을 많이 리용하였다. 최근 오차역전파(BP: Back Propagation)신경망[2]을 리용하여 그 성능을 개선하기 위한 방법과 다목적이지러짐제거방법이 제안되여 교정에 리용되였다. 그러나 이러한 방법들은 넓은 시야각렌즈의 이지러짐특성을 정확히 모형화하지 못하였으므로 교정오차가 큰 결함 이 있다. 론문에서는 하나의 주어진 촬영기에 주목하여 신경망과 학습자료를 구성하여 렌즈이 지러짐교정의 정확도를 높이기 위한 방법을 제안하였다. １．교정원리와 신경망 이지러진 화상의 자리표와 표준화상의 자리표들사이의 변환식은 대수다항식이나 분 수식, 극자리표형식으로 표현할수 있다. 렌즈이지러짐교정에서는 방사이지러짐을 많이 론 하는데 중심리탈과 접촉렌즈이지러짐 등 광학계의 제작상특성들도 사실상 이지러짐에 영 향을 준다. 표준화상과 이지러진 화상을 그림 1에 보여주었다. ㄱ) ㄴ) 그림 1. 표준화상과 이지러진 화상 그림 1에서 ㄱ)는 표준화상이며 ㄴ)는 넓은 시야각카메라에 의하여 이지러진 화상 이다. 이지러짐교정을 위한 신경망의 구조를 그림 2에 보여주었다. 그림 2에서 보여준것처 럼 신경망은 입력층과 출력층외에 3개 중간층을 가지고있는 오차역전파신경망이다. 입력 x=x 1 ( , x 2 ) T 는 교정전화상자리표 ( x d x , d T) , 출력 y=y ( 1 , y 2 ) T 는 교정된 화 1y 2y 신경망을 리용한 넓은 시야각렌즈의 비선형이지러짐교정방법 － 79 － 상자리표 x=x 1 x , ( 2 T) ( x u x , u 와 y=y ( ) 에 대응된다. 입력층과 출력층은 점자리표로서 모두 2개의 신경원 즉 1 y , 로 이루어져있다. ) 2 (cid:35) (cid:35) (cid:35) 1x 2x 입력층 중간층 1 중간층 2 중간층 3 출력층 그림 2. 이지러짐교정을 위한 신경망의 구조 오차함수는 신경망의 실제출력 ( ixy 와 리상출력 ) id 사이의 2제곱오차를 리용하여 표시한다. E ( w ) = || d i − y ( wx ; i 2||) 1 2 N ∑ i 1 = 학습과정은 주어진 화상대응쌍에 대하여 레벤베르그－마르크와드(LM: Levenberg (wE 가 최소로 되도록 무게곁수들을 결정하 ) Marquardt)알고리듬[1]을 리용하여 오차함수 는 과정이다. 중간층의 세포개수가 주는 영향을 고려하여 실험적으로 중간층의 유니트수를 각각 40, 30, 20으로 한다. 중간층의 개수가 많아지면 과도적응현상이 나타나기때문에 3개의 중 간층을 준다. 신경망에서 학습과정은 최량화리론에 기초한 레벤베르그－마르크와드알고 리듬[1]이 수렴속도가 제일 빠르고 정밀도도 비교적 높다. 표본자료는 이지러진 화상과 교정화상에서 MN × 개의 표본점들을 우연적으로 선택 하여 구성한다. 신경망이 처리하는 자료수값의 차이가 비교적 크기때문에 반드시 표본자료에 대하여 정규화처리를 진행하여야 한다. 만일 정규화를 진행하지 않으면 작은 수값정보가 큰 수 값정보에 의하여 가리워지므로 학습에 영향이 미친다.  ,1[ −− 구역내에서 변화가 비교적 평탄하기때문에 전달함수는 값구역 ]0.1,9.0[ ]9.0 와 가장 적합한 정규화처리는 표본자료를 [ 9.0,9.0− ]사이에로 하는것이다. 다음의 식을 리용하여 정규화처리를 할수 있다. p =′ i P i P max × 9.0 (1) 구조의 오차역전파신경망에 의한 이지러짐교정효과 여기서 P 는 화상의 x 축 혹은 y 축자리표이다.  45 실험을 통하여 30 20 2 2 − − − − 가 가장 좋다는것을 알수 있다. 전달함수는 쌍곡탕겐스함수를 리용한다. xf )( = 2 − x − 2 x 1 − 1 + e e － 80 － 종합대학학보 정보과학 주체109(2020)년 제66권 제4호 )(xf 의 값구역은 ]1,1[− 이며 도함수의 값구역은 에 도달하는것이 매우 힘들다. 이것은 출력자료를 로 훈련속도와 정밀도를 높일수 있다는것을 의미한다. ]25.0,0[ ]9.0,9.0[− 이다. )(xf 의 출력이 1근방 범위내에서 조종할수 있으므 ２．실험결과와 분석 실험에서는 각이한 개수의 살창점을 가진 격자화상과 실화상들에 대하여 이지러짐교 정을 진행하고 성능평가를 진행하였다. 성능평가를 위하여 다음과 같은 정확성지표를 리용한다.  ① 편차 수평방향과 수직방향의 편차는 각각 다음과 같다.  ′− v | ′− uu E E = = |, v | | x y 편차의 최대값과 최소값을 교정정확성지표로 리용한다.  ② 2차뿌리오차 (2) E RMSx = ( u i ′− u i 2 ,) E RMSy = ( v i ′− v i ) 2 1 n n ∑ i 1 = (3) 1 n n ∑ i 1 = n ∑ 1 n E RMS = [( u i ′− u i ) 2 + ( v i ′− v i 2 ]) 1 = 21 × 입력자료에 대한 실험결과를 표 1에 보여주었다. 21 i 표 １． 21 × 입력자료에 대한 실험결과 21 구   분 xE max yE max E RMSx E RMSy RMSE 선행방법[2] .3 498 × 10 830.2 × .3 498 × .2 830 × .2 035 × − 8 − 11 810 − 11 − 810 − 11 − 810 − 11 − 제안한 방법 197.4 × 10 .9 393 × 10 566.1 × 10 .2 984 × 10 .3 291 × 10 810 − 11 − 표 1에서는 이지러진 격자화상과 표본격자화상의 21× 개의 표본점자료에 대하여 21 선행방법[2]과 론문에서 제안한 방법을 리용한 결과를 보여주었다. 신경망학습의 수렴특성을 그림 3에 보여주었다. 오차 510− 10 10− 15 10− 20 10− 오차 510− 10 10− 15 10− 20 10− 0 50 100 200 250 반복/수 150 ㄱ) 0 20 40 60 80 100 120 140 160 180 ㄴ) 반복/수 그림 3. 신경망학습의 수렴특성 신경망을 리용한 넓은 시야각렌즈의 비선형이지러짐교정방법 － 81 － 그림에서 ㄱ)는 선행방법이고 ㄴ)는 제안한 방법이다.  각이한 입력자료에 대한 실험결과를 표 2에 보여주었다. 표 ２．각이한 입력자료에 대한 실험결과 No. 19 × 13 입력자료  25 × 15 40 × 25 1 2 3 4 5 10 20 20 20 50 10 20 25 50 50 선행방법 제안한 방법 .4 219 2 × 10 .3 698 × 10 307.1 3 × 10 002.6 × 10 .2 729 3 × 10 999.7 × 10 345.1 3 × 10 .2 147 6 × 10 600.1 2 × 10 953.8 1 × 10 − 16 − 17 − 18 − 16 − 16 − 27 − 26 − 25 − 23 − 23 10 20 25 50 50 실화상에 대한 교정결과를 그림 4에 보여주었다. ㄱ) ㄴ) 그림 4. 실화상에 대한 교정결과 그림 4에서 ㄱ)는 넓은 시야각카메라로 입력된 이지러진 화상이며 ㄴ)는 제안한 방 법을 리용하여 비선형이지러짐을 교정한 결과이다. 주어진 넓은 시야각렌즈에서 생기는 비선형이지러짐을 신경망을 리용하여 제거하는 한가지 방법을 제안하고 실험을 통하여 그 효과성을 검증하였다. 맺 는 말 참 고 문 헌 [1] Richard Hartley; Multiple View Geometry in Computer Vision, Cambridge University, 452～529, 2006. [2] Tian Likun et al.; Electronics Optics & Control, 3, 2012. 주체109(2020)년 8월 5일 원고접수 － 82 － 종합대학학보 정보과학 주체109(2020)년 제66권 제4호 A Method of Nonlinear Distortion Correction of FOV Lens Using Neural Network Choe Chun Hwa, Kim Jin Ok In this paper, we proposed a method of nonlinear distortion correction using BP neural network and corrected the distortion of FOV lens using the proposed method. Keywords: nonlinear lens distortion, BP neural network, FOV lens