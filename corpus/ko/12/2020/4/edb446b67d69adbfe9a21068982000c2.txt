김일성종합대학학보 정보과학 주체109(2020)년 제66권  제4호 중첩신경망에 의한 화상긁힘선검출의 한가지 방법 서 효 선 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다.  《첨단과학기술분야에서 세계적경쟁력을 가진 기술들을 개발하기 위한 투쟁을 힘있게 벌려야 합니다.》 필림을 일정한 기간 사용하게 되면 그 화상에는 여러가지 물리적작용과 요인으로 하 여 긁힘선과 얼룩점, 반점무늬 등 부정적요소들이 생겨나 화상의 질을 떨구게 한다. 그러 므로 이러한 요소들을 정확히 검출하고 제거하는것은 화상수복에서 중요한 문제로 된다. 특히 긁힘선은 어둡고 밝은 선형태로 나타나는데 이것은 화상에서 경계선과 류사한 특성 을 가지는것으로 하여 정확히 검출하기가 어렵다. 선행연구[1, 3]에서는 연산자를 리용하는 방법, 긁힘선모형을 리용하는 방법, 려파기 와 유전알고리듬을 리용하는 방법, 신경망을 리용하는 방법들이 제안되였지만 이러한 방 법들은 검출정확도가 낮은 결함이 있다. 그리고 장치적으로 빛거르개를 리용하여 검출하 는 방법도 제안되였지만 이것은 비용이 많이 든다. 론문에서는 화상에서 긁힘선을 검출하기 위한 중첩신경망(CNN: Convolution Neuro Network)을 구성하고 망성능을 높여 긁힘선검출정확성을 높이기 위한 방법을 제안하 였다. １．긁힘선분류를 위한 중첩신경망구성 중첩신경망에 의한 긁힘선검출방법은 입력으로 일정한 크기의 화상쪼각(patch)을 넣 고 이 화상쪼각의 중심화소가 긁힘령역화소인가, 아닌가를 판정하고 긁힘령역과 비긁힘 령역으로 출력한다. 긁힘선검출의 정확성은 학습표본과 망구성, 화상쪼각의 크기를 어떻 게 설정하는가에 따라 결정되게 된다. 화상에서 긁힘선의 표식화는 수동적으로 진행하며 그것에 기초하여 자동적으로 학습 표본을 얻는다. 긁힘선검출을 위한 중첩신경망은 중첩층, 솎음층, 전결합층, 분류층으로 구성하였다. 중첩신경망의 구조를 그림에 보여주었다. 6 × 6 × 64 2 × 2 3 × 3 × 32 2 × 2 입력자료 중 첩 층 솎 음 층 중 첩 층 솎 음 층 500 전 결 합 층 2 분 류 층 예 아니 그림. 중첩신경망의 구조 그림에서 보여주는것처럼 중첩신경망은 64개와 32개의 특징지도(Feature Map)로 된 33 × 인 려파기들을 가 66 × 과 22 × 인 최대솎음층들이 각각 놓여있다. 마지막에 이 2개의 중첩층으로 이루어졌다. 이 중첩층들은 각각 크기가 지고있으며 그뒤에 크기가 22 × 와 중첩신경망에 의한 화상긁힘선검출의 한가지 방법  4개의 층으로부터 나온 출력이 두층으로 된 전결합층에 들어간다. 이 층은 첫번째 층에 500개의 신경단위를 가지고 두번째 층에는 2개의 신경단위를 가진다. － 63 － 마지막층에 있는 2개의 신경단위는 화상쪼각의 중심화소에 대하여 두가지로 분류된 다. 하나는 중심화소가 긁힘령역에 속하는것이고 다른 하나는 중심화소가 비긁힘령역에 속하는것이다. 중첩신경망은 보통 여러개의 중첩층과 솎음층들로 구성된다. 중첩층에서 매개 특징 지도는 같은 특징을 가지고 전체 화상을 평가하기 위하여 같은 려파기로 모든 화상을 중 첩하여 얻는다. 중첩층들은 일반적으로 여러개의 특징지도들을 포함하며 중첩신경망에서 매 중첩층의 다음에는 솎음층이 놓인다. 이 층들에서 리용하는 솎음기술은 평가할 특징 들의 정확한 위치에 대한 정보의 중요성을 강조하기 위한 목적으로 리용된다. 또한 이 솎음층들은 학습하여야 할 파라메터의 개수를 줄이는것으로써 학습과정에 도움을 준다. 중첩신경망의 출력은 화상쪼각의 중심화소가 긁힘령역에 속하는가에 대한 가능성을 결정 한다. 화소들을 2개의 령역으로 분류하고 2진값을 취하기 위하여 가능한 값들에 대한 턱값 을 실험적으로 T = 0.000 1로 설정하였다. 턱값이 크면 일부 긁힘화소점들이 잃어질수 있으며 지내 작으면 많은 거짓위치점을 산생시킬수 있다. ２．실험 및 결과분석 1 1 × 920 080 제안된 방법의 효과성을 평가하기 위하여 pixel인 10장의 긁힘화상을 리 용하였다. 먼저 화상에서 긁힘령역에 대하여 수동적으로 긁힘선을 표시한다. 다음 실험의 pixel의 화상을 얻고 긁힘령역 효률을 높이기 위하여 긁힘선을 포함하는 40장의 에 놓이는 표본과 놓이지 않는 표본모임을 자동적으로 얻는다.  중첩신경망의 학습은 20개 화상들을 가지고 진행하였으며 × 개 입력표본들 을 리용하고 나머지 20개 화상들은 시험표본으로 리용하였다. 그리고 화상쪼각의 크기는 43 × 43 프로그람은 Matlab R2017a로 실현하였다. 표본자료에 대한 검출정확성은 시험표본자 pixel로 하였다. 256 × 256 000 20 4 료모임에서 정확히 검출된 표본자료와 시험표본자료의 개수의 비로 평가한다. FA = × 100 (1) AS TS 여기서 FA는 검출정확성, AS는 검출된 표본자료의 개수, TS는 시험표본자료의 개수이다. 학습모형에 기초한 긁힘선검출은 시험화상에 대하여 긁힘화소와 배경화소로 분류된 2진 화상으로 출력된다. 화상자료에 대한 긁힘선검출정확성은 다음의 식에 의하여 평가한다.  2 × TP + + 식에서 TP는 실지긁힘선이 정확히 긁힘선으로 분류된 화소의 개수이고 FP는 배경이 긁힘선으로 잘못 분류된 화소의 개수이며 FN은 긁힘선이 배경으로 잘못 분류된 화소의 개수이다. (2) TP FP 100 FN F × × = 2 중첩신경망구조에 따르는 긁힘선검출정확성비교를 다음의 표에 보여주었다. － 64 － 종합대학학보 정보과학 주체109(2020)년 제66권 제4호 표. 중첩신경망구조에 따르는 긁힘선검출정확성비교 표본자료에 대한 정확성/% 화상자료에 대한 정확성/% 방법 선행방법[2] 선행방법[3] 제안한 방법 96.09 89.74 98.44 81.7 79.5 84.4 표에서 보여주는것처럼 제안한 방법이 선행방법에 비해 긁힘선검출정확성이 높다는 것을 알수 있다. 화상긁힘선검출을 위한 중첩신경망을 구성하고 그 효과성을 실험을 통하여 검증하 였다. 맺 는 말 참 고 문 헌 [1] Alasdair Newson et  al.; IEEE Transactions on Image Processing, 23, 3, 1240, 2014. [2] Jorge Calvo-Zaragoza et  al.; Machine Vision and Applications, 28, 665, 2017.  [3] Yanhui Guo et  al.; Measurement, 125, 586, 2018. 주체109(2020)년 8월 5일 원고접수 A Method of Image Scratch Detection Using Convolutional Neural Network So Hyo Son In this paper we have presented the method that can accurately extract scratch feature, selecting input patch size and depth of the network rationally, and proved through experiment. Keywords: scratch, convolutional neural network, feature extraction