김일성종합대학학보 정보과학 주체109(2020)년 제66권  제4호 심층신경망을 리용한 실시간차번호판령역검출의 한가지 방법 리충일, 김순돌, 최철 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《우리는 가까운 앞날에 전반적인 과학기술분야에서 세계를 디디고 올라설수 있다는 배심을 가지고 첨단돌파의 기적들을 련이어 창조하여야 합니다.》 심층신경망(DNN: Deep Neural Network)은 화상인식뿐아니라 대상검출에서도 높은 성 능을 보여주고있으며 그것의 층깊이는 보다 더 깊어지고있다. Fast R-CNN에 이어 Faster R-CNN 등 심층신경망에 의한 대상검출방법[1]들이 차례로 제안되면서 대상검출의 속도와 정확도가 높아지고있다. 그러나 심층신경망방법들을 대상검출의 한 종류에 속하는 차번호판령역검출에 적용 하는 경우 실시간성보장에서 문제가 제기된다. 론문에서는 실시간차번호판령역검출을 위한 심층신경망의 구조를 설계하고 그에 기 초한 차번호판령역검출방법을 제안하였다. １．문 제 설 정 차번호인식은 차번호판령역추출과 차번호문자인식으로 구성되며 여기서 차번호판령 역검출의 성능을 높이는것이 선차적인 문제로 나선다. 차번호문자인식의 성능이 아무리 좋다고 해도 차번호판령역검출에서 실패하면 차번 호인식자체가 실패로 끝난다. 또한 주행차량들에 대한 차번호인식체계에서는 실시간성보장이 중요한 요구로 제 기된다. 한다. 차번호인식에서 실시간성을 보장하자면 적어도 100ms이내에 인식이 진행되여야 그러나 심층신경망을 리용한 선행한 대상검출방법들은 GPU(도형처리장치)를 리용하 는 경우에는 고속이지만 CPU(연산처리장치)를 리용하는 경우에는 실시간성을 보장하지 못한다. 현실적으로 GPU를 내장한 콤퓨터가 많지 못하고 장치비용이 높기때문에 CPU에서 실시간성을 보장하는것이 중요한 문제로 나선다. GoogLeNet의 Inception, ResNet[2] 등 망의 성능을 유지하면서 파라메터용량과 계산량 11× 중첩층을 리용하여 심층신경망의 층수를 깊게 하는 방법들이 제안되 론문에서는 선행방법들의 우점을 반영하여 CPU에서도 차번호판령역검출의 실시간성 을 보장할수 있는 한가지 심층신경망방법을 제안하였다. 을 줄이기 위해 고있다. 심층신경망을 리용한 실시간차번호판령역검출의 한가지 방법 － 53 － ２．차번호령역검출을 위한 심층신경망의 구조설계 １）중첩연산의 분해에 의한 망파라메터의 축소 중첩연산의 원리에 의해 입력특징지도에 33× 려파 기를 두번 중첩시킨것과 같게 된다. 이때 층수는 2배 늘어나지만 파라메터수는 25로부터 18로 줄어들게 된다. 결과 학습을 효률적으로 진행하게 하고 학습문제를 계층적으로 분 해할수 있게 한다. 55× 려파기를 한번 중첩시킨것은 이로부터 최신심층신경망들은 크기가 5이상인 려파기들을 33× 려파기들로 교체하고 층수를 늘이는 방향으로 설계되고있다.[2] 한편 33× 중첩연산전에 13× 중첩연 31× 중첩연산으로 분해하는 방법 등 파라메터크기를 줄이는 여러가지 방법들이 제 11× 중첩연산을 삽입하는 방법, 33× 중첩연산을 론문에서는 중첩층의 려파기조를 2개의 려파기조로 분해하여 파라메터크기를 축소하 산과 안되고있다. 는 방법을 제안하였다. 로수를 입력특징지도 F의 너비, 높이, 통로수를 (W, H, M), 출력특징지도 G의 너비, 높이, 통 k × 려파기들의 조 K의 크기는 이때 걸음값(stride)이 1이고 채우기값(padding)이 [k/2]일 때 표준중첩연산은 다음과 이라고 하면 NMk NHW ( 이다. (( × × × k k ) ) ) , , 같다. G , nlk , = , nmji , , ik −+ ,1 l j −+ ,1 m ⋅ F (1) ∑ K i , , mj 식 (1)의 표준중첩연산의 계산량(적합연산의 개수)은 려파기조 K를 그림과 같이 분리할수 있다. NMHWkk ⋅ ⋅ ⋅ ⋅ ⋅ 이다. · · · · · · ··· … M k k k k … M ㄴ) N ㄱ) 1 M 1 ··· ··· … · · · N ㄷ) 그림. 려파기조의 분리 ㄱ) 표준 k × 려파기조 K , ㄴ) 입력통로방향의 k k × 려파기조 K′ , ㄷ) 출력통로방향의 k 11× 려파기조 K ′′ 즉 입력특징지도에 대하여 그림 1의 ㄱ)와 같은 려파기조 K 를 적용할대신에 ㄴ)의 ,′ 에 대하여 ㄷ)의 려파기조 려파기조 K′ 를 먼저 적용하고 얻어진 중간특징지도 mlkG , K ′′ 를 적용한다. － 54 － 종합대학학보 정보과학 주체109(2020)년 제66권 제4호 식 (1)을 중첩연산기호 ⊗ 를 리용하여 표기하면 다음과 같다. G n F m , nm = ∑ ⊗ K (2) m 입력특징지도 F 는 입력특징지도화상 F = mF { | m = ,0 M − }1 )이고 출력 특징지도 G 는 출력특징지도화상 = ,0 N − }1 )이며 mF 들의 모임( nGG { = | n nG 들의 모임( M = − ,0 m | nm , K = { K ,1 n = ,0 N − }1 은 k k × 려파기조이다. 그림 1과 같이 려파기조 K 를 입력통로방향의 려파기조 K′ 와 출력통로방향의 려파 기조 K ′′ 로 분해하면 다음과 같다. m ⊗′=′ G K m ∑ F m ′⊗′′ G , nm m K = G n m (3) (4) K′ 는 M개의 k × 려파기조이며 K ′′ 는 M개의 k 11× 려파기조가 N개 들어있는 려파기 조묶음이며 NM × 행렬로 실현된다. 식 (3), (4)에 의한 중첩연산을 진행하는 경우 계산량은 HWMkk ⋅ ⋅ ⋅ ⋅ + HWNM ⋅ ⋅ ⋅ 로 된다. 이다. 결국 파라메터축소비률 R 는  ⋅ ⋅ R = HWNMHWMkk + ⋅ HWNMkk ⋅ ⋅ ⋅ ⋅ ⋅ ⋅ ⋅ ⋅ ⋅ = 1 1 + 2 kN (5) 따라서 3=k 이고 N 이 128 또는 256과 같이 큰 경우 축소전에 비해 약 9배의 계산 량축소효과를 가진다. ２）차번호령역검출을 위한 심층신경망의 구조설계 파라메터를 축소하기 전 망층들의 배치와 크기를 표 1에 보여주었다. 층의 류형 conv1/mp2 conv2/mp2 conv3/mp2 conv4/mp2 conv5/mp2 conv6 conv7/mp2 conv8 conv9 avgpool 표 １．축소전 망층들의 배치와 크기 입력특징지도의 크기 려파기조의 크기 448×448×3 224×224×16 112×112×32 56×56×64 28×28×128 14×14×256 14×14×256 7×7×512 7×7×1 024 7×7×20=980 3×3×3×16 3×3×16×32 3×3×32×64 3×3×64×128 3×3×128×256 3×3×256×256 3×3×256×512 3×3×512×1 024 1×1×20 파라메터를 축소한 후 망층들의 배치와 크기를 표 2에 보여주었다. 표 1, 2에서 mp2는 22 × 크기의 max-pooling연산을 의미하며 conv(id), conv(od)는 각각 입력통로방향, 출력통로방향의 려파기조에 의한 중첩연산을 의미한다. 심층신경망을 리용한 실시간차번호판령역검출의 한가지 방법 － 55 － 표 ２．축소후 망층들의 배치와 크기 입력특징지도의 크기 려파기조의 크기 층의 류형 conv1/mp2 conv2(id) conv3(od)/mp2 conv4(id) conv5(od)/mp2 conv6(id) conv6(od)/mp2 conv7(id) conv8(od)/mp2 conv9(id) conv10(od) conv11(id) conv12(od)/mp2 conv13(id) conv14(od) conv15(fc) avgpool 448×448×3 224×224×16 224×224×16 112×112×32 112×112×32 56×56×64 56×56×64 28×28×128 28×28×128 14×14×256 14×14×256 14×14×256 14×14×256 7×7×512 7×7×512 7×7×1 024 7×7×20=980 3×3×3×16 3×3×16 1×1×16×32 3×3×32 1×1×32×64 3×3×64 1×1×64×128 3×3×128 1×1×128×256 3×3×256 1×1×256×256 3×3×256 1×1×256×512 3×3×512 1×1×512×1 024 1×1×20 망의 출력은 마지막전련결층의 출력에 33× 크기의 average pooling연산을 거쳐 얻는다.  망의 출력은 대상검출층(DL:Detect Layer)을 거쳐 대상령역검출을 진행하며 이 층에서 의 대상령역검출방법[3]은 다음과 같다. 대상검출층의 입력은 77 ×× 20 크기의 텐소르이고 출력특징지도 77 × 의 매 요소에 4개의 고정4각형(default box)이 적용되며 검출대상클라스는 1개이기때문에  각형자리표값 클라스개수 직 4(4 (1)) (4) 20 = + × 의 예측이 진행된다. 4개의 고정4각형들의 크기 Box(w, h)는 입력화상을 448× 크기로 정규화한 화상에 448 서 출현하는 차번호판의 너비, 높이들을 참고하여 다음과 같이 정한다. Box(w, h) = {(37, 37), (49, 45), (72, 68), (93, 85)} ３）망의 학습 고정4각형의 개수를 N 이라고 할 때 대상추출층의 1개 특징요소에서의 손실함수는 선행방법[1]에서와 류사하게 다음과 같이 계산한다. gpcxL , ,( , ) = ( L cls cx ,( ) + L loc gpx , ,( )) (6) 1 N L loc ,( gpx , ) = N 1 N ∑ ∑ Pos m ∈ cx ,{ Sx L ij 1 hwcy , }, ( m p i − ˆ g m j ) (7) 검출손실함수 i ∈ 에서 p 는 예측4각형, g 는 정답4각형이며 － 56 － 종합대학학보 정보과학 주체109(2020)년 제66권 제4호 m ˆ g = j ˆ{ g cx j ˆ, g cy j w j , h }ˆ g j ˆ, g ˆ g cx j ˆ g w j = ( g cx j − d cx i /) d w i ˆ, g cy j = ( g cy j − d cy i /) d h i = log( g w j / d w i ), ˆ g h j = log( g h j / d h i ) 이다. 여기서 이다. 은 ip 와 }0,1{=ijx 1LS 은 다음과 같다. 고 클라스손실함수는 이다. jg 의 겹침면적이 턱값 5.0=ouI 보다 크면 1, 작으면 0이다. 그리 SL 1 x )( = 2 x ,5.0 x < 1 x − ,5.0 x ≥ 1 ⎧ ⎪ ⎨ ⎪⎩ (8) L cls ,( cx ) −= x ij log( c i ) − log( c i ) (9) N ∑ i ∈ Pos N ∑ i ∈ Neg ３．실험 및 결과분석 제안방법의 유효성을 판정하기 위하여 해상도의 촬영기로 차번호판이 보 1 이는 도로상의 차량을 촬영한 화상 1 200개를 준비하고 짝수번째 화상을 학습용, 홀수번 째 화상을 검사용으로 리용하였다. 080 920 × 1 학습과 검사는 GTX-980이 장비된 Corei7 3.6GHz콤퓨터에서 Tensorflow흐레임워크로 진행되였다. 4만회의 학습을 진행하여 얻은 모형들에 의한 성능평가를 표 3에 보여주었다. 표 ３．성능평가 검출시간 CPU/ms GPU/ms 분 류 화상모임 화상수/개 검출수/개 검출률/% 모형의 크기/MB 학습 파라메터 축소전방법 검사 학습 제안방법 검사 600 600 600 600 590 575 590 574 300 300 70 70 75 75 25 25 98.3 95.8 98.5 96.1 27.5 3.2 표 3은 제안방법이 파라메터축소전에 비해 인식정확도의 손실이 없이 기억용량을 8.5배 축소하는것과 동시에 인식시간을 4배 단축함으로써 100ms(CPU시간)이하의 실시간 차번호판검출을 보장한다는것을 보여준다. 맺 는 말 실시간차번호판인식을 보장하기 위한 심층신경망방법을 제안하고 실험을 통하여 그 유효성을 확증하였다. 심층신경망을 리용한 실시간차번호판령역검출의 한가지 방법 － 57 － 참 고 문 헌 [1] S. Len et al.; IEEE Transaction on Pattern Analysis & Machine Intelligence, 39, 6, 1137, 2017. [2] K. He et al.; Computer Vision and Pattern Recognition, 770, 2016. [3] W. Liu et al.; European Conference on Computer Vision, 21, 2016. 주체109(2020)년 8월 5일 원고접수 A Method of Real-time Vehicle License Plate Location Using Deep Neural Network Ri Chung Il, Kim Sun Dol and Choe Chol In this paper we designed a high-speed deep neural network using filter decomposition for real- time vehicle license plate recognition system on running vehicles and confirmed that the proposed method has a high speed of below 100ms on even CPU by experiments. Keywords: deep neural network, license plate location, license plate recognition