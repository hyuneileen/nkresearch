김일성종합대학학보 정보과학 주체108(2019)년 제65권  제1호 생물가스발효공정에서 미지입력 및 상태의 최소분산불편추정의 한가지 방법 리충주, 길호일 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《과학기술을 발전시키는것은 나라의 경제를 빨리 발전시키기 위한 중요한 담보입 니다.》(《선집》 증보판 제11권 133페지) 생물가스발효공정은 유기페기물을 리용하여 유용한 에네르기물질인 생물가스(메탄가 스)를 얻어내는 생화학공정으로서 전망이 큰 재생에네르기분야의 하나로 인정받고있으며 안정하면서도 효률적인 공정운영과 조종을 위한 연구[1]가 많이 진행되고있다. 생물가스생산공정의 운영과 조종에서 주되는 난점의 하나는 공정의 주요입력들과 상 태들에 대한 측정이 불가능한것이며 이를 해결하기 위한 여러가지 방법[2, 3]들이 제안되 였다. 그러나 이러한 방법들은 모형의 구조 및 파라메터들에 대한 정확한 정보를 기초로 하고있으며 추정된 상태의 불확정성정도를 평가할수 없는 결함을 가지고있다. 론문에서는 생물가스발효공정의 모형과 측정에서의 불확정성을 고려하여 미지입력과 상태를 추정할수 있는 한가지 최소분산불편추정방법을 제안하였다. １．생물가스발효공정의 수학적모형 우리는 생물가스발효공정의 전형적인 수학적모형인 AM2[4]와 현실적인 측정조건(1차 유기물의 농도가 측정불가능)을 고려하여 다음과 같은 리산모형을 제기하였다. ( ξ 1) k + = y k ( ) = A k C k ( ) ( ) k ξ ( ) ( ) k ξ + + B k r k ( ) ( ) 1 1 F k u k ( ) ( ) + + η + B k u k ( ) ( ) 2 k ( ) (1)                       (2) k ( ) ω 여기서 T D k ( ) − ⋅ 0 0 1 0 T D k ( ) − ⋅ 0 0 0 , ⎤ ⎥ ⎥ ⎥ ⎦ 1 − ⋅ T D k ( ) ξ k ( ) = , u k ( ) = A k ( ) ⎤ ⎥ ⎥ ⎥ ⎦ ⎤ ⎥ ⎥ ⎥ ⎦ S k ( ) 2 Z k ( ) ⎡ ⎢ ⎢ ⎢ ⎣ , X k ( ) 2 T k ⋅ ⎡ 1 ⎢ T k ⋅ ⎢ 3 ⎢ 0 ⎣ 1 0 0 ⎡ ⎤ ⎥ ⎢ 0 1 0 , ⎥ ⎢ ⎥ ⎢ ⎦ ⎣ 0 0 0 ⎡ ⎢ ⎢ ⎢ ⎣ , k ( ) S in 2 Z k ( ) in r k ( ) 2 − ⋅ ⎤ ⎥ ⎥ ⎥ ⎦ T D k ( ) 0 = 1 ⎡ ⎢ ⎢ ⎢ ⎣ 0 T D k ( ) − ⋅ 0 0 ⎡ ⎢ ⎢ ⎢ ⎣ ⎡ ⎢ = ⎢ ⎢ ⎣ 0 0 0 0 0 0 0 0 k 5 ⎤ ⎥ ⎥ ⎥ ⎦ B k ( ) 1 = B k ( ) 2 = C k ( ) = F k ( ) 2 T k − ⋅ T k ⋅ T 4 ⎤ ⎥ ⎥ ⎥ ⎦ , 2S 는 VFA(휘발성지방산)농도, Z 는 알카리농도, 2X 는 메탄생성균의 농도를 의미한 이며 다. 또한 T 는 표본화주기, D 는 희석률, k는 띠염시각, 첨수 in 은 해당 성분들의 입력농 생물가스발효공정에서 미지입력 및 상태의 최소분산불편추정의 한가지 방법 － 79 － 도, k− 는 화학당량곁수, k 1 5 한편 1( ) r ξ 는 초산생성반응의 속도로서 체계의 미지입력으로 간주하며 r ξ 는 메탄 2 ( ) ,ω η는 각각 모형 및 측정잡음이다. 생성반응의 속도로서 다음의 동력학방정식에 의하여 표시된다. r 2 ( ) ξ μ= 2 max S + 2 K S 2 S 2 X 2 (3) ２．미지입력 및 상태의 최소분산불편추정알고리듬 메탄가스류량의 측정값 gasq 와 그 분산 gasη 로부터 u 중의 r k 와 그 오차분산을 다 2 ( ) 음과 같이 계산할수 있다. 2ˆ ( ) r k = q gas / k 5 (4) Q k ( ) r 2 2 kη= gas 5 / (5) 1k − 시각에 ξ 와 u 의 불편추정값과 그것의 오차분산을 각각 ˆ( k ξ − 1), P kξ ( − 1), − ˆ( 1), u k 방법에 의하여 ( P k u − 이라고 하고 k시각에 새로운 출력 1) 1k − 시각의 1r 을 구할수 있다. y k 가 얻어졌다면 최소분산불편추정 ( ) 우선 1r 이 없는 조건에서 얻어진 상태의 예측값과 오차분산을 구한다. ( A k ˆ 1) ( u k ˆ 1) ( ξ 1) − = 1) − + | k k ˆ ( ξ − k −               (6) 1) ( B k 2 − T P k k ( ξ | 1) − = A k ( − 1) P k ( ξ − 1) A k ( − 1) + + B k ( 2 − 1) P k ( u − 1) B k ( 2 T 1) − + Q k ( ω − 1) (7) 여기서 이다. Q k ( ω − 1) = E T ⎡ k ( ) ω ω ζ ⎣ ζ k ( ) ⎤ ⎦ 다음 편차정보(출력예측과 실제출력사이의 편차정보)로부터 최소두제곱법을 리용하여 미지입력 1r 의 최량추정값과 그 오차공분산을 다음과 같이 구할수 있다. − F k u k C k ˆ ( r k 1 )( kM k ( M y k 1) − = [ [ ( kBkC [ ( kBkC )( )( = 1 ⋅ 1 − − 1 − T )]1 1) − − ˆ ( ) ( | k k ξ ~ ( kBkCkR ~ )( kR T )( )( 1 − 1 T )]1 ~ kR )( ˆ                    (8) ( ) ( )) ] 1 − (9) )1 − ⋅ = kkPkC ξ )( ( | − )1 kC )( + kFkPkF )( u )( )( + kR )( η (10) rP k ( 1 1) − = ⎡ C k B k [ ( ⎣ ( ) 1 T 1)] − 1 − R k C k B k ( % ( ) ( ) − 1) 1 (11) T 1 − ⎤ ⎦ 여기서 R k ( ) η = E T ⎡ ( ) k η η ⎣ k ( ) ⎤ ⎦ 이다. ( )C k 의 구조적특징(세번째 행이 모두 령이다.)을 고려하면 ( )M k 의 세번째 렬이 모두 령이라는것을 알수 있다. 그러면 식 (8)과 (10)을 다음과 같이 고쳐쓸수 있다. ˆ ( r k 1 1) − = ( M y k k ˆ ( ) ( k kξ C k | − − 1)) (12) － 80 － 종합대학학보 정보과학 주체108(2019)년 제65권 제1호 C k P k k ξ R k ( ) % ( = ( ) R k ( ) η 1r 을 리용하여 체계의 미지상태에 대하여 추정을 진행 (13) C k ( ) 1) − + | T 2S 와 Z 의 관측값은 이미 1r 의 추정을 진행하는데 리용하였으므로 gasq 의 관측값을 다음으로 얻어진 반응속도 한다. 리용하여 2r 가 2X 를 추정한다.  2X 와 추정값을 구한다. 2S 의 비선형함수라는것을 고려하여 확장칼만려파기를 리용하여 2X 의 우선 1r 의 추정오차의 표현식을 얻는다. ( )( ( ) M k y k 1) − = 1) − − ( r k 1 ( r k % 1 ˆ ( ) ( ξ C k − | k k − 1)) = = − ( M k C k A k ( )( ( ) − % 1) ( ξ k 1) − + ( C k B k ( ) − 1) 2 ( u k % 2 1) − + (14) + ( ) C k ω ξ ( k 1) − + η ( )) k 다음 체계방정식 (1)을 리용하여 상태의 한걸음예측과 오차를 얻는다. ˆ * ξ * % ξ ( | k k ) ( k k | ) ˆ | ( k k ξ= * A k ( = − 1)+ ( B k 2 − − % 1) ( ξ k 1) − + ˆ 1) ( r k 1 * B k ( 2 −                     (15) 1) − 1) ( u k % 1) − + * ω ξ (16) 여기서 1( ), r k % ξ% k ( ), ξ ( ), k ( ) u k 의 추정오차이며 I ( r k 1) − = % 는 각각 1( ), ( ) u k * ( A k * ( B k 2 * ω ξ B k ( 2 1) − = nI 1) − − − = − ( I ( n n ( B k 1 ( B k 1 − 1) ( M k C k A k ( )) ( ) −                       (17) 1) − 1) ( M k C k B k ( )) ( ) −                      (18) 1) 2 M k C k ( ) ( )) ω ξ ( k 1) − − B k ( 1 − 1) M k ( ) ( ) k η (19) 이다. 그러면 식 (16)에 의하여 *ˆ ( ξ k k | * P k k ( ξ | ) = + * A k ( * Q k ( ξ − 1) P k ( ξ − 1) 1) − = ) 의 오차공분산은 다음과 같이 계산된다. * A k ( 1) 1) 1) 1) − + − − − + T T * B k ( 2 * B k ( 2 P k ( u = ( I n − B k ( 1 − 1) M k C k P k k ( )) ( ) ( | − I n − B k ( 1 − 1) M k C k ( ) ( )) T + ξ T 1)( T (20) B k ( 1 다음으로 1계근사법을 리용하여 ( M k R k M k B k 1) − 1 2S 와 ( ) gasq 를 ( ) ( ) 1) + − η 2X 의 선형함수로 표현하고 다음의 방 정식을 얻는다. 여기서 이다. 여기서 y gas = C gas k ( ) ( ) k ξ η + k ( ) (21) gas gas C ( ) k = q ∂ gas S ∂ 2 ⎡ ⎢ ⎢ ⎣ , q ∂ gas X ∂ 2 ˆ * = ξ ξ k k ( | ) ˆ * = ξ ξ k k ( | ) ⎤ ⎥ ⎥ ⎦ 0, (22) 그러면 다음의 방정식에 의하여 칼만증폭행렬 ( )K k 를 계산할수 있다. K k ( ) = E * % ( ξ ( k k y | % ) gas T k ( ) ) ⎡ ⎣ E y ( % gas k y ( ) % gas 1 − T k ( ) ) ⎤ ⎦ (23) 생물가스발효공정에서 미지입력 및 상태의 최소분산불편추정의 한가지 방법 － 81 － y % gas ( )= y k gas ( ) k − C gas ( ) k *ˆ ξ ( | k k ) (24) E * % ( ξ ( k k | − 1) y % gas T * P k k C | k ( ) )= ( ξ ) gas T k ( ) (25) E y ( % gas k y ( ) % gas T k ( ) ) = C gas k P k k C ( ) ( ) | * ξ gas T k ( ) + R , η gas k ( ) (26) R , η gas k E ( )= ( η k ( ) η gas gas T k ( ) ) (27) 이다. 끝으로 다음의 방정식조에 의하여 상태추정 *ˆξ 과 오차공분산 Pξ를 갱신한다. ˆ ξ ( ) k ˆ * ξ= ( | k k 1) − + ( K y − k r S 5 2 ( 2 , X 2 gas )) (28) P k ( ) ξ = I K k C ( ) − ⎡ ⎣ gas * P k k ( ξ | ⎤ ⎦ ) (29) ３．모의실험 및 분석 생물가스발효공정의 benchmark모형으로 널리 리용되는 ADM1모형에 기초한 모의연구 를 통하여 제안된 상태 및 입력추정방법의 효과성을 검증하였다. ADM1모형의 파라메터와 입력특성은 선행방법과 같게 설정하였다. 또한 체계의 입력농도가 시누스함수의 형태로 변화된다고 가정하였다. 이 경우 제안된 방법에 따라 얻어진 입력 및 상태의 추정결과를 다음의 그림에 보여 주었다. ) 1 - d • 3 - m D O C g k ( / 1 r 0.30 0.25 0.20 0.15 2.0 1.5 1.0 0.5 ) 3 - m D O C g k ( / 2 X 0 0 40 42 44 46 48 50 52 54 56 58 60 t/d 200 t/d 20 40 60 80 100 120 140 160 180 그림. 입력변화가 시누스함수인 경우 입력 및 상태의 추정결과 그림으로부터 론문에서 제안된 방법이 측정불가능한 입력과 상태를 가진 생물가스발 － 82 － 종합대학학보 정보과학 주체108(2019)년 제65권 제1호 효공정의 상태를 유효하게 추정할수 있다는것을 알수 있다.(그림에서 실선은 실제곡선, 점선은 추정곡선이다.) 생물가스발효공정에서 측정불가능한 입력과 상태들을 추정하기 위한 한가지 최소분 산불편추정기의 설계방법에 대하여 제안하고 모의실험을 통하여 그 유효성을 검증하였다. 맺 는 말 참 고 문 헌 [1] S. Carlos-Hernandez et al.; Water Science and Technology, 17, 690, 2009. [2] Albino Mart’nez-Sibaja et al.; Procedia Technology, 7, 173, 2013. [3] O. Bernard et al.; Biotechnology and Bioengineering, 75, 4, 424, 2001. 주체107(2018)년 11월 5일 원고접수 A Method for the Unbiased Minimum Variance Estimation of the Unknown Inputs and States in the Biogas Fermentation Process Ri Chung Ju, Kil Ho Il In this paper, we proposed an unbiased minimum variance estimation method to estimate the unknown inputs and states considering the uncertainty in the model and measurement of the biogas fermentation process. Key words : biogas fermentation process, unknown input, state estimation, unbiased minimum variance estimation