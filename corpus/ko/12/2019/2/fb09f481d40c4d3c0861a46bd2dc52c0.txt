김일성종합대학학보 정보과학 주체108(2019)년 제65권  제2호 동화상에서 최근방탐색에 의한 제거령역수복의 성능을 개선하기 위한 방법 최춘화, 엄금정 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다.  《첨단돌파전을 힘있게 벌려야 나라의 과학기술전반을 빨리 발전시키고 지식경제의 토 대를 구축해나갈수 있습니다.》(《조선로동당 제7차대회에서 한 중앙위원회사업총화보고》 단행본 39페지) 선행연구[1]에서는 대상에 기초한 동화상수복방법을 제안하였다. 그러나 수복해야 할 대상의 운동이 정확한 주기성을 가져야 한다. 선행연구[2]에서는 쪼각에 기초한 동화상수복방법을 제안하였다. 그러나 높은 차원수 의 최근방탐색으로 하여 속도가 뜨며 HD동화상에 대해서는 처리할수 없다. 론문에서는 동화상에서 제거된 령역에 대한 수복의 성능을 개선하기 위하여 대략최 근방을 탐색하여 동화상을 수복하는 방법을 제안하였다. １．동화상수복문제의 정식화 3 u →Ω : R 시공간위치를 을 시공간립방체 Ω 우에서 정의된 동화상의 색정보라고 하자. 동화상에서 ∈ 을 이 위치에서의 색값으로 표시한다. H 를 수 tyx ), ,( Ω∈ 로, pu ( R = p ) 3 복하여야 할 구멍, D 를 자료모임(가리워지지 않은 구역)이라고 하면 φ=∩ DH 이다. DH ∪=Ω 이고 pN 를 p 를 중심으로 하는 시공간립방체쪼각 그리고 그것에 대응하는 동화상쪼각을 3×N크기의 벡토르 W u p = (( u ) (cid:34) ( u q 1 Nq )) 으로 표시하자. pN 에서 N개의 화소 ,1 (cid:34) 들 Nq , q 은 이미 정해진 방법으로 순서화되여있다.  } D NDp ~ 를 정의하고 가리워진 구역을 수복하는데 D { ∈= ~ D , p ⊂ 의 쪼각들만을 리용 한다. 마찬가지로 ~ H ∈∪= Hp N u p u pW 와 가장 류사한 쪼각 3 기 R→Ωφ : 을 리용하여 정식화할수 있다. 즉 ~ Dp ∈ 을 만족시켜야 한다. ) ∀ , pp + ( φ 도 정의하면 동화상수복은 매 화소 Ω∈p 에 대하여 쪼각 qW 의 화소 Ω∈q 를 얻는것이다. 이것은 화소들사이의 이동넘기 q p φ+= ( p ) 는 p의 대응이다. 이 넘기기는 동화상수복은 다음의 목적함수를 최소로 하는 φ를 구하는 문제로 정식화할수 있다.  ( u p WWd (1) ,( uE ) φ u p ) = ( φ + 2 p , ) ∑ Hp ∈ 여기서 － 74 － 종합대학학보 정보과학 주체108(2019)년 제65권 제2호 2 ( u WWd p , u p + ( φ p ) ) ∑ = 1 N pNq ∈ )( qu − ( qu + ( φ p )) (2) 2 2 이다. 식 (1)은 탐색과 재구성의 단계를 거쳐 최량화된다.  ① 탐색단계에서 입력동화상 u 가 주어지면 수복하여야 할 구역 H 의 화소들을 가진 매 쪼각 ~ pW 의 최근방(NN)을 D 에서 찾는다. ② 재구성단계에서 φ가 주어지면 매 화소 Hp ∈ 에 새로운 값 ( pu 를 준다. 이 단계 ) 들을 만족시키는 풀이가 얻어질 때까지 계속 반복한다. ２．최근방탐색 최근방탐색은 초기화, 전파, 우연탐색으로 이루어진다.  ① 초기화에서는 매 쪼각 , ∈ 에 우연적으로 NN을 할당한다. ~ HpW p ② 전파에서는 NN들을 가지고있는 φ에서 이동(shift)을 진행한다.  위치 tyx ), ,( 에서 p = W W W , , ,1 pW 에 거리상 가깝다면 ( φ − + p x p + φ yx ,( ty t ), ),1 ( pφ 는 새것으로 교체된다. tyx ,( φ )1 ) − + − p , 의 3개 쪼각들중 하나가 ,1 ty ), , W p p φ+ ( p ) , W t + ,1 yx ,( tyx ) , ,( + φ 주위에서 매 쪼각 φ + p 에 대해서도 같은 조작을 진행한다. )1 + pW 의 보다 좋은 NN들을 우연적으로 pW φ+ 보다 ( p ) 마찬가지로 W x + ③ 우연탐색에서는 ( φ + p 탐색한다. k번째 반복에서 우연후보들은 다음과 같이 계산할수 있다. r 는 여기서 max 우에서 균등분포로부터 얻어지는 3차원벡토르이다. p φ+ ( p ) ) q p 주위의 최대탐색반경, p += ( φ ⎣ r max ⎦k k δρ (3) + kδ 는 단일립방체 [－1, 1]×[－1, 1]×[－1, 1] 은 탐색창문크기의 축소인 )1,0(∈ρ 자이다. 여기서는 이 값을 0.5로 설정한다. 이러한 우연탐색을 리용하면 동화상전체에 대 한 최소화를 진행할수 있다.  최대탐색파라메터 max r 는 입력된 해상도준위에서 최대크기로 설정한다. 전파와 우연 탐색은 만족한 풀이를 얻을 때까지 반복된다. 보통 반복회수를 10으로 설정한다. 무게붙은 평균법을 리용하여 매 화소들의 재구성을 진행한다. ３．제거령역수복 q pus p ( + φ ( p )) ∑ Nq ∈ p ∑ s q p Nq ∈ p pu ( ) = , ∈∀ Hp (4) s q p = ⎛ ⎜ exp ⎜ ⎝ − 2 , ( WWd q 2 2 σ p q ( + φ p ) ) ⎞ ⎟ ⎟ ⎠ (5) 동화상에서 최근방탐색에 의한 제거령역수복의 성능을 개선하기 위한 방법 － 75 － 파라메터 pσ 는 모든 거리 q )( +φ Hp ∈ 에서 최종재구성은 다음과 같다.  * final final q WWd ({ q , u ( p ) = pu ( φ+ *q ( )) , q Nq ∈ ), p } 의 75%로 한다. ( Wd 1 − final q , W ))( q q ( φ+ final ) (6) = arg min Nq ∈ p ４．실험결과 및 분석 실험은 선행방법[2]과 비교하여 Core i7 2.5GHz에서 진행하였다.  동화상수복결과를 다음의 그림에 보여주었다. ㄱ) ㄴ) ㄷ) 그림. 동화상수복결과 그림에서 ㄱ)는 원화상이고 ㄴ)는 선행방법[2]에 의한 결과이며 ㄷ)는 제안된 방법의 결과이다. 실험에서의 대비분석은 수복의 성능을 평가하는 두제곱오차합과 실행시간을 가지고 진행하였다. 수복의 성능에 대한 평가는 이동대상을 동화상에 수동으로 삽입하고 제거된 화상과의 두제곱오차합을 계산하는 방법으로 진행하였다. 표 1에서는 수복의 질에 대한 평가를, 표 2에서는 각이한 크기의 동화상에 대한 실행 시간을 대비적으로 보여주었다. 표 １．수복의 질에 대한 평가                표 ２．각이한 해상도에 대한 실행시간 두제곱오차합 320×240×25 720×576×25 1 920×1 080×25 방법 선행방법[2] 제안된 방법 127 79 방법 해상도/picxel 선행방법[2] 제안된 방법 1.3s 11s 7.2s 45s 31s 3s 실험결과에서 보여준것처럼 제안된 방법이 높은 수복질을 보장하면서도 실행시간이 빠르다는것을 알수 있다. 제거된 령역에 대한 수복의 성능을 개선하기 위해 최근방탐색을 리용하여 동화상수 복을 진행함으로써 수복의 질을 보장하면서도 실행시간을 단축할수 있는 방법을 제안하 였다. 맺 는 말 － 76 － 종합대학학보 정보과학 주체108(2019)년 제65권 제2호 참 고 문 헌 [1] M. Granados et al.; Computer Graphics Forum, 31, 2, 228, 2013. [2] Y. Liu et al.; IEEE Transactions on Image Processing, 23, 2, 1692, 2017. 주체108(2019)년 2월 5일 원고접수 A Method for Improving the Performance of the Removal Region Inpainting by Nearest Neighbor Search in Video Choe Chun Hwa, Om Kum Jong In this paper, we proposed a method that set the global purpose function using patch and decreased the computational time by using nearest neighbor search in video inpainting. Key words: video inpainting, NN, shift map