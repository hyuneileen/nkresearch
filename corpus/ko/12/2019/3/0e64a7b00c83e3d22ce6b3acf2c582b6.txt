김일성종합대학학보 정보과학 주체108(2019)년 제65권  제3호 최량호모그라피를 리용한 카메라교정의 한가지 방법 방금석, 박지혜 단일 혹은 다중카메라들은 3차원공간안의 선수들의 위치와 다른 카메라들과의 선수 들의 정보교환과 추적에 리용된다. 를 결정하였다. 선행연구[1, 2]에서는 2개의 카메라화상들사이에 사영변환을 리용하여 선수들의 위치 이 경우 실화상에서는 잡음의 영향으로 인한 오차를 가지게 된다.  론문에서는 경기장환경에서 카메라로 얻은 경기장바닥화상으로부터 최량호모그라피 를 리용하여 카메라의 교정파라메터들을 결정하는 방법을 제안하였다. １．호모그라피와 카메라교정파라메터 카메라교정파라메터인 외부자세결정을 위하여 실지 경기장장면화상을 참고평면으로 변환하는 호모그라피를 결정하고 이 호모그라피로부터 카메라의 교정파라메터 즉 그것의 위치와 자세(회전행렬)를 얻을수 있다. 카메라교정파라메터들을 얻기 위하여 사용자자리표계의 선택을 Z축은 바닥평면에 수 0=Z 으로 되도록 실지 경기장바닥에 귀착시켜 3차원자리표계를 설정 직이고 바닥평면은 한다. 카메라렌즈의 확대, 축소설정에 따라 변화되는 초점거리 f 를 내놓고는 모든 내부카 메라파라메터(행렬 K )는 알려진다고 가정한다. f x 0 = K ⎞ ⎟ ⎟ ⎟ ⎠ 는 주점의 자리표이다.[1] c y c 1 ⎛ ⎜ ⎜ ⎜ ⎝ 0 0 ⋅ 0 r f (1) 여기서 r는 방향비, ( x c y , c ) 같은 관계를 가진다. 카메라내부행렬 K 와 카메라자세 그리고 호모그라피 H 사이의 관계를 론의하자.  회전행렬 R 의 렬벡토르들을 ir 라고 하면 3차원점들과 그것에 대한 화상들은 다음과 = rrK [ 1 2 r 3 − C = KR 10 ~ XH ′ = (2) ⎛ ⎜ λ ⎜ ⎜ ⎝ x y 1 ⎞ ⎟ ⎟ ⎟ ⎠ X Y 0 1 ⎛ ⎜ ⎜ ] ⎜ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎟ ⎟ ⎟ ⎠ 01 00 ⎛ ⎜ ⎜ ⎜ ⎝ − c − c − c x y z X Y 1 ⎛ ⎞ ⎜ ⎟ ⎜ ⎟ ⎜ ⎟ ⎝ ⎠ ⎞ ⎟ ⎟ ⎟ ⎠ ~ 여기서 λ는 실수이고 X ′ 카메라중심이다. H 는 참고평면과 경기장바닥화상사이의 3×3호모그라피이다. 은 Z 자리표가 없는(실지는 0) 3차원점의 동차자리표이며 C는 식 (2)로부터 최량호모그라피를 리용한 카메라교정의 한가지 방법 － 67 － 01 10 00 ⎛ ⎜ ⎜ ⎜ ⎝ − c − − c c x y z ⎞ ⎟ ⎟ ⎟ ⎠ 0 1 0 1 H = λ KR (3) 이며 식 (3)으로부터 T T − HKKH 1 − = 2 λ (4) 1 0 ⎛ ⎜ ⎜ ⎜⎜ ⎝ − c x − c y ( c x 2 ) + ( c y + ( c z 2 ) − c x − c y 2 ) ⎞ ⎟ ⎟ ⎟⎟ ⎠ 을 얻는다. 식 (4)에 식 (1)을 대입하면 T H 1 0 b 2 ⎛ ⎜ ⎜ ⎜ ⎝ 0 b 1 b 3 b 2 b 3 b 4 ⎞ ⎟ ⎟ ⎟ ⎠ H = 2 λ 1 0 ⎛ ⎜ ⎜ ⎜⎜ ⎝ − c x − c y 2 ) − c x − c y ( c x 2 ) + ( c y + ( c z 2 ) 이다. 여기서 이다. 이때 미지수는 b = ( /1 bbbb ( , , , = − 1 4 2 4b 라는것을 알수 있다. x c − r ) 2 3 , , 식 (3)으로부터 카메라외부파라메터(회전행렬)는 2 /1( r ) y c /1(, r ) y c 2 2 + 2 x c + f ⎞ ⎟ ⎟ ⎟⎟ ⎠ )2 R = 1 − HK λ = 1 − HK λ 10 − 01 10 00 ⎛ ⎜ ⎜ ⎜ ⎝ − c − − c c x y z ⎞ ⎟ ⎟ ⎟ ⎠ 01 − 00 − ⎛ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎝ c c c x z y c z 1 c z ⎞ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎠ ２．기하학적오차와 호모그라피 로 표시된다. 평면호모그라피와 화상에서 측정된 잡음있는 대응쌍 대응점들의 동차자리표는 x ′↔ 가 주어졌다고 하자. x x = yx ,( T)1, , x =′ ( x ′ , T)1, ′ y 이다. 호모그라피에 관한 대응점의 오차를 측정하는데는 여러가지 방법들이 있으나 여기 서는 기하학적오차를 리용하기로 한다. 이 경우 최대우도추정은 재사영오차에 의한 기하학적거리를 최소화한다. 즉 ([ xd )ˆ, x i i 2 + xd ( 2 ])ˆ, ′ x i ′ i (5) ∑ i 이다. 여기서 ′↔ 는 측정된 대응점들이고 x x i i ixˆ 과 ix′ˆ 는 추정된 대응점들이다. 두 화상에서의 재사영오차를 그림 1에 보여주었다. － 68 － 종합대학학보 정보과학 주체108(2019)년 제65권 제3호 Xˆ d X H X ′ d ′ XH ˆ HX 기하학적오차는 이다. 여기서 이다. 그림 1. 두 화상에서의 재사영오차 )ˆ( xe = ( x − 2 )ˆ x + ( y − 2 )ˆ y )ˆ +′−′+ x x ( ( y )ˆ ′−′ y 2 2 ˆ x =′ hyhxh 2 3 1 hyhxh 9 8 7 + + + + ˆ ˆ ˆ ˆ , ˆ y =′ hyhxh 4 6 5 hyhxh 7 9 8 + + + + ˆ ˆ ˆ ˆ 기하학적오차의 최소화에서는 LM법이나 가우스뉴톤법, 특이값분해[1]를 비롯한 여러 가지 방법으로 호모그라피를 얻는다. 얻어진 호모그라피를 카메라교정파라메터의 회전행 렬계산에 리용한다. ３．실험 및 결과분석 실험은 임의의 각도에서 카메라로 찍은 화상에 대한 실화상자료를 가지고 진행하 였다. 경기장의 실화상과 참고화상을 그림 2에 보여주었다. ㄱ) ㄴ) 그림 2. 경기장의 실화상과 참고화상 호모그라피와 회전행렬, 대응점을 표에 보여주었다. 표．호모그라피와 회전행렬, 대응점 방법 선행방법 .0 059 호모그라피(H) 3 3 463.0 − 356.0 1 096 8 000 42 − .0 003 05 ⎛ ⎜ ⎜ ⎜ ⎝ .0 − .0 − 회전행렬(R) 000.0 65 .0 000 137 5.8 .0 000 025 000.0 612 .6 253 .71 2 − 000.0 42 − .0 003 05 − 72.42 제안한 방법 .0 122 − 08.0 ⎛ ⎜ ⎜ ⎜ ⎝ − .0 384 000.0 11 .0 000 62 6.8 226.267 8 424.0 6 .13 644 .0 000 003 .0 000 606 35.6 − .0 000 225 − .0 002 84 0.1 − .0 000 225 − .0 002 84 − 7.42 대응점 .226 199 5 720 1 6 72.255 1.0 ⎞ ⎟ ⎟ ⎟ ⎠ ⎞ ⎟ ⎟ ⎟ ⎠ ⎛ ⎜ ⎜ ⎜ ⎝ ⎛ ⎜ ⎜ ⎜ ⎝ 2. 184 23.19 ⎞ ⎟ ⎟ ⎟ ⎠ 7.178 0.1 ⎞ ⎟ ⎟ ⎟ ⎠ ⎛ ⎜ ⎜ ⎜ ⎝ ⎛ ⎜ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎟ ⎠ ⎞ ⎟ ⎟ ⎟ ⎠ 최량호모그라피를 리용한 카메라교정의 한가지 방법 － 69 － 표에서는 호모그라피로부터 얻은 회전행렬과 2개의 화상사이에 대응점들을 통하여 카메라교정에서 선행방법[2]과 제안한 방법과의 정확성을 비교하였다. 실지 경기장에서 자리표는 (118, 105)이며 표준경기장에서의 자리표는 (227, 72)이다. yx, 자리표들과 표준경기장에서 자리표들, 편차들의 합평균을 계산하였다. 제안한 방법에서의 합평균편차는 .0 이며 선행방법에 의한 합평균편차는 9 이다. 따라서 제안한 방법이 선행방법보다 대응점오차가 작아졌다는것을 알 LME .0= 540 493 15 4 =E 수 있다. 호모그라피를 리용하여 카메라의 교정파라메터인 회전행렬을 계산하는 한가지 방법 을 제안하였다. 기하학적오차를 최소로 하는 호모그라피를 리용하였으므로 교정파라메터 의 정확성이 개선되였다. 맺 는 말 참 고 문 헌 [1] M. Alemán-Flores, L. Alvarez; Pattern Recognition, 47, 10, 89, 2014. [2] José Henrique Brito; Computer Vision and Image, Understanding, 157, 1, 240, 2017. A Camera Calibration Method Using Optimal Homography 주체108(2019)년 5월 5일 원고접수 Pang Kum Sok, Pak Ji Hye As camera calibration parameter has been determined by homography which minimises the geometric error, the accuracy of the calibration has improved. Key words: camera calibration, extrinsic parameter, homography