김일성종합대학학보 정보과학 주체108(2019)년 제65권  제3호 자원예약방식을 리용한 실시간망통신의 성능개선 한광민, 황철진 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《프로그람을 개발하는데서 기본은 우리 식의 프로그람을 개발하는것입니다. 우리는 우리 식의 프로그람을 개발하는 방향으로 나가야 합니다.》(《선집》 증보판 제21권 42 페지) 일반적인 망파케트흐름은 망통신과제들의 실시간성을 담보해주지 못한다. 그림 1에 자료를 송수신할 때 사용하는 완충기[1, 2]들을 보여주었다. 응용프로그람 응용프로그람 송신소케트완충기 수신소케트완충기 소케트/전송층/망층/자료련결층 소케트/전송층/망층/자료련결층 전송층대기렬 장치구동프로그람 장치구동프로그람 전송고리대기렬 수신고리대기렬 망기판 망기판 망기판내부완충기 망기판내부완충기 그림 1. 자료를 송수신할 때 사용하는 완충기 응용프로그람은 자료를 생성하고 송신소케트완충기에 추가하며 TCP층에서는 파케트 를 생성해서 전송층대기렬(qdisc)을 통하여 장치구동프로그람으로 보낸다.[2] 장치구동프로그람과 망기판사이에는 전송고리완충기가 있으며 망기판에는 내부완충 기가 있고 여기에 전송할 파케트를 저장한다. 파케트는 망기판내부수신완충기에 저장되며 장치구동프로그람과 망기판사이에는 수 신고리대기렬이 있다. 수신고리대기렬에 들어간 파케트는 장치구동프로그람이 꺼내서 웃 준위층으로 보낸다. 장치구동프로그람과 웃층사이에는 완충기가 없으므로 응용프로그람은 자원예약방식을 리용한 실시간망통신의 성능개선 － 15 － 수신소케트완충기에 적재된 자료[1, 3]를 리용한다.. 론문에서는 자원예약에 의한 파케트흐름을 갱신하고 예약대기렬들의 우선권에 기초 하여 파케트들을 실시간으로 처리하는 방법을 제안하였다. １．자원예약방식에 의해 갱신된 파케트흐름 １）자원예약 자원예약은 실시간망통신과제들에 대하여 망대역폭을 예약하고 할당하며 그에 대한 관리를 진행함으로써 실시간망통신과제들의 실시간성을 담보해주는 실시간조작체계의 한 부분이다. 망자원예약의 기본사명은 실시간망예약과제들에 대하여 망대역폭을 예약하고 할당하 며 그에 대한 관리를 진행함으로써 실시간망예약과제들의 실시간성을 담보하도록 하는것 이다. ２）자원예약의 구조 망자원예약의 구조는 그림 2와 같다. 송신예약 부분모듈 망예약 API 망예약관리 조종모듈 망예약 입장조종부 수신예약 부분모듈 그림 2. 망자원예약의 구조 매 구성요소의 역할은 다음과 같다. ① 망예약 API 응용프로그람과 핵심부와의 대면을 위한 구성요소이다. 응용프로그람은 망예약 API 를 통하여 망예약을 진행한다. ② 망예약입장조종부 응용프로그람이 요구한 예약이 가능한가를 검사하는 구성요소이다. ③ 송신예약부분모듈 나가는 파케트에 대한 예약을 구현한 구성요소이다.  ④ 수신예약부분모듈 들어오는 파케트에 대한 예약을 구현한 구성요소이다. ⑤ 망예약관리 및 조종모듈 송신 및 수신예약의 창조와 해제 등 예약관련정보에 대한 관리와 예약에 대한 재충 전, 고갈처리(예약이 고갈된 상태에서 강제처리방식에 따르는 처리), 예약량의 변경 등 예 약조종을 진행하는 구성요소이다. － 16 － 종합대학학보 정보과학 주체108(2019)년 제65권 제3호 망자원예약모듈은 사용자가 망예약 API를 통하여 송수신예약을 진행하는것으로부터 시작되며 망예약관리 및 조종모듈에 의하여 송수신예약이 창조되기 전에 먼저 예약에 대 한 입장조종이 진행된다. 입장조종이 허가되였으면 송수신예약이 등록된다. 송신예약이면 본래의 망(IP)층 대기 렬에 예약대기렬을 확장한다. 수신예약이면 자료련결층에 예약을 위한 수신대기렬을 창조 한다. 입장조종이 허가되지 않았으면 사용자에게 통보한다. 다음으로 들어오고나가는 모든 파케트에 대하여 예약관련검사가 진행된다. 만일 어떤 파케트가 송수신예약된 소케트의 파케트라면 예약량에 대한 검사가 진행되고 그에 기초 하여 파케트가 처리되며 예약량이 고갈된 상태라면 강제처리방식에 따르는 처리를 진행 한다. 송신예약과 수신예약은 류사한 구조를 가지고있다. 그림 3에서는 송신예약파케트인 경우 송신예약부분모듈의 동작과정을 보여주었다. 시 작 송신파케트로부터 소케트정보를 얻는다. 아니 예약관련? 예 예약량이  남아있으면? 예약관련 상태정보값을 변경한다. 해당한 완충기에 파케트를 넣는다. 파케트일정관리기는 우선권에 기초하여 파케트를 전송한다. 아니 예 Soft방식 고갈처리? Hard 방식 파케트를 버린다. 끝 그림 3. 송신예약파케트인 경우 송신예약부분모듈의 동작과정 우선 나가는 파케트에 대한 예약검사를 진행하며 만일 예약관련파케트라면 그 파케 트를 해당 예약대기렬에 넣고 예약관련파케트가 아니라면 일반대기렬을 리용한 표준흐름 에 따른다. 다음 표준적인 파케트일정관리기에 의한 처리를 진행한다. 자원예약방식을 리용한 실시간망통신의 성능개선 － 17 － 파케트일정관리기는 가장 높은 우선권을 가지는 예약대기렬의 파케트들을 먼저 처리 한다. 파케트일정관리기는 제일 높은 우선권을 가지는 대기렬을 선택하고 그 대기렬과 관 련된 상태를 검사하며 해당 시간주기내에서 예약이 아직도 고갈되지 않았다면 대기렬에 서 파케트를 꺼내서 그것을 망기판을 통하여 전송한다. 그렇지 않으면 다음으로 제일 높 은 우선권을 가지는 대기렬에서 파케트들을 처리한다. 다음으로 송수신파케트를 처리할 때마다 현재의 예약사용량을 계수하며 예약과제가 주기안에 예약량을 모두 사용한 경우 강제처리방식에 따르는 고갈처리를 진행한다. 망자원예약은 사용자가 망예약 API를 통하여 송수신예약이 련결된 자원모임을 해제 할 때 끝나게 된다. ２．실험 및 결과분석 송신예약과제를 하나 창조하고 망통신(송신)을 진행하는 일반과제를 작성하여 부하상 태에서의 예약의 동작을 본다.  실험방법은 다음과 같다. 일반과제를 하나씩 추가할 때마다 망의 전송부하는 늘어난다. 일반과제의 수를 0(무 부하상태)으로부터 하나씩 증가시키면서 부하상태에서 예약량을 담보하는가를 본다. 부하상태에서 송신예약의 정확성검사(부하상태에서의 예약조종)과정을 표 1에 보여주 표 １．부하상태에서 송신예약의 정확성검사(부하상태에서의 예약조종) 실 행 주기/s 예약대역폭/B 일반과제의 수 1 2 3 4 5 6 7 5 5 5 5 5 5 5 4 000 000 4 000 000 4 000 000 4 000 000 4 000 000 4 000 000 4 000 000 0 1 2 3 4 5 6 부하상태에서 송신예약의 정확성실험결과는 표 2와 같다． 표 ２．부하상태에서 송신예약의 정확성실험결과 주기당 사용대역폭 일반과제수 0 일반과제수 1 일반과제수 2 일반과제수 3 일반과제수 4 일반과제수 5 일반과제수 6 5 812 276 5 820 612 5 831 032 5 823 738 5 428 820 5 466 332 5 456 954 5 450 702 5 021 398 5 039 112 5 024 524 5 043 280 4 617 102 4 638 984 4 628 564 4 638 984 4 090 892 4 128 404 4 036 740 4 133 614 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 었다. 주기 1 2 3 4 － 18 －  표계속 주기 종합대학학보 정보과학 주체108(2019)년 제65권 제3호 주기당 사용대역폭 일반과제수 0 일반과제수 1 일반과제수 2 일반과제수 3 일반과제수 4 일반과제수 5 일반과제수 6 5 6 7 8 9 10 11 12 13 14 15 5 831 032 5 832 074 5 827 906 5 817 486 5 831 032 5 829 990 5 832 074 5 831 032 5 821 654 5 822 696 5 831 032 5 459 038 5 463 206 5 454 870 5 453 828 5 454 870 5 447 576 5 451 744 5 461 122 5 444 450 5 463 206 5 428 820 5 037 028 5 040 154 5 040 154 5 031 818 5 042 238 5 030 776 5 032 860 5 033 902 5 042 238 5 044 322 5 039 112 4 618 144 4 610 850 4 623 354 4 631 690 4 610 850 4 607 724 4 634 816 4 642 110 4 612 934 4 628 564 4 607 724 4 129 446 4 156 538 4 132 572 4 153 412 4 151 328 4 154 454 4 254 486 4 150 286 4 151 328 4 146 118 4 150 286 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 3 999 196 우의 값들에서 Soft이므로 부하가 없을 때에는 고갈처리파라메터가 여유대역폭을 더 사용하여 예약량보다 많은 대역폭을 사용하므로 부하가 늘어날수록 쓸수 있는 여유대역 폭은 작아진다. 결과에서 볼수 있는바와 같이 일반과제가 하나씩 늘어날 때마다 전송대역 의 부하로 인하여 우리가 주목하는 과제의 대역폭사용량이 대략 400 000B씩 감소된다. 이러한 방법으로 일반과제를 4개 창조하였을 때의 대역폭사용량을 추정해보면 4 100 000, 5개일 때 3 700 000, 6개일 때 3 300 000정도로 되여야 한다. 즉 일반과제 4개까 지는 여유대역폭을 가지며 5개부터는 대역폭의 여유가 없을뿐아니라 부하로 인하여 자기 가 쓰려는 대역폭을 모두 사용할수 없다. 그러나 시험이 보여준것처럼 우리가 예약을 진행한 과제는 일반과제가 5개이든 6개 이든 자기가 예약한 대역폭을 모두 사용하였다. 일반과제를 더 실행시켜 망부하를 높여도 예약과제가 사용하는 대역폭의 사용량에는 변함이 없다. 즉 망자원예약이 정확히 진행된다. 자원예약에 의한 파케트흐름을 갱신하고 예약파케트들에 대하여 해당한 예약대기렬 들을 리용하며 예약대기렬들의 우선권에 기초하여 파케트들을 실시간으로 처리하는 방법 으로 실시간망통신과제들의 실시간성을 보장할수 있게 하였다. 맺 는 말 참 고 문 헌 [1] Olaf Kirch; TimeSys Linux/CPU and TimeSys Linux/NET User’s Manual, Willey, 110～239, 2011. [2] Klaus Wehrle; The Linux Networking Architecture Design and Implementation of Network Protocols in the Linux Kernel, Springer, 230～286, 2015. [3] Christian Benvenuti; Understanding Linux Network Internals, CRC Press, 130～215, 2014. 주체108(2019)년 5월 5일 원고접수 자원예약방식을 리용한 실시간망통신의 성능개선 － 19 － Performance Improvement of Real-Time Network Communication Using Resource Reservation Method Han Kang Min, Hwang Chol Jin In this paper, we proposed a method of processing packets in real time using reservation queue for reserved packets to ensure the real-time nature of network communication tasks. Key words: real time, network communication, reservation, priority