김일성종합대학학보 정보과학 주체107(2018)년 제64권  제2호 FPGA를 리용한 다중위상 다통로PWM조종기의 한가지 실현방법 최충성, 리학철 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《과학연구기관들과 과학자, 기술자들은 우리 나라의 실정에 맞고 나라의 경제발전에 이바지할수 있는 과학기술적문제를 더 많이 풀어야 하겠습니다.》(《선집》 증보판 제13권 173페지) PWM(임풀스폭변조)조종기술은 전력전자기술분야에서 광범히 응용되고있는 기술이다. 특히 직류－직류, 교류－직류, 교류－교류변환기들에 전용화된 PWM조종소자들이 많이 리용되고있으며 그 종류와 기능도 다양해지고있다. 그러나 이 전용소자[1]들은 모두 한통로 혹은 서로 반대위상으로 동작하는 한쌍의 PWM구동신호만을 출력하는 2통로방식의 조종소자들로서 여러개의 출력소자들로 구성된 대출력변환기설계에 이 소자들을 리용하는 경우 큰 전류진동으로 인한 절환잡음이 발생 하여 부하체계의 동작과 안정성에 부정적인 영향을 미친다. 론문에서는 대출력 직류－직류변환기들에서 전류진동을 효과적으로 감소시킬수 있는 다중위상 다통로PWM조종기를 설계하기 위한 한가지 방법을 고찰하였다. １．한통로PWM구동방식을 리용한 승압형직류－직류변환기의 전압전류특성 한통로PWM구동방식을 리용한 승압형(Boost)직류－직류변환기의 일반적구조와 전류 전압변화특성을 그림 1에 보여주었다. VIN CIN Load Vo Co Vo Ls Vg iC D ㄱ) Q ΔI Vo− R t T ㄷ) ΔI t DT T ㄴ) 그림 1. 승압형직류－직류변환기의 일반적구조와 전류전압특성 ㄱ) 일반적구조, ㄴ) 입구전류, ㄷ) 충방전류, ㄹ) 전압파형 ΔVo T ㄹ) t iIN － 24 － 종합대학학보 정보과학 주체107(2018)년 제64권 제2호 그림 1의 ㄴ)에서 보는것처럼 한통로PWM조종방식을 리용한 승압형직류－직류변환기 의 입구전류파형은 톱날파형식을 가진다. 출구콘덴샤의 내부기생용량과 내부저항을 무시할 때 전압진동폭은 다음과 같다. DTV 0 RC (1) V 0 Δ = = 0 DTP 0 VC 00 0V 은 출구전압, 0P 은 출구전력, T 는 0VΔ 은 출구전압진동폭, R 는 출구저항, 여기서 PWM주기, D 는 작업주기, 0C 은 출구려파용량값이다. 식 (1)에서 알수 있는것처럼 출구전압요동은 출구전력에 비례하고 전원회로의 PWM 주파수와 출구용량값에는 반비례한다. 따라서 이 값을 줄이자면 출구려파용량을 늘이거나 전원회로의 PWM주파수를 증가 시켜야 한다. 그러나 출구려파용량을 증가시키는것도 한계가 있으며 소자의 절환주파수를 높이는 것도 역시 소자의 특성상제한을 받는다.[1] 스위칭전원회로의 출구려파콘덴샤로 사용하는 전해콘덴샤는 자체의 기생유도도성분 이 크기때문에 실제적인 절환잡음은 식 (1)에서 표현된 값보다 더 커진다. ２．분산방식형직류－직류승압변환기의 구성과 전류전압특성 다중위상 다통로PWM구동방식을 리용한 분산방식형승압변환기의 구성과 전류전압특 성은 그림 2와 같다. im i3 i2 m ③ ② ① iom io3 io2 i1 Ls1 S1 iIN VIN io1 io Vo C R S2 S3 Sm iIN DT iCI Δi iIN T m=3 DT ΔI t Vo T ΔI1 t ΔVoi 다중위상 다통로 PWM 조종기 m=3 T t 그림 2. 분산방식형승압변환기의 구성과 전류전압특성 t T 그림 2에서 볼수 있는것처럼 다중위상 다통로PWM구동방식을 적용하면 단일통로 PWM구동방식일 때보다 입출구전류전압변동이 훨씬 감소되며 이것은 승압형전원회로의 절환잡음을 크게 감소시킨다.[2] 통로수가 m일 때 p번째 PWM통로에서의 입구전류변동값은 다음의 식으로 표현할수 있다. p m p m ⎧ ⎪ ⎪ ⎪ ⎨ ⎪ ⎪ ⎪ ⎩ FPGA를 리용한 다중위상 다통로PWM조종기의 한가지 실현방법 － 25 － (1－ TD ≥) T 일 때 ( V o pT − mt ) , 0 t ≤< pT m − V )( IN mL S ) mt pT − mL S I ≈Δ P ( IN V pT m p mD + m TtT ≤< V IN L S DT − V o IN V − L S ⎛ ⎜ ⎝ t − p mD + m T ⎞ ,    ⎟ ⎠ p mD + m , t ≤< T (2) (1－ TD ≤) T 일 때 pT + mt ) 0  , t ≤< Dm mp −+ m T I ≈Δ P ⎧ ⎪ ⎪ ⎪ ⎨ ⎪ ⎪ ⎪ ⎩ V IN V IN V o − L S ( ( mT − mL S pT mt − mL S V ⎛ ⎜ ⎝ p m IN ) , Dm mp −+ m tT − ⎞ ,        ⎟ ⎠ p m TtT ≤< tT ≤< T (3) p m I =Δ T m I Δ ⎛ ⎜ ⎜ ⎝ max ∑ ⎛ ⎜ ⎜ ⎝ i INV 은 입구전압이며 ⎞ ⎟ min－ ⎟ ⎠ 1 = P i m ∑ I Δ P ⎞ ⎟ 0, ⎟ ⎠ ≤< Tt (4) 1 = PIΔ 는 주어진 어떤 시점의 입구전류변동값 식 (2)와 (3)에서 이다. 차로 결정된다. 전체적인 전류변동은 m개 통로의 개별적인 전류변동들의 합에서 최대값과 최소값의 그림 1과 2를 대비해보면 다중위상 다통로PWM구동방식으로 승압회로를 구동할 때 입구전류 및 출구전압변동이 훨씬 줄어든다는것을 알수 있다.[2] ３．다중위상 다통로PWM조종기의 설계와 구현 １）다중위상 다통로PWM조종기의 기능  ① 입력조종핀들의 론리준위값을 리용한 완전한 하드웨어적인 조종기능 ② 론리반결합조종방식을 리용한 전압조종방식의 출구전압조종기능  ③ 상별로 조종가능한 16상까지의 PWM구동신호출력기능  ④ 2～100kHz범위에서 PWM주파수의 설정기능  ⑤ 출구전압의 조종안정성을 높일수 있게 하는 불감시간 및 조종시정수의 설정기능 ⑥ 출구단락 및 과부하보호를 위한 PWM주기별에 따르는 전류차단기능 ２）조종기의 론리적구성도 그림 3에 다중위상 다통로PWM조종기의 구성도를 보여주었다. 그림 3에서 보는것처럼 조종기는 크게 4개의 모듈로 구성되여있다. 즉 외부론리설 정핀값에 따라 16개까지의 톱날파를 생성하기 위한 다중위상 톱날파발생모듈, 출구전압 － 26 － 종합대학학보 정보과학 주체107(2018)년 제64권 제2호 값과 기준전압값사이의 론리비교결과에 기초하여 출구전압추정량을 얻어내기 위한 전 압조종모듈, 다중위상 톱날파형과 전압추정값을 비교하여 다중위상 다통로PWM신호를 불감시간값까지 추가하여 생성하기 위한 PWM구동파형생성 및 불감시간설정모듈, 매개 PWM통로의 과전류상태를 실시간적으로 감시하여 PWM주기별로 보호하기 위한 과전류 보호모듈들이다. 주파수설정핀 ［2..0］ 조종시정수설정핀 ［2..0］ 조종방향설정핀 ［2..0］ 다중위상 톱날파신호 ［15..0］［15..0］ 다중위상 톱날파 발생모듈 다중위상 PWM 구동핀 ［15..0］ PWM 구동파형 생성 및 불감시간 설정모듈 과전류 보호모듈 전압조종모듈 조종추정 신호  불감시간설정핀 ［2..0］ 과전류수감핀 ［15..0］ 그림 3. 다중위상 다통로PWM조종기의 구성도 다중위상 톱날파발생모듈은 입력설정신호에 따라 각이한 주파수와 위상을 가지는 톱 날파신호를 생성하는 모듈로서 최대로 16까지의 다중위상 PWM신호를 생성하기 위한 비 교기준파를 16bit의 수자신호로 출력한다. 전압조종모듈은 출구전압값과 기준전압사이의 비교결과에 따라 출구전압의 반결합조 종을 실현하기 위한 조종모듈이며 PWM구동파형생성 및 불감시간설정모듈은 전압조종모 듈의 출력인 전압추정량과 기준톱날파를 비교하여 다중위상 다통로PWM신호를 생성하고 전력전자요소들의 안전한 동작을 위해 PWM출구파형에 불감시간주기를 삽입해주는 모듈 이다. 전류보호모듈[3]은 출구단락이나 과부하상태에서 과전류값을 수감하여 PWM주기별로 차단조종을 실현하기 위한 전류조종모듈이다. ３）조종기의 구성과 기능설정 (１) 다중위상 톱날파발생모듈  톱날파발생모듈은 16개까지의 다중위상 다통로방식의 수자식톱날파를 생성하기 위한 계수회로와 입력핀들의 론리에 따라 톱날의 주파수와 출구구동통로수를 변화시키기 위한 선택기 및 계수기조종회로로 구성된다. 이 모듈은 PWM신호를 생성하기 위한 다중위상 기준톱날파를 생성하는 모듈로서 량 측경사면을 가지는 톱날파를 생성한다. 이 모듈은 50MHz의 소편기준박자를 가지고 충분한 분해능을 가지는 2～100kHz의 범 위내에서 해당한 주파수를 가지는 톱날파를 생성한다. 톱날파주파수는 이 모듈에 대한 주파수설정입력핀(PWM_FREQ_SEL[2..0])의 론리준위 값들에 따라 8가지 방식으로 설정할수 있다. 또한 상설정핀(PHASE_SEL[3..0])의 론리준위값에 따라 최대 16개 통로까지의 다중위 FPGA를 리용한 다중위상 다통로PWM조종기의 한가지 실현방법 － 27 － 상 톱날파기준신호를 출력할수 있다. 주파수설정입력핀들의 론리준위에 따르는 톱날파주파수값들은 표 1과 같다. 표 1．주파수설정입력핀들의 론리준위에 따르는 톱날파주파수변화 No. 주파수설정입력핀들의 론리값 PWM_FREQ_SEL[2..0] 톱날파주파수/kHz 1 2 3 4 5 6 7 8 000 001 010 011 100 101 110 111 2 4 8 16 20 40 50 100 (２）전압조종모듈 전압조종모듈은 출구전압수감모듈로부터 입력받은 출구전압신호를 입력핀들의 론리 에 따라 증가, 감소 및 유지하기 위한 조종방향설정모듈과 조종시정수를 해당 입력신호의 론리준위에 따라 변경시키기 위한 시정수조종모듈로 구성된다. 표 ２．PWM조종특성 이 모듈은 조종방향설정핀(V_UP_DOWN[1..0])과 조종시정수를 조절하기 위한 조종시정수설정핀 (CTRL_STEP[2..0])의 론리준위에 따라 출력전압을 기 준전압과 해당한 시정수내에 일치하도록  조종한다. 해당 입력핀들의 론리에 따르는 PWM조종특성은 표 2와 같다. 조종방향설정핀론리 V_UP_DOWN [1..0] 조종특성 전압증가조종 전압감소조종 조종정지 예약 01 10 00 11 (３）PWM구동파형생성 및 불감시간(Dead time)설정모듈 PWM구동파형생성 및 불감시간설정모듈은 전압조종모듈로부터 입력된 출구전압추정 신호와 다중위상 다통로톱날파입력신호를 비교하여 설정된 위상수와 통로수를 가지는 PWM신호를 생성하기 위한 PWM생성모듈과 불감시간설정을 위한 입력조종신호들의 론리 에 따라 해당한 PWM주기마다에 불감시간주기를 삽입하기 위한 불감시간설정모듈로 구 성된다. 불감시간설정모듈은 PWM출력회로들에서 체계의 동작안정성을 높이기 위해 필요한 불감시간주기를 PWM임풀스주기마다 삽입해주는 기능을 수행한다. 이 모듈은 불감시간설정핀(DEAD TIME_SEL[2..0])들의 론리준위에 따라 100ns부터 10 sμ 범위에서 8개의 방식으로 불감시간을 변화시킬수 있다.(표 3) (４）과전류보호모듈 과전류보호모듈은 과전류 및 단락보호핀들로부터 입력된 론리신호로부터 과전류 및 단락상태를 검출하기 위한 출구과전류 및 단락검출모듈과 과전류 및 단락상태가 검출되 는 즉시에 출구 PWM을 차단하기 위한 보호모듈 그리고 매번의 PWM주기마다 보호상태 를 해제시키는 동기식재설정모듈로 구성된다. － 28 － 종합대학학보 정보과학 주체107(2018)년 제64권 제2호 표 ３．불감시간조종핀들의 론리준위에 따르는 특성값 No. 불감시간조종핀들의 론리값 DEAD TIME_SEL[2..0] 불감시간/ sμ 1 2 3 4 5 6 7 8 000 001 010 011 100 101 110 111 0.1 0.4 0.5 1 2 4 8 10 이 모듈은 과전류 및 단락상태를 PWM주기별로 검출하여 과전류수감핀(SPC[11..0])들 의 수감결과에 기초하여 출구 PWM신호를 주기별로 차단하는 기능을 수행한다. 과전류 및 단락보호입력신호들은 과전류 및 단락보호뿐아니라 조종기의 동작시작과 정지를 론리적으로 조종하는데도 적용할수 있다. ４）조종기의 구현과 시험결과 조종기의 설계와 구현은 Altera의 dspbuilder9.0기능을 리용하여 Matlab Simulink환경에 서 진행하였다. 소자는 Altera의 Cyclone I계렬의 EP1C6Q240C6이다. 우의 론리조종기를 리용한 12상 PWM승압정류회로에서 입구전압 및 출구전압변동특 성을 단상PWM조종기(UC3842)를 사용한 승압정류회로와 비교한 결과는 표 4와 같다. 표 ４．승압정류회로의 입출구전압변동특성 입구전압변동범위/V 출구전압변동범위/V 부하/kW 승압방식 단상승압형DC－DC변환방식 12상승압형DC－DC변환방식 단상승압형DC－DC변환방식 12상승압형DC－DC변환방식 3.3 0.03 10.5 0.15 0.7 0.03 1.7 0.09 10 30 표 4에서 알수 있는것처럼 12상 PWM론리조종기를 리용한 승압형정류회로의 입출구 전압변동특성은 단상PWM론리조종기를 사용한 경우[2]보다 입구전압변동폭이 1/100이하 이며 출구전압변동폭도 1/20이하이다. 이것은 다중위상 다통로PWM구동방식이 단상PWM구동방식에 비하여 PWM승압회로 의 잡음특성과 안정성이 훨씬 높다는것을 보여준다. 맺 는 말 대출력 직류－직류변환기들에서 전류진동을 효과적으로 감소시킬수 있는 다중위상 다통로PWM조종기를 Matlab의 DSP Builder도구를 리용하여 설계하고 FPGA(Field Programmable Gate Array)소편에 실현하였으며 승압형직류－직류변환기에 적용하여 그 유 FPGA를 리용한 다중위상 다통로PWM조종기의 한가지 실현방법 － 29 － 효성을 검증하였다. 결과 입구전압변동특성값은 1%, 출구전압변동특성값은 5%로 감소되였다. 참 고 문 헌 [1] R. Chedid et al.; Wind Eng., 22, 1, 1, 1998. [2] K. T. Wong; IEEE Power-Electr. Power Appl., 148, 1, 35, 2001. [3] J. Rodriguez et al.; IEEE Trans. Ind. In form, 9, 2, 1003, 2013. 주체107(2018)년 2월 5일 원고접수 A Implementation Method of Multiphase and Multichannel PWM Controller Using FPGA Choe Chung Song, Ri Hak Chol This paper presented a design method of multiphase and multichannel PWM controller. PWM controller can decrease switching noise of current in large power DC－DC converter. As a result of the test it is proved that this controller reduces input voltage coefficient of variation to 1%, output voltage coefficient of variation to 5% than preceding controller. Key words: FPGA(Field Programmable Gate Array), PWM(Pulse Width Modulation) controller