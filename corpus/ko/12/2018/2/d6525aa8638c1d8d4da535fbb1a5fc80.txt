김일성종합대학학보 정보과학 주체107(2018)년 제64권  제2호 한소편콤퓨터에 의한 수자온도측정체계구성의 한가지 방법 김 운 봉 종전에는 상사온도수감부를 리용하여 상사온도측정체계를 구성하고 상사/수자변환하 여 콤퓨터에 전송하는 방법으로 측정체계를 구축하였다. 이러한 온도측정체계는 상사식온 도수감부에서 얻어지는 상사량과 그것의 수자변환으로 인한 오차가 발생되여 온도측정의 정확도가 떨어지는 결함들이 나타났다.[1－3] 론문에서는 온도측정의 정확도와 체계안정성문제를 해결하기 위하여 한소편콤퓨터 ATmega16과 수자온도수감소자 DS18B20으로 구성된 수자식온도측정체계를 구성하는 문 제를 설정하고 해결하였다. １．수자식온도측정체계의 구성요소 수자식온도측정체계를 구성하자면 두가지 문제가 해결되여야 한다. 즉 한소편콤퓨터 ATmega16과 수자온도수감소자 DB18B20과의 장치대면부설계와 DS18B20조종프로그람작 성이다. １）장치대면부설계 한소편콤퓨터 ATmega16과 LCD현시기 및 DB18B20과의 결합을 위해서는 여러개의 입출력포구가 요구된다. 1602 LCD현시기와의 대면부에는 8개의 자료입출력선과 3개의 조 종신호선을 위한 포구가 필요된다. 그리고 DB18B20과의 대면부에는 1개의 자료입출력선 만이 요구된다. 이로부터 LCD와의 자료선 DB0－DB7과의 대면부에 자료입출력포구 PB, 빗장조종신호 E와의 대면부에는 PA6포구, 읽기/쓰기조종신호 R/W와의 대면부에는 PA5포 구를, 지령 및 자료선택조종신호 RS와의 대면부에는 PA4포구를 할당한다. 또한 DB18B20 과의 대면부에는 PD4포구를 할당한다. 이에 기초하여 ATmega16과 LCD, DB18B20과의 대면부를 구성하면 그림 1과 같다. LCD현시기와 DB18B20과의 대면부에 리용된 ATmega16의 모든 포구들은 일반자료입 출력동작을 수행한다. ２）DS18B20조종프로그람(수자온도측정프로그람) 조종프로그람은 크게 초기화함수, 바이트자료읽기함수, 바이트자료쓰기함수, 시동함수, 자료읽기함수로 이루어진다. 초기화함수의 기본기능은 한소편콤퓨터가 DS18B20에 초기화임풀스를 출력하고 DS18B20이 그것에 응답하여 시동임풀스를 출력하는 초기화렬을 구성하여 자료전송을 위 한 초기화를 진행하는것이다. DS18B20은 한소편콤퓨터가 출력하는 재설정임풀스에 응답하여 시동임풀스를 보내여 한소편콤퓨터에 의한 수자온도측정체계구성의 한가지 방법 － 19 － 한소편콤퓨터에 DS18B20이 모선상에 있으며 동작준비상태에 있다는것을 알린다. 그림 1. ATmega16과 LCD, DB18B20과의 대면부 초기화기간에 한소편콤퓨터는 최소 480μs동안 1선모선을 낮은 준위로 끌어내려 재설 정임풀스를 전송하고 수신방식으로 이행한다. DS18B20은 이 올림면을 검출하고 그 시각 부터 15μs부터 60μs까지 대기하며 다음에 60μs부터 240μs까지 1선모선을 낮은 준위로 끌 어내려 1개의 시동임풀스를 전송하여 한소편콤퓨터에 DS18B20이 있다는것을 알린다. 초기화함수실행흐름은 다음과 같다. ① ATmega16의 대역중단을 모두 불허한다. 그것은 이 시각에 어떤 중단이 발생되는 경우 DS18B20과의 통신초기화가 파괴되기때문이다. ② DS18B20과의 자료선포구 PD4를 출력방식으로 설정하고 DS18B20의 규약에 따라 500μs의 재설정임풀스를 PC6포구로 출력한다. 규약에서는 한소편콤퓨터가 출력하는 재설 정임풀스의 길이가 480μs이지만 여기서는 500μs로 설정한다. ③ 한소편콤퓨터는 PD4를 입력방식으로 설정하여 DS18B20으로부터 시동임풀스입력 을 80μs동안 대기한다. ④ 한소편콤퓨터는 DS18B20으로부터 시동임풀스상태를 입력한다. 500μs후 한소편콤 퓨터의 대역중단허가상태를 검사하고 허가되였다면 대역중단을 가능으로 설정한다. ⑤ 바이트자료읽기함수는 DS18B20으로부터 수자온도값을 읽기하는 기능을 수행한다. DS18B20은 상사온도값을 상사/수자변환하여 1B의 수자온도값을 직렬로 한소편콤퓨 따라서 한소편콤퓨터에서는 직렬로 수자온도값을 받아 병렬자료변환을 진행하여야 터에 전송한다. 한다. － 20 － 종합대학학보 정보과학 주체107(2018)년 제64권 제2호 ㄱ) 함수는 먼저 한소편콤퓨터의 대역중단을 불가능으로 설정한다. 그것은 DS18B20 으로부터 자료입력시 중단이 발생하는 경우 자료가 잃어지기때문이다. ㄴ)  DS18B20으로부터 1bit의 수자온도값을 입력한다. ㄷ) 입력된 직렬수자온도값을 비트별로 병렬변환한다. ㄹ) 한소편콤퓨터의 대역중단허가상태를 검사하고 허가되였다면 대역중단을 가능으 로 설정한다. ⑥ 바이트자료쓰기함수도 바이트자료읽기함수와 류사한 기능을 수행하게 된다. 즉 한 소편콤퓨터가 DS18B20에 1B의 명령을 쓰기하는 기능을 수행한다. ⑦ 시동함수에서는 초기화함수를 호출하여 DS18B20에 대한 초기화 즉 DS18B20과의 초기화렬을 형성한데 기초하여 Skip ROM명령과 Convert_T명령을 DS18B20에 전송한다. 이때 1B쓰기함수를 리용한다. 이 함수에 의하여 DS18B20은 온도수감을 진행하여 얻어진 상사온도값을 수자값으로 변환하게 된다. ⑧ 자료읽기함수는 DS18B20에 대한 초기화를 진행하고 ROM명령과 기능명령을 전송 하여 DS18B20이 수자값으로 변환된 온도수자값을 준비해놓은 상태에서 수자온도값을 읽 어들이는 함수이다. ㄱ) DS18B20에 대한 초기화를 진행한다. ㄴ) DS18B20에 ROM뛰여넘기명령을 전송하여 임의의 ROM코드정보를 내보냄이 없이 동시에 모선상의 모든 장치들을 주소화한다. ㄷ) 패드읽기명령을 DS18B20에 전송하여 온도변환값을 읽어들인다. 이에 기초하여 바이트읽기함수를 호출하여 수자온도값을 입력한다. ⑨ DS18B20의 구동부분프로그람과 1602 LCD현시기의 구동부분프로그람작성에 기초 하여 수자식온도측정프로그람의 기본함수를 작성한다. ２．기본함수흐름도 기본함수는 크게 포구초기화와 DS18B20초기화, LCD초기화, DS18B20에 의한 온도측 정현시부분으로 이루어진다. 기본함수흐름도를 그림 2에 보여주었다. ① 포구초기화에서는 LCD현시기대면부조종신호들을 위한 PA 및 PB포구초기화를 진 행한다. 입력포구방식인 경우에는 끌어올림저항을 유효로 설정한다. ② DS18B20의 초기화를 진행한다. DS18B20의 초기화렬이 형성되고 한소편콤퓨터와 DS18B20사이의 신호접속이 이루어진다. 8bit자료모선방식, 5×8점방식이 설정된다. ③ LCD현시기초기화를 위해 LCD초기화함수를 호출한다. 결과 LCD의 2행현시방식, ④ LCD현시기에 온도측정값을 현시하기 위한 문자렬들을 현시하여 현시준비를 완료 ⑤ DS18B20시동을 진행한다. 즉 시동함수를 호출하여 ROM뛰여넘기명령과 변환명령 을 DS18B20에 전송하여 온도변환을 진행하고 상사/수자변환한다. 한다. 한소편콤퓨터에 의한 수자온도측정체계구성의 한가지 방법 － 21 － ⑥ DS18B20으로부터 수자온도변환값을 입력한다. 이를 위해 자료읽기함수를 호출한다. ⑦ 수자온도값을 LCD에 현시한다. 이와 같은 과정을 반복한다. 그림 2. 기본함수흐름도 맺 는 말 론문에서는 수자온도소자 DS18B20의 특성을 분석한데 기초하여 수자온도소자와 한 소편콤퓨터 ATmega16과의 련결포구를 확정하고 ATmega16과 LCD현시기, 수자온도소자 DS18B20으로 구성된 수자식온도측정체계를 구성하였다. 또한 수자온도소자 DS18B20조종프로그람과 LCD현시구동프로그람을 작성한데 기초 하여 수자온도측정체계를 구성하였다. 참 고 문 헌 [1] 김명성 등; 정보과학, 1, 61, 주체105(2016). [2] 葛治军; 信息技术, 9, 149, 2005. [3] 李军; 测控技术, 21, 7, 65, 2002. 주체107(2018)년 2월 5일 원고접수 － 22 － 종합대학학보 정보과학 주체107(2018)년 제64권 제2호 A Method of Configuration of Digital Temperature  Measurement System by MCU In this paper, unlike prior analog temperature measurement system, digital temperature measurement system was configured with a combination of digital temperature device DS18B20 and ATmega16 MCU. Also on the basis of programming to control digital temperature device DB18B20 and to drive for LCD, digital temperature measurement system was configured. Kim Un Bong Key words: temperature measurement, MCU