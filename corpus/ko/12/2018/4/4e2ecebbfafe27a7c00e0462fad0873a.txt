김일성종합대학학보 정보과학 주체107(2018)년 제64권  제4호 SIP를 리용한 탁상화면공유의 한가지 방법 안창혁, 최정혁, 신문혁 SIP[1]는 현재 IP망에서 다매체호출확립규약으로서 절대적인 지위를 차지하고있다. 론문에서는 먼저 탁상화면의 공유를 실현하기 위한 대표적인 선행방법[2]을 연구한데 기초하여 표준적인 SIP봉사기나 말단들과도 호환성이 가능하고 높은 영상질을 보장할수 있는 한가지 방법을 제기하였다. １．탁상화면공유의 실현방법 론문에서는 탁상화면공유를 위한 자료흐름과 조종을 위한 자료흐름을 서로 다르게 구성하였다. 순수 탁상화면의 공유는 본질에 있어서 일반 영상대화와 같다고 볼수 있다. 다만 화상원천이 카메라입력자료가 아니라 사용자의 콤퓨터화면자료가 된다. 그러므로 말단프로그람이 탁상화면의 자료를 취하여 제공하여준다면 탁상화면의 공 유는 사실상 영상대화와 같다. 탁상화면공유를 실현하기 위한 말단의 요구사항을 표에 보 여주었다. 표. 장치입력모듈의 구성 화상모듈 화면입력모듈 탁상화면 1 화면입력모듈 탁상화면 2 … … 카메라모듈 카메라 1 카메라모듈 카메라 2 사용자는 호출확립시에 장치정보를 교환하고 화면공유를 위한 매체흐름을 구성한다. 화상자료의 부호화는 H.264방식을 리용한다. 탁상화면공유시에 SDP통보문의 구조는 다음과 같다. c: IN IP4 170.102.122.39 t: 0 0 m: video 10004 RTP/AVP 96 99 a: rtpmap: 96 H264/9000 a: fmtp:96 profile-level-id=4DE01f; packtization-mode=1 a: imageattr: 96 send*recv [x=[0-1600], y=[0-900]] ２．SIP를 리용한 원격조종실현방법 론문에서는 SIP의 SUBSCRIBE, NOTIFY통보문들을 리용하여 원격조종을 실현하였다. １）통보문의 흐름과정 조종순차는 다음과 같다. ① 공유자는 조종자에게 원격조종을 위한 SUBSCRIBE통보문을 보낸다. SIP를 리용한 탁상화면공유의 한가지 방법 － 15 － ② 조종자는 원격조종정보를 NOTIFY통보문으로 만들어서 공유자에게 송신한다. 그림 1에 원격조종을 위한 SIP통보문의 흐름과정을 보여주었다. Invite 200 Ok 조종요구 (RTP 쎄션) Notify … Subscribe Expire:0 Subscribe Event:remote-control 그림 1. 원격조종을 위한 SIP통보문의 흐름과정 통보문구성에서 알아야 할 내용들은 다음과 같다. 원격조종을 위한 SUBSCRIBE대화는 어디까지나 화면공유대화에 속하므로 대화식별 자를 자기의 본 대화식별자와 같이 한다. 그러므로 본 대화가 완료되면 자동적으로 원격 조종용SUBSCRIBE대화도 완료되게 된다. 이것은 신호가 봉사기중계방식인 경우 비정상적인 대화완료시에 봉사기의 부하를 줄 이도록 한다. SUBSCRIBE와 NOTIFY통보문의 Event머리부는 remote-control값으로 보낸다. 조종자가 NOTIFY를 보낼 때마다 CSeq값이 반드시 하나씩 증가하여야 한다. NOTIFY통보문의 Content-Type는 remote-control+xml로 한다. ２）원격조종용NOTIFY통보문의 구조 NOTIFY통보문의 내용부분은 XML형식으로 이루어져있다. 통보문의 구조는 사용자의 마우스와 건반사건을 보내기 위하여 설계되였다. XML의 정의는 다음과 같다. <?xml version=1.0 ?> <remote-control ns=““version=””> <mouse> <move x=“[0..1]” y=“[0..1]” /> <pressed alt=“[1－3]” /> <released alt=“[1－3]” /> </remote-control> </mouse> <keyboard action=“[pressed|released]” charcode=“[0－256]” /> － 16 － 종합대학학보 정보과학 주체107(2018)년 제64권 제4호 ３）원격조종정보의 생성 및 처리 원격조종은 명백히 조종자와 공유자의 처리로서 갈라진다는것을 알수 있다. 조종자는 조종정보를 만들어 보내며 공유자는 그것을 받아서 처리한다. 조종정보의 생성 및 처리에 서는 다만 순차성문제만이 제기된다. SIP는 기본적으로 UDP규약을 사용하므로 파케트의 순차성을 담보할수 없다. 그러나 조종정보는 순차성이 철저히 담보되여야 하므로 이에 대한 추가적인 처리를 요구한다. 이 처리에 대한 요구사항은 다음과 같다. 조종자프로그람에서는 조종자의 마우스 및 건반사건이 일어나면 시간을 기준으로 하 여 차례로 NOTIFY통보문을 만들어 보낸다.(이때 remote-control꼬리표의 version속성값을 1 씩 증가시킨다. 이것은 공유자에게 있어서 매우 중요한 정보로 된다.) 공유자는 NOTIFY통보문을 받아서 remote-control꼬리표의 version정보를 분석하여 마 지막으로 받은 version값보다 작거나 같으면 무시하고 크면 처리한다. 우의 요구에 따라 처리를 진행하는 과정에 리론적으로 무시되는 값이 있을수 있다. 이것은 다음의 경우에 일어날수 있다. ① 사용자의 사건발생간격이 빠른것으로 하여 망상에서 파케트의 순서가 바뀔수 있다. ② 망지연이나 봉사기의 부하로 인하여 파케트가 중복전송될수 있다. 사용자의 행위는 두가지로서 건반과 마우스사건으로 이루어진다. 전자에 대하여 론의 할 때 사용자의 건반사건은 인간의 행위로 인한것으로 하여 아무리 빨라도 1s에 20번 발 생하기 어렵다. 그러나 마우스는 체계의 특성에 따라 1s에 수십번씩 발생하며 지속시간도 비교적 오 그러므로 전자의 경우 일부 마우스사건에 대한 통보문이 무시될수도 있다. 그러나 요 구사항에 따라 제일 마지막통보문은 반드시 전달될것이므로 원격조종에서 불합리한것은 없다. 후자의 경우에 중복전송되는 파케트는 무시되므로 사용자에게 아무러한 영향도 미치 래다. 지 않는다. ３．실험 및 성능평가 여기서 기본목적은 화면공유의 특성과 원격조종에서의 부하특성을 검증하는데 있다. 화면공유의 특성에 대한 검증은 공유화면의 화질과 망에서의 대역폭에 대한 측정을 통하여, 원격조종에서의 부하특성은 조종자의 조종파케트루실률과 대역폭에 대한 측정을 통하여 진행한다. 시험에서는 2대의 Core I3콤퓨터가 사용되였으며 두 콤퓨터는 100Mbps망카드를 적재 하고있다. 콤퓨터들에는 각각 Java로 작성한 말단프로그람들이 동작하고있으며 봉사기는 따로 없다. 2대의 말단은 P2P통신을 진행한다. 화면공유를 위한 화면통신부호화모듈은 H.264를 리용하였다. 먼저 화면공유의 특성을 분석하여본다. SIP를 리용한 탁상화면공유의 한가지 방법 － 17 － 공유화면의 봉우리신호대잡음비(PSNR)를 계산하고 1min동안 AutoCAD2007에 대한 화면공유를 진행하였다. 이때 화면의 해상도는 1 600×900이다. 그림 2에 화상의 신호대잡음비를, 그림 3에 화면공유통신대역폭을 보여주었다. 36.5 R N S P 36.0 35.5 35.0 34.5 34.0 33.5 0 10 20 30 40 50 60 70 t/s 그림 2. 화상의 신호대잡음비 그림 3. 화면공유통신대역폭 실험결과는 PSNR값이 평균 35로서 사용되는 대역폭에 비하면 비교적 높은 수값을 나타낸다. 실제로 화면에서 10pt정도의 영문서체도 명백히 알아볼수 있다는것을 보여준다. 다음은 원격조종의 특성을 분석하여보자. 그림 4는 1min동안에 원격조종용NOTIFY통보문의 수와 그로 인한 통신대역폭을 보여 준다. 그림 4에서 봉우리를 이루는 10～14s까지의 구간은 조종자가 무질서하게 마우스를 움직일 때 나타나는 현상이다. 타자구간은 30～34s사이인데 타자속도는 초당 15건으로서 매우 빠르게 진행되였다.  그림 4에서 알수 있는바와 같이 최대타자구간은 보통 마우스사건구간과 거의 같다. － 18 － 종합대학학보 정보과학 주체107(2018)년 제64권 제4호 우와 같은 실험을 10번 반복하여 NOTIFY통보문의 손실률을 측정하였는데 최대마우 스구간인 10～15s사이에서 99.9%를 보장하였다. 150 120 / 90 개 수 문 보 60 통 30 0 10 20 30 40 50 t/min 60 그림 4. 원격조종용NOTIFY통보문의 수와 통신대역폭 현재 SIP통합대화기들과의 호환성을 보장하면서도 화면공유에서 화질이 충분히 보장되 였다는것을 실험적으로 증명하고 회의방식에서의 확장성도 제기하였다. 따라서 사용자들은 영상대화중에 탁상화면과 카메라를 바꾸어가면서 대화할수도 있게 되였다. 제안된 방법은 IP-PBX들과 호환성을 가진다. 맺 는 말 참 고 문 헌 [1] J. Rosenberg et al.; SIP, IETF RFC3261, 2002. [2] Y. Chan et al.; Metadata Capture for Screen Sharing, US9021367, 2015. 주체107(2018)년 8월 5일 원고접수 A Method of Desktop-Sharing Using SIP An Chang Hyok, Choe Jong Hyok and Sin Mun Hyok This paper describes a method for sharing and controlling desktop over network using SIP(Session Initiation Protocol). Key words: SIP, desktop-sharing