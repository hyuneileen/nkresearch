김일성종합대학학보 정보과학 주체107(2018)년 제64권  제4호 생물가스생산공정에서 최량실험계획법에 의하여 파라메터동정의 정확성을 높이기 위한 한가지 방법 길호일, 전재경 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《과학자, 기술자들은 현실에 튼튼히 발을 붙이고 사회주의건설의 실천이 제기하는 문 제들을 연구대상으로 삼고 과학연구사업을 진행하여야 하며 연구성과를 생산에 도입하는 데서 나서는 과학기술적문제들을 책임적으로 풀어야 합니다.》(《선집》 증보판 제15권 492페지) 유기물질의 혐기성분해[1]는 수많은 미생물들에 의하여 이루어지는 복잡한 생화학공 정으로서 비선형성과 불확정성의 특징을 가지며 따라서 그것의 파라메터동정의 가능성과 질은 실험계획에 크게 의존한다. 론문에서는 최량실험계획(OED : Optimal Experimental Design)수법을 리용하여 혐기성소 화공정의 대표적인 수학적모형의 하나인 ADM1의 파라메터를 정확하게 추정하기 위한 실험계획을 얻어내는 한가지 방법에 대하여 제안하였다. １．유전알고리듬을 리용한 최량실험계획작성 비선형체계인 경우 파라메터동정을 위한 실험계획은 일반적으로 그것의 정보량(파라메 터에 관한 정보량(FIM : Fisher Information Matrix))을 최대화하는것[1]을 목표로 하여 결정한다.  파라메터들의 단위가 서로 다른것을 고려하여 우리는 OED의 D－기준을 리용하여 목 적함수를 다음과 같이 설정하였다. max det F = det D ⎧ ⎪ ⎨ ⎪ ⎩ N m ∑∑ k i 1 1 = = w i y ∂ i θ ∂ ⎛ ⎜ ⎝ t ( k ) Q i k , T ⎞ ⎟ ⎠ y ∂ i θ ∂ t ( k ) ⎫ ⎪ ⎬ ⎪ ⎭ (1) 여기서 F는 FIM행렬로서 실험계획의 정보량을 나타내며 θ는 파라메터벡토르, y 는 관측 w , Q 는 무게파라메터들로서 관측량의 중요도와 매 시각에서 그것의 측정오차 벡토르, i i ,k 에 의하여 결정된다. 또한 D는 실험계획벡토르로서 매 시각에서의 희석률로 구성된다. 즉 , 1[ D D , = L ADM1모형의 복잡성으로부터 식 (1)에서 출력 y의 파라메터 θ에 관한 도함수를 얻어 이다. D T ]N 내는것은 비교적 곤난하므로 다음과 같은 수값미분으로 그것의 근사값을 구한다. ∂ ∂ ∂ y y y j θ ∂ t ( k ) = ⎡ ⎢ ⎣ j θ ∂ 1 t ( k ) L j t ( k ) ⎤ ⎥ ⎦ θ ∂ n ∂ y j ∂ θ i t ( k ) = i Δ+ y j ( θ , k ) − y ( θ j i Δ− , k ) 2 Δ θ i 생물가스생산공정에서 최량실험계획법에 의하여 파라메터동정의 … － 41 － 여기서 jy kθ 는 k 시각에 파라메터가 θ인 모형의 ( , ) j 째 출력을 의미한다. 또한 θ t =Δ− [ θ 1 , , L θθ Δ− i i , , L θ n ] T , + θ i Δ = 1[ θ , L , + Δ θ θ i i , , θ n L T ] 이다. ADM1의 모의시간이 비교적 길기때문에 최량화문제 (1)을 푸는데 많은 시간이 소모 될수 있으므로 희석률 D를 실현하는 현실적조건을 고려하여 다음과 같은 가정을 한다. ① D는 일정한 시간구간동안에 불변이다.(구간상수) 즉 = k D N i ( ⋅ N N k ⋅ + 0, ), = = ) ( / i , , D N i p p p L 1, , N p L − 1 이다. 여기서 pN 는 변화주기를 의미한다. ② D는 유한개의 상수값만을 취한다. 즉 lN 1 D , , lND 은 D가 취할수 있는 수값의 개수이다. ( ) { ∈ D k L min }, D D D ∈ [ , i D max ] 이다. 여기서 실례로 iD 를 평등분포값으로 설정할수 있다.  ) D ( i D D = + min D − min 1 − max N l ( i ⋅ − 1), i = 1, L               (2) N , l 그러면 D의 탐색공간은 ( lN 으로 축소되며 계산시간을 훨씬 단축하게 된다. 한편 최량화문제 (1)의 풀이를 구하기 위하여 우리는 대역적탐색방법인 유전알고리듬 N N ) p (GA)을 리용하였다. 그림 1에 후보풀이의 염색체표현실례를 보여주었다. D   maxD minD pN pN2 1D 2D pkN N= 시간/d / pNN D 염색체 그림 1. 후보풀이의 염색체표현실례 또한 식 (1)을 리용하여 매개의 개체들의 적응도를 계산한다. 유전알고리듬의 기본연 산들 즉 초기화, 선택, 교차, 변이조작들은 Matlab의 GA ToolBox의 기정값을 리용하였는데 구체적으로는 다음과 같다. ① 초기화 : 우연적으로 초기개체군을 생성한다. ② 선택 : 비례선택법을 리용한다. ③ 교차 : 우연교차법을 리용한다. ④ 변이 : 우연변이조작을 리용한다. － 42 － 종합대학학보 정보과학 주체107(2018)년 제64권 제4호 전체 파라메터동정흐름도를 그림 2에 보여주었다. 파라메터값범위 초기값설정 동적모형풀이 OED 해석기 자료비교 실제자료 곡선일치? 파라메터조정 아니 예 최량화된 파라메터모임 끝 그림 2. 전체 파라메터동정흐름도 ２．모 의 실 험 모의실험을 통하여 제안된 방법의 효과성을 검증하였다. １）민감도분석 우선 선행방법[2]에 기초하여 ADM1의 초기파라메터들과 입력성분의 농도를 설정하였다.  미생물의 초기농도가 공정의 동적특성에 미치는 영향을 고려하여 두가지 정황 즉 미 3 0.1kgCODm− )를 설정하고 1.0 kgCODm− )와 낮은 경우(C2: 생물초기농도가 높은 경우(C1: 3 실험을 진행하였다. 다음으로 모의시간은 40d, 희석률은 다음과 같이 설정하였다. ( ) D t ⎧ = ⎨ ⎩ 0.05, 0, 0 10 t ≤ ≤ t < ≤ 10 40 우의 두가지 정황하에서 얻어진 파라메터민감도분석결과에 기초하여 관건적인 파라 메터로서 다음의 파라메터들을 선택하였다. disk 분해속도상수 : 초산과 기름질분해균의 최대기질소모상수 : 기름질과 수소분해균의 반포화속도상수 : K k , k , m ac , m fa , K , S fa , S h 2 분석결과 C2의 경우에 k , m ac , k 의 민감도가 C1보다 높다는것 즉 C2인 경우 파라 , m fa 생물가스생산공정에서 최량실험계획법에 의하여 파라메터동정의 … － 43 － 메터에 관한 정보함량이 더 높다는것을 알수 있다. ２）최량실험설계 OED의 D-기준과 목적함수 (1)에 기초하여 유전알고리듬을 리용하여 최량인 실험방안 을 얻어내였다. 유전알고리듬의 초기개체군수를 40개로, 희석률변화주기는 2d로, 희석률은 0, 0.025, 0.05, 0.075, 0.1중의 한값을 취하는것으로 설정하였다. 얻어진 ADM1파라메터동정 을 위한 최량실험계획을 그림 3에 보여주었다. 률 석 희 0.15 0.1 0.05 0 0 5 10 15 25 30 35 20 시간/d 40 그림 3. ADM1파라메터동정을 위한 최량실험계획 ３）파라메터최량화 ADM1의 동력학적모형의 파라메터들가운데서 k dis , k S , fa , k , acm 를 각각 0.3, 0.6, 0.4로 설정하고 기타 파라메터들은 선행방법[3]의 값으로 설정한다. 다음 우의 실험계획에 따라 모의실험자료를 얻어내였다. 다음 실험자료에 가장 부합되는 파라메터들을 곡선근사화의 방법으로 구하였다. 파라메터들의 초기값과 변화구간은 그것의 물리적의미와 선행방법[2, 3]에 근거하여 다음과 같이 결정하였다.  1.0 1.0 1.0 표．ADM1파라메터추정결과 0.1 ≤ ≤ 2.1 5.1 실제값 추정값 ≤ ≤ ≤ k k k 0.29 0.3 dis ≤ fa S , acm , 파라메터 disk  faSK , acmk , 0.6 4 0.64 4.81 ADM1파라메터추정결과를 표와 그림 4에 보여 주었다. 표와 그림 4에서 볼수 있는것처럼 얻어진 파라메터들은 실험자료와 비교적 잘 일치된다. 0.2 0 5 10 15 25 30 35 40 20 시간/d 그림 4. ADM1파라메터추정결과 실제파라메터에 의한 자료 동정파라메터에 의한 자료 0.8 0.7 0.6 0.5 0.4 0.3 ) 1 - d 3 - m D O C g k ( / 량 류 스 가 탄 메 － 44 － 종합대학학보 정보과학 주체107(2018)년 제64권 제4호 맺 는 말 참 고 문 헌 대역적최량화수법의 하나인 유전알고리듬을 리용하여 혐기성소화공정의 파라메터동 정을 위한 최량실험계획을 작성하고 그에 의하여 보다 유효하고 정확한 파라메터를 결정 하는 한가지 방법을 제안하였다. 제안된 방법의 효과성을 모의실험을 통하여 검증하였다. [1] A. Donoso-Bravo et al.; Water Research, 45, 17, 5347, 2011. [2] S. Hassam et al.; Biochemical Engineering Journal, 99, 193, 2015. [3] U. Jeppsson et al.; Water Science and Technology, 53, 1, 287, 2006. 주체107(2018)년 8월 5일 원고접수 A Method for Improving the Accuracy of Parameter Estimation by OED in the Biogas Production Process Kil Ho Il, Jon Jae Gyong In this paper, we proposed a method to obtain the experimental design for estimating the parameters of ADM1, which were the typical mathematical model of anaerobic digestion, by OED. Key words: parameter estimation, anaerobic digestion process, experimental design