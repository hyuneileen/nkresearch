김일성종합대학학보 정보과학 주체107(2018)년 제64권  제3호 Diameter규약에 의한 AAA봉사기구축의 한가지 방법 김강현, 송준명 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《정보통신부문에서는 그 우월성이 확증된 IP망으로 통신기반을 전반적으로 갱신하고 전국적범위로 확대하며 고정통신과 이동통신을 통합하여 그 응용능력과 편리성, 효과성을 최대로 높이도록 하여야 합니다.》 AAA봉사기는 가입자들에 대한 인증 및 접근권한과 료금계산기능을 제공해주는 봉사 기이다. 중요한 문제로 나선다. 고정통신과 이동통신을 통합하는 다음세대통신망에서 AAA봉사기를 구축하는 문제는 론문에서는 AAA규약인 Diameter규약을 실현한 선행결과[1, 2]에 기초하여 우리 식의 새로운 AAA봉사기를 구축하기 위한 한가지 방법을 제안하고 성능을 시험하였다. １．AAA봉사기의 구축방법 １）봉사기의 구조 AAA봉사기는 그림 1과 같이 3개의 모듈로 이루어진다. 확장모듈 삽입쏘프트웨어방식으로 Diameter 응용프로그람을 처리 처리모듈 Diameter 기본규약 처리 서고모듈 처리모듈과 확장모듈에서 사용 그림 1. AAA봉사기구조 ① 처리모듈 Diameter기본규약을 처리하는 모듈로서 말단들의 련결을 관리하며 삽입쏘프트웨어방 식으로 추가된 응용프로그람들을 실행시켜 말단들에 대한 요청을 처리해주는 기능을 수 행한다. ② 서고모듈 처리모듈과 확장모듈에서 사용되는 통보문해석과 대화처리, 로그처리들을 제공해준다. Diameter규약에 의한 AAA봉사기구축의 한가지 방법 － 13 － ③ 확장모듈 삽입쏘프트웨어방식으로 여러개의 Diameter응용프로그람들을 관리함으로써 인증과 권 한처리, 료금계산처리를 위한 응용프로그람들을 1개의 봉사기에서 가동시키거나 부하가 커지는 경우 여러개의 봉사기에 쉽게 분산할수 있도록 한다. ２）AAA처리를 위한 응용프로그람설계 ① EAPServer 인증과 권한확인을 진행하는 응용프로그람이다.  인증방법은 RFC5216에서 정의된 EAP-TLS를 사용하며 Diameter규약에서 EAP파케트 를 처리하기 위하여 RFC4072에서 정의된 Diameter EAP Application규약을 실현한다. 권한처리는 인증이 성공한 경우 Diameter EAP파케트로 필요한 권한정보를 전송하는 방법으로 진행한다. 인증시 전송되는 파케트의 계층구조는 그림 2와 같다. TLS EAP-TLS EAP Diameter 그림 2. 인증파케트의 계층구조 ② CCServer, ACServer 료금계산처리를 진행하는 응용프로그람이다. 료금계산처리는 실시간처리와 비실시간 처리방식을 모두 지원하는것으로 한다. 실시간처리를 위한 응용프로그람은 CCServer로서 RFC4006에서 정의된 Diameter신용 조종응용(Credit Control Application)규약을 실현한다. 비실시간처리를 위한 응용프로그람은 ACServer로서 Diameter기본규약에서 정의된 회 계요청/회계응답명령을 처리한다. ３）통보문처리흐름 말단들에서 들어오는 요청을 처리해주기 위하여 봉사기는 3개의 대기렬(요청대기렬, 처리대기렬, 응답대기렬)과 3개 부류의 스레드들(요청처리스레드, 응답처리스레드, 내부처 리스레드)을 사용한다.(그림 3) 봉사기부하에 따라 해당 부류의 스레드들을 여러개 기동시켜 처리할수 있도록 한다.  의뢰기로부터 받은 Diameter통보문들은 초기 통보문해석과 통보문검증과정을 거쳐 요 청대기렬에 보관된다. 를 검사한다. 요청처리스레드들은 요청대기렬에서 통보문을 꺼내서 내부처리가 가능한 통보문인가 내부처리가 불가능하면 응답대기렬에 추가하여 다른 봉사기가 처리하도록 통보문을 전송하게 된다.(통보문중계자의 기능수행) 통보문이 내부적으로 처리가 가능한 통보문인가를 검사하여 처리대기렬에 추가한다.  내부처리스레드들은 확장모듈에 등록된 응용프로그람들을 사용하여 통보문을 처리하 － 14 － 종합대학학보 정보과학 주체107(2018)년 제64권 제3호 고 해당한 응답을 생성한다. 요청대기렬 ② 요청처리 스레드 ① 전송대기렬 요청보관목록 ⑧ 응답대기렬 ⑦ 응답처리 스레드 ⑥ ③ ⑤ 처리대기렬 ④ 내부처리 스레드 확장모듈 그림 3. 통보문처리흐름 그림 3의 ②와 ④에서 다른 봉사기 혹은 의뢰기에 전송해야 하는 통보문들이 응답대 응답처리스레드들은 응답대기렬에서 통보문을 꺼내서 통보문을 전송해야 하는 목적 전송할 목적지가 결정되면 통보문들은 해당 목적지의 전송대기렬에 추가되여 해당 기렬에 추가된다. 지를 결정한다. 목적지로 전송되게 된다. 요청파케트가 전송되면 해당한 응답파케트가 도착할 때까지 요청보관목록에 보관되 며 일정한 시간안에 응답파케트가 도착하지 않으면 요청파케트를 다시 전송하게 된다. (재전송처리) 또한 응답이 오기 전에 련결이 해제되는 경우 다른 봉사기에로 처리를 시도할수도 있다. (실패시 처리기능) ３．성 능 시 험 １）시험환경 시험은 구축된 AAA봉사기의 안정성과 처리능력을 평가하기 위하여 각이한 류형의 요청통보문을 다량으로 전송할 때 봉사기의 처리확률에 대한 분석을 진행하는 방법으로 하였다. Diameter규약에 의한 AAA봉사기구축의 한가지 방법 － 15 － 시험에서는 2개의 콤퓨터(말단과 봉사기)와 1개의 경로기를 사용하였다.(그림 4) 의뢰기 (Core I5 1G RAM) Diameter Diameter 봉사기 (Core I5 1G RAM) 경로기 (TP-LINK 100Mbps) 그림 4. 시험환경 시험은 각이한 류형의 요청통보문에 대하여 1s당 N개의 요청을 30min동안 전송할 때 의 성공확률을 기록하는 방법으로 진행하였다. ２）시험결과 N = {100, 200, 300, 400, …, 4 700, 4 800, 4 900, 5 000}: 1s당 전송한 요청개수 1s당 전송하는 요청개수를 우와 같이 설정하고 시험을 진행한 결과 성공확률은 그림 5와 같다. 100 / % 률 확 공 성 50 0 1 000 2 000 3 000 4 000 5 000 요청개수 그림 5. 여러가지 류형의 요청부하에 따르는 성공확률 실선–인증요청, 파선–실시간 료금계산요청, 점선–비실시간 료금계산요청 다음의 표에 시험결과를 보여주었다. 표. 시 험 결 과 요청류형 요청당 통보문 개수 1s당 처리할수 있는  요청개수(MAX) 선행봉사기[2]에서  처리개수 인증요청 실시간 료금계산 요청 비실시간 료금계산 요청 3 2 1 1 100 1 800 3 200 260 지원하지 못함 지원하지 못함 맺 는 말 시험결과 새롭게 구축된 봉사기가 선행한 봉사기에 비하여 처리능력이 우월하다는 것이 검증되였으며 수만명의 가입자를 가진 중규모체계에서 사용할수 있다는것을 검증 하였다. 또한 봉사기의 성능을 높이거나 부하분산알고리듬을 리용하면 대규모체계에서도 사 용할수 있다는것을 검증하였다. － 16 － 종합대학학보 정보과학 주체107(2018)년 제64권 제3호 참 고 문 헌 [1] 박명숙; 망보안규약, 공업출판사, 125～145, 주체102(2013). [2] M. Nakhjiri; AAA and Network Security for Mobile Access, Wiley, 147～165, 2005. A Method for Constructing a AAA Server Using Diameter Protocol 주체107(2018)년 5월 5일 원고접수 Kim Kang Hyon, Song Jun Myong In this paper, we proposed a method constructing a AAA server using diameter protocol and evaluated its performance. Key words: AAA server, on-line charging