김일성종합대학학보 정보과학 주체110(2021)년 제67권  제1호 국부적이동을 가지는 가우스혼합모형을 리용한 피부표면의 깊이추정방법 윤강진, 전명일 선행연구[1]에서는 피부표면복제품이나 레이자 혹은 전기마당을 리용하는 측정기구 를 통하여 피부상태를 측정하고 그것에 기초하여 피부표면의 3차원모형을 생성하였다. 깊이정보를 얻기 위한 여러가지 방법[3, 4]들이 제안되였으며 그가운데서 대표적인 한가 지 방법은 카메라의 초점거리를 리용하는 3차원깊이지도생성방법인 Shape From Focus(SFF)[2] 방법이다. 론문에서는 전용측정기구에 의존하지 않고 일반카메라를 리용하여 피부표면의 깊이 를 추정하기 위한 방법을 제안하였다.(그림 1) 화상평면 P i o 대상평면 렌즈 그림 1. SFF방법의 원리 Q 광학식촬영장치 이송장치 렌즈의 초점거리를 f , 대상평면으로부터 렌즈의 중심평면까지의 거리를 o , 렌즈로부터 화상평면까지 의 거리를 i 라고 하면 다음의 식이 성립한다. 11 =+ i o (1) 1 f 이에 기초하여 측정기구를 다음과 같이 구성하였 조종기판 직류전원 그림 2. 측정장치의 구성도 다.(그림 2) １．국부적이동을 가지는 가우스혼합모형의 학습 광학식촬영장치가 이동하면서 피부표면 SF 를 촬영하여 얻은 순서화된 화상렬을 , (cid:34) 이라고 하자. , I 1 , I 2 MI 국부적이동을 가지는 가우스혼합모형을 리용한 피부표면의 깊이추정방법 － 43 － 그러면 이 화상렬의 kI 는 SF 의 개별적인 측정점들의 색, 밝기정보와 함께 깊이정보 도 반영한다. 그림 3에서와 같이 초점연산결과가 최대로 되도록 관측된 깊이정보는 옹근수화되여 는 δ+k 일수 있다.( 1( <<− δ 표현되는 어떤 k 값으로 얻어지지만 실제적인 깊이정보는 편차) δ )1 이제 관측점 k 의 근방에서 초점연산결과를 가우스혼합모형으로 근사화하자. SF 의 한 점 hw 에서 측정된 초점연산결과에 따라 최대점 k 를 전후로 각각 7개 ) ( , 의 초점연산결과를 포함하는 15차원관측벡토르는 다음과 같다. , ) [ = hwFV ( T hw , ), )] 관측벡토르의 매 성분값들을 리용하여 학습자료를 다음과 같이 구성한다. , hwf ( k fhw hw , hw , hw , hw , hw , hw , (cid:34) (cid:34) (cid:34) (cid:34) )] ), ), ), ), ), ), ), 1 + = = y ( ( ( ( [ ( ( ( ( − + − f f f f f f f 6 7 7 , , , , , k k k k hwf ( k , k 1 + k + 7 (2) k − , 7 y = [ x = [ y 1 x 1 , , (cid:34) , , (cid:34) , 2 x 2 y 15 x 15 k 6 − ] ] δ (3) 관측값 실제값 현된다. 4−k 3−k 2−k 1−k k 1+k 2+k 3+k 4+k 그림 3. 관측된 깊이정보와 실제적인 깊이정보사이 관계 이제 어떤 미지의 함수가 있어서 x 와 y 사이에 다음의 식이 성립한다고 하자. y 이때 함수는 비선형이며 근사화문제는 오차2제곱최소화의 견지에서 다음과 같이 표 (4) x =)(F ΜGF ,( Σ − )] (5) 2 arg , Σ [min Μ 식 (2)와 같이 표현되는 15개의 관측점들에 대하여 식 (5)를 전개하면 다음과 같다. ⎤ ⎞ ⎟ ⎥ ⎟ ⎥ ⎠ ⎦ 편차 δ를 가지고 식 (5)를 모든 관측점들에로 일반화하면 다음과 같다. μ j i 2 2 σ i arg min w Μ , , Σ i ⎛ ⎜ exp ⎜ ⎝ 1 2 σπ i ΜGF [min Μ , Σ arg w , i ∑ ∑ ⎡ ⎢ ⎢ ⎣ 2 )] ,( Σ w i − − − ≡ − 1 = 1 = 15 x y N ) ( 2 j i j 2 (6) arg , wi 식 (7)에서 δ는 그림 3과 같은 의미를 가지는 중심편차이다.  식 (3)과 같이 표현되는 M 개의 학습자료쌍 min[ , Μ Σ ,( ΜG Σ δ M F ), − , 2 )] (7) δΜG Σ ) ,( , y k 를 결정하는 알고리듬은 다음과 같다. ,1 = x k ( , k 에 대하여 식 (7)을 만 족시키는 가우스혼합모형 입력 T : 반복중지턱값 t : 학습곁수 － 44 － 종합대학학보 정보과학 주체110(2021)년 제67권 제1호 L : 학습자료의 개수 ,( ΜG Σ ) 출력 걸음 １ SF 의 hw∀ , ( ) 에서 식 (3)과 같이 정의되는 학습자료모임 ( x , j y j ), j = ,1 L 을 ) 에 대하여 식 (5)를 만족시키는 G Σ ,(0 Μ ) 을 결정한다. x , j y j ,) j = ,1 L 에 대하여 다음공정들을 진행한다. ) 에 대하여 식 (7)을 만족시키도록 iw 와 δ 를 수정하여 Gt Σ ,( Μ ) 을 갱신 구성한다. ( 걸음 ２ x 1 y , 1 걸음 ３ 모든 ( ① ② 1=t  x i y , ( i 한다. t 1+= t ③ ④ 다음식이 TE < 를 만족시킬 때까지 걸음 ②, ③을 반복한다. E = F ( x ) − G t k ,( Σ Μ , ) δ (8) 2 L ∑ k 1 = 걸음 ４ Gt Σ ,( Μ ) 을 출력한다. ２．실험 및 결과분석 가우스혼합모형을 리용할 때 피부표면의 3차원구조가 얼마나 더 잘 얻어지는가를 평 가하기 위하여 다음과 같은 평가함수를 리용한다. 여기서 Wnd 는 SF 의 주목위치 ( MSE ≡ DhwDE , [( − ) ( ) hw , ∈ hw 에 설정된 작은 창문, ) , ( (Wnd )) 2 |] Wnd hwD ( , (9) ) 는 ( hw 위치에서 ) , 추정한 깊이정보, (D )Wnd 는 창문 Wnd에서의 깊이정보의 평균값이다. 실험에서 창문의 크기는 국소부위에서 깊이차이가 그리 심하지 않고 원활할것이라는 가정에 따르면 식 (9)로 33× 으로 설정하였다. 얻은 2제곱편차가 작은 깊이정보들이 보다 정확하다고 볼수 있다. 그림 4의 ㄱ)는 가우스혼합모형을 적용하지 않았을 때, 그림 4의 ㄴ)는 가우스혼합모 형을 적용하여 옹근수화된 깊이정보를 소수로 넘겼을 때이다. 88 89 71 88.2 88.9 71.3 88 91 73 88.4 90.3 73.8 90 87 81 90.7 87.3 80.4 ㄱ) ㄴ) 그림 4. 33 × 근방에서 얻은 깊이정보의 실례 표에 MSE 를 가지고 평가한 실례를 보여주었다. 표에서 보는바와 같이 실험결과는 피부표면의 각이한 위치에서의 MSE 평가결과는 을 리용하는 경우 더 원활한 깊이정보를 얻을수 있다는것을 보 ,( ΜG Σ ) 가우스혼합모형 여준다. 1 2 3 4 5 국부적이동을 가지는 가우스혼합모형을 리용한 피부표면의 깊이추정방법 － 45 － 번 호 ,( ΜG Σ ) 을 리용하였을 때(제안방법) ,( ΜG Σ ) 을 리용하지 않았을 때(선행방법[2]) 표．MSE를 가지고 평가한 결과 48.17 70.09 37.88 45.06 53.81 49.95 71.41 37.94 46.56 55.03 중심이동을 가지는 가우스혼합모형과 SFF방법을 리용하여 련속적인 깊이정보를 얻 기 위한 한가지 방법을 제안하고 국부령역에서 깊이정보의 원활성을 평가하는 방법으로 제안방법의 효과성을 증명하였다. 맺 는 말 참 고 문 헌 [1] Jorgen Serup et al.; Non-Invasive Methods and the Skin, Taylor & Francis, 457～564, 2006. [2] M. Mahmood et al.; Optics Letters, 35, 8, 1272, 2010. [3] Meysam Madadi et al.; Pattern Recognition Letters, 56, 14, 2015. [4] Srimanta Mandal et al.; IEEE Transacs on Image Processing, 26, 1, 119, 2017. 주체109(2020)년 11월 5일 원고접수 A Method of Estimating the Depth of Skin Surface Using Mixed Gaussian Model with Local Movement Yun Kang Jin, Jon Myong Il In this paper, we proposed a method of estimating sequential depth information using GMM with central movement and SFF, and demonstrated the efficiency of suggesting method by evaluating smoothness of depth information in local area. Keywords: SFF, GMM, depth map