김일성종합대학학보 정보과학 주체110(2021)년 제67권  제1호 심층신경망을 리용한 흐림류형분류의 한가지 방법 최옥주, 최춘화 경애하는 동지께서는 다음과 같이 말씀하시였다.  《첨단돌파전은 현대과학기술의 명맥을 확고히 틀어쥐고 과학기술의 모든 분야에서 세계를 앞서나가기 위한 사상전, 두뇌전입니다.》 흐림류형복원은 퇴화화상으로부터 원래의 선명한 화상을 재생하는 처리방법이다. 일 반적으로 점확장함수가 알려지지 않은 흐림화상이 입력되므로 흐림류형복원에서 선차적 으로 해결해야 할 문제는 화상이 어떤 원인에 의하여 퇴화되였는가를 분류하는것이다. 선행연구[1]에서는 주파수령역에서의 흐림특징과 신경망을 리용하여 흐림류형을 분 류하는 방법을 제안하였다. 선행연구[2]에서는 중첩신경망을 리용하여 흐림류형을 분류하는 방법을 제안하였다.  선행연구들에서 제안한 방법들은 흐림특징들이 흐림류형에 따라 차이나지만 시각적 인 이지러짐이 있고 학습과정에 적합하지 않은 초기값들로 하여 학습이 어려워지는 결함 이 있다. 론문에서는 개선된 흐림특징과 사전학습된 심층자기부호화기를 리용하여 흐림류형분 류의 정확도를 높이는 방법을 제안하였다. １．푸리에변환에 기초한 흐림류형의 특징 화상이 퇴화되는 원인에 따라 흐림류형들은 가우스흐림과 운동흐림, 초점흐림으로 분류될수 있다. ① 화상흐림은 다음의 식으로 모형화될수 있다.  n + f )(*)( x x = 는 화상공간에서 화소의 자리표를 나타내며 x )( x )( q g (1) )(xf )(xq 는 점확장함수(PSF: Point Spread Function), *은 중첩연산자, )(xg 는 흐려진 화상, ) 여기서 yx=x ,( 는 원래의 선명한 화상, )(xn 는 추가적인 잡음이다. ② 가우스흐림에 대한 점확장함수는 다음과 같다. q σx ,( ) = 1 2 σπ ⎛ ⎜ exp ⎜ ⎝ − 2 2 x + y 2 2 σ Rx ⎞ ⎟ , ∈⎟ ⎠ (2) 여기서 σ 는 추정되여야 할 흐림의 반경이고 R 는 화상령역으로서 한다. ]3,3[ σσ− 로 설정 카메라의 선형움직임으로 나타나는 운동흐림의 점확장함수는 다음과 같다. q x )( = ,(, yx ) sin( cos( ) ω ) ω ⎛ ⎜⎜ ⎝ ⎞ =⎟⎟ ⎠ 1 M ⎧ ⎪ ⎨ ⎪ ⎩ ,0 기타 2 ,0 x + 2 y ≤ M 2 4/ (3) 심층신경망을 리용한 흐림류형분류의 한가지 방법 － 67 － 여기서 은 화소단위로 움직이는 거리를 나타내며 는 축에 대한 각도에 따라 움직 이는 방향을 나타낸다. ③ 초점흐림에 대한 점확장함수는 다음과 같다. (4) 여기서 는 흐림반경이다. 식 (1)의 량변에 푸리에변환을 적용하면 다음과 같다. 여기서 이다. 세가지 형태의 흐림류형에 대한 주파수스펙트르화상을 그림 1에 보여주었다. (5) 그림 1. 세가지 형태의 흐림류형에 대한 주파수스펙트르화상 그림 1에서 ㄱ)는 가우스흐림이고 ㄴ)는 운동흐림이며 ㄷ)는 초점흐림이다. 그림 1에 서와 같이 동일한 화상에 대하여 서로 다른 퇴화방법으로 얻은 흐림류형의 푸리에주파수 스펙트르모양은 차이나며 같은 종류의 흐림류형의 주파수스펙트르는 모양이 거의 같다. 그러나 푸리에주파수스펙트르화상은 그림 1에서와 같이 십자모양의 밝은 줄무늬가 있는 것으로 하여 정확히 식별하기 어렵다. 우와 같은 십자모양의 밝은 줄무늬가 생기는 리유 는 화상의 테두리부분에서 밝기변화가 심하기때문이다. 이로부터 공간령역에서 화상의 테두리부분밝기변화를 없애기 위하여 창문함수를 적용한다. 크기가 인 창문함수는 다음과 같이 정의한다. 창문함수를 적용한 운동흐림류형에 대한 푸리에주파수스펙트르화상을 그림 2에 보여 주었다. (6) 그림 2. 창문함수를 적용한 운동흐림류형에 대한 푸리에주파수스펙트르화상 그림 2에서 ㄱ)는 운동흐림류형이고 ㄴ)는 창문함수의 적용류형이며 ㄷ)는 푸리에주 － 68 － 종합대학학보 정보과학 주체110(2021)년 제67권 제1호 창문함수를 적용한 세가지 흐림류형에 대한 푸리에주파수스펙트르화상을 그림 3에 파수스펙트르류형이다. 보여주었다. 그림 3. 창문함수를 적용한 세가지 흐림류형에 대한 푸리에주파수스펙트르화상 그림 3에서 ㄱ)는 가우스흐림이고 ㄴ)는 운동흐림이며 ㄷ)는 초점흐림이다. ２．심층신경망을 리용한 흐림류형분류 흐림류형분류를 위한 신경망은 3개의 숨은층과 1개의 Softmax층으로 구성되여있다.  흐림류형분류를 위한 심층신경망의 구조를 그림 4에 보여주었다. 그림 4. 흐림류형분류를 위한 심층신경망의 구조 자기부호화기를 리용한 사전학습방법으로 숨은층 1, 2, 3을 사전학습시킨다. 매 숨은 층의 입력들은 비감독학습에 의한 자기부호화기의 부호화출력들이며 전체적인 망은 감독 학습으로 학습시킨다. 흐림류형분류를 위한 학습은 화상자료기지에 있는 선명한 화상렬들을 각이한 흐림파 라메터에 의해 퇴화시키고 퇴화된 화상들에 푸리에변환을 적용하여 푸리에주파수스펙트 르화상렬을 얻는다. 푸리에주파수스펙트르화상들을 32×32pixel크기로 축소하고 축소한 화 상들을 심층신경망의 학습특징으로 입력하여 망을 학습시킨다. 망의 손실함수는 교차엔 트로피를 리용한다. 심층신경망을 리용한 흐림류형분류의 한가지 방법 － 69 － ３．실험 및 결과분석 학습표본들의 수는 모두 12 000개이며 그중 가우스흐림표본 4 000개, 운동흐림표본 4 000개, 초점흐림표본 4 000개이다. 학습표본의 크기는 32×32pixel이다. 시험자료로서 6 000개의 표본들을 선택하였다.  심층자기부호화기의 입력층과 중간층의 마디수는 다음과 같이 설정한다.  500 →→→ 024 10 30 → 1 3 성능을 비교하기 위하여 분류정확도 CR 를 리용한다. N N cN 는 정확히 분류된 표본의 개수이고 선행방법과 제안한 방법을 비교하였다.(표) (%) CR = a c 여기서 × 100 aN 는 전체 표본의 개수이다. 방법 선행방법[1] 선행방법[2] 제안한 방법 표．선행방법과 제안한 방법과의 비교 자료기지 1(CR) 자료기지 2(CR) 94.8% 92.2% 95.2% 95.4% 93.9% 96.2% 표에서 보여준것처럼 제안한 방법에 의한 분류결과의 정확도가 선행방법에 비하여 높다는것을 알수 있다. 퇴화된 화상을 정확히 복원하기 위하여 개선된 흐림특징과 심층신경망을 리용하여 흐림류형을 분류하였다. 맺 는 말 참 고 문 헌 [1] Ruomei Yan et al.; IEEE Transactions on Image Processing, 25, 4, 1910, 2016. [2] Shamik Tiwari et al.; I. J. Image, Graphics and Signal Processing, 9, 47, 2014. A Method of Classifying Blur Type Using Deep Neural Network 주체109(2020)년 11월 5일 원고접수 Choe Ok Ju, Choe Chun Hwa We proposed a method of classifying blur type using advanced blur features and deep neural Keywords: blur type, deep neural network, Fourier transformation network.