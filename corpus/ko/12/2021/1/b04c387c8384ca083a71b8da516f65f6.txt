김일성종합대학학보 정보과학 주체110(2021)년 제67권  제1호 그라디엔트하강알고리듬에 의한 자세추정체계의 특성해석 량학명, 김철진 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《모든 과학자, 기술자들이 과학기술발전의 추세에 맞게 첨단과학과 기초과학발전에 힘을 넣어 나라의 과학기술을 세계적수준에 올려세우도록 하여야 합니다.》(《선집》 증보판 제20권 62페지) 최근 MARG수감부들이 각종 비행체를 포함한 운동체의 자세결정에 광범히 도입되고 있다. MARG수감부를 리용한 자세결정에서는 일반적으로 칼만려파기 혹은 확장칼만려파기 나 상보려파기들을 리용한다.[1－3] 론문에서는 4원수와 그라디엔트하강알고리듬을 리용한 상보려파기설계의 한가지 방법을 제안하고 실지자료를 리용한 모의실험을 통하여 자세추정체계의 특성을 해석하 였다. １．4원수와 운동체의 자세표현 대상의 자세는 설정된 기준(관성)자리표계에 관한 동 체자리표계의 회전각(오일러각), 자세행렬 혹은 4원수로 표현된다. 4원수는 3차원공간에서 강체 혹은 자리표계의 방향 을 표현할수 있는 4차원복소수이다. 오일러정리에 따르면 자리표계 A 에 관한 자리표계 rˆA 주위에로의 B 의 방향은 자리표계 A 에서 정의된 축 각 θ의 회전으로 표현할수 있다.(그림 1) 그림 1에서 호상 직교하는 단위벡토르 Z,Y,X 와 A 는 각각 자리표계 A , B 의 주축을 표시한다. A A Z,Y,X B B B 자리표계 A 에 관한 자리표계 B 의 방향을 표현하는 4원수 qˆA B 은 식 (1)로 정의된다. 그림 1. 자리표계에서의 회전관계 A B ˆ q = [ q 1 q 2 q 3 q 4 ] = [ cos θ 2/ − r x sin θ 2/ − r y sin θ 2/ − r z sin θ ]2/ (1) 는 각각 자리표계 A 의 Z,Y,X 축에서의 단위벡토르 rA 의 성 식 (1)에서 r x 분들을 표시한다. , r y , r z 표현된다. 그림 1에서 자리표계 B 의 임의의 방향은 자리표계 rA 주위에로의 각 θ 의 회전으로 4원수연산은 흔히 방향을 표현하는 4원수가 우선 표준화될것을 요구한다. 그러므로 방향을 표현하는 모든 4원수들은 단위길이를 가진다. 그라디엔트하강알고리듬에 의한 자세추정체계의 특성해석 － 105 － 한편 4원수에 대하여 공액4원수를 생각할수 있으며 qA B ˆ 의 공액4원수는 다음과 같이 표현된다. *A qˆ B = B A qˆ = [ q 1 − q 2 − q 3 − q 4 ] (2) qˆA B 의 공액4원수 2개의 4원수 qˆB A 은 자리표계 B 에 관한 자리표계 A 의 방향을 표현한다. b,a 에 대한 4원수적은 하밀톤규칙으로 결정된다. a b =⊗ [ a 1 a 2 a 3 a 4 ] ⊗ b [ 1 b 3 b 4 ] = b 2 T = ba 11 ba 21 ba 31 ba 41 ⎡ ⎢ ⎢ ⎢ ⎢ ⎣ − + − + ba 22 ba 12 ba 42 ba 32 − + + − ba 33 ba 43 ba 13 ba 23 − − + + ba 44 ba 34 ba 24 ba 14 ⎤ ⎥ ⎥ ⎥ ⎥ ⎦ (3) 3차원벡토르는 어떤 4원수에 의해 회전할수 있다. 이때 4원수연산을 위해 첫 원소로 0을 삽입하여 4요소행벡토르를 구성한다. 한편 B 으로 표현된 방향은 4원수를 리용하여 회전행렬 RA qˆA B 로 표현할수도 있다. RA B = 2 2 2 q 2 1 qq (2 32 qq 42 q 21 +− qq − 41 qq 31 (2 + ) ⎡ ⎢ ⎢ ⎢ ⎣ qq + 41 2 q 21 +− 3 (2) (2 qq (2 32 2 q 2 1 qq 43 (2) − qq 21 ) 2 ) ) qq 42 qq 43 2 q 1 − + 21 qq 31 qq 21 2 q 4 +− ⎤ ⎥ ⎥ ⎥ ⎦ (4) 운동체들에서의 오일러각 즉 종요각, 횡요각 및 편요각 BZ 축주위로의 회 BX 축주위로의 회전 φ의 순차적인 회전에 의한 방향을 φθψ , 는 , BY 축주위로의 회전 θ , 전 ψ , 표현한다. qˆA B 의 오일러각표현은 식 (4)의 원소들에 의해 다음과 같이 표시된다. 2 q ))1,1( + 1 ),1,2( )1 =− qq 32 qq 41 2(2 2, tan tan ψ (2 A B A B A R R A = − 2 2 q θ −= sin 1 − 2( qq 42 + 2 qq 31 ) −= sin 1 − ( R ))1,3( (5) φ = A tan 2(2 qq 43 − 2 qq 21 , 2 q 1 2 4 + 2 q )1 =− A tan (2 R ),2,3( R ))3,3( A B A B 2 2 A B ２．자세추정(융합)려파기 ① 쟈이로스코프에 의한 자세추정 3축쟈이로스코프는 동체자리표계의 한다. 만일 그 측정량을 리용하여 벡토르 Z,Y,X 축주위로의 각속도 ωωω z y , , x 를 측정 S ω= ,0[ ωωω y z , , x ] (6) 를 정의한다면 동체자리표계에 관한 지구자리표계의 방향변화속도를 표현하는 4원수도함 수 qS E (cid:5) 는 다음과 같이 계산할수 있다. S E (cid:5) q = S E ˆ q ⊗ ωS 1 2 (7) － 106 － 종합대학학보 정보과학 주체110(2021)년 제67권 제1호 시각 t 에서 동체자리표계에 관한 지구자리표계의 방향 S E qω 는 초기조건이 알려지 t, 면 4원수도함수 S E (cid:5) q , ω = t S E ˆ q est , S ⊗ ω t t −1 (8) 1 2 의 수치적분으로 계산할수 있다. S E Sω 는 시각 t 에서 측정된 각속도, q , ω S E = t 여기서 t ˆ q est , t 1 − + S E (cid:5) q , ω t t Δ (9) tΔ 는 표본화주기, S E qˆ 1−t,est 은 이전시각의 방 향추정량이며 첨수 ω는 4원수가 각속도로부터 계산된다는것을 보여준다. ② 가속도계와 자력계측정에 의한 자세추정 3축가속도계는 수감부의 운동으로 인한 선형가속도가 혼합된 동체자리표계에서의 중 력마당의 크기와 방향을 측정하며 류사하게 3축자력계는 국부자속과 이지러짐이 혼합된 동체자리표계에서의 지구자기마당의 크기와 방향을 측정한다. 만일 지구자리표계에서 지구마당의 방향이 알려진다면 동체자리표계에서 마당방향의 측정은 지구자리표계에 관한 동체자리표계의 방향을 계산할수 있게 한다. 그러나 임의로 주어진 측정에 대하여 유일한 방향풀이가 존재하지 않고 무한풀이가 존재한다. 이로부터 유일한 풀이를 얻기 위하여 4원수로 표현되는 최량화문제를 설정한다. 수감부의 방향 qˆS E 은 지구자리표계에서 미리 주어진 마당의 기준방향 켜 동체자리표계에서 측정된 마당방향 과 같은 최량화문제로 구할수 있다. sˆS 과 일치시키는 방향이다. 그러므로 dˆE 을 회전시 qˆS E 은 다음 f ( S E ,ˆ q E ,ˆ d S )ˆ s min RqS ˆ E ∈ 4 (10) f ( S E ,ˆ q E ,ˆ d S )ˆ s = S E * ˆ q E ⊗ ˆ d S ˆ q −⊗ E S ˆ s (11) qS ˆ E = [ qq 1 2 q 3 q 4 ] , E ˆ d = 0[ d x d y d z ] , S ˆ s = 0[ s x s y s z ] 여기서 이고 이다. 식 (10)의 최량화문제를 푸는 여러가지 알고리듬이 존재하지만 여기서는 실현과 계 산이 가장 단순한 알고리듬의 하나인 그라디엔트하강알고리듬을 리용한다. 초기추측방향 0qˆS E 과 걸음크기 μ에 기초하여 qˆS E 의 방향을 추정하는 그라디엔트하 강알고리듬은 다음과 같이 표현된다. S E ˆ q k =+ 1 S E ˆ q k − μ ∇ f ∇ f ( S E S ( E ,ˆ q ,ˆ q E E ,ˆ d ,ˆ d S )ˆ s S )ˆ s , k = ,2,1,0 (cid:34) , n (12) ∇ f ( S E ,ˆ q E ,ˆ d S )ˆ s = J T ( S E ,ˆ q k E )ˆ fd ( S E ,ˆ q E ,ˆ d S )ˆ s (13) 2 d x 2/1( − 2 2 x ( qqd 32 ( qqd 31 x − 2 q 3 qq 41 qq 42 − + ⎡ ⎢ ⎢ ⎢ ⎣ 2) + q 2 4 2) + d y ( qqd 41 q − y 2/1( 2) + ( qqd 43 y − + 2 2 qq 21 qq 32 2 q − 4 2) + 2) + ( qqd 42 z − 2) + ( qqd 21 q − z 2/1( + 2 2 z d qq 31 qq 43 2 q − 3 ) − s ) − s ) − s x y z ⎤ ⎥ ⎥ ⎥ ⎦ (14) f ( S E ,ˆ q E ,ˆ d S )ˆ s = 그라디엔트하강알고리듬에 의한 자세추정체계의 특성해석 － 107 － J ( S E ,ˆ q k E )ˆ d = 2 2 2 2 qd y qd x qd x 4 4 3 ⎡ ⎢ ⎢ ⎢ ⎣ − + − 2 qd z qd 2 z qd 2 y 3 2 2 2 qd y − − + 3 qd 4 y 2 qd 2 y 1 qd z + − 4 qd 2 z 1 qd 4 z 2 3 4 2 2 qd x qd x 2 qd z 1 − 4 qd x 2 2 + 3 qd x + qd y 2 + 2 qd 2 y − 2 qd z − 4 2 qd x 1 4 qd 4 z 3 − − 4 2 3 qd + x qd − x 1 qd 2 x 2 qd 2 y qd 4 y 2 + − + 4 qd y 2 3 qd 2 z 1 qd 2 z 3 ⎤ ⎥ ⎥ ⎥ ⎦ (15) 식 (12)와 (13)은 임의의 방향으로 미리 주어진 마당에 적용할수 있는 일반적인 알고 리듬이며 가속도계와 자력계에 대하여 자리표계의 주축이 1개 혹은 2개라고 가정하면 알 고리듬은 보다 단순해진다. 가속도계에 대하여 중력의 방향을 수직( z 축)축으로 정의하면 식 (14), (15)의 dˆE 과 sˆS 을 로 표준화한 가속도계측정벡토르 를 대입하면 다음과 같은 식을 얻는다. ˆ =gE ]1000[ (16) S ˆ a = 0[ a x a y a z ] (17) f ( S E ,ˆ q S )ˆ a = (18) (2 qq 42 − (2 qq 21 − + q 2/1(2 ) qq 31 qq ) 43 2 2 q − 2 3 − a x − a ) − ⎡ ⎢ ⎢ ⎢ ⎣ q 3 ⎤ ⎥ ⎥ ⎥ ⎦ q z 2 q 3 0 y a 2 2 ⎤ ⎥ ⎥ ⎥ ⎦ J S ( Eg )ˆ q = 2 − 2 q 2 0 ⎡ ⎢ ⎢ ⎢ ⎣ 2 q 2 4 q 1 q − 4 2 2 q 1 − 2 q 4 q 3 − 4 (19) 한편 지구자기마당은 1개의 수평축과 수직축성분을 가진다고 볼수 있다. 수직축성분은 마당의 경사에 관계되며 식 (14), (15)에 dˆE 와 sˆS 을 로 표준화한 자력계측정벡토르 를 대입하면 E ˆ b = 0[ b x 0 b z ] (20) S ˆ m = 0[ mmm ] (21) x y z f ( S E ,ˆ q E ,ˆ S )ˆ mb = 5.0(2 b − x qqb (2 x 32 qqb (2 + x 31 2 q 3 − q − qq 41 qq 42 2 qq (2) ) m qqb + − − z 4 42 31 (2) ) m qqb qq + + − z 21 43 2 2 q − − 2 3 5.0(2) b z + q ⎡ ⎢ ⎢ ⎢ ⎣ J S ( Eg ,ˆ q E )ˆ b = − ⎡ ⎢ ⎢ ⎢ ⎣ qb 2 − z 3 qb qb 2 2 + x z 4 qb 2 x 3 2 qb 2 z 4 qb qb 2 2 + x z 3 1 qb qb 4 2 x z − 4 2 qb 4 qb 2 − − x z 1 3 qb qb 2 2 + x z 2 qb qb 4 2 x z 3 1 − 4 가 얻어진다. z x ) − y m ⎤ ⎥ ⎥ ⎥ ⎦ qb 4 + x 4 qb 2 + x 1 qb 2 x 2 − − (22) 2 qb 2 z qb 2 z 3 ⎤ ⎥ ⎥ ⎥ ⎦ (23) 한편 중력이나 지구자기마당만의 측정은 수감부의 유일한 방향을 주지 못한다. 그러 므로 2개 마당의 측정과 기준방향들을 다음과 같이 결합한다. － 108 － 종합대학학보 정보과학 주체110(2021)년 제67권 제1호 f S ( Ebg , ,ˆ q S ,ˆ E ˆ ba S )ˆ m = (24) ⎡ ⎢ ⎢ ⎣ S f ( Eg S ,ˆ q ( Eb f ,ˆ q E ,ˆ b S )ˆ a S ⎤ ⎥ ⎥ ⎦ )ˆ m ⎡ ⎢ ⎢ ⎣ 식 (18)과 (22)로 주어지는 목적함수에 대한 풀이는 어떤 선으로 표시되는 최소값을 (25) S T ( Eg S ,ˆ q ( E S ( Ebg J T b )ˆ q E ⎤ ⎥ ⎥ ⎦ )ˆ b )ˆ b ,ˆ q = J J E , 가지며 식 (24)로 정의되는 풀이는 0≠xb 이라면 유일한 최소값을 가진다. 2개의 마당을 결합한 경우 그라디엔트하강알고리듬은 다음과 같이 표현된다. S E q ∇ , t = S E ˆ q est , − μ1 t − t (26) ∇ ∇ f f 여기서 이다. f =∇ J T S ( Eg ˆ q est E , 1 , t − )ˆ fb ˆ q f ) S ( Eg S ˆ q ( Ebg , , 1 − , S S )ˆ a t ,ˆ a t est , t est , t 1 − J T S ( , Ebg ˆ q est , t 1 − ⎧ ⎪ ⎨ ⎪⎩ E ,ˆ S )ˆ mb (27) 식 (26)을 리용하여 이전시각의 방향추정량 1 −t S mˆ 에 의해 정의된 목적함수의 그라디엔트 est , S ˆ E q 토르 S aˆ 와 t 산된 추정방향 t S E q ,ˆ∇ 를 계산할수 있다. t 과 시각 t 에서 표본화된 측정벡 f∇ 에 기초하여 시각 t 에서 계 이때 tμ 의 값은 큰 걸음크기로 인한 과조절이 생기지 않도록 다음과 같이 설정한다. || (28) = αμ α t Δ > 1 || , S E (cid:5) q , ω t t 여기서 tΔ 는 표본화주기, S E q ,ω(cid:5) 는 쟈이로스코프에 의해 측정된 방향속도이다. t ③ 려파기융합알고리듬 지구자리표계에 관한 동체자리표계의 추정된 방향 여 계산된 방향 S E q ,ω , t S E q ,∇ 의 융합으로 얻어진다. t S E q , 는 각각 식 (9), (26)에 의하 est t S E q ,ω , t S E q ,∇ 는 다음과 같은 4원수로 표현된 상보려파기에 의하여 융합된다. t S E S Et tγ− 는 매개 방향계산에 작용된 무게들로서 1( −+ S ) Et q , ω 0, γ γ est = q q ∇ t t t , , ≤ γ t ≤ 1 (29) ωqS E 의 수렴률이 tγ 의 값은 tγ 와 여기서 ∇qS E 의 수렴률과 같도록 정의할수 있다. 1( ) γ t = β μ t t Δ + β (30) 여기서 t Δ/μ 는 t ∇qS E 의 수렴률이며 β는 쟈이로스코프측정오차에 대응하는 4원수도함수 의 크기로 표현된 ωqS E 의 수렴률이다. 식 (29)와 (30)은 α 에 관계되는 크다는 가정에서 S E q ,ω 와 t ∇qS E 의 수렴률이 방향변화의 물리적속도와 같거나 S E q ,∇ 의 최량융합을 담보한다. 만일 α 가 매우 크다고 가정 t 하면 tμ  역시 매우 커지며 융합려파기는 다음과 같이  단순해진다. 그라디엔트하강알고리듬에 의한 자세추정체계의 특성해석 － 109 － S E q est , t = S E ˆ q est , t 1 − + S E (cid:5) q − βω, t t Δ (31) ⎛ ⎜ ⎜ ⎝ ∇ ∇ f f ⎞ ⎟ ⎟ ⎠ ３．모의실험 및 결과분석 제안한 자세결정방법을 위성평대체계의 실측자료에 기초하여 MATLAB를 리용하여 모의를 진행하였다. 그림 2에 수감부에 의한 측정자료를 보여주었다. 그림 2. 수감부에 의한 측정자료 그림 3에 5.0,01.0=β 일 때의 오일러각자세추정결과를 보여주었다. 그림 3. 오일러각자세추정결과(ㄱ) 오일러각이 0.01일 때, ㄴ) 오일러각이 0.5일 때) － 110 － 종합대학학보 정보과학 주체110(2021)년 제67권 제1호 그림 3에서 보는바와 같이 β 의 값에 따라 추정결과는 크게 달라지는데 β 의 값이 클수록 자세추정에서 고주파진동현상이 나타난다. 이것은 좋은 자세추정결과를 얻자면 β를 작게 설정하여야 한다는것을 보여준다. 4원수와 그라디엔트하강알고리듬을 리용한 상보려파기설계의 한가지 방법을 제안하 고 모의를 통하여 그라디엔트하강알고리듬의 걸음크기파라메터와 자세추정특성의 관계를 해석하였다. 파라메터를 크게 할수록 자세추정에서 고주파진동이 나타나며 이로부터 파 라메터의 값을 작게 설정하는것이 합리적이라는 결론을 얻었다. 맺 는 말 참 고 문 헌 [1] Zheming Wu et al.; IEEE Sensor Journal, 10, 3856, 2016. [2] Hamad Ahmed et al.; IEEE Trans. Intelligent Transportation Systems, 7, 1723, 2017. [3] Jing Chang et al.; IEEE Trans. Control Systems Technology, 3, 1140, 2018. 주체109(2020)년 11월 5일 원고접수 Characteristics of Attitude Estimation System Using Gradient Decent Algorithm Ryang Hak Myong, Kim Chol Jin We considered a design method for attitude estimation system using gradient decent algorithm and analyzed the relationship between the parameter of algorithm and the accuracy of attitude estimation. The simulation results show that the smaller the value of parameter, the higher the accuracy of attitude estimation. Keywords: attitude estimation, gradient decent algorithm, quaternion