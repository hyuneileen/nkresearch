김일성종합대학학보 정보과학 주체110(2021)년 제67권  제2호 광선추적법에 의한 외부부분품의 회전을 고려한 위성그림자모형화방법 김진예, 윤금일 선행연구[1]에서는 태양비침면적의 증가가 위성에서 요구하는 에네르기를 공급하도 록 하는데 도움을 준다는것을 밝혔다 한편 선행연구[2]에서는 2중깊이법을 리용하여 우주비행체의 빛비침도를 계산하는 방법을 제안하였으나 회전하는 부분품은 고려하지 않고 태양빛의 입사각에 따르는 위성 동체의 그림자면적만을 계산하였다. 론문에서는 광선추적법을 리용하여 태양빛의 입사각에 따르는 위성동체와 그 부분품 의 회전에 따르는 그림자면적을 계산하는 방법을 제안하고 모의실험을 통하여 그 효과성 을 검증하였다. 위성그림자모형화는 주어진 위성의 자세에서의 위성정보들을 입력으로 받아들여 그 에 따르는 위성그림자의 면적을 계산하는 문제이다. 그림자계산모형의 입력으로는 태양빛방향벡토르와 회전하는 위성부분품들의 회전각, 회전축정보를 리용하였다. 회전부분품의 회전에 대해서는 회전부분품의 모든 마디점을 회전시킨 다음 고정부분 품으로 보고 그림자를 그리는 방법을 적용한다. 그러므로 먼저 고정부분품들에 대한 그 림자계산방법을 고찰하고 다음 회전부분품들의 회전에 대해서 고찰한다. 이에 기초하여 광선추적법을 리용하여 위성표면에 생기는 그림자를 계산한다. 그림자계산은 두 단계로 진행한다. 우선 매 표면에 대해 표면의 법선벡토르 과 태양벡토르 사이각을 계산하며 표면 n 이 태양벡토르에 대해 정방향면(빛을 받음.)인가 역방향면(빛을 받지 않음.)인가를 판 단한다. S 다음 정방향면인 경우 표면의 매 정점을 통과하는 빛이 위성의 다른 부분과 사귀는 가 사귀지 않는가 즉 앞에 장애물이 있는가를 판단하여 그 점에 그림자가 생기는가 생기 지 않는가를 판단한다. 론문에서는 요구되는 정확도와 계산시간을 만족시킬수 있는 위력한 방법인 광선추적 법을 리용하여 위성그림자의 면적을 계산하였다. 우리가 눈으로 주변물체들을 볼수 있는것은 그 물체들의 면에서 반사된 빛이 우리 눈에 들어오기때문이다. 광선추적법(Ray Tracing)은 이러한 기하광학의 원리에 기초하여 빛이 광원으로부터 시점에 이를 때까지 물체와의 관계를 추적하여나가는 방법이다. 이때 계산효률을 높이기 위하여 시점으로부터 광원에로 거꾸로 나가면서 빛경로를 조사한다. 편리상 Z 축우에 시점이 놓이는것으로 보고 투영면에 XY 평면을 택한다．그리고 이 평면우에 서로 수직인 평행선을 등간격으로 그어 작은 정4각형을 하나의 화소로 선택한 다.(그림 1) － 98 － 종합대학학보 정보과학 주체110(2021)년 제67권 제2호 그림 1. 광선추적법에서 시점, 시선과 투영면 시선이 물체와 많은 점에서 사귀므로 시점으로부터의 거리를 구하여 가장 가까운 사 귐점을 찾는데 이 점을 가시점이라고 부른다. 이 가시점에서 곡면의 법선벡토르를 계산 하고 물체의 색속성, 반사률, 굴절률을 구한다. 그리고 이 가시점으로부터 광원방향으로 반사선을 그을 때 불투명체와 사귀는가를 확인하는 방법으로 가시점이 그림자속에 놓이 는가를 따진다. 다음 이 점에서 반사선방향, 굴절선방향으로 물체가 있는가를 확인한다. 이 선을 간 접시선 혹은 2차시선이라고 하며 간접시선과 물체가 서로 사귈 때 가시점으로부터 제일 가까운 사귐점을 간접가시점 혹은 2차가시점이라고 한다. 이 과정은 재귀적으로 반복되 며 2진나무로 표시할수 있다.(그림 2) 그림 2. 광선추적법의 2진나무 ㄱ) 반사선방향의 2진나무, ㄴ) 굴절선방향의 2진나무 2진나무에 의한 탐색과정은 광원과 만나든가 2진나무의 층깊이의 최대값에 도달할 때까지 진행된다. 이 탐색과정이 끝난 다음 2진나무의 아래끝으로부터 거슬러올라가면서 매 간접가시점에서의 빛세기를 계산하여 총체적인 빛세기를 구해나간다. 투영면의 주어 진 화소를 지나는 시선이 물체와 만나지 않으면 광선추적나무는 빈것으로 본다. 화소의 밝기는 광선추적나무의 밑(말단마디)에서부터 밝기값들이 축적되여 결정된다. 나무의 매개 마디에 대한 면의 밝기는 부모면(나무가지의 웃쪽 다음마디)으로부터 면까 지의 거리에 따라 감쇠되며 이것은 부모면의 밝기에 추가된다. 그러므로 화소의 밝기는 광선나무의 뿌리마디에서 감쇠된 밝기들의 합으로 된다. 화 광선추적법에 의한 외부부분품의 회전을 고려한 위성그림자모형화방법 － 99 － 소빛이 만나는 면이 없으면 광선추적나무는 비고 화소에는 배경밝기값이 할당된다. 그림 3에 빛과 만나는 면과 반사빛세기의 계산에 필 요한 단위벡토르들을 보여주었다. 그림 3에서 단위벡토르 는 빛경로방향이며 은 면 u 의 단위법선벡토르, 는 단위반사벡토르, 은 광원으로 향하는 단위벡토르, ( u 의 반대)와 사이의 중간단위벡토르이다. R H 는 시점으로 향한 단위벡토르 N V L L 면에서 주사빛세기는 의한 확산반사세기는 aaIk LNkd ( ⋅ 와 같이 계산되며 광원에 ) 에 비례하고 거울반사세기 는 NHk s ( ⋅ ) sn 에 비례한다. 그리고 2차광선경로 에 대 R 한 거울반사방향은 면의 법선과 입사빛방향에 관계된다. uR = − 그림 3. 빛과 만나는 면과 반사빛 세기의 계산에 필요한 단위벡토르들 2( Nu ⋅ ) (1) 또한 투명한 면일 때에는 재료를 통하여 투과되는 빛으로부 터의 세기몫을 얻어야 한다. 즉 그림 4에 보여준바와 같이 투과 방향 T 를 따라 2차광선을 추적하는데 이것은 벡토르 와 으 로부터 다음과 같이 쓸수 있다. N u η i η r 2 T = u − cos θ r − cos (2) η i η r ⎛ ⎜⎜ ⎝ η i η r ⎞ Ni ⎟⎟ θ ⎠ 그림 4. 화소빛의 굴절 iη rη 굴절각 의 코시누스는 굴절법칙으로부터 계산할수 있다. 즉 여기서 , 는 각각 입사재질과 굴절재질의 굴절률이다. rθ sin θ r = sin θ i (3) 로부터 다음의 식을 유도할수 있다. ⎞ ⎟⎟ ⎠ 회전부분품의 회전에 대해서는 회전부분품의 모든 마디점을 회전시킨 다음 고정부분 품으로 보고 그림자를 그리는 방법을 적용한다. 그러므로 먼저 고정부분품들에 대한 그 림자계산방법을 고찰하고 다음 회전부분품들의 회전에 대해서 고찰한다. (4) η i η r cos cos θ r ⎛ ⎜⎜ ⎝ θ i 1( − − = 1 ) 2 이에 기초하여 광선추적법을 리용하여 위성표면에 생기는 그림자를 계산한다. 광선추적법에 의한 태양판의 비침도분석은 광선들의 사귐점과 인공지구위성동체의 다면체를 얻는것인데 이것은 볼록다면체의 임의의 그림자를 만들게 된다. 개의 작은 쪼각(정확히 4각형)들로 나누어지며 빛은 태양의 위치와 태양판은 NM × 매 4각형의 중심점에서 시작한다. 인공지구위성동체와 태양판의 겹침부분은 동체에 의하여 어두워지고 태양판우에 그 림자를 만든다. 또한 다음의 식 이때 비침도인자( )는 광선들이 사귀는 수( )를 리용하여 계산한다. nI rI S a = NMIP /( a n ⋅ ⋅ ) (5) － 100 － 종합대학학보 정보과학 주체110(2021)년 제67권 제2호  P a − = S I a a (6) I r 1 −= NMI n /( ⋅ ) (7) 에 의하여 비침도면적( )을 계산한다. aP 그림자면적계산에 널리 리용된다. 우의 방법은 모든 비직결사영대상들에 대하여 다 리용가능하기때문에 우주비행체의 제안한 방법의 효과성을 검증하기 위하여 6면체의 본체에 2개의 회전하는 부분품이 있는 다음과 같은 위성(가상적인 위성)모형의 그림자계산에 대한 모의실험을 진행하였다. 위성모형의 마디점분할결과는 그림 5와 같다. 그림 5. 위성모형의 마디점분할결과 ㄱ) 마디점을 2로 분할하였을 때 , ㄴ) 마디점을 1로 분할하였을 때 태양벡토르가 (1, 0.3, 0.7)일 때 위성그림자를 계산한 결과는 그림 6과 같다. 이때 위성전체 총 면적 1 238 2cm 에서 그림자면적 은 794.35 로서 58.928%였다. 2cm 2cm 2cm 한편 본체의 면적이 1 000 2cm 일 때 그림자면적은 로서 54.922%이다. 그리고 태양판 1의 면적 549.219 이 174 일 때 그림자면적은 88.468 8 로서 50.844%, 2cm 태양판 2의 면적이 174 로 서 90.036%를 차지하였다. 일 때 그림자면적은 156 2cm 2cm 태양판들을 회전시키면서 시험을 반복하였다. 태양판 1의 회전축방향벡토르는 (0, 0, 1), 통과정점 그림 6. 태양벡토르가 (1, 0.3, 0.7)일 때 위성그림자모형 은 (20, 10, 0)이며 태양판 2의 회전축방향벡토르는 (0, 0, 1), 통과정점은 (0, 10, 0)이다. 태양벡토르가 (－1, －0.2, 0.3)이고 태양판 1을 110°, 태 양판 2를 130°회전시켰을 때 위성그림자모형은 그림 7과 같다. 2cm 총 그림자면적은 871.205 64.623%이다. 여기서 본체의 그림자면적은 651.953 체면적의 65.195%이며 태양판 1에서 그림자면적은 118.732 2cm 로서 68.237%, 태양판 2에서 그림자면적은 100.519 57.7698%이다. 로서 위성의 전체 면적의 로서 본 2cm 로서 2cm 그림자계산시간은 마디점을 2로 분할했을 때 0.15 s , 1로 분할했을 때 0.27 걸렸다. 이때 그림자계산정확도는 각각 87%, 92%정도였다. 이것은 2중깊이법[2]보다 10%, 그 s 림자륜곽테두리사영법[1]보다 6% 높은 정확도를 가진다. 그림 7. 위성그림자모형 광선추적법에 의한 외부부분품의 회전을 고려한 위성그림자모형화방법 － 101 － 모의실험결과로부터 제안된 방법이 주어진 위성모형에 대하여 요구되는 그림자계산 정확도와 계산속도를 만족시킨다는것을 알수 있다. 설계된 위성그림자의 모형화방법은 임의의 비직결사영대상들에 적용가능하고 태양빛 의 입사각에 따라 고정부분품의 그림자면적을 먼저 계산하고 다음 회전부분품의 회전에 따르는 그림자면적을 계산하므로 인공지구위성의 빛비침도를 계산하기 위한 매우 효과적 인 방법이다. 맺 는 말 참 고 문 헌 [1] Bo Cai et al.; Modern Education and Computer Science, 4, 40, 2011. [2] Hoshang Kolivand et al.; International Journal of Computer Graphics, 2, 1, 8, 2011. 주체110(2021)년 2월 5일 원고접수 A Shadow Modeling Method of the Satellite in Consideration of the Rotation of External Parts Using Ray Tracing Kim Jin Ye, Yun Kum Il To verify the effectiveness of designed method, the model of the satellite was designed and a shadow calculation experiment of the satellite model was performed in variable gestures to verify that the method had required accurate and velocity. Keywords: ray tracing, off-line projection object, shadow region