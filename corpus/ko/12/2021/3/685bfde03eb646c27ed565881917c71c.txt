김일성종합대학학보 정보과학 주체110(2021)년 제67권  제3호 ONVIF표준을 리용한 망카메라의 발견방법 최경국, 황병수 ONVIF(Open Network Video Interface Forum)표준은 망동화상장치들간의 정보교환에 대 한 통용적인 규약을 정의한다. ONVIF의 표준은 IP망동화상의 전송장치와 IP망동화상의뢰 기사이의 표준대면부를 실현한다. 선행연구[2]에서는 ONVIF규약에 기초하여 망동화상감시의뢰기의 대면부를 설계하고 봉사기장치에 대한 장치발견 및 장치관리봉사기능을 완성하며 동화상흐름전송을 실현하 는 방법을 제안하였다. 론문에서는 망동화상감시체계에서 ONVIF에 기초한 장치발견규약 WS-Discovery를 리 용하여 국부망내의 망카메라를 자동으로 발견하는 방법을 제안하였다. １．WS-Discovery에 기초한 장치발견봉사생성 망동화상감시체계에서 망동화상흐름전송의 실현은 장치발견과 봉사생성흐름으로 이 루어진다. １）WS-Discovery분석 ONVIF에서는 국부망내의 장치발견을 위해 WS-Discovery규약을 리용하였다. ONVIF 장치는 WS-Discovery규약의 Target Service역할을 하며 의뢰기는 규약의 Client역할을 수행 한다. WS-Discovery는 IP다중방송을 리용하여 장치자동발견을 진행하는 일종의 규약으로서 SOAP와 UDP다중방송을 사용하여 봉사가 의뢰기에 의해 발견되도록 한다. 그것의 응용 목적은 국부망내에서 의뢰기가 동적으로 1개 혹은 여러개의 목표봉사를 탐색하도록 하는 것이다. WS-Discovery규약에 대응시켜볼 때 망동화상감시체계는 의뢰기와 동등하며 망카 메라는 목표봉사와 동등하다. 망동화상감시체계는 망카메라를 발견하기 위하여 다음과 같은 4가지 류형의 통지문 을 사용한다. ① Hello 망카메라가 IP망에 련결되거나 혹은 그것의 원래자료가 변화될 때 UDP를 사용하여 1개의 Hello통지문을 다중방송한다. 통지문에는 종단점참조(Endpoint Reference)를 비롯한  목표봉사가 포함된다. ② Bye 망카메라가 IP망에서 분리될 때 1개의 Bye통지문을 발송한다. 동일하게 통지문에는 종단점참조가 포함된다. ③ Probe 의뢰기는 UDP를 사용하여 1개의 Probe통지문을 다중방송하여 망카메라를 찾는다. Probe통지문은 Types 및 Scopes를 포함할수 있다. Types는 발견하려는 장치형태, Scopes는 발견하려는 봉사들의 형태, 위치, 하드웨어, 이름 등을 지정하는 속성이다. － 8 － 종합대학학보 정보과학 주체110(2021)년 제67권 제3호 ④ ProbeMatch 목표봉사가 만일 Probe통지문에 정합된다면 ProbeMatch통지문을 발송하여 장치의 유일 표식과 봉사주소를 제공한다. 의뢰기는 Probe통지문을 발송한 후 1개이상의 ProbeMatch의 정합통지문을 받을수 있다. 만일 의뢰기가 목표봉사의 종단점참조를 얻었지만 봉사주소를 알수 없는 경우 Resolve통지문을 발송하여 종단점참조를 통하여 봉사주소를 발견한다. ２）장치발견의 봉사생성흐름 WS-Discovery규약에 의한 장치발견에서는 장치류형을 ONVIF의 망카메라에 대한 탐 색요구로 지정한다. WS-Discovery규약에 기초한 봉사생성흐름을 그림 1에 보여주었다. WS-Discovery 기술규범문서 WS-Discovery 봉사서술문서 WSDL 도구가 번역생성 하는 의뢰기코드 SOAP1.2통신 도구가 번역생성 하는 봉사기코드 망동화상감시체계 망카메라 그림 1. WS-Discovery규약에 기초한 봉사생성흐름 WS-Discovery가 서술하는 장치발견봉사는 WSDL문서를 사용한다. 망동화상감시체계 에서는 WS-Discovery의 WSDL문서에 기초하여 WSDL번역도구를 통해 특정한 플래트홈 (platform)에 대응한 코드를 생성한다. 망카메라에서는 WSDL문서에 기초하여 WSDL번역 도구를 통해 특정한 플래트홈에 대응한 코드를 생성하여 봉사를 실현한다. 망동화상감시체계와 망카메라사이에는 SOAP1.2규약을 리용하여 정보를 전송교환한 다. 망동화상감시체계는 다중방송요청을 진행하며 망카메라는 단일방송응답을 하여 장치 봉사주소의 자동발견을 실현한다. ２．장치발견의 체계실현 망동화상감시체계와 망카메라에서 WS-Discovery에 기초한 장치발견을 위한 체계실현 은 다음과 같은 방법으로 진행한다. １）망동화상감시체계의 실현 망동화상감시체계는 IP망내의 망카메라를 탐색할 필요가 있을 때 다중주소 239.255. 255.250 및 포구 3702를 리용하여 망에 Probe통지문을 발송한다. Probe통지문내에서는 탐 색할 장치류형을 지정하기도 하고 탐색범위를 지정할수도 있다. 탐색할 장치류형[1]은 <d:Types>dn:NetworkVideoTransmitter</d:Types>로 지정한다. 여 기서 dn은 이름공간의 앞붙이이다. Probe통지문의 Message-ID는 통지문의 유일표식이다. ONVIF표준을 리용한 망카메라의 발견방법 － 9 － 단일방송으로 응답하는 ProbeMatch통지문을 수신한다면 그 통지문의 RelatesTo꼬리표 에 기초하여 통지문이 정합되는것이 어느 요청인가를 식별한다. 그리고 ProbeMatch통지 문으로부터 망카메라의 봉사주소를 비롯한 필요한 정보를 얻는다. 망동화상감시체계와 망카메라사이의 장치발견흐름을 그림 2에 보여주었다. 망동화상감시체계 망에 가입, Hello통지문을 다중방송 Probe통지문을 다중방송 ProbeMatch통지문을 단일방송 망에서 분리, Bye통지문을 다중방송 망카메라 그림 2. 망동화상감시체계와 망카메라사이의 장치발견흐름 ２）망카메라의 실현 망카메라가 IP망에 가입하거나 혹은 봉사의 원래자료가 변화될 때 망에 Hello통지문 을 다중방송한다. <a:EndpointReference>는 목표봉사를 표식하는데 WS-Discovery가 요구하는 UUID가 아 니라 ONVIF가 요구하는 URN:UUID를 사용하여 표시한다. 망카메라가 망에서 분리될 때 망에 1개의 Bye통지문을 다중방송한다. 통지문내의 <a:EndpointReference>는 Hello통지문 내의것과 일치하며 동일한 1개의 봉사를 나타낸다. 망카메라가 망에 가입할 때 동시에 다중방송에 가입하는데 다중방송주소는 239.255. 255.250이며 특정한 포구는 3702이다. 망카메라가 망에 가입한 후에는 수신대기상태에 있 으며 만일 망을 통하여 Probe다중방송통지문을 수신할 때 <d:Types>꼬리표의 탐색조건 NetworkVideoTransmitter가 망카메라의 장치류형과 정합되는가 아닌가를 검사한다. 정합되지 않는 경우 통지문을 버리고 아무러한 처리도 하지 않으며 정합되는 경우 Probe통지문의 MessageID를 기록하고 ProbeMatch통지문의 MessageID를 새로 작성한다. 체계는 UUID유일표식을 사용하며 RelatesTo꼬리표를 기록하는 Probe통지문의 MessageID 를 지정하고 ProbeMatch통지문을 발송하여 응답한다. 망동화상감시체계는 RelatesTo에 기 초하여 응답한것이 어느 Probe요청인가를 알게 된다. ProbeMatch통지문내의 XAddrs는 장 치의 봉사주소 http://192.168.1.125:8081/device_service.asmx를 표시하며 망동화상감시체계는 그것을 리용하여 망카메라와 통신한다. ３．실험 및 결과 론문에서는 ONVIF표준을 지원하는 1대의 망카메라를 국부망에 련결하고 장치발견기 능을 시험하였다. 장치발견기능이 얻어낸 주소에 기초하여 동화상흐름주소를 얻고 VLC재 생기를 리용하여 이 주소에 접속하여 카메라동화상전송을 실현하였으며 얻어낸 장치주소 가 정확하다는것을 실험을 통하여 확증하였다. － 10 － 종합대학학보 정보과학 주체110(2021)년 제67권 제3호 ONVIF가 지정하는 WS-Discovery규약에 기초한 장치발견방법을 제안하고 Probe 및 ProbeMatch통지문의 발송 및 응답을 실현함으로써 자동적으로 국부망내의 망카메라를 발 견하고 봉사주소를 얻을수 있도록 하였다. 맺 는 말 참 고 문 헌 [1] ONVIF. ONVIF Core Specification Version 2.0[S], 17～84, 2010.  [2] 朱耀麟 等; 西北大学学报(自然科学版), 44, 3, 392, 2014. 주체110(2021)년 5월 5일 원고접수 Discovery Scheme of IP Camera Using ONVIF Specification Choe Kyong Guk, Hwang Pyong Su In this paper, we have proposed the device discovery scheme based on WS-Discovery in ONVIF specification, so that it discovers IP camera within LAN by implementing transmission and response of messages such as Probe and ProbeMatch, then retrieves its service address. Keywords: ONVIF, device discovery, WS-Discovery