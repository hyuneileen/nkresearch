김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체105(2016)년 제62권 제10호 Vol. 62 No. 10  JUCHE105(2016). 직교우연량렬을 리용한 역방향확률 미분방정식의 수값풀이법 원영준, 김문철 역방향확률미분방정식은 금융수학을 비롯한 여러 분야에서 대단히 중요한 역할을 하 며 이에 대한 연구 특히 수값풀이를 구하기 위한 연구가 광범히 진행되고있다. 선행연구[1, 2]에서는 역방향확률미분방정식의 수값풀이를 구하기 위하여 조건부수 학적기대값을 증분의 밀도함수를 리용하여 모의하였으며 일반화된 −θ 도식을 제기하 였다. 이로부터 론문에서는 조건부수학적기대값을 모의하기 위하여 직교우연량렬의 리용방 법을 연구하였으며 반복법을 리용하여 수값풀이도식을 제기하고 그 오차를 평가하였다. 완비확률토대 )) P ℑ (, t 적분가능한 우연량이라고 하면 이또의 표현정리에 의하여 과정 −ℑT 가측인 우연량 ( TWg=ξ ,( ωsz ) ) 가 존재한다. 우에서 주어진 , , ℑΩ ( 가 두제곱 ][ Ε= ξξ ,( sz ) ω dW 의 조건부수학적기대값은 ,( ωsz ) 를 리용하여 구할수 있다. T ∫+ 0 ,( ωsz ) 를 구하기 위하여 에르미트다항식렬 xTH ,( ) = n 의해 만들어지는 우연량렬 ( WTH ,( T n )) 는 다음의 성질들을 가진다. n ( T ) − n ! n d n dx 2 x )2/( T e 2 − x T )2/( ( e ) 에 ① ,( WTH T n ) = H ,( dWWs ) s n 1 − ② n , [ Ε∀ WTH ,( T n dWWs ) ,( s = 0 )] Ε= T ⎡ ⎢ ⎢ ⎣ WTHWTH ) T T ,( ,( H ∫ 1 − 0 n n m n ( ) T − ! n ⎤ ⎥ ⎥ ⎦ )] = 0 n d n dx ③ ≠∀ nm , [ Ε ( 대로 되므로 임의의 두제곱적분가능한 우연량 에 의하여 전개할수 있다. (2 L , ℑΩ∈ξ 정리 １ 임의의 에 대하여 WTH ,( T )) P ) n , T ∫ 0 ∞ ∑ n 1 = T ∞ ∫ ∑ n 1 = － 17 － 수이다. 다항식렬 ,( xTH ) = n 2 x )2/( T e 2 − x T )2/( ( e ) 가 두제곱적분가능한 함수공간의 토 ( TWg=ξ ) 를 직교에르미트우연량렬 −ℑT 가측인 직교우연량렬 WTH ,( T n ) 를 리용하면 ][ ξξ Ε= + WTHa T n ,( n ) Ε= ][ ξ + 〈 HWTHWg n ,( ) 〉 ), ( T T ,( dWWT s ) n 1 − 가 성립 된다. 여기서 fT 는 정규분포 )(x N 0,( T ) 0 의 밀도함수, g 는 ξ 에 의해 정해지는 가측함 종합대학학보(자연과학)   주체105(2016)년  제62권  제10호 정리 1을 리용하면 2제곱적분가능한 ξ의 조건부수학적기대값은 다음과 같다. <∀ Tt , Ε=ℑ|Ε t [ ξ ] ][ ξ + sz ,( ) ω dW Ε= ][ ξ + 〈 WTHWTHWg T ,( ,( ) 〉 ), ( T T n n ) = t ∫ 0 ∞ ∑ n 1 = ∞+ ∞ ⎛ ⎜ ∑ ∫ ⎜ ⎝ 1 = n ∞− T ∫ t ∞ ∑ 1 n = ⎞ ⎟ ⎟ ⎠ ⎤ ⎥ ⎥ ⎦ T ∫ t Ε= ][ ξ + 〈 WtHWTHWg t ,( ,( ) 〉 ), ( T T n n ) = Ε= ][ ξ + fxTHxg ) n ,( )( T WtHdxx )( t n ,( ) 보조정리 １ −ℑT 가측인 (2 L , ℑΩ∈∀ξ , P ) 에 대하여 ξ N Ε= ][ξ + WTHa T n ,( n ) 이고 N ∑ 1 = n Ε | ξξ − N 2| < ε 이면 | ,( sz ) ω − z N ,( s ω 2|) ds < ε 이 성립된다. 이제 역방향확률미분방정식이 다음과 같이 주어졌다고 하자. T ⎡ Ε ∫ ⎢ ⎢ ⎣ 0 1 + y n t ξ += ysf ,( n s , z n s ) ds − z n s 1 + dW , ξ = Wg ( T ) (1) T ∫ t T ∫ t n : β ⎛ ⎜ Ε= ⎜ ⎝ T ⎡ ∫ ⎢ ⎢ ⎣ 0 s β e ( y 2 s + z 2 s ) ds 2/1 ⎞ ⎟ ⎟ ⎠ ⎤ ⎥ ⎥ ⎦ 초기과정 0 ( y = ,0 0 z = )0 으로부터 출발하여 1 + y n t ξ += ,( ysf n s , z n s ) ds − z n s 1 + dW 에 의 해 과정쌍렬 ( y n , n z ) 이 생성되면 함수 f 의 리프쉬츠조건에 의하여 ( y , n z ) 이 풀이 zy 에로 수렴한다는것은 이미 밝혀져있다. 즉 노름 ,( ) ,(|| zy ||) 을 도입하면 이 노름의 의미에서 수렴한다. n ξξ ∫+= ,( ysf n s , z n s ) ds T 0 라고 하면 두제곱적분가능한 우연량의 위너과정에 의한 표현 정리에 의하여 어떤 과정 1+n sz 이 있어서 n ξ Ε= n [ξ ] + z n s 1 + dW 가 성립된다. T ∫ 0 이 식에서 나오는 1+n sz 을 앞에서와 같이 직교우연량렬로 표시하여 1 + y n s n [ ξ Ε= | ] −ℑ s ,( ysf n s , z n s ) ds n ξ = − z n s 1 + dW 를 계산한다. 0 = t 0 (cid:34)1 t << < t N = T 이고 t =Δ t − t n = n +1 라고 하면 역방향확률미분방정식의 수값풀 이를 구하기 위한 수값풀이도식은 다음과 같다. 걸음 １ 매 시각 nt 에서 초기값을 y 0 t n = ,0 z 0 t n = 0 으로 놓는다. 걸음 ２ k yξ = + n 1 + ysf ,( k s , z k s ) ds 로 놓고 k ξ k [ ξ Ε= ] + 1 + z k s dW 에 의하여 1+k sz 을 t n 1 + ∫ t n 결정한다. － 18 － T ∫ s 1 + nt ∫ 0 s ∫ 0 T N 직교우연량렬을 리용한 역방향확률미분방정식의 수값풀이법 걸음 ３ 1 + y k t n Ε= k [ξ ] + 1 + z k s dW n t ∫ 0 ⎡ ⎢ ⎢ ⎣ t n 1 + ∫ t n ⎤ ⎥ ⎥ ⎦ 복한다. 걸음 ４ Ε | 1 + y k t n − y k t n 2 | Ε+ 1 + | z k s − z k s 2 | ds ε< 이 될 때까지 걸음 2, 3을 1+k 번 반 보조정리 ２ 수값풀이의 오차한계 ε 가 주어졌을 때 우의 수값풀이알고리듬에 의한 매 걸음 nt 에서의 수값풀이의 오차는 [ Ε y − y n t n 2 ] Ε+ ( z s − z t n 2 ) ds ε< 이다. 증명 || y t n 1 + − Wg ( t 1 + n 2 ||) ε< 이 되게 함수 y t n = y t n 1 + + sf ,( y s , z s ) ds − dWz s , ξ n 1 + = y n 1 + + ysf ,( , s z s ) ds 로 놓으면 Ε= k [ξ ] + y n 1 + z k s dW 가 성립된다. || ξ − y n || Ε⇒< ε ( z s − z t n 2 ) Ε≤ ( z s − z k s 2 ) Ε+ ( z k s − z t n 2 ) < 이므로 ⎡ ⎢ ⎢ ⎣ t n 1 + ∫ t n ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ ⎢ ⎣ t n 1 + ∫ t n [ Ε y t n − y n 2 ] k [ ξξ −Ε≤ 2 ] Ε+ ( z s − z k s 2 ) ds < ⎡ ⎢ ⎢ ⎣ t n +1 ∫ t n ⎤ ⎥ ⎥ ⎦ 1+ng 을 선택한다. t n 1 + ∫ t n ⎡ ⎢ ⎢ ⎣ t n 1 + ∫ t n ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ ⎢ ⎣ t 1 +n ∫ t n ⎤ ⎥ ⎥ ⎦ ε 2 ε 2 . ⎤ ⎥ ⎥ ⎦ t n 1 + ∫ t n ⎤ ⎥ ⎥ ⎦ 따라서 [ Ε y − y n t n 2 ] Ε+ ( z s − z t n 2 ) ds ε< 이 성립된다.(증명끝) 수값풀이의 오차를 평가하기 위하여 t ∈ t ,( i t i 1+ ] 일 때 t시각에서의 수값풀이를 ( π y t , π z t ) 라고 하고 로 놓는다. π y t : = y i t ( −− t ) f yt ,( i , i z i ) + π dWz s , t i +≤< i 1 t t t ∫ t i 정리 ２ 역방향확률미분방정식의 반복법에 의한 수값풀이알고리듬의 오차는 임의의 정수 ε에 대하여 분할의 차수가 충분히 클 때  T ⎡ ⎢ ⎢ ⎣ sup ,0[ t T ∈ π y t Ε+ [ Ε ∫ − y ] 2 0 | ] t z s − z π s 2 | ds < ε . 증명 역방향확률미분방정식 (1)의 t 에서의 수치풀이의 오차는 다음과 같다. y t − π y t = ( ,( ysf , s z s ) − ,( ysf , i z i )) ds + ( z s − π ) dWz s ⎤ ⎥ ⎥ ⎦ t ∫ t i f 의 리프쉬츠조건을 리용하면 다음의 식들이 성립된다. 1 + n t n 1 + ∫ t n nt ∫ 0 ⎡ ⎢ ⎢ ⎣ t n +1 ∫ t n t ∫ t i － 19 － 종합대학학보(자연과학)   주체105(2016)년  제62권  제10호 L >∃ ,0 | ysf ,( , s z s ) − ysf ,( , i z i |) ≤ yL (| − y i s | + | z − z i s |) (2) [ Ε y t − 2 π y t ] Ε≤ | ,( ysf , s z s ) − ,( ysf , i 2 z i |) ds Ε+ ( z s − 2 z π s ) ds ≤ ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ ⎢ ⎣ t ∫ t i ⎤ ⎥ ⎥ ⎦ ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ ⎢ ⎣ t ∫ t i (3) ⎤ ⎥ ⎥ ⎦ Ε≤ L (| y s − y t i 2 | + | y t i − y i 2 | + | z s − z i 2 )| ds Ε+ ( z s − 2 π z s ) ds t ∫ t i ⎡ ⎢ ⎢ ⎣ ⎡ ⎢ ⎢ ⎣ t ∫ t i 보조정리 2의 결과를 리용하면 매 분할시각 it 에서 다음과 같다. 또한 확률적분변환공식을 적용하면 Ε y t i − y i 2 | + | z s − z i 2 | ds ε< ⎤ ⎥ ⎥ ⎦ t ∫ t i ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ | ⎢ ⎣ ⎡ t ⎢ ⎢ ⎣ t 2 i 1 + | ∫ t i i 1 + Ε ∫ t i [ Ε y t i 2 − y i ] Ε+ z s − π z s 2 | ds [ Ε− y t i 1 + − y i 1 + 2 ] = = [( y s − π y s )( ,( ysf , s z s ) − ,( ysf π t i , z π t i ))] . ds 이제 식 (2)와 부등식 >∀ α ,0 ∀ ba , ∈ R , ab ≤ a α 2 2 + b / α 을 리용하면 Ε ⎡ t ⎢ ⎢ ⎣ i 1 + ∫ t i ⎤ ⎥ ⎥ ⎦ | z s − π z s 2 | ds [ Ε≤ y − y i 1 + 2 ] [ Ε− y t i − y i ] 2 + t i 1 + (4) i 1 + ⎤ ⎥ ⎥ ⎦ 이며 식 (4)의 오른변의 매 마디들에 대하여 다음의 식이 성립된다. 1 Ε+ α ⎡ t ⎢ ⎢ ⎣ α Ε+ π y s ⎡ ⎢ ⎢ ⎣ ds ∫ t ∫ t + − + − − (| y y y y y 2 2 2 1 + | | | | | | s s t t i t i i i i i z s − z i 2 )| ds ⎤ ⎥ ⎥ ⎦ ∃ C , θ > ,0 Ε | y s − π y s 2 | ds ≤ C ( [ θ Ε y 2 − y i ] t i [) Ε−+ θ 1( y − y i 2 )] t i ⎡ ⎢ ⎢ ⎣ t i 1 + ∫ t i ⎤ ⎥ ⎥ ⎦ 보조정리 2로부터 매 걸음 it 에서 [ Ε y 2 − y i ] t i ε Ε⇒< n 4 ⎡ ⎢ ⎢ ⎣ t i 1 + ∫ t i | y s − π y s 2 | ds < 이다. ⎤ ⎥ ⎥ ⎦ ε n 4 또한 t =Δ n t +1 으로 놓고 보조정리 2를 적용하면 − t n n Ε ⎡ ⎢ ⎢ ⎣ t i 1 + ∫ t i (| y t i − y i 2 | + | z s − z i 2 )| ds ≤ t n [ Ε y t i 2 − y i ] Ε+ | z s − z i 2 | ds Δ≤ t n ⎤ ⎥ ⎥ ⎦ ⎛ ⎜ ⎜⎜ ⎝ ⎡ ⎢ ⎢ ⎣ t i 1 + ∫ t i εε = T 8 8 n . 주어진 ε과 분할의 차수 n 에 대하여 | y s − y t i 2 | ds ≤ 이 성립하게 α 를 결 정하면 다음의 식이 성립된다. ⎡ ⎤ ⎢ ⎥ ⎢ ⎥ ⎣ ⎦ π y s Ε α ds ∫ t − y 2 1 + | | s t i i 1 Ε+ α ⎡ ⎢ ⎢ ⎣ t i 1 + ∫ t i (| y s − y t i 2 | + | y t i − y i 2 | + | z s − z i 2 )| ds < ⎤ ⎥ ⎥ ⎦ ε n 4 1 α 1 + i ⎡ t ⎢ Ε ∫ ⎢ ⎣ t i － 20 － ⎤ ⎥ ⎥ ⎦ ⎞ ⎟ ⎟⎟ ⎠ ⎤ ⎥ ⎥ ⎦ ε n 8 직교우연량렬을 리용한 역방향확률미분방정식의 수값풀이법 식 (4)에서 i 를 0 부터 n 까지 변끼리 합하면 다음과 같다. T ⎡ Ε ∫ ⎢ ⎢ ⎣ 0 ⎤ ⎥ ⎥ ⎦ | z s − π z s 2 | ds [ Ε≤ y T − y N 2 ] [ Ε− y 0 − 2 π y 0 ] + ε n 4 n ≤⋅ εεε 2 4 4 + = 이 결과를 식 (3)에 대입하면 t ∈∀ ,0[ T ], [ Ε y t − 2 π y t ] ε ⇒< 2 sup ,0[ t T ∈ ] [ Ε y t − 2 π y t ] < ε 2 이므로 따라서 [ Ε y t − 2 π y t ] Ε+ ( z s − 2 π z s ) ds < ε 이 성립된다.(증명끝) sup t T ,0[ ∈ ] T ⎡ ∫ ⎢ ⎢ ⎣ 0 ⎤ ⎥ ⎥ ⎦ 참 고 문 헌 [1] 리은하 등; 조선민주주의인민공화국 과학원통보, 6, 10, 주체104(2015). [2] Wei Dong Zhao et al.; International Journal of Numerical Analysis and Modeling, 10, 876, 2013. 주체105(2016)년 6월 5일 원고접수 Simulation of BSDE using Orthogonal Random Variables Won Yong Jun, Kim Mun Chol We use the orthogonal random variables to estimate the control term which is the important part of the solution of BSDE and simulate the solution of BSDE using Picard’s iteration. Key word: BSDE － 21 －