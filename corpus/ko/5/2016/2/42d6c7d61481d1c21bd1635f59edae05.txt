김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체105(2016)년 제62권 제2호 Vol. 62 No. 2  JUCHE105(2016). WANN모형에 의한 월류출예보방법 김 영 봉 우리는 시계렬해석에서 좁은 시간스펙트르의 다중식별기능을 가지고있는 웨블레트해 석법[1]과 비교적 강한 비선형, 자학습, 자체적응능력을 가지고있는 인공신경망(ANN)[2, 3] 의 우점을 결합하여 월류출예보에 적용하기 위한 연구를 하였다. １．WANN모형구성의 기본원리와 작성순서 １) 기본원리 웨블레트해석법에서는 복잡한 흐름량의 시계렬을 몇개의 서로 다른 대역의 각이한 주 파수의 웨블레트곁수계렬과 척도곁수계렬 [ ww , 1 2 , , L p cw , p ] 로 분해한다. 웨블레트곁수계렬은 고주파성분을 나타내고 척도곁수계렬은 저주파성분을 나타낸다. 분해된 고주파성분과 저주파성분들이 시계렬에서 차지하는 비중은 완전히 다르며 그 것들의 변화경향도 같지 않다. 그리고 원시계렬의 예측값에 대한 기여몫도 다르다. ANN은 간단한 비선형함수(시그모이드함수)의 복합과정을 거쳐 임의의 비선형관계를 근 사하게 정의하는 능력을 가지고있다. 웨블레트변환과 ANN의 결합은 먼저 시계렬을 웨블레트변환하고 다시 웨블레트변환 계렬과 원시계렬과의 관계를 ANN으로 처리하여 원시계렬의 결과값을 얻는 방식으로 진 행한다. 웨블레트분해계렬이 다음과 같다고 하자. L 여기서 p는 분해층수, n은 분해계렬의 길이, 2 1 twtw ), ),( ( ( t = , n )는 저주파성분이다. ,2,1 L T시각에 웨블레트분해계렬 , tw p ),( c p t ( ), t n (1) twtw ), ( ( ), 1 2 , pL 는 고주파성분, c p )(t , = ,1 L tw )( τ+t (τ－예견기)시각의 원시계렬을 망의 출력으로 하여 ANN모형을 만든다. 우와 같은 모형을 웨블레트변환과 ANN과의 결합모형(WANN모형)이라고 한다. twtw ), ( ( ), 2 1 , pL tw )( , c p 를 ANN의 입력으로 하고 )(t ２）작성순서 ① 시계렬의 웨블레트분해 웨블레트분해변환곁수는 A Trous알고리듬을 리용하였다. 시계렬 tQtc = )(0 )( ∽ + tQ 에 대하여 )}({ tc )( i = ∑ ckh )( i ∽ k −= − 1 t ( + k i ()2 = ,2,1 L  p ) , － 137 － 라고 하면 A Trous웨블레트산법은 다음과 같다. 종합대학학보(자연과학)   주체105(2016)년  제62권  제2호 tW )( i , p = − 1 tCt − )( C i 는 각각 척도밑에서의 고주파계렬과 저주파계렬, i ()( ,2,1 L = p ) , i = 는 척도 P밑에서의 웨블레트변환계렬이라고 부른다. L ) 여기서 ww { , 1 2 , , ( L ,2,1 i ()( twtc ), i i p cw , ② WANN모형의 구성 ANN의 입력은 X = } [ p 망모형구조는 3층구조로 한다. 망의 무게곁수는 BP산법을 리용하여 학습하게 한다. twtw ( ), ( ), 2 1 , pL tw ),( c p T t )]( , 출력은 tQy ([ = τ+ )] (τ는 예견기), ２．월류출예보를 위한 WANN모형의 적용실례 월류출예보를 위한 웨블레트변환과 ANN과의 결합모형구축을 위한 자료선정은 대동강 의 2개 지점과 청천강의 4개 지점에 대하여 1951－2002년까지의 자료를 학습자료로, 2003 －2005년까지의 자료를 검사자료로 선정하였다. １）월류출예보모형의 파라메터결정 월류출예보모형의 파라메터로서는 주어진 자료의 분해층수 p와 학습곁수 η, 숨은층 마 디점수 h 가 있다. 이 파라메터들은 연구지역에서도 지점에 따라 다르기때문에 지점별로 시 행착오법을 리용하여 결정하였다. 6개 지점에서 얻어진 월류출예보모형의 최적파라메터는 표 1과 같다. 표 1. 월류출예보모형의 최적파라메터 지  점 구분 p  η h 청천강(1) 청천강(2) 청천강(3) 청천강(4) 대동강(1) 대동강(2) 2 0.75 8 2 0.80 6 2 0.70 8 2 0.80 7 3 0.85 9 3 0.85 6 ２）월류출예보모형의 작성 대동강류역 1지점에서 작성한 월류출예보모형(모형의 최적파라메터는 p=2, η =0.75, h =8)의 구조는 그림과 같다. 이제 tc )( 2 = tw )( 3 로 놓으면 tQ ( =+ )1 twtwtwf [ ( 2 ),( ), ( 1 8 3 3 = )] ⎛ ∑ ∑ ⎜ φν j ⎜ ⎝ 1 = 작성한 모형의 예견기는 1년이며 xW ji i θ j ⎞ ⎟ ⎟ ⎠ − 1 = j i 이다. )(⋅φ 는 시그모이드함수이다. x =φ 1/(1)( xe −+ ) jiW 는 입력층과 숨은층사이 무게곁수 이고 jν 는 숨은층과 출력층사이 무게곁수 이며 jθ 는 턱값이다. 그림. WANN모형의 구조 ３）월류출예보모형적용결과에 대한 평가 두 하천의 6개 지점에서 월평균흐름량의 예보모형을 작성하고 그것에 대한 평가를 진 행하였다. 대동강 1지점에 대한 평가를 진행한 결과는 표 2와 같다. － 138 － WANN모형에 의한 월류출예보방법 표 ２．웨블레트변환－ANN결합모형에 의한 예보결과 월 구분 실측값/ 3 1 −⋅ sm( 3 1 −⋅ sm( 상대오차/% ) ) 예보값/ 1 2 3 4 5 6 7 8 9 10 11 12 3.56 2.93 3.19 11.90 24.50 14.10 28.70 44.80 12.40 6.04 4.81 3.38 3.48 2.88 3.34 10.60 27.50 12.80 22.30 33.70 10.80 6.61 4.83 3.28 2.1 1.6 4.8 11.3 11.9 9.2 22.3 26.9 12.8 9.4 0.7 2.8 표 2에서 보는바와 같이 예보지점에서 WANN모형에 의한 예보결과는 7, 8월을 제외 하고 상대오차가 12%이하였다. WANN모형을 강하천들에서 월평균흐름량의 예보에 적용할수 있다. 맺 는 말 참 고 문 헌 [1] 최홍식 등; 기상과 수문, 3, 16, 주체90(2001). [2] 곽일환; 기상과 수문, 2, 18, 주체92(2003). [3] 박효영 등; 기상과 수문, 3, 20, 주체100(2011). Monthly Flow Forecast Method by WANN Model 주체104(2015)년 10월 5일 원고접수 Kim Yong Bong We applied models which combined wavelet transform and advantages of ANN in time series analysis to monthly inflow forecast. As a result, the relative error of observed and predicted values was below 12%.  Key words: wavelet, artificial neural network － 139 －