김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체105(2016)년 제62권 제4호 Vol. 62 No. 4 JUCHE105(2016). 반응의 과도상태를 계산하기 위한 한가지 제1원리적방법 김남혁, 량명성 반응의 과도상태를 계산하는것은 반응성을 연구하는데서 매우 중요하며 이를 위한 여러가지 방법들이 제기되였다.[2－4] 이 방법들중 널리 쓰이고있는 방법은 NEB(nudged elastic band)방법이며 이 방법에서는 반응물과 생성물사이에 계의 복사본(영상점)들을 미 리 가정한 다음 매 영상점들에 대하여 계의 전에네르기와 힘을 계산하게 된다. 그러나 계 의 크기가 큰 경우에는 매 영상점에 대한 계산에서 대단히 오랜 시간이 걸리게 되며 이 것을 극복하자면 매 영상점들에 대한 계산시간을 단축하여야 한다. 제1원리계산방법인 SIESTA(spanish initiative for electronic simulations with thousands of atoms)는 립자수가 많은 계에 대하여 다른 방법들보다 계산시간이 짧으므로 SIESTA와 NEB를 결합한다면 과도상태의 계산에 드는 시간을 대폭 줄일수 있다. 그러나 SIESTA와 NEB의 결합은 아직까지 실현된것이 없다. 론문에서는 SIESTA와 NEB를 결합하여 반응의 과도상태를 비교적 쉽게 계산할수 있 는 방법론을 세웠다. １．NEB방법 NEB방법[2, 5, 6]에서는 먼저 계의 복사본들 다시말하면 영상점들을 가상적인 용수철 들로 련결하여놓아 반응물의 배치 R로부터 생성물의 배치 P에 이르는 반응경로를 불련속 적으로 표현한다. 초기에 영상점들은 R와 P를 련결하는 직선우에서 선형보간하여 생성된 다. 다음 최적화알고리듬을 리용하여 이 영상점들을 최소에네르기경로(MEP)로 완화시킨다. 영상점들이 련결된 용수철띠를 [ RRR 1 2 0 , , , (cid:34) , NR ] 와 마감상태 R0 =R P=NR 이 최적화된다. NEB방법에서는 다음과 같은 함수 간상태의 영상점들 , 는 고정되여있으며 그사이에 놓인 NR RS (cid:34) ( 1 , ) , ,1 (cid:34) 에 관하여 최소화한다. R N NR N 으로 표시하자. 여기서 초기상태 1−N 개의 중간영상점들만 을 구성하고 이 함수를 중 ( (cid:34) , RS 1 , R N ) = 1 − ( RE i ∑ ) + ∑ k 2 ( R i − R i 1 − 2 ) (1) 이것은 i 1 = 1−N 개의 구와 튐성곁수가 k 인 N 개의 용수철로 이루어진 탄성띠가 2개의 1 = i 고정점사이에 늘여져있는것으로 볼수 있다. 이 사영하는 방법으로 해결할수 있다. 이러한 방식은 일부 문제점[3]을 가지고있으나 원자들을 변위시키는 힘을 다음과 같 F i ∇−= RE ( i ) s + F i ⊥ || ∇−= RE ( i ) ⊥ ( Rk i + − R i − R i − R i 1 − 1 + ) i τˆ (2) NEB방법을 적용하는데서 가장 중요한것은 매 영상점들에서 단위접선벡토르를 정확 － 61 － 종합대학학보(자연과학)   주체105(2016)년  제62권  제4호 히 결정하는것이다. 이로부터 접선벡토르를 구하기 위한 여러가지 방법들이 제기되였으나 이 방법들은 일부 문제점을 가지게 되였다.[1] 이로부터 영상점 i 에서 경로에 대한 접선 벡토르는 그 영상점과 그보다 더 큰 에네르기를 가진 이웃한 영상점을 련결하는 벡토르 에 의해 다음과 같이 정의된다.[7] R i 영상점 i 가 에네르기최소점( = + τ i 1 + E i − τ i < E i E i 1 − − R i , R i ) 혹은 최대점( E = 1 − i RE ( i ) E i 1 + (4) < )이라면 접선 > E i 1 − E i ˆ τ i = , , + ⎧ τ ⎪ i ⎨ − ⎪⎩ τ i R − i > 1 + , > E i > E i 1 − i 1 + < E i < E i 1 − i 1 + E E = (3) 벡토르는 다음과 같다. 여기서 τ i = + ⎧ τ ⎪ i ⎨ + ⎪⎩ τ i Δ E Δ E max i min i − τ Δ+ i − τ Δ+ i E E min i max i , , E E > E i 1 − i 1 + < E i 1 − i 1 + (5) Δ E max i = Δ E min i = E ( max ( E min − EE , i i 1 − − E i i 1 + − EE , i i 1 − − E i i 1 + ) , ). 다음 우와 같이 구성한 접선벡토르를 규격화한다. 이 규격화된 접선벡토르를 리용하 면 탄성띠는 영상점의 수가 충분한 경우 반드시 MEP에로 수렴하게 된다. 반응의 과도상 태는 수렴한 영상점들을 보간하여 얻은 구조들가운데서 최대에네르기를 가지는 구조이다. 과도상태와 초기상태의 에네르기의 차가 반응이 일어나기 위해서 극복해야 할 에네르기 고개로 된다. ２．SIESTA와 NEB의 결합 SIESTA방법은 노름보존의포텐샬과 원자궤도형토대를 리용하는것으로 하여 계산속도 가 빠르고 계산자원소비가 적으며 립자수가 많은 계들에 대한 계산을 쉽게 할수 있다. 이 로부터 SIESTA와 NEB를 결합하면 표면들에서 분자의 흡착과 해리와 같은 반응과정의 과도상태와 에네르기고개를 다른 계산방법들에 비해 쉽게 결정할수 있다. NEB방법을 SIESTA와 결합하자면 우선 SIESTA의 계산출력자료들을 분석하여야 한다. 표 1에 NEB방법을 적용하는데 필요한 자료들과 그것을 제공하는 SIESTA의 출력화일들, 출력자료들의 단위에 대하여 주었다. 표 １．NEB계산에 필요한 자료와 그것을 제공하는 SIESTA의 출력화일들, 출력자료들의 단위 No. NEB에 필요한 자료 SIESTA출력화일 1 2 3 에네르기 원자들에 작용하는 힘 원자자리표 LOG화일 .FA화일 .xyz화일 단위 eV eV/Å Å NEB방법을 프로그람으로 실현하자면 우선 모든 식들을 적당한 단위량들을 리용하여 － 62 － 반응의 과도상태를 계산하기 위한 한가지 제1원리적방법 무본화하여야 한다. 표 2에 에네르기와 힘을 비롯한 몇가지 물리적량들의 무본화에 리용 한 단위량들과 표시를 주었다. 표 ２．몇가지 물리적량들의 무본화에 리용한 단위량들 No. 무본화하려는 량 무본화단위량 무본화단위량의 표시 1 2 3 4 5 6 탄성띠의 탄성곁수 힘 변위 시간 질량 1 ÅeV/ 1 2ÅeV/ 1Å 1fs=10−15s 1amu=1.660 57×10−27kg 에네르기 1eV 0F  0k  0R  0t  0m  0E 물리적량을 무본화하자면 그 량을 표 2에서 준 단위량들로 나누어주면 된다. 무본화 된 량은 문자우에 물결표시를 하여 나타낸다. 무본화결과 식 (1)－(2)는 다음과 같이 된다. 1 2 (6) 1 − ~ RE ( i ~ ~ Rk ( i ∑ ∑ ~ R i ~ S = − + 1 − N N ) ) 2 i 1 = i 1 = ~ ~ Rk |( i ~ R i − ~ R i ~ R i − − ~ F i ~ ( RE i s ~ F i ~ ( RE i ) ⊥ ⊥ + + | || |) |) −∇= 는 SIESTA의 .FA화일에 출력되는 힘이며 이 수값들을 그대로 리 −∇= ~ 식 (7)에서 iRE∇− ( ~ 용하면 된다. 또한 iR 들이므로 화일의 수값을 그대로 무본화된 식에 대입할수 있다. 접선벡토르는 규격화되면 무본량이 되기때문에 접선벡토르를 계산하는 식들을 무본화할 필요는 없으며 .xyz화일의 1Å을 단위로 하는 원자자리표들을 그대로 리용하여 구할수 있다. 들은 SIESTA의 .xyz화일에 1Å을 단위로 하여 출력되는 원자자리표 (7) τˆ)| i 1 + 1 − | | NEB계산과정에 원자자리표들은 식 (7)에 의해 계산된 힘에 의하여 분자동력학적방법 으로 변위시키게 된다. 초기속도가 0이고 질량 m인 물체에 힘 F가 Δt시간동안 작용할 때 일어난 변위는 뉴톤의 제2법칙에 의해 다음과 같이 주어진다. R =Δ 1 2 F m 2 t Δ (8) 식 (8)을 무본화하면 다음과 같다. ~ F ~ m 2 Δ ~ t 1 2 ~ R =Δ 2 tF 00 mR 0 0 식 (9)에서 m~ 은 질량의 무본화단위량을 원자질량단위로 정하였기때문에 원자량으로 된다. 분자동력학적계산에서는 시간간격을 지나치게 크게 잡거나 작게 잡지 말아야 한다. ~ 대체로 원자들의 최대변위 다시말하여 식 (9)로부터 R Δ 가 주어지므로 그에 따라 시간간 격을 다음과 같이 정할수 있다. (9) 01.0 1 2 ~ t Δ ≈ 2 ⋅ ⋅ ~ F ~ m ~ t =Δ ⎛ ⎜ ⎜⎜ ⎝ ⎛ ⎜ ⎜ ⎝ 1 2 ~ F ~ m min 1 − ⋅ ⎞ ~ ⎟ 01.0 R Δ⎟ ⎠ 21 ⎞ ⎟ ⎟⎟ ⎠ (10) － 63 － 종합대학학보(자연과학)   주체105(2016)년  제62권  제4호 ~m 은 움직일수 있는 원자들의 원자량들중에서 제일 작은 값이다. 식 (10)에서 min 물리적량들의 무본화를 완성한데 기초하여 무본화된 식들을 프로그람으로 전환하였 다. 프로그람은 다음과 같은 4단계의 순환을 거치면서 동작한다. ① 반응의 초기상태와 마감상태를 구성하고 선형보간방법으로 중간영상점들을 생성 한다. 기와 매 원자들에 작용하는 힘, 함수 ② SIESTA를 리용하여 초기상태와 마감상태를 포함한 모든 영상점들에서 전에네르 NR ③ 계산된 에네르기와 힘에 기초하여 매 영상점들에서 단위접선벡토르들을 구성하고 을 계산한다. RS (cid:34) , ( 1 ) , 영상점들에 작용하게 될 힘을 결정한다. ④ 이 힘을 리용하여 매개 영상점들을 분자동력학적인 방법으로 변위시킨다. 다음 단 이 주어진 오차한계내에서 변하지 않을 NR 계 ②로 넘어간다. 이 순환은 함수 RS (cid:34) , ( 1 ) , 때까지 진행한다. SIESTA는 리눅스체계의 쉘환경에서 실행되므로 단계 ①, ③, ④에 해당한 처리를 진 행하는 프로그람은 C++언어로 작성하여 쉘에서 실행될수 있게 하였으며 SIESTA와 C++ 이 수렴할 때까지 언어로 작성된 프로그람들사이의 자료교환과 실행, 함수 ) , RS (cid:34) , ( 1 NR 진행하게 되는 순환과정은 모두 쉘에서 실행되는 쉘스크립트로 조종하였다. 다시말하여 SIESTA의 코드를 수정함이 없이 NEB의 기능들을 C++언어로 따로 작성하고 SIESTA와 C++언어로 작성된 프로그람들의 호상련관과 실행을 쉘스크립트로써 실현하였다. 새로 작성된 프로그람의 정확성을 검증하기 위하여 같은 대상에 대하여 DMol3프로 그람으로 계산한 결과와 비교하였다. 계산대상으로서 불화메틸에서 불소1가음이온의 교환 과정 을 설정하였다. FCH → F F + + − − FCH 3 3 그림은 DMol3과 SIESTA로 각각 얻은 과도상태들을 보여주었다. 그림에서 보는바와 같이 두 프로그람으로 계산한 과도상태는 서로 같았으며 과도상 태의 에네르기고개들은 0.01eV의 정확도로 일치하였다. 이것은 새로 작성한 프로그람을 과도상태의 탐색과 반응의 에네르기고개를 계산하는데 리용할수 있다는 담보를 준다. 그림. DMol3과 SIESTA와 결합한 NEB방법으로 얻은 과도상태 ㄱ) DMol3방법, ㄴ) SIESTA와 결합한 NEB방법 － 64 － 반응의 과도상태를 계산하기 위한 한가지 제1원리적방법 맺 는 말 론문에서는 제1원리계산방법인 SIESTA와 반응의 과도상태탐색방법인 NEB를 결합하 여 립자수가 많은 계들에서 과도상태를 쉽게 결정할수 있는 방법론을 세웠다. 또한 이미 존재하는 SIESTA의 코드를 수정함이 없이 NEB기능만을 C++언어를 리용하여 작성하고 리눅스의 쉘스크립트를 리용하여 두 프로그람을 련결시키는 방법으로 SIESTA와 NEB의 결합을 실현하였다. 참 고 문 헌 [1] B. Delley; J. Chem. Phys., 113, 7756, 2000. [2] Y. Yang et al.; J. Phys. Chem., C 115, 17378, 2011. [3] H. Jonsson et al.; Nudged Elastic Band Method for Finding Minimum Energy Paths of Transitions in Classical and Quantum Dynamics in Condensed Phase Simulations, World Scientific, 385, 1998. [4] A. Heyden et al.; J. Chem. Phys., 123, 224101, 2005. [5] G. Mills et al.; Phys. Rev. Lett., 72, 1124, 1994. [6] G. Mills et al.; Surf. Sci., 324, 305, 1995. [7] G. Henkelman et al.; J. Chem. Phys., 113, 9978, 2000. 주체104(2015)년 12월 5일 원고접수 A First-Principles Method for the Calculation of the Transition State of the Reaction Kim Nam Hyok, Ryang Myong Song By combining SIESTA and NEB, we establish a method which can easily determine the transition state of the reaction involving systems with relatively many atoms. The combination is accomplished using Linux shell script. NEB is written in C++ and code of SIESTA is not modified.  Key words: SIESTA, NEB, transition state － 65 －