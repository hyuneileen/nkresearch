김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체105(2016)년 제62권 제4호 Vol. 62 No. 4  JUCHE105(2016). 혼합가우스분포와 기대값최대화를 리용한 맹인글자 문서화상 행추출의 한가지 방법 최철, 리정철 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《정보기술발전을 위한 과학연구사업을 앞세워야 합니다.》(《선집》 증보판 제20권 380 페지) 맹인글자문서화상인식체계는 문서에 인쇄된 맹인용점글자(Braill Character)를 화상입력 장치로 읽어들여 인식하는 체계로서 최근시기 그 연구가 본격화되고있다.[2] 맹인글자문서화상의 인식에서는 행을 정확히 추출하는것이 뒤단계의 인식을 위해 매 우 중요한 문제로 제기된다. 이러한 행추출방법에는 호우변환과 히스토그람을 리용한 방법, 라돈변환(RT: Radon Transform)에 의한 방법 등 여러가지가 있다. 론문에서는 혼합가우스분 포를 리용한 맹인글자문서화상에서의 행추출의 한가지 방법을 제기하고 실험을 통하여 그 유효성을 검증하였다. １．혼합가우스분포를 리용한 행추출 론문에서는 부분구역선택에 의한 경사각추출방법[1]에 의해 문서의 경사보정은 이미 진 행된것을 전제로 한다. 맹인글자문서화상을 인식하기 위해서는 맹인글자를 이루는 매개 행을 결정해야 하는 데 이를 위해서는 문서의 웃가장자리로부터 첫행까지의 거리(b)와 행사이간격( β)을 추정 해야 한다. 앞으로는 이 두 파라메터(b와 β)를 행파라메터라고 표기한다. 맹인글문서는 그 특성상 하나의 행이 3개의 부분행으로 이루어지므로 행분포는 3개의 가우스분포의 혼합으로 모형화될수 있다. 그러나 우리는 모형의 복잡성과 파라메터추정에 서의 느린 수렴성문제를 극복하기 위하여 한행안의 3개의 부분행들을 하나의 가우스분포 로 모형화한다. 문서를 2진화하고 련결성분추출을 진행했을 때 매 련결성분의 수직자리표들의 분포는 다음과 같이 표현할수 있다. yg )( = lbyN + ;( , ) σβ (1) 1 L L 1 − ∑ l 0 = 식 (1)에서 L 은 문서안의 행개수, l 은 행번호, y 는 추출된 련결성분들의 수직자리표, b 와 β는 행파라메터, δ는 모형의 분산을 나타낸다. 식 (1)에서 보는바와 같이 모든 련결성분의 수직자리표 y 의 분포는 1차원가우스혼합 분포로 표현할수 있다. － 26 － 혼합가우스분포와 기대값최대화를 리용한 맹인글자문서화상 행추출의 한가지 방법 문제는 식 (1)이 최대로 되는 모형의 행파라메터를 추정하는것인데 우리는 이 문제를 기 대값최대화(EM: Expectation Maximization)알고리듬으로 해결하려고 한다. 매 련결성분을 iC 로 표현하면 기대값최대화문제는 다음과 같이 해결할수 있다. １）기대값결정단계 먼저 기대값최대화를 위한 우도함수를 다음과 같이 결정한다. log ( yp 1 , π 1 , y 2 , π 2 , (cid:34) , y N , π N ) = log ( yp , i π i ) = N ∏ 1 = i = log N ∑ 1 = i ⎛ ⎜ π i ⎜ ⎝ ⎛ ⎜ ⎜ ⎝ c 1 L L 1 − ∑ 0 = l ( yN ; i lb + , ) σβ 1( −+ π i ) (2) 1 S ⎞ ⎟ ⎟ ⎠ ⎞ ⎟ ⎟ ⎠ i = 식 (2)에서 N 은 련결성분개수, iy 는 i 번째 련결성분의 수직자리표, c 는 계산상수, δ 는 모형의 분산, S 는 해당 련결성분이 잡음일 확률이다. 그리고 iπ 는 련결성분의 사전확 률로서 다음과 같이 계산된다. ( Cpπ = dot ∈ = i )F| i p |F( i C ∈ 점모임 ) p |F( i ( Cp C ∈ ∈ i dot 점모임 ) p |F( ) i + Cp ( C i ∈ 점모임 ) ∈ 잡음모임 ) Cp ( ∈ 잡음모임 ) i i i 한편 식 (2)를 그것의 파라메터들에 관하여 미분하고 그것들을 령으로 놓으면 복잡한 비 선형방정식모임이 생기는데 이것을 풀기는 매우 어렵다. 그러므로 우리는 반복적인 EM방 법을 리용하여 우도를 최대화하도록 파라메터를 결정한다. 이 경우에 우연변수들은 ,1 , ωω 1 2 (cid:34) 이며 여기서 ,1,0{ Nω ω i (cid:34) ∈ L − , , , i (3) L } t θ = 은 행번호를 나타낸다. t t , σβ t b ,{ } 가 주어질 때 매 iω 의 확률 기대값결정단계에서는 현재(t)시각에 추정 분포를 구해야 한다. 즉 P il = P ( ω i = yl | , i t , θπ i ) = P = ( ω i yP ( yl , | t , θπ i i t , θπ i ) | i ) = ( ω i = yl , i | t , θπ i ) t P ) θπωθπω = = ( l l , , , | t | ) i i i i = (4) P ( ω i = yl , i | t , θπ i ) t P ) θπωθπω = = ( l l , , , | t | ) i i i P L ∑ l = 0 = = i yP ( L ∑ l = 0 yP ( i = i yP ( L ∑ l = 0 yP ( i i , t ( θπωθω P = = ) l l , , | t | ) i i i t ( θπωθω P = = ) l l , , | t | ) i i i P ( | ) θπω = l , = i i ,         (5) 0 Ll −≤≤ 1 Ll = ( yP i | ) l θω = , = i ) , σβ 0 Ll −≤≤ 1 Ll = .       (6) π i π i 1 L 1 − ⎧ ⎪ ⎨ ⎪⎩ lby + i 1 S ; ( cN ⎧ ⎪ ⎨ ⎪⎩ 식 (4)에서 iω 가 주어질 때 iy 와 iπ 의 조건부독립성을 리용한다.( iω 를 알고있다고 하면 iy 는 i <ω 인 경우 유효한 점이고 L i =ω 은 인위적인 점으로 된다.) L － 27 － 종합대학학보(자연과학)   주체105(2016)년  제62권  제4호 ２）최대화단계 우선 이 단계에서는 보조함수 t Q θθ ,( ) 를 다음과 같이 만든다. Q t ,( θθ ) N L 1 − = ∑ ∑ i l =1 0 = θ b= ,{ log − ⎛ ⎜ ⎜ ⎝ , } σβ log σ − ( y i 1 2 b −− 2 σ 2 ) l β P il ⎞ ⎟ ⎟ ⎠ + C (7) 여기서 C 는 파라메터 에 대해 상수이며 따라서 최량화문제에 영향을 주지 않 는다. 다음 보조함수의 파라메터들의 다음번 추정 t t 1 + , σβ 1 + = t θ b { 1 + , t 1 + } 을 다음과 같이 결정한다. max θ 를 최대화하기 위하여 파라메터 arg t θ 1 =+ t Q θθ ,( ) 를 계산하여 령으로 되게 하여야 한다. 즉 t Q θθ ,( ) (8) θ b= ,{ , } σβ 의 매개에 대해 Q 의 편도함수 ∂ b ∂ ∂ ∂ β Q t ,( θθ 0) ⇒= Q t ,( θθ 0) ⇒= ⎛ ⎜ ⎜ ⎝ ⎛ ⎜ ⎜ ⎝ N L 1 − ∑ ∑ i 1 = l = 0 ⎞ ⎟ bP +⎟ il ⎠ ⎛ ⎜ ⎜ ⎝ 1 − lP il N L ∑ ∑ i 1 = l = 0 ⎞ ⎟ =⎟ β ⎠ ⎛ ⎜ ⎜ ⎝ N L 1 − ∑ ∑ i 1 = l = 0 ⎞ ⎟ ⎟ ⎠ yP il i ,      (9) 1 − lP il N L ∑ ∑ i 1 = l = 0 1 − 2 Pl il N L ∑ ∑ i 1 = l = 0 ⎞ ⎟ =⎟ β ⎠ ⎛ ⎜ ⎜ ⎝ 1 − lP il N L ∑ ∑ i 1 = l = 0 y i ⎞ ⎟ ⎟ ⎠ ,     (10) ∂ σ ∂ Q t ,( θθ 0) ⇒= .          (11) ⎞ ⎟ b +⎟ ⎠ N L ⎛ ⎜ ⎜ ⎝ 1 − ∑ ∑ i 1 = l = 0 ( yP il i lb −− ) β 2 N L 1 − ∑ ∑ l = 0 P il 1 i = 방정식 (9)와 (10)은 다음과 같이 결합된다. A b ⎡ ⎤ =⎥ ⎢ β ⎦ ⎣ B , b ⎡ ⎤ 1−=⎥ BA ⎢ β ⎦ ⎣ (12) 이때 행렬 A와 B는 다음과 같이 정의된다. A = L N P il 1 − ∑ ∑ 0 1 i = = 1 N − ∑ ∑ lP il 1 = = l L 0 i l ⎡ ⎢ ⎢ ⎢ ⎢ ⎣ L N 1 − ∑ ∑ lP il 0 1 l i = = 1 N L − 2 ∑ ∑ Pl il 1 = = 0 i l ⎤ ⎥ ⎥ ⎥ ⎥ ⎦ , B = N L 1 − ∑ ∑ i 1 = l = 0 ⎡ ⎢ ⎣ yP il i N L 1 − ∑ ∑ i 1 = l = 0 T ⎤ ⎥ ⎦ lP il y i (13) 우의 식들을 리용하여 문서화상의 행파라메터들 ,{ θ b= } , σβ 가 추정되면 행의 위치 를 정확히 알아낼수 있으며 이때 중간선위치는 다음과 같이 얻을수 있다. yl lb += β− , l ( = ,1,0 (cid:34) , L − )1 (14) β 2 실천에서는 행개수를 1～30사이로 놓고 매개 행에서 최대우도를 내는 행파라메터를 계 산한 다음 가장 큰 우도를 가질 때의 행개수와 행파라메터를 최종결과로 한다. － 28 － 혼합가우스분포와 기대값최대화를 리용한 맹인글자문서화상 행추출의 한가지 방법 같다. ２．실험결과 및 성능평가 제안된 맹인글자문서화상의 행추출방법의 효과성을 검증하기 위하여 분해능이 200dpi , 5− , 인 화상입력장치(《BENQ-Scanner-5005》)로 입력한 50개의 문서화상을 20− + 5 , +10 , 15+ (cid:68)20 로 회전시켜 모두 400개의 실험화상을 준비하였다. , 15− , 10− , + 여기에 기초하여 실험을 진행하고 제안한 방법과 선행한 방법을 비교한 결과는 표와 표．행추출률 평가 적용방법 문서개수 정확히 추출한 개수 행추출률/% 선행한 방법[2] 제안한 방법 400 400 392 398 98.4 99.5 표에서 보여준것처럼 제안한 방법의 행추출성능이 선행한 방법보다 높은것은 선행한 방 법과는 달리 문서의 경사각을 추정파라메터로 결정하지 않았기때문이다. 4/ 실험에서는 행파라메터의 초기값을 화상높이 ( βσ = ,10 β /) L = = b , 로 주었다. 그림 1에 론문에서 제안한 방법을 리용한 행추출의 한가지 실례를, 그림 2에 행개수에 따르는 우도변화를 보여주었다. 그림 1. 경사보정 및 행추출결과 ㄱ) 원화상, ㄴ) 추출결과 그림 2는 문서안에 행이 모두 25개까지 있 을수 있다고 가정했을 때 행개수에 따르는 우 도값을 표시한 그라프이다. 그림에서 행개수가 13일 때 우도값이 최 대로 되므로 이때의 행파라메터를 리용하여 행추출을 진행하였다. － 29 － 그림 2. 행개수에 따르는 우도변화 종합대학학보(자연과학)   주체105(2016)년  제62권  제4호 [1] 종합대학학보(자연과학), 52, 8, 40, 주체95(2006). 참 고 문 헌 [2] M. Yousefi et al.; A Robust Probabilistic Braille Recognition System, Springer, 14, 2011. 주체104(2015)년 12월 5일 원고접수 A Method for Extracting Lines of the Braille Document Image using GMM and EM Choe Chol, Ri Jong Chol We proposed a method to exactly extract the lines of braille document image using GMM and EM. in the braille document images. By experiments, we confirmed that the proposed method was very effective for extracting lines Key words: braille, GMM － 30 －