김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체105(2016)년 제62권 제12호 Vol. 62 No. 12  JUCHE105(2016). 망응용층규약식별을 위한 다중핵심부 려과체계설계에 대한 연구 박 성 호 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《정보산업을 빨리 발전시키고 인민경제의 모든 부문을 정보화하여야 합니다.》 (《선집》 증보판 제20권 380페지) 고속의 망응용층규약식별에 다중핵심부구성방식을 리용하기 위한 연구[2]가 진행되였 으나 망프로그람들의 병렬화수준이 높지 못하고 다중핵심부봉사기들에서의 일정관리가 복잡한것으로 하여 망파케트처리에서 충분한 능력을 발휘하지 못하고있다. 일반적으로 콤퓨터망에서의 공격행위들은 주로 파케트자료부의 내용 즉 응용층의 자 료에 기초하여 진행되게 된다. 또한 많은 망응용프로그람들이 큰 대역너비와 계산능력을 요구하므로 망응용들의 우선권에 기초하여 자원을 분배하게 된다. 이로부터 망보안과 QoS보장을 위하여 망응용층규약식별문제가 중요하게 제기되고있다.[1] 한편 10Gbps이상의 고속망들의 출현으로 하여 망자료흐름의 밀도가 높아졌으며 이로 하여 망응용층규약식별의 실시간성에 대한 요구가 높아졌다. 다중핵심부(Multicore)구성방식은 여러개의 핵심부들에서 병렬의 프로쎄스나 스레드들 을 실행함으로써 파케트처리능력을 높일수 있으므로 큰 대역너비를 가지는 망들에서 요 구되는 I/O처리를 정합하기 위한 봉사기가동환경으로 널리 쓰인다. 그러나 실제적인 처리 기리용률을 높이는 문제는 해결되지 못하고있으며 이것은 문제대상에 따라 구체적인 해 결방법을 찾아야 한다. 론문에서는 망응용층규약식별과제를 병렬화하고 다중핵심부봉사기에서 일정관리를 단순화함으로써 응용층규약식별의 성능을 높이는 문제를 론의하였다. １．병렬화와 일정관리에 의한 응용층규약식별의 성능개선 우리는 응용층규약식별을 위한 파케트패턴정합처리를 다중핵심부구성방식의 다중스 레드방식으로 실현하였는데 이때 스레드는 전처리스레드(PT)와 패턴정합스레드(MT)로 구 성하였다. 여기서 PT는 파케트들의 머리부정보를 기본으로 하는 전처리조작과 파케트들 의 일정관리기능을, MT는 파케트의 자료부정보를 기본으로 하는 파케트정합처리기능을 수행한다. 체계성능을 높이기 위한 간단한 방법은 보다 많은 MT들을 만드는것인데 리론적으로 는 처리단위의 수에 비례한다. 그러나 실천에서 다중스레드화의 확장성문제는 OS일정관 리기와 다중스레드화의 설계에 크게 의존한다. － 20 － 망응용층규약식별을 위한 다중핵심부려과체계설계에 대한 연구 한편 Linux kernel 2.6에서 스레드화된 부하를 관리하기 위하여 O(1)일정관리기가 쓰 이는데 이 일정관리기는 입출력류사성관리(I/O Affinity)를 실현한다는 우점이 있지만 핵심 부간 자료복제로 인한 캐쉬실패에 의한 간접소비를 산생시킨다. 그리고 여러개의 MT들이 창조되면 매 MT는 하나의 련결완충기상에서 실행되며 한 련결에서 하나의 새로운 파케 트가 재조립될 때 비지 않은 스레드실행대기렬을 우연선택하면 같은 련결의 파케트들을 다른 핵심부들에 복제함으로써 추가적인 캐쉬실패를 초래하게 된다. 이러한 문제를 해결하기 위하여 다중핵심부봉사기에서의 류사성에 기초한 한가지 일 정관리방법을 제안하였는데 그 과정은 그림과 같다. Core 0(CPU 0)에 PT를 고정분배하고 다중 핵심부봉사기의 나머지 매개 핵심부들에 하나 의 MT를 결합한다. 그러면 여러개의 MT들이 패턴정합을 위한 처리를 병렬로 진행하게 된다. 이때 하나의 독립적인 스레드를 하나의 전용핵 심부에 분배하면 일정관리에서 간접소비를 줄 이고 부하의 이동으로 인한 캐쉬실패를 줄일수 있으며 캐쉬와 자원리용률을 개선할수 있다. 본질에 있어서 같은 련결에 대한 모든 조 립완충기들(서로 다른 수의 파케트들을 가지는) 은 같은 MT에 할당되며 따라서 같은 련결의 파케트들은 머리부의 IP층정보뿐아니라 자 료부에서 잠재적인 공통부분들도 공유하므로 같은 CPU에서 같은 련결의 파케트들을 처 리하면 보다 좋은 캐쉬일치성을 유지할수 있다. 그림. 류사성에 기초한 일정관리 응용층규약식별을 위한 일정관리알고리듬은 다음과 같다. ① 일정관리기는 들어오는 파케트에 대하여 먼저 그것의 련결상태에 기초한 분류가 필요한가를 결정한다. ② 만일 그 련결에 대하여 이전의 결과가 전혀 기록된것이 없다면 일정관리기는 그 새 파케트를 련결완충기에 추가하고 이 새로운 완충기를 이미 같은 련결의 조립완충기들 을 포함하고있는 MT실행대기렬에 추가한다. ③ MT실행대기렬이 꽉 찬 경우에 일정관리기는 새 입력을 위한 실행대기렬이 준비 될 때까지 대기한다. 만일 들어오는 파케트가 새 련결에 속한다면 일정관리기는 가장 짧 은 실행대기렬을 가지는 MT를 찾아 부하균형을 맞추려 하므로 이때 초기캐쉬실패(cold cache line)가 보통 존재하지만 이 부하균형방법은 기정의 OS일정관리기에 비하여 초과간 접소비를 초래하지 않는다. 실행대기렬의 매 항목을 분류하기 전에 MT는 그 련결상태가 변화되였는가를 검사한 다. 만일 려과체계가 일정한 수의 파케트들을 가지고 련결을 성공적으로 분류한다면 MT 는 자기의 실행대기렬로부터 새 련결을 불러들인다. 이때 어느 한 MT가 련결의 분류에 실패할 때 리용된 파케트들은 여전히 그 MT가 리용한 캐쉬에 남아있게 된다. 그러므로 그 이후의 련결분류는 그 캐쉬를 리용할수 있으며 초기경우에 비하여 보다 효과적으로 실행될수 있다. － 21 － 종합대학학보(자연과학)   주체105(2016)년  제62권  제12호 ２．실험결과분석 성능을 확인하기 위하여 다중스레드화에 의한 응용층려과체계의 련결준위병렬화를 위한 일정관리와 기정의 OS일정관리를 처리량, CPU리용률, 캐쉬실패률을 기본척도로 하 여 모의실험을 진행하였다. 그리고 디스크I/O, TCP/IP재조립과 역단편화, 련결완충기재조 립과 일정관리를 포함하는 전처리를 위하여 하나의 스레드(PT)를 리용하였다. 이때 패턴 정합을 위한 스레드(MT)들의 수를 변화시키는 방법으로 실험하였다. 실험결과 7개의 병렬스레드가 있을 때 체계처리량은 원래의 OS일정관리기에 비하여 51%만큼 증가하였다. 즉 체계는 MT들의 수에 따라 거의 선형으로 확장(실례로 스레드가 7개일 때 6.5배)되였다. 또한 CPU리용률도 류사성에 기초한 방법에서보다 효과적인것으로 나타났는데 기정의 일정관리에 비하여 약 15% 감소되였다. 한편 L2캐쉬실패률은 50% 줄어들었다. 기정의 일정관리에서는 부하균형을 위하여 스 레드들을 이동시키지만 제안한 방법에서는 같은 련결의 파케트들은 모두 같은 스레드에 배당되고 이것들이 하나의 지정된 핵심부로 지정되므로 패턴정합을 위하여 캐쉬가 계속 유지상태에 있게 되며 캐쉬리용률이 높아지게 된다. 맺 는 말 응용층규약식별을 위한 다중핵심부구성방식에서 류사성에 기초한 일정관리스레드방법 을 제기하였으며 이로 하여 기정의 OS일정관리에 비하여 처리량은 51% 증가하고 CPU리 용률은 15% 감소되였다. 또한 캐쉬실패률을 크게 줄임으로써 전체적인 체계성능을 높일수 있게 하였다. 참 고 문 헌 [1] B. Veal et al.; Proceedings of ANCS, 63, 2011. [2] B. Dhamankar et al.; Journal of Networks, 6, 5, 58, 2012. 주체105(2016)년 8월 5일 원고접수 A Research on Design of the Multicore Filter System for the Identification of Network Application-Level Protocols Pak Song Ho We describe that the performance of the application-level protocol identification is raised by parallelizing task for the network application-level protocol identification and simplifying the scheduling in the multicore server. Key words: application-level protocol identification, multicore filter system － 22 －