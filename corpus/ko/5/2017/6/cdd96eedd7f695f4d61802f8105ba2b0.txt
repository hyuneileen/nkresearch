김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체106(2017)년 제63권 제6호 Vol. 63 No. 6  JUCHE106(2017). FxLMS-CF알고리듬과 보상알고리듬에 기초한 ANC레시바성능제고방법 정철, 김진혁, 김정철 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《첨단과학기술분야에서 세계적경쟁력을 가진 기술들을 개발하기 위한 투쟁을 힘있게 벌려야 합니다.》(《조선로동당 제7차대회에서 한 중앙위원회사업총화보고》 단행본 39페지) 능동소음조종은 저주파대역의 소음을 효과적으로 제거하는 첨단기술분야의 하나이다. 능동소음조종의 기본알고리듬은 FxLMS이다. 그러나 이 알고리듬은 외부소음의 특징에 따 라 수렴속도가 상대적으로 느리고 소음제거성능이 떨어진다. 또한 능동소음조종에 리용되 고있는 대부분의 소자들은 Floating-point DSP소자에 기초하고있다.[1, 2] Fixed-point DSP소자 를 리용하기 위하여 Leaky FxLMS알고리듬, ADF알고리듬 등을 제안[3]하였으나 반소음신호 의 세기를 떨구는것으로 하여 총체적으로 능동소음조종체계의 소음제거성능을 감소시킨다. 이로부터 우리는 Fixed-point DSP장치에서 수렴속도를 훨씬 개선하면서도 소음제거성 능을 더욱 높이기 위한 방법을 제안하였다. １．보상된 FxLMS-CF알고리듬 １）교환오차와 Feedback효과를 고려한 FxLMS알고리듬 FxLMS-CF ANC기본조종알고리듬인 FxLMS알고리듬에서는 음향학적인 경로를 고려하기 위하여 LMS려파기의 입구에 소음신호 )(nx 을 그대로 입력하는것이 아니라 ′ )( nx = h (ˆ ZS ) n )( ∗ nx )( (1) 을 입력한다. 결국 2차경로 (ZS 가 반소음고성기와 오차마이크사이에 있으나 FxLMS알고 ) 리듬에서는 2차경로가 앞에 있는것으로 근사화된다. 이제 ne )(C ′′= ny )( ′− ny )( (2) 을 교환오차라고 하면 교환오차를 고려하여 줄여야 할 총오차신호는 이다. 여기서 ′ )( ny = n )( ∗ [ nxnw )( ⋅ T n )( ∗ nx ( )] = ′ nxnw )( )( ⋅ 이다. T 총체적인 오차 = nd )( ′′+ ny )( h ZS ( ) ne )(T )( ne T = )( ne + (3) )( ne C T nw ( = )] , ′′ )( ny [)( ⋅ h ZS ) ( 을 받아들이면 식 (3)은 )( ne − = )( ne C )( ne T (4) 으로 표시된다. 이제 원가함수(cost function)를 nJ )( = 으로 정의하고 원가함수의 최소화를 위한 [ ne ( T )] 2 － 42 － 종합대학학보(자연과학)   주체106(2017)년  제63권  제6호 무게벡토르갱신을 위한 LMS적응알고리듬을 유도하면 ( nw )1 =+ )( nw − μ ′ )( nxne ⋅ T )( (5) 이 얻어진다. )(C ne 이 일정할 때 )(T ne 의 최소화는 곧 )(ne 의 최소화와 등가이므로 무게 갱신알고리듬 식 (5)는 ANC체계에서 오차신호를 최소로 하는 알고리듬으로도 된다. 한편 능동소음조종형레시바에서 반소음신호가 참조마이크로 귀환되여 능동소음조종 기의 성능을 저하시키는 feedback효과를 무시할수 없다. 그러므로 우리는 우에서 제기한 교환오차와 feedback효과를 고려한 FxLMS알고리듬 즉 FxLMS-CF를 다음과 같이 제안하였다. ① 준백색소음을 반소음고성기로 내보내여 LMS알고리듬에 의한 2차경로모형화와 feedback경로모형화를 진행하여 그 임풀스응답특성 h (ˆ ZS ② 참조마이크와 오차마이크를 리용하여 소음신호 , n )( h ZPb (ˆ ) )(nr 과 오차신호 n )() 을 추정한다. )(ne 을 입력한다. ③ Feedback효과를 고려한 소음신호 )(~ nx = nr )( − )(~ nx 을 다음식에 의하여 계산한다. ~ nf )( ny )( nr )( n )( − = h ∗ (ˆ ZPb ) (6) ④ 반소음신호 )(ny 을 계산하고 반소음고성기로 출력한다. )( ny = T )(~)( nxnw ⋅ = k (~)( knxnw − ) (7) N ∑ k = 0 ⑤ 식 (2)－(5)를 리용하여 교환오차와 총체적인 오차를 계산한다. ⑥ 무게곁수를 갱신한다. nw ( )1 =+ nw )( − )(~)( ′ nxne ⋅ T μ (8) 실시간적으로 단계 ②부터 ⑥까지를 반복한다. ２）Fixed-point형DSP소자에서 보상알고리듬 론문에서는 비실시간모의방법에 의한 진폭, 위상보상인자추정방법을 제기하고 FxLMS- CF알고리듬에 적용하였다. 리상적인 반소음은 비실시간모의를 통하여 추정할수 있다. 이때 feedback효과가 무시 되며 반소음신호가 반소음고성기를 통하여 출력되지 않으므로 총체적인 오차신호는 )(T ne = )( nd ′′+ )( ny (9) 으로 된다. 이러한 비실시간모의를 통하여 얻어진 리상적인 반소음을 기의 무게곁수를 이라고 하자. w ideal n )( y ideal n )( , ANC조종 실제적인 반소음은 실지 동작하는 ANC조종기를 비실시간적으로 근사하게 모방하는 방법으로 얻을수 있다. y 이때 얻어지는 실지 반소음신호를 real n )( 하자. 실제적인 반소음을 리상적인 반소음으로 만들기 위하여서는 실제적인 반소음의 위 상과 진폭을 추가적으로 보상하든가 아니면 반소음을 생성하는 조종기를 변경시켜야 한 다. 전자는 잡음의 영향을 크게 받지만 후자는 적게 받는다. 이로부터 론문에서는 리상적 인 반소음조종기와 실제적인 반소음을 출력하는 조종기의 주파수응답특성을 대비하는 방 , ANC조종기의 무게곁수를 real n )( 이라고 w FxLMS-CF알고리듬과 보상알고리듬에 기초한 ANC레시바성능제고방법 － 43 － 법으로 보상인자들을 유도하였다. 유도결과는 다음과 같다. ( ) ωαωωα H = ( ) ( ) ⋅ ⋅ e j Δ ( ) ωθ j [ ) )] − ωθωθ ( ( w ideal w real (10) = W W ideal real ( ( j ) ω = ） j ω I ) ( ω w ideal w I ) ( ω real e 여기서 W real ( j ω =） wF { n )}( = real I w real ( )( ω = Re W ( j )) ω ⋅ e real w j ( ) ωθ real , W ideal ( j ) ω = wF { ideal n )}( = I w ideal )( ( ω = Re W ( j )) ω ⋅ e ideal w j ) ωθ ideal ( . (11) 이제 (ωα 는 각주파수 ω에서의 진폭보정인자, ) (ωθΔ ) 는 각주파수 ω에서의 위상차 라고 하자. 그러면 위상차로부터 위상보정인자를 추정할수 있는데 그 과정을 보면 다음과 같다. 평균값정리를 리용하면 평균진폭보정인자라고 불리우는 근사적인 진폭보정인자 α 는 α = 1 f Δ f 2/ Δ ∫ )2( f πα 2/ f Δ− df = 1 f Δ ω stop stop 2 f π = ∑ 2 f π = ω start start I w real w ideal I ) ( ω ) ( ω , f =Δ f stop − f start (12) 로 정할수 있다. 만약 소음과 반소음이 리상적인 단색파에 가까와간다면 며 ( 0ωαα = 위상보정은 실제조종기의 구조에 약간의 시간지연을 추가하는 방법으로 다음과 같이 이 된다는것을 쉽게 알수 있다. 으로 되 0→Δf ) 간단하게 하려고 한다. p =′ 0 arg w [max m ~) wmk + ( * real ideal ( k )] − N ≈ arg ( * wmk real + ) ideal ( k )] − N (13) w [max m 여기서 N 은 무게곁수벡토르의 길이 즉 ANC조종기의 차수, ][⋅ 는 교차상관함수이다. 추정되는 위상보정인자 0p′ 는 상관함수의 성질로부터 리상적인 조종기와 실제적인 조종기의 상관관계가 최대로 되도록 추정되고 결국 모든 각주파수에 대한 평균위상보정 인자라고 말할수 있다. 결과 식 (12)와 식 (13)을 고려하여 실지 반소음의 위상을 식 (7)대신에 에 따라 위상과 진폭을 보정하면 은 리상적인 반소음에 보다 가깝게 되며 소음제 ~ y real n )( = α ⋅ (~)( knxn − ′+ pk 0 ) (14) ′− pN 0 ∑ w k = 0 ~ y real n )( 거성능이 높아지게 된다. 실험에 리용된 DSP소자는 TMS320C6416T이다. ２．실 험 결 과 １）FxLMS-CF알고리듬의 성능평가 론문에서는 FxLMS-CF알고리듬의 성능을 다른 알고리듬[3, 4]과 비교평가하였다. 실 험에서는 표본화주파수를 2kHz로 하였으며 FxLMS려파기들의 차수는 20으로 하였다. 그림 1에 각종 알고리듬들의 오차신호그라프를 보여주었다. － 44 － 종합대학학보(자연과학)   주체106(2017)년  제63권  제6호 ㄱ)               ㄴ)              ㄷ)  그림 1. 각종 알고리듬들의 오차신호그라프 102.3 ⋅ , ㄴ) FxLMS-CE, , ㄷ) FxLMS-CF, 910 − 45.7 45.7 =μ =μ =μ 10 910 − ⋅ ⋅ − ㄱ) FxLMS, 그림 1에서 보는바와 같이 FxLMS-CF알고리듬은 다른 알고리듬들에 비하여 수렴속도 가 빠르며 소음제거성능도 가장 좋다. ２）진폭, 위상보상인자추정과 보상알고리듬의 성능평가 FxLMS알고리듬에 대하여 비실시간모의에 의한 진폭 및 위상보상인자추정을 진행하 고 그것을 실시간실험을 통하여 확증하였다. 그림 2에 각이한 위상보상에 따르는 FxLMS알고리듬에 의한 실시간실험결과를 주었다. ㄱ) ㄴ) ㄷ) ㄹ) ㅁ) ㅂ) ㅅ) ㅇ)  그림 2. FxLMS알고리듬에서 위상보상인자의 실험적검증 ㄱ)－ㅈ)는 p′ 가 각각 0－8까지 변할 때 ㅈ) FxLMS-CF알고리듬과 보상알고리듬에 기초한 ANC레시바성능제고방법 － 45 － 그림 2의 첫번째 그림은 식 (14)에서 0=′p 일 때의 오차신호그림이고 오른쪽으로 가 면서 p′ 가 증가하며 제일 마지막그림은 8=′p 일 때의 오차신호그라프이다. 그림 2에서 보는바와 같이 위상보상인자 p′ 에 따라 소음제거성능이 가장 좋을 때는 ) 나머지경우에는 소음이 전혀 제거되지 않거나 7=′p 인 때에도 조종알고리듬이 수렴한다. 이것 7,1=′p 그림 2의 ㄴ)와 ㅈ)인 경우이다.( 그 성능이 상대적으로 떨어진다. 그러나 은 위상보상인자가 일정한 주기성을 가진다는것을 보여주고있다. 파동의 간섭원리에 의 하면 간섭의 극대와 극소가 주기적으로 변한다. 다시말하여 간섭의 극대와 극소는 주기 성을 가지며 마찬가지로 위상보상인자도 주기성을 가지게 되는것이다. 현재 실험에서 리용된 소음의 기본주파수가 294Hz이고 표본화주파수가 2 000Hz이므 로 위상보상인자는 6을 주기로 하여 반복적으로 나타난다는것을 알수 있다. 총체적으로 론문에서 제기한 방법으로 넓은 대역소음에 대하여 23.8dB만큼 소음을 제거할수 있다. 맺 는 말 교환오차와 Feedback효과를 다같이 고려한 FxLMS-CF알고리듬을 제안하고 여기에 론 문에서 제기한 보상방법도 받아들여 소음제거성능을 보다 높였다. 론문에서는 위상 및 진폭보상인자를 비실시간모의로 추정하기 위한 새로운 방법론을 제기하고 그것을 실험적으로 확증하였다. [1] E. R. Berstein et al.; International J. of Industrial Ergonomics, 30, 1, 2012. [2] Manabi Kubo et al.; Applied Acoustics, 87, 174, 2015. 참 고 문 헌 [3] S. M. Kuo et al.; Design of Active Noise Control Systems with the TMS320 Familly, Texas Instruments, 25～43, 76～95, 1996. [4] I. Tabatabaei Ardekani et al.; Signal Process, 91, 1262, 2011. 주체106(2017)년 2월 5일 원고접수 Performance Enhancement Method of Noise Reduction based on FxLMS-CF Algorithm and Compensation in the ANC Headset Jong Chol, Kim Jin Hyok and Kim Jong Chol In order to improve the noise reduction performance in the Fixed-point DSP device we proposed the method for estimating phase and amplitude compensation factor of anti-noise signal by non-realtime simulation. By considering the commutation error and feedback effect, this compensation method has been applied to real Fixed-point DSP devices, and as a result both the convergence rate and the total performance of noise reduction have been improved. Key words: active noise control(ANC), Fixed-point DSP