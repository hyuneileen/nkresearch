김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체106(2017)년 제63권 제6호 Vol. 63 No. 6  JUCHE106(2017). 망침입검출을 위한 드문련관규칙발굴의 한가지 방법 공혜옥, 정철영 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《수학, 물리학, 화학, 생물학과 같은 기초과학부문에서 과학기술발전의 원리적, 방법론 적기초를 다져나가면서 세계적인 연구성과들을 내놓아야 합니다.》(《조선로동당 제7차대회에서 한 중앙위원회사업총화보고》 단행본 40페지) 론문에서 제기한 침입검출체계의 이상검출을 위한 드문련관규칙발굴알고리듬은 침입 검출과 같이 드물게 발생하는 숨은 패턴들을 발굴하는데 적용할수 있으며 비빈발항목모임 을 대상으로 하는것으로 하여 해쉬토대를 리용하는 전통적인 련관규칙발굴알고리듬보다 속 도문제, 기억공간문제에서 우점을 가지고있다. 련관규칙발굴의 표준응용실례인 시장바구니분석의 목표는 업무자료기지안의 항목모임 들사이의 관계를 밝히는것이다. 이 관계는 업무자료기지안의 빈발항목모임에 기초한다. 그 러나 침입검출체계를 위한 망파케트자료기지에서는 시장바구니분석과는 달리 망가입자들 의 정상활동이 비정상활동보다 많으므로 빈발항목모임을 발견하는것보다 비빈발항목모임 에 기초하여 련관규칙발굴알고리듬의 효과성을 높일수 있다. 선행연구[1－3]에서는 공통적인 패턴과 규칙을 발굴하지만 고립적인 패턴이나 규칙 즉 드문련관규칙을 발굴하는데는 충분한 관심을 돌리지 못하였다. 선행연구[4]에서는 비빈발항목들로부터 효과적인 련관규칙을 발굴하는 알고리듬들을 제 기하고 업무자료기지에서의 정량적련관규칙을 론의하였지만 관계형자료기지에서의 정량적 련관규칙의 정식화를 주지 못하였으며 또한 정상적인것과의 차이를 표현하는 새로운 규칙 을 이상규칙이라고 보고 드문패턴을 발굴하는 문제의 중요성을 제기하였으나 여러 형태의 이상패턴들을 효과적으로 식별하기 위한 흥미측도에 대하여서는 제기하지 못하였다. 우리는 침입검출에서와 같이 드물게 발생하지만 가치있는 패턴을 발굴하는것이 매우 중 요하게 제기되는 응용분야들에 적용할수 있는 드문련관규칙발굴문제를 론의한다. 대부분의 련관규칙발굴알고리듬들은 흥미있는 규칙들을 발굴하기 위하여 최소지지도 와 최소믿음도를 리용한다. 이때 이 2개의 파라메터에 의하여 생성되는 많은 련관규칙들이 축소되여도 여전히 사용자에게 흥미가 없는 많은 규칙들이 생성된다. 실례로 간장과 소금의 구입자료를 보여주는 표에서 규칙 《간장→소금》의 지지도는 20% 즉 80%로서 상당히 높 p (/) 로서 높다. 이 규칙의 믿음도가 간장 ) 간장 ( 20/25 소금 0.8 p ∧ = = 표. 간장과 소금의 구입자료(%)  간장 ￢간장 ∑렬 소금 ￢소금 ∑행 25 5 20 75 5 70 100 10 90 으므로 이 규칙은 유효한 규칙이라고 할수 있다. 그런데 소금을 사는 사람은 90%로서 믿음도 80%보다 크므로 이 규칙은 잘못 발굴되였다. 사실상 간장과 소금중에서 어 느 하나를 구입하면 다른것을 구입하는 일은 거의 없으 므로 서로 부정적으로 련관된다고 볼수 있다. 망침입검출을 위한 드문련관규칙발굴의 한가지 방법 － 15 － 우의 실례는 최소지지도와 최소믿음도를 리용하는 련관규칙발굴의 취약성을 보여준다. 즉 규칙에서 전제의 발생이 결론의 발생을 의미하지 않는다면 잘못된 련관규칙을 유도할 수 있다. 이로부터 론문에서는 호상관련성에 기초하여 자료항목모임들사이의 흥미있는 관계를 찾 는 다른 방법을 제기한다. 주어진 자료기지안의 항목모임 A 의 지지도를 sprt A 라고 할 때 자료기지안의 항목 ( ) 모임 X와 Y의 호상관련성에 대한 통계적정의는 다음과 같다.  , YX Y ( ( sprt ) 이면 이로부터 Interest ∪ YX =YX Interest ∪ YX 1) sprt sprt sprt sprt /() = = ( ) ( , ⋅ ( 이면 ( Interest 한 Interest 1) , >YX ( , <YX 1) sprt 이면 ( ∪ YX ) > sprt ( X ) ⋅ sprt Y )( sprt ( ∪ YX ) < sprt ( X ) ⋅ sprt 즉 Interest값이 1이면 Y와 X는 독립이므로 규칙 론이 독립이면 규칙이 흥미없다는것을 의미한다. ⋅ ) ( ( ) X X )) 이므로 Y와 X는 독립이며 sprt 이므로 Y는 X에 긍정적으로 관련된다. 또 이므로 Y는 X에 부정적으로 관련된다. Y )( Y )( X → 는 흥미가 없다. 이것은 전제와 결 Y 최소흥미도를 min_Interest라고 할 때 | sprt ( YX ∪ ) − sprt ( X ) ⋅ sprt Y |)( ≥ min_ Interest 이면 항 목모임 YX ∪ 는 잠정적으로 흥미있는 항목모임으로 볼수 있다. , yX = , φ Z ∃ = , ∩ YXYX : ≤kx ) sprt ( ∪ YX sprt , min_ sprt ( , x ∈∀ k ≤ky ) min_ k sprt ∈ Y , 일 때 Z는 잠정적으로 비빈발항목모임,  sprt ( YX ∪ sprt − ) ( | X ) ⋅ sprt Y |)( ≥ min_ Interest 이면 Z는 잠정적으로 흥미있는 비빈발항목모임이라고 한다. min_sprt, min_conf, min_Interest를 각각 주어진 업무자료기지에서 규정된 최소지지도와 최소믿음도, 최소흥미도라고 할 때 다음과 같은 정의를 할수 있다. 정의 １ I = φ=YX ∩ , sprt ( X I ,{ 1 ≠ ) I 2 , (cid:34) , ,0 sprt } nI Y )( 을 업무자료기지안의 항목들의 모임이라고 하고 ⊆  I , min_Intere > 일 때 다음의 0 YX , st ≠ 0 , min_sprt > 0, min_conf > 0, 조건 ①－③을 만족시키는 X → 를 흥미있는 유효규칙 혹은 련관규칙, 조건 ④－⑦을 만 Y 족시키는 ① sprt X → 를 흥미있는 드문유효규칙 혹은 드문련관규칙이라고 한다. ( Y ≥YX ∪ min_ sprt ) ② | sprt ( YX ∪ ) sprt ( X ③ conf ( X Y =→ sprt ( − ) ) sprt ⋅ ∪ YX Y |)( ≥ sprt ( /) min_Intere st X ) ≥ min_ conf ④ ⑤ sprt ( X ) ≤ min_ sprt , sprt Y )( ≤ min_ sprt | sprt ( YX ∪ ) − sprt ( X ) ⋅ sprt Y |)( ≥ min_Intere st ⑥ Interest ( 1) , >YX Y ) =→ ( X ⑦ conf sprt ( R를 관계형자료기지, ∪ YX f 1 , f ) ≥ min_ sprt /) (cid:34) 을 R의 마당들, ( X nf conf , , 2 m 리산화된 령역값들이라고 하면 R의 매 레코드 iR 는 유일한 식별자 ID를 가지며 v q 1 k 으로 표시할수 있다. 따라서 R에서 가능한 모든 항목모임은 (cid:34)= ,2,1 (cid:34) , (cid:34) , R i f 1 ,1 N = = = = = = nk } { v { k jk m I f j f 2 2 n , , , , k i i i i iR | i } 이다. 여 q ( j = ,1 (cid:34) , , kn = ,1 (cid:34) , j ) 를 jf 의 기서 N은 R의 레코드수이다. － 16 － 종합대학학보(자연과학)   주체106(2017)년  제63권  제6호 f { = X f 1 p p , = = 1 2 2 RID⊆X RID에 대하여 안의 마당이름들이고 k k f I } p = ⊆ (cid:34) , , 이면 레코드 RID는 X를 포함한다고 말한다. 여기서 ,1 (cid:34) 는 X안의 마당들에 대응되는 리산화된 령역값들이다.  p 를 정량적항목모임이라고 할 때 R안의 어떤 레코드 ,1 (cid:34) 는 X f kf kp , , 관계형자료기지 R에서 정량적항목모임 X를 포함하는 레코드들의 백분률은 X의 지지 도이다. 이것을 업무자료기지에서와 마찬가지로 정의 ２ I = { f = q jk j | j = ,2,1 (cid:34) , kn , = ,1 (cid:34) , ) sprt X 로 표시한다. ( 을 R안의 정량적항목모임이라고 하고 } m j , YX ⊆ , YXI ∩ φ= , sprt ( X ) ≠ ,0 sprt Y )( ≠ 0 , min_sprt > 0, min_conf > 0, min_Intere st > 0 X → 를 정량적련관규칙, 조건 ④－⑦을 만족시 일 때 다음의 조건 ①－③을 만족시키는 Y X → 를 드문정량적련관규칙이라고 한다. sprt Y sprt ( ≥YX ∪ 키는 min_ ① ) ② | sprt ( YX ∪ ) − sprt ( X ) ⋅ sprt Y |)( ≥ min _Interest ③ conf ( X Y =→ ) sprt ( ∪ YX /) sprt ( X ) ≥ min_ conf ④ ⑤ sprt ( X ) ≤ min_ sprt , sprt Y )( ≤ min_ sprt | sprt ( YX ∪ ) − sprt ( X ) ⋅ sprt Y |)( ≥ min_ Interest ⑥ Interest ( >YX 1) , ⑦ conf ( X Y =→ ) sprt ( ∪ YX /) sprt ( X ) ≥ min_ conf 드문정량적련관규칙의 발굴과정은 다음과 같은 두가지 단계들로 구성된다. 단계 １ 흥미있는 비빈발항목모임들을 식별한다. 즉 정의 1(혹은 정의 2)의 ④로부터 = ∩ φ , = , YX∃ yX , ∈ Y Z : , sprt ( YX ≤kx ) min_ ∪ YX sprt , sprt ( x ∈∀ , k ≤ky min_ ) k  sprt 이면 Z는 비빈발항목모임이며 정의 2의 ⑤로부터  Y |)( | YX ∪ sprt sprt sprt X − ( ) ) ( ⋅ ≥ min_ Interest 이면 Z는 잠정적으로 흥미있는 비빈발항목모임이다. 이러한 Z들을 주어진 자료기지에서 모 두 발견해낸다. 단계 ２ 발견된 비빈발항목모임들로부터 흥미있는 규칙들을 추출한다. 즉 비빈발항목 모임들의 가능한 결합들로부터 정의 2의 ⑥을 리용하여 드문련관규칙들로 제한하며 정의      2의 ⑦을 리용하여 강한 흥미를 가진 드문련관규칙들을 추출한다. 이처럼 드문정량적련관규칙발굴과정은 련관규칙발굴과정과 원리적으로 동일하며 업무 자료기지가 아니라 관계형자료기지라는것, 단계 1에서 빈발항목모임들이 아니라 비빈발항 목모임들을 발견한다는것, 단계 2에서 흥미가 없는 련관규칙들은 배제한다는것 등에서 차 이난다. 다음으로 망침입검출을 위한 해쉬화알고리듬에 대하여 보자. 망파케트자료기지는 관계형자료기지이며 침입자료는 정상자료보다 훨씬 드물게 나타 난다. 따라서 망파케트자료기지에서 드문정량적련관규칙들을 발견하는 방법을 적용한 이상 검출체계를 구축할수 있다. 또한 망파케트자료기지는 레코드길이가 상대적으로 길지 않고 동일하며 더우기 비빈 발항목들의 수는 극히 적으므로 해쉬화방법을 적용하여 비빈발k－항목모임들의 지지도를 효 망침입검출을 위한 드문련관규칙발굴의 한가지 방법 － 17 － 과적으로 계산할수 있다. 알고리듬은 다음과 같다.  입력: R, min_supp (최소지지도), min_Interest (최소흥미도), min_conf (최소믿음도) 출력: RAR (R의 드문련관규칙들의 모임) ① R를 조사하여 모든 1－비빈발항목모임들의 족 NL1을 구한다. ② Address =φ for ∀r∈R {    rL1= 1-비빈발항목모임족(r); // rL1⊆NL1    for(k=2; rLk-1≠φ; k++){ rCk=apriori_gen(rLk-1);      for ∀c∈rCk { Address(k, c) = Hash(c);        if Address(k, c)∉Address{         Address=Address∪Address(k, c); Value(k, c) = 1;}        else         Value(k, c)++;      } //Hashing }  } //support ③ NL =φ for ∀Address(k, c)∈Address{ NLk= {Hash-1(Address(k, c))|Value(k, c)≤min_supp};    NL=NL∪NLk; } //NL: All infrequent itemsets ④(cid:1)RAR =φ ∀X, Y⊆NL, X∩Y=φ, if (|supp(X∪Y)−supp(X)supp(Y)|≥min_Interest)∧(Interest(X, Y)>1) ∧(supp(X∪Y)/supp(X)≥min_conf) RAR=RAR∪{X→Y}; //All Rare Association Rules return RAR;   Procedure apriori_gen(NLk-1)  Ck=φ(cid:1) for ∀l1∈NLk-1{    for ∀l2∈NLk-1{      if (l1[1]=l2[1])∧(l1[2]=l2[2])∧…∧(l1[k-2]= l2[k-2])∧(l1[k-1]<l2[k-1]) then{ c=l1∞l2;        Ck=Ck∪k c;}}} return Ck; － 18 － 종합대학학보(자연과학)   주체106(2017)년  제63권  제6호 알고리듬에서는 먼저 자료기지를 조사하여 1－비빈발항목모임들을 식별하고 자료기지를 두번째로 조사하면서 매 레코드에 포함된 k－비빈발항목모임들의 지지도를 해쉬함수를 리용하여 계산한 다음 | sprt ( YX ∪ ) − sprt ( X ) ⋅ sprt Y |)( ≥ min _Interest , Interest ( >YX 1) , 을 리용하여 흥미있는 정의 비빈발항목모임들만을 골라내며 conf ( X ≥→ Y ) min_ conf 를 만족시키는 흥미가 강한 드문련관규칙을 발굴한다. 알고리듬의 적용과정은 아래와 같이 구성된다. 걸음 １ 자료기지 R를 조사하면서 5.0 min_ sprt 구한다. = 를 리용하여 1－비빈발항목모임 NL1을 걸음 ２ 자료기지 R를 두번째로 조사하면서 매 레코드에 포함된 비빈발항목들을 식별해내고 그것들의 가능한 결합으로 k－비빈발항목모임들을 구한 다음 해쉬화수법으로 지지도를 계산한다. 걸음 ３ | sprt ( ∪ YX ) − sprt ( X ) sprt Y |)( 의 값을 계산한다. 이 값이 min_Interest보다 작지 않은 를 계산하고 Interest ( >YX 1) , 인 정의 련관규칙 흥미있는 드문련관규칙들을 추출한다. ∪ YX ) sprt ⋅ sprt ( X ( 걸음 ４ Interest YX , sprt = ( ) ) Y )( 들을 추출한다. sprt ( sprt ∪ YX X ( ) ) 강한 련관규칙들을 추출한다. 걸음 ５ conf ( X Y =→ ) 의 값을 계산하고 conf ( X ≥→ Y ) min_ conf 인 흥미가 이와 같이 우리는 마당개수가 수십개정도인 망파케트자료기지를 대상으로 하는 침입 검출체계에서 드물게 발생하는 이상현상들을 목표로 침입패턴을 발굴할수 있는 실천적인 해 쉬토대의 드문련관규칙발굴알고리듬을 개발하였다. 론문에서 제기한 알고리듬은 침입검출과 같이 드물게 발생하지만 가치있는 숨은 패턴을 발굴하는 응용분야들에 적용할수 있으며 비빈발항목모임을 대상으로 하기때문에 해쉬토대의 방법으로 전통적인 련관규칙발굴알고리듬보다 속도문제, 기억공간문제에서 뚜렷한 우점을 가지도록 설계되였다. [1] Hyeok Kong et al.; IJTPC, 10, 12, 1, 2015. 참 고 문 헌 Technologies, 29～30, 164～170, 2015. [3] Li Hanguang et al.; Physics Procedia, 24, 1615, 2012. [2] K. M. M. Aung et al.; Proceedings of 2015 International Conference on Future Computational [4] N. Rountree et al.; Rare Association Rule Mining and Knowledge Discovery: Technologies for Infrequent and Critical Event Detection, Hershey, 15～32, 168～184, 2010. 주체106(2017)년 2월 5일 원고접수 망침입검출을 위한 드문련관규칙발굴의 한가지 방법 － 19 － A Method of Rare Association Rule Mining for Network Intrusion Detection Kong Hye Ok, Jong Chol Yong We propose a new practical rare association rule mining algorithm for anomaly detection in intrusion detection system (IDS). This algorithm can be applied to the fields require to mine the hidden patterns which are rare but valuable like IDS, and it is designed based on hashing among infrequent item-sets, and it has obvious advantages of speed and memory space limitation problems than the traditional association rule mining algorithms. Key words: infrequent item-set, anomaly detection