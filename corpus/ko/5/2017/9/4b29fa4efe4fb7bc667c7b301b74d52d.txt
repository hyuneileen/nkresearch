김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체106(2017)년 제63권 제9호 Vol. 63 No. 9  JUCHE106(2017). 오유있는 학습문제에 기초한 한가지 격자암호체계에 대한 연구 리룡철, 김철은 경애하는 최고령도자 동지께서는 다음과 같이 말씀하시였다. 《정보통신부문에서는 첨단암호기술을 개발리용하여 통신하부구조의 보안준위를 높임으 로써 적들의 해킹과 도청을 철저히 막으며 통신의 안전성과 신뢰성을 확고히 담보하여야 합 니다.》 앞으로 량자콤퓨터가 정보처리에 널리 리용되면 RSA암호나 타원곡선암호와 같이 현 재 널리 리용되고있는 암호체계는 더이상 쓸수 없게 된다.[2] 이로부터 세계적으로 량자 콤퓨터로도 풀수 없는 새로운 암호에 대한 연구가 심화되고있으며 특히 격자암호가 광범 히 연구되고있다. 론문에서는 평등우연분포를 리용하여 정의된 오유있는 학습(LWE: Learning With Errors)문제에 기초하여 알고리듬적으로 보다 효률적이고 안전한 격자암호체계의 한가지 구성방법을 제기하고 그 안전성을 증명한다. 선행연구[1]에서 제기된 풀기 어려운 문제로 알려진 LWE문제에 기초한 격자암호체계 는 량자콤퓨터를 리용한 공격에 안전하다는 우점이 있지만 열쇠길이가 매우 크다는 결함 으로 하여 실용화되지 못하였다. 선행연구[2]에서는 선행연구[1]에서의 암호체계보다 열쇠길이가 더 짧으면서 보다 안 전한 격자암호체계를 제기하였다. 이 암호체계는 선행연구들에서 제기된 추상적인 암호체 계를 실용화한것인데 다른 격자암호체계들보다 공간효률성이 더 좋다. 그러나 선행연구[2]를 비롯한 일련의 연구들에서 제기된 LWE문제에 기초한 격자암호 체계들은 이전의 체계들에 비하여 공간효률성에 있어서나 안전성에 있어서 많이 갱신되 였지만 오유분포가 리산가우스분포에 따른다는 가정에 기초하고있기때문에 그것들을 알 고리듬으로 실현하자면 품이 많이 든다는 약점을 가지고있다. 선행연구[3]에서는 리산가우스분포대신에 {0, 1}에서의 평등분포를 오유분포로 리용 하여도 적당한 제한조건을 주면 LWE문제의 난도가 보장된다는것을 증명하였다. 선행연구들에서 제기된 격자암호체계들에서 알고리듬적으로 보다 실현하기 쉬운 평 등분포를 오유분포로 리용하지 못한 리유는 표본개수 m이 충분히 클 때에는 Arora-Ge의 에서의 평등분포를 오유분포로 리용한 LWE문제를 풀수 있기때문 방법[4]으로 +∈ Ζ ) Ζ t ( t 이였다. 한편 선행연구[3]에서는 일정한 제한조건밑에서 평등분포를 오유분포로 가지는 LWE 문제의 복잡성을 증명하였으나 설정된 제한조건의 특성으로 하여 아직까지 그것에 기초 한 격자암호체계가 나오지 못하고있다. 오유있는 학습문제에 기초한 한가지 격자암호체계에 대한 연구 － 15 － 우리는 평등분포를 오유분포로 가지는 LWE문제에 기초한 한가지 격자암호체계를 제 기한다. xf :)( = ρ s ρ s ∫ R n )( x )( z dz = )( x n ρ s s , ρ xs )( = − π ⎛ ⎜ exp ⎜ ⎝ 2|| 2 || x s ⎞ ⎟ ⎟ ⎠ nR 우에서 파라메터 s 를 가지는 가우스분포라고 한다. 과 같은 밀도함수를 가지는 분포를 잉여격자 c ⊂+ L R 과 파라메터 0>s n 에 대하여 리산가우스(확률)분포 sLD ,+c 는 D c + , sL ρ ⎧ s ～ ⎨ ,0 ⎩ ( x ), cx +∈ L cx +∉ L 을 만족시키는 분포이다. 리산가우스분포는 평활파라메터 s 를 가진다. 이것은 매 잉여류 L+c 들의 가우스질량 ρ s ( c + L :) = )( x 들이 얼마간의 상대 ∑ cx +∈ ρ s L 오유까지 허용하면서 거의 같아질 때의 가장 작은 정의파라메터로 볼수 있다. LWE문제는 파라메터로서 옹근수 n 과 q , 옹근수모임 Ζ 우의 오유분포 χ를 가진다. 인 리산가우스분포에 따르는데 이때 α 를 여기서 오유분포 χ 는 보통 면적이 ( <ααq )1 상대오유률이라고 부른다. 정의 １[1](LWE분포) 비밀값이라고 부르는 벡토르 n qΖs ∈ 에 대하여 Ζ × 우에서 q n q Ζ 평등우연적으로 n qΖa ∈ 을 취하고 χ←e 를 선택하면서 ba 를 출력하여 표본화되는 분 ,( ) 포 χ,sA 를 LWE분포라고 부른다. 여기서 LWE문제는 두가지 부류 즉 LWE분포로부터 여러개의 표본들이 주어졌을 때 비밀값 을 찾는 문제(탐색－LWE문제)와 LWE분포표본들과 평등우연표본들이 주어졌을 때 어느 것이 LWE분포표본들인가를 결정하는 문제(판정－LWE문제)로 나누어진다. n 이다. mod as , +〉 〈= q b e qΖs ∈ 에 대한 LWE분포 χ,sA 로부터 m개의 독립표본들 정의 ２ 평등우연비밀값 ( a i b , i n q Ζ q ∈) Ζ × 가 주어졌을 때 s 를 찾는 문제를 탐색－LWE문제라고 한다. 정의 ３ 평등우연비밀값 n qΖs ∈ 에 대한 LWE분포 표본들이 주어졌을 때 어느것이 LWE분포 χ,sA 와 평등분포에서 뽑은 m개의 χ,sA 의 표본이고 어느것이 평등분포의 표본인 가를 결정하는 문제를 판정－LWE문제라고 한다. 대표적인 격자암호체계들에 대하여 보자. Regev의 암호체계 선행연구[1]에서는 LWE문제에 기초한 다음과 같은 격자암호체계를 내놓았다. ① 비밀열쇠는 평등우연적인 LWE비밀값 n qΖs ∈ 이며 공개열쇠는 LWE분포 χ,sA 로부 터 뽑은 nm ≈ ( + log)1 q 개정도의 벡토르 ( a i b , i 〈= as , 〉 ) i 1+∈ n qΖ 들이다. 행렬로 표시하면 공개열쇠는 Α = ∈ (Ζ n q )1 ×+ n 과 같다. Α t b ⎡ ⎢ ⎢ ⎣ ⎤ ⎥ ⎥ ⎦ 이때 t b = t eΑs + ⋅ t mod q 이다.(사용자가 여러명인 경우 인증기관이 A 를 모든 사용자 들에게 배포하여 공유하게 함으로써 공개열쇠크기를 tb 로 줄인다.) t t 정의에 의하여 ( − s )1, ⋅ eΑ = 0≈ mod q 가 성립된다. 여기서 오유분포 χ는 리산가우 ⎛ ⎜⎜ ⎝ t q 2 ⎢ ⎢ ⎣ ⎥ ⎥ ⎦ ⎞ ⎟⎟ ⎠ － 16 － 종합대학학보(자연과학)   주체106(2017)년  제63권  제9호 스분포이다. ② 암호화는 공개열쇠의 우연적인 렬벡토르들의 부분합벡토르의 마지막성분에 통보 문비트 μ를 적당히 부호화하여 더하는 방법으로 1개 비트씩 진행한다. 즉 평등우연적으 로 m}1,0{∈x 을 취한 다음 암호문 xΑc +⋅ = , μ0 ⋅ 1+∈ n qΖ 을 출력한다. ③ 복호화는 비밀열쇠 s 를 리용하여 다음과 같이 진행된다. t ( − s )1, c −=⋅ ( s )1, ⋅ μxΑ ⋅+⋅ t t = e μx ⋅+⋅ q 2 ⎢ ⎢ ⎣ ⎥ ⎥ ⎦ q 2 ⎢ ⎢ ⎣ ⎥ ⋅≈⎥ μ ⎦ q 2 ⎢ ⎢ ⎣ ⎥ ⎥ ⎦ mod q 계산결과가 0에 가까우면 0, 에 가까우면 1을 복호화결과로 출력한다. q 2 ⎢ ⎢ ⎣ ⎥ ⎥ ⎦ Lindner와 Peikert의 암호체계 선행연구[2]에서 제기한 암호체계에서는 옹근수모듈수 과 같은 파라메터들이 리용된다. 이 차원수들은 암호체계가 , 옹근수차원수 1 , 2≥q n 1 ≥n 2 기초하고있는 LWE문제들과 관련된다. 열쇠생성과 암호화에 리용되는것은 가우스분포파라메터들 ks 와 es , 통보문자모 ∑ (실례로 ∑ ={0, 1}), 통보문길이 을 리용하는 단순한 부호화함수 encode : →Σ 1≥l 이다. 또한 통보문자모의 기호에 대하여 오유턱값 가 리용된 decode Σ→qΖ: qΖ , 복호화함수 1≥t 이 충분히 클 때 임의의 옹근수 , ) e t e q + = [ t −∈ mod encode ( ) μ decode ( ) 에 대하여 다음과 같다.  μ 다. 여기서 우리는 평등분포를 오유분포로 하는 LWE문제에 기초하여 선행연구[1]에서 제기한 LWE격자암호체계에 비하여 열쇠길이가 보다 짧고 알고리듬적으로 보다 효률적인 새로운 격자암호체계를 제기한다. 열쇠생성 ×∈ ΖΑ mn q ( ααnm + 1( ), ≈ > 0 )이 평등우연적으로 뽑은 행렬이라고 하고 오유 분포 χ가 {0, 1}에서의 평등분포라고 하자. 이때 비밀열쇠는 매 성분을 오유분포 χ 에서 표본화한 n 차원벡토르 n}1,0{∈s 이며 공개열쇠는 Α = ∈ (Z n q )1 ×+ m 과 같다. 여기서 t b = t eΑs t ∈+ Ζ m q 이며 e 는 매 성분이 χ Α t b ⎡ ⎢ ⎢ ⎣ ⎤ ⎥ ⎥ ⎦ 에서 독립적으로 표본화된 m차원벡토르이다.  t t ( s − 이때 암호화 암호화와 복호화는 1개 비트 eΑ = mod )1, 0≈ q ⋅ 가 성립된다는것을 알수 있다. }1,0{∈μ 씩 진행한다. 평등우연벡토르 m}1,0{∈r 을 취하고 다음과 같은 계산을 진행하여 암호문을 출력한다. rΑc +⋅ = , μ0 ⋅ + ,( 0 1 te n +∈′ Ζ ) q , χ←′e ⎛ ⎜⎜ ⎝ t q 2 ⎢ ⎢ ⎣ ⎥ ⎥ ⎦ ⎞ ⎟⎟ ⎠ 복호화 복호화는 비밀열쇠 s를 리용하여 다음과 같이 진행한다. 먼저 ( − s )1, c −=⋅ ( s )1, ⋅ μrΑ ⋅+⋅ t t t e ′+⋅ e r 를 계산한 다음 결과가 q 2 ⎢ ⎢ ⎣ ⎥ =′+⎥ e ⎦ ⋅ μ q 2 ⎢ ⎢ ⎣ ⎥ +⎥ ⎦ q 2 ⎢ ⎢ ⎣ ⎥ ⎥ ⎦ 보다 작으면 0, 같거나 크면 1을 출력한다. 오유있는 학습문제에 기초한 한가지 격자암호체계에 대한 연구  평문을 l개 비트씩 암호화하기 위하여서는 암호체계를 다음과 같이 구성하면 된다. 비밀열쇠를 행렬의 매 성분들이 χ에서 독립적으로 표본화된 ln×∈χS 로, 공개열쇠를 － 17 － Α = ∈ (Ζ ) mln ×+ q ⎡ ⎢ ⎢ ⎣ t Β Α ⎤ ⎥ ⎥ ⎦ lm × q 으로 설정한다. 여기서 t B t = EAS + ∈ Ζ t 이며 ml×∈χE 은 행렬들의 매 성분들을 χ에 서 독립적으로 표본화한 오유행렬이다.[5] 론문에서 제기된 암호체계는 선행연구[1]에서 제기한 암호체계에서 표본개수 개로 줄이고 대신에 선행연구[2]에서 제기한 착상을 ( + 1( α+ ) ≈ nm log)1 ( >α 를 )0 q nm ≈ 리용하여 암호문에 오유항을 더 첨가함으로써 체계의 안전성을 높이였다. 다음으로 암호체계의 정확성과 안전성에 대하여 론의하자. 정리 １ 론문에서 제기된 암호체계의 복호화과정은 파라메터들이 조건 q > m 2 + 2 를 만족시킬 때 정확히 진행된다. 증명 암호체계의 정의로부터 다음식들이 성립된다. ( − s t , 1) c ⋅=⋅ μ ′+⋅ e r , e0 ≤ r ≤⋅ m , 0 ≤′≤ e 1 t q 2 ⎢ ⎢ ⎣ ⎥ +⎥ ⎦ t e 따라서 0=μ 일 때 (0 −≤ s 1) c ≤⋅ m + 1 , 1=μ 일 때 t , t s , 1) c ≤⋅ m + 1 이다. q 2 ⎢ ⎢ ⎣ ⎥ ( −≤⎥ ⎦ q 2 ⎢ ⎢ ⎣ ⎥ +⎥ ⎦ t q 2 ⎢ ⎢ ⎣ ⎥ ⎥ ⎦ 한편 암호체계의 복호화과정이 정확히 진행되자면 0=μ 일 때 (0 −≤ s , 1) c <⋅ 가 q 2 ⎢ ⎢ ⎣ ⎥ ( −≤⎥ ⎦ q 2 성립되여야 하며 1=μ 일 때 t s , 1) ⋅ c 가 성립되여야 한다. 따라서 m 1 <+ q ⎢ ⎢ 2 ⎣ 일 때 확률 1로 암호문을 정확히 복호화한다.(증명끝) ⎥ ≤⎥ ⎦ ⎥ ≤⎥ ⎦ ⎥ +⎥ ⎦ 와 q 2 q 2 ⎢ ⎢ ⎣ ⎢ ⎢ ⎣ m + 1 q > m 2 + 2 이 성립되여야 한다. 즉 제안된 암호체계는 정리 ２ 론문에서 제기한 암호체계는 그것이 기초하고있는 LWE문제의 난도가 담보 되는 조건에서 CPA－안전하다. 불가능하다는것을 밝히면 충분하다. 증명 CPA공격자가 평문 μ에 대하여 최대로 알아낸것들이 다 평등우연적인것과 구별 공격자가 암호체계에 대하여 볼수 있는것은 그러므로 cΑ 뿐이다.  가 평등우연적인것과 구별불가능하다는것을 밝히면 된다. 여기서 , cΑ ) ( ( ) , = Α ⎤ ⎥ ⎥ ⎦ Α tb 는 공개열쇠이며 ⎡ ⎢ ⎢ ⎣ 우선 론문에서 제기한 암호체계가 기초하고있는 LWE문제의 난도가 담보된다는 가정 으로부터 공개열쇠의 매 렬벡토르들이 평등우연적인것인가 아니면 LWE분포에서 취한 표 은 암호문이다. (Enc μΑ ) c ← , 본들인가를 구별할수 없다는 사실이 나오므로 공개열쇠 Α = 는 평등우연적인것과 구 Α tb ⎡ ⎢ ⎢ ⎣ ⎤ ⎥ ⎥ ⎦ 별불가능하다. － 18 － 종합대학학보(자연과학)   주체106(2017)년  제63권  제9호 다음으로 ( cΑ 도 평등우연적인것과 구별불가능하다. ) , rΑc +⋅ = , μ0 ⋅ + 0 ,( te ) ′ 인데 r , e′ 는 평등우연이고 Α 는 평등우연적인것과 ⎛ ⎜⎜ ⎝ t q 2 ⎢ ⎢ ⎣ ⎥ ⎥ ⎦ ⎞ ⎟⎟ ⎠ 구별불가능하다고 볼수 있으므로 암호문 c 는 Α 의 매 렬벡토르들과 독립적으로 평등우 연적인것과 구별불가능하며 따라서 cΑ 도 평등우연적인것과 구별불가능하다. ) ( , 따라서 론문에서 제기한 암호체계는 그것이 기초하고있는 LWE문제의 난도가 보장되 는 조건에서 CPA－안전하다.(증명끝) 다음으로 암호체계의 기초로 되는 LWE문제의 난도에 대하여 보기로 하자. 정리 ３[2] n 과 nm ⋅= 1 이 옹근수이고 q ≥ )1(Οn 이 충분히 큰 모듈수라고 하면 , qmn , 를 파라메터로 가지고 에서의 독립평등분포를 오유분포로 가지는 LWE문제는 최소한 nΘ ( log/ n ) 차원격자우에서 =γ 내의 근사도를 가지는 최악의 ~ qnΟ ( ⋅ ) 경우의 근사격자문제들만큼 어렵다. 정리 ４ 론문에서 제기한 암호체계가 기초하고있는 LWE문제는 최소한 nΘ log/( n ) 차 원격자우에서 ~ nfΟ ( 다. 여기서 =γ ( ~ qnΟ ( ⋅ ) 내의 근사도를 가지는 최악의 경우의 근사격자문제들만큼 어렵 )) 은 Ο (log nfn ( ⋅ )) 의 간략표시이다. c는 고정된 상수이다. c 증명 론문에서 제기한 암호체계가 기초하고있는 LWE문제는 오유분포가 0>c ) 의 독립평등분포이며 표본수는 이고 모듈수는 이다.( nm ≈ (1 c + > m 2 + 2 q 에서 m}1,0{ ) ⎛ ⎜ ⎜ ⎝ ⎛ ⎜⎜ Ω+ ⎝ 1 log n ⎞ ⎞ ⎟ ⎟⎟ ⎟ ⎠ ⎠ m}1,0{ 이때 n 1( + c ) n ⋅= 1 이 성립된다. ⎛ ⎜ ⎜ ⎝ ⎛ ⎜⎜ Ω+ ⎝ 1 log n ⎞ ⎟⎟ ⎠ ⎞ ⎟ ⎟ ⎠ 왜냐하면 ′>∀>′∃ n ,0 n n 일 때 c ≥ 이므로 c 이기때문이다. 1 log n ⎛ ⎜⎜ Ω ⎝ 1 log n ⎞ =⎟⎟ ⎠ 또한 q ≥ )1(Οn 이 성립된다. 왜냐하면 q > 2 m 2 >+ 2 n n => )1( Οn 이기때문이다. 따라서 론문에서 제기한 암호체계가 기초하고있는 LWE문제는 정리 3의 전제조건을 내의 근사도를 가지는 최악 차원격자우에서 만족시키므로 최소한 ~ qnΟ log/( nΘ =γ n ) ) ( ⋅ 의 경우의 근사격자문제들만큼 어렵다.(증명끝) 참 고 문 헌 [1] O. Regev; J. ACM, 56, 6, 1, 2005. [2] R. Lindner et al.; Better Key Sizes for LWE-based Encryption, CT-RSA, 319～339, 2011. [3] D. Micciancio et al.; Hardness of SIS and LWE with Small Parameters, CRYPTO, 21～39, 2013. [4] S. Arora et al.; Lecture Notes in Computer Science, Springer, 403～415, 2011. 주체106(2017)년 5월 5일 원고접수 오유있는 학습문제에 기초한 한가지 격자암호체계에 대한 연구   A Lattice Cryptosystem based on the LWE Problem － 19 － Ri Ryong Chol, Kim Chol Un We propose a construction of a lattice cryptosystem based on LWE problem defined using uniform error distribution, which is more efficient and secure algorithmically, and prove its security.  Key word: lattice cryptosystem