김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체106(2017)년 제63권 제11호 Vol. 63 No. 11  JUCHE106(2017). 한 형태의 최량조종문제에 의한 화상－곡면생성 김신범, 허명송 우리는 중심투영으로 얻어진 흑백색화상으로부터 3차원곡면을 얻는 문제(화상－곡면생 성문제)를 해결하기 위한 한가지 방법으로서 최량조종모형을 리용하는 수법을 제기하였다. 화상－곡면생성문제는 하나의 흑백색화상으로부터 3차원곡면을 재생하는 문제로서 콤퓨터시각처리에서 중심연구대상의 하나로 되고있으며 천문학, 의학 등 많은 리용분야를 가지고있다. 화상－곡면생성문제에 대한 선행연구들에서는 정사영 또는 중심투영법으로 얻은 화 상들로부터 3차원곡면을 생성하기 위한 문제들을 취급하였다. 선행연구[2]에서는 해당한 수학적모형들에 여러가지 풀이법들을 적용하였다. 특히 최 량조종문제를 리용한 화상－곡면생성에 대한 연구[1]에서는 일반화된 화상－곡면생성모형에 르쟝드르변환을 실시하여 얻은 하밀톤－야코비방정식을 반복법으로 풀었다. 한편 전체 그물점우에서가 아니라 제한된 그물점우에서만 반복법을 적용함으로써 계 산속도를 높일수 있게 하는 고속전진법이 제기되고 이 방법이 비등방성아이코날방정식들 에 대하여서도 효과적이라는것이 증명되였다.[3, 4] 론문에서는 화상－곡면생성문제가 한가지 형태의 최량조종문제와 동등하다는것을 밝 히고 고속반복법을 적용하여 계산속도를 높이기 위한 연구를 진행하였다. １．화상－곡면생성문제의 수학적모형 일반적으로 화상－곡면생성문제는 취급되는 곡면의 종류와 그 곡면으로부터 화상을 얻 는 방식, 점광원의 위치에 따라 서로 다른 수학적모형으로 서술된다. 화상－곡면생성문제에 서 곡면은 람베르트면과 비람베르트면으로 분류되는데 람베르트면은 면의 매 점의 빛세기 가 이 점에서의 단위법선벡토르와 단위빛벡토르의 스칼라적에 비례하는 곡면이다.[1] 또한 화상을 얻는 방식에는 두가지 방식 즉 정사영방식과 중심사영방식이 있는데 정 사영방식은 곡면을 수직으로 사영하는 방식이고 중심사영방식은 시각중심(렌즈의 초점)으 로부터 곡면을 투시적으로 사영하는 방식이다. 우리는 람베르트면에 대하여 중심사영방식으로 화상을 얻는 경우의 화상－곡면생성 모형에 대하여 론의한다． 광원은 시각중심에 위치한다고 가정한다.  앞으로 이 가정을 만족시키는 화상－곡면생성문제를 시각중심투영화상－곡면생성문 제라고 부른다. 일반적으로 화상의 빛세기 xI ( ′ , y ′ ) 는 다음의 방정식으로 표시된다. － 12 － 종합대학학보(자연과학)   주체106(2017)년  제63권  제11호 xI ( ′ , y =′ ) ka zyx ,( , ) Φ vsn ,( , ) (1) 여기서 yxa ,( , z ) x ,( zy , 는 곡면우의 점, x ,( 는 곡면의 매 점에서 입사빛세기이며 ) 에서의 법선벡토르, s 는 광원의 빛방향, v 는 시각방향이다. vsnΦ zy , 는 ,( x y ) ) ( ′ ) ′ , 에 대응되는 화상평면우의 점, 는 곡면의 반사정도, n 은 , x ,( ) zy , 간단히 X ′= , x ( y ′ ) 라고 하자. 곡면이 람베르트면일 때 방정식 (1)은 ( XI ) ρ= cos i (2) 로 된다. 여기서 ρ는 곡면의 반사능이고 i 는 주어진 점에서 빛의 입사각이다. cos 는 주어진 점에서 법선벡토르 n과 광원방향단위벡토르 L의 스칼라적으로 다음과 i 같이 표시된다. cos i = n |/( n |) ⋅ ( LL |/ |) (3) 식 (2), (3)으로부터 다음의 식이 성립된다. XI ( ) ( = ρ n |/ n |) ⋅ ( LL |/ |) (4) 지금 론의하는 곡면을 S 라고 하자.  곡면이 람베르트면이고 투영방식이 중심투영일 때 곡면 S 는 S = ⎧ ⎪ ( Xu ⎨ ⎪ ⎩ ) ⎡ ⎢ ⎢ ⎢ ⎣ x y ′ ′ − f ⎤ ⎥ ⎥ ⎥ ⎦ ⎫ ⎪ ⎬ ⎪ ⎭ X Ω∈ (5) 로 표시된다.[1] 여기서 (Xu 는 X 점에서 화상의 깊이이고 f 는 렌즈의 초점거리이다. ) 이때 방정식 (4)는 XI ( /) ρ ⋅ [( f 2 2 ∇+ v ) X ( ∇+ v ) 2 + Q 2/12 ] 2 − Q = 0 (6) 으로 된다. 여기서 uln=v 이고 (XI 는 X 점에서의 빛세기이며 ) fQ = 2 / | X 2 | + f 2 이다. 방정식 (6)은 중심투영화상－곡면생성문제의 수학적모형으로서 이로부터 (Xu 를 구 ) 하면 표시식 (5)에 의하여 곡면을 생성할수 있다. 화상이 주어졌을 때 모형 (6)에서 곡면의 반사능 ρ를 결정하는 문제가 제기된다. 하나의 화상으로부터 곡면의 반사능을 결정하기는 일반적으로 어렵다.  그러므로 우리는 일정한 가정밑에서 곡면의 반사능 ρ를 결정하는 한가지 론의를 진 행한다. 보조정리 곡면이 람베르트면이며 법선벡토르의 방향들이 3차원공간에 균일하게 분포 되여있다고 하면 곡면의 반사능 ρ는 μρ 2= ( μ는 화상의 평균빛세기)로 결정된다. 증명 곡면의 법선벡토르 n 은 x 축, z 축과 이루는 각 βα, 에 의하여 =n (sin sin , αβαβ sin sin , cos ) β (7) 로 표시된다. 여기서 β∈ ,0[ π ]2/ 이고 α∈ ]2,0[ π 이다. 가정으로부터 법선벡토르들은 곡면우에서 x 축방향으로 균일하게 분포된다. 그러므로 z 축방향에 따르는 법선벡토르의 분포는 βα, 에 관하여 f ( βα = ) , cos )2/( πβ 로 된다. 한 형태의 최량조종문제에 의한 화상－곡면생성 － 13 － 시각중심투영화상－곡면생성문제에서 법선벡토르를 식 (7)과 같이 표시할 때 빛벡토르는 로 된다. I ( ) ρβα 로 된다. 따라서 빛세기 ( βαI ) , cos βρ LL |/ n |/( 는 )1,0,0(=L = = |) |) n ( , ⋅ 람베르트면에 대하여 화상의 평균빛세기 μ는 다음과 같이 주어진다. μ = (( IR , βα )) = ( , αββαβα ) dd ( ) f , 2/ ππ 2 ∫ ∫ I 0 0 따라서 ( βαI , ) 와 ( βαf ) , 에 관한 표시식으로부터 μ dd αβ = 가 나 2/ ππ 2 ∫ = ∫ 0 0 ρ β 2 cos 2 π ρ 2 온다.(증명끝) ２．시각중심투영화상－곡면생성문제의 최량조종문제로의 귀착 이제 시각중심투영화상－곡면생성모형과 한가지 형태의 최량조종문제에 대응되는 하 밀톤－야코비방정식이 동등하다는것을 론의하자. 다음과 같은 조종계를 생각하자. dt t /)( dY = t t ), ( ( )) αα Ω∈= X (8) ⋅               (9) ), > 0 t tYg (( Y )0( 2 여기서 )(tY 는 t 시각 계의 상태이고 Ω 는 2R 의 유계열린구역이다. 또한 A 이때의 최량조종문제는 초기상태 g : R →× A R 이며 ,0[:)(α ⋅ ) A→∞+ 는 단편련속조종, 2 { a ∈= Ω∈X | || a }1|| = R 에 대응되는 계 (8)의 궤도들가운데서 Ω 의 A→∞+ ) } |)({: αα ⋅ =Λ 이다. ,0[: , 경계에 도달되는 시간이 최소인 조종과 궤도를 구하는 문제이다. 이때의 조종을 초기상태 X 에 관한 최량조종, 대응되는 궤도를 최량궤도라고 부른다. )(⋅α 에 대응되는 계 (8)의 궤도가 Ω 의 경계에 ⋅αXT , ( 을 초기상태 와 조종 Ω∈X )) ( 도달되는 시간이라고 할 때 최량조종문제의 값함수 ( α ⋅ ( XV ( XT = ) , R→Ω:V  )), X Ω∈ inf )( Λ∈⋅ α 는 다음과 같이 정의된다. 값함수 R→Ω:V 가 만족시켜야 할 하밀톤－야코비방정식은 다음과 같다. , aaXgXV ( (10) 1}) = −∇ ) ( ⋅ {sup Aa ∈ 아래의 정리는 모형 (6)과 주어진 최량조종문제의 하밀톤－야코비방정식 (10)의 호상 관계를 보여준다. 정리 aXg , ( {) = XQXI /[) ( ( ) − XQXI )( ( ( ) + f )] ⋅ (( aX ) + )}1 일 때 방정식 (6)은 2 2 2 2 2/1 2 2 하밀톤－야코비방정식 (10)과 동등하다. 증명 ′ ( XI ) = XI ( ρ/) 웃식을 정돈하면 ( f | ∇+ v 이로부터 (1[ + X ′ XI ({ 2 1() + X ∇⋅ v |/ ∇ v |) /[ Q 로 놓으면 방정식 (6)은 다음과 같이 쓸수 있다. 2 2 2 2/12 ] − Q = 0 ∇+ v 2 ) ) ⋅ ′ XI ( 2 f [( 2 )| 2 v ) X ( ∇+ 2 + 2 |) |] v =∇⋅ | Q [ ) X ( v ∇+ 2 2 Q = Q + 2 )( ′− QXI ( 2/1 + f 2 )]} v ∇⋅ 2 |/ v ∇ 2 2 ′− ( QXI )( 2 (1[) ′ ( XIQ / 2 + f ) 을 얻는다.  2 2 /)] ′ ( XI ) 1| | v =∇⋅ 2 이 나온다. 2 이제 ∇=a |/ v ∇ , v ∇ ( Xg )( 임을 고려하면 방정식 (6)과 (10)은 동등하다.(증명끝) | v ′= ({ XI ′− ( QXI ∇⋅ /[] Q ∇ ∇ |/ |/ X + |) |) v v v 2 + f 2/1 2 )]} 으로 놓고 이 성립되며 이로부터 － 14 － 종합대학학보(자연과학)   주체106(2017)년  제63권  제11호 ３．고속반복법에 의한 화상－곡면생성 정리로부터 중심투영화상－곡면생성모형 (6)을 푸는 문제가  2 (1() QXI aXg , ′= ({) 2 /[)) ′− ( aX ⋅ XI Q )( + + ( f 2 2 2/1 2 )]} 으로 놓을 때의 하밀톤－야코비방정식 (10)을 푸는 문제로 귀착된다는것을 알수 있다. 이제 하밀톤－야코비방정식 (10)에 반라그랑쥬근사에 기초한 고속반복법을 적용하자. 정리의 동등성으로부터 구역 Ω 를 리산화그물의 크기가 xΔ 로 되게 리산화하자. ∇ − 임을 고려하면 그물점 로 약속한다. iX 에서 방정식 (9)는 V=v ([ v /)] X X X ≈ + v v ) ( ( i ( i aaXhg , )) i , )) aaXhg i v X − ( ( i i =− 01}/)] h h 으로 표시된다. {[ − v ( X + i sup Aa ∈ h Δ= aXgx ( / , ) 로 놓고 웃식의 량변에 h 를 곱하면 i − v ( X i {sup Aa ∈ Δ+ xa ) + v ( X ) Δ− aXgx ( / , )} = 0 i 과 같게 되며 따라서 다음과 같은 결론을 얻을수 있다. X aXgx ( ( ({ v Δ+ Δ+ xa X = v ) ) / , i inf Aa ∈ i )} (11) 이때 식 (11)을 리용한 매 그물점 iX 에서의 먼저 조종모임 ) 을 32개 방향으로 리산화하고 매 조종에 대하여 의 계산법은 다음과 같다. ( )1,0(BA = iXv ( v Xi Δ+ xa ) i i iXv ( ) i 는 v ( X Δ+ xa ) Δ+ aXgx ( / , ) 의 값이 최소로 되는 방향(최량조종 i 의 값을 계산한다. 식 (11)로부터 방향)의 값으로 된다. 고속반복법을 적용하는데서 값이 미리 주어진 점들의 모임을 초기점모임이라고 하자.  이제 그물점전부의 모임을 으로 분류하자. S S , , S 1 2 3 고속반복알고리듬은 크게 두 단계 즉 초기화단계와 기본순환단계로 갈라볼수 있는데 구체적으로 보면 아래와 같다. 초기화단계는 다음과 같다. 걸음 １ 모든 그물점들을 모임 3S 의 점으로 놓고 초기값을 +∞ 로 설정한다. 걸음 ２ 초기점모임에 속하는 그물점들을 모임 3S 의 점으로부터 모임 1S 의 점으로 바꾸어놓고 값을 주어진 초기값으로 설정한다. 걸음 ３ 모임 3S 의 점들가운데서 이웃점이 1S 에 속하는것들을 3S 으로부터 2S 의 점으로 바꾸어놓는다. 기본순환단계는 다음과 같다. 걸음 １ 2S 에 속하는 매 점의 값을 식 (11)을 리용하여 갱신한다. 걸음 ２ 갱신된 값과 갱신되기 전 값을 비교한다. 만일 두 값차의 절대값이 ε보다 작으면 이 점을 1S 의 점으로 바꾸어놓고 3S 에 속 하는 이웃점들을 2S 의 점으로 바꾸어놓는다. 걸음 ３ 2S 가 비지 않았으면 걸음 1로 이행한다. 시각중심투영화상－곡면생성모형에 고속반복법을 적용하여 얻은 실험결과들은 다음 의 그림들과 같다. 한 형태의 최량조종문제에 의한 화상－곡면생성 － 15 － ㄱ)                  ㄴ) 그림 1. 주전자화상(ㄱ))과 그것에 대한 3차원곡면의 재생(ㄴ)) ㄱ)                  ㄴ) 그림 2. 조각상(ㄱ))과 그것에 대한 3차원곡면의 재생(ㄴ)) 론문에서는 중심투영화상－곡면생성모형이 한가지 형태의 최량조종문제에 대응되는 하밀톤－야코비방정식과 동등하다는것을 밝히고 이에 기초하여 고속반복법을 적용하였다.  참 고 문 헌 [1] E. Prados et al.; Math. Model. Numer. Anal., 40, 2, 393, 2006. [2] E. Cristiani et al.; Kybernetika, 46, 2, 207, 2010. [3] F. Dang et al.; International Conference on Computational Science, 59, 123, 2014. [4] W. K. Jeong et al.; SIAM J. Sci. Comput., 30, 5, 2512, 2008. 주체106(2017)년 7월 5일 원고접수 On the Shape from Shading Problem by One Type  of Optimal Control Problem Kim Sin Bom, Ho Myong Song Shape from shading problem is to compute the three-dimensional shape of a surface from a single black and white image of that surface. We have solved the perspective shape from shading problem where the light lies at the optical center by using an optimal control problem. Key word: perspective shape from shading problem