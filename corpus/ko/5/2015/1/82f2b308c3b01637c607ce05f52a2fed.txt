김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체104(2015)년 제61권 제1호 Vol. 61 No. 1  JUCHE104(2015). PSTN에서 매체중계를 실현하기 위한 한가지 신호조종흐름에 대한 연구 김영남, 문일남, 류광식 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《정보산업을 빨리 발전시키고 인민경제의 모든 부문을 정보화하여야 합니다.》 (《선집》 증보판 제20권 380페지) VoIP망에서 SIP프록시와 B2BUA를 리용하여 매체중계를 실현하기 위한 신호조종흐 름에 대한 연구는 진행[1]되였지만 PSTN에서 쏘프트스위치와 련동하여 매체중계를 실현 하기 위한 방법에 대하여서는 론의하지 못하였다. 론문에서는 PSTN에서 쏘프트스위치와 련동하여 매체중계를 실현하기 위한 신호조종 흐름을 새롭게 제안하고 그에 대한 성능평가를 하였다. １．PSTN에서의 매체중계방식 PSTN에서 가입자들사이의 통신은 쏘프트스위치와 접근관문들사이의 협동에 의하여 이루어진다. 쏘프트스위치는 H.248과 같은 신호조종규약에 의하여 접근관문들과 통신하면 서 두 접근관문사이의 매체흐름이 확립되도록 조종하며 이에 의해 확립되는 매체흐름은 오직 접근관문들사이에만 이루어진다. NAT횡단이나 통화분석과 같은 기능을 실 현하기 위해서 쏘프트스위치는 접근관문들사 이에만 이루어지는 매체흐름경로를 변경시켜 매체중계기를 통하여 접근관문들사이의 매체 흐름이 이루어지도록 신호조종을 진행한다.(그 림 1) 매체중계기는 쏘프트스위치와 통신하면서 가입자들사이의 매체흐름이 자기를 걸쳐서 이 루어지도록 하며 동시에 응용봉사기와 련동하 여 응용봉사기에 통화내용을 전송하는 역할을 수행한다. 그림 1. PSTN에서의 매체중계방식 ２．매체중계를 실현하기 위한 신호조종흐름 우리는 앞에서 언급한 매체중계방식에서 쏘프트스위치와 매체중계기, 매체중계기와 응용봉사기사이의 구체적인 신호조종흐름에 대해서 연구하였다. － 26 － PSTN에서 매체중계를 실현하기 위한 한가지 신호조종흐름에 대한 연구 우리는 쏘프트스위치와 매체중계기사이의 신호조종규약으로서 SIP[2]를 리용하고 매 체중계기와 응용봉사기사이의 신호조종규약으로서는 SIP-I를 리용하였다. 전체적인 신호조종흐름은 다음과 같다. 쏘프트스위치는 매체중계처리를 해야 하는 대상가입자들에 대해서 호출이 발생할 때 발신자와 착신자에 대해서 각각 INVITE를 매체중계기에 보낸다. 또한 착신자가 호출에 대해 응답하면 앞서 보낸 INVITE에 대한 re-INVITE를 보낸다. 호출이 완료될 때에는 BYE를 보낸다. 발신자와 착신자별로 신호조종흐름을 갈라서 본다면 신호조종흐름은 크게 6개의 단계로 구분할수 있다. １）첫 INVITE처리단계 이 처리단계는 매체중계기가 쏘프트스위치로부터 통신정보, 대상관련정보를 받고 응 용봉사기와 중계매체자원들, 응용매체자원들을 교환하는 단계로서 그 과정은 다음과 같다. ① 매체중계기는 쏘프트스위치로부터 첫 INVITE통보를 접수한다. ② 매체중계기는 이 INVITE통보로부터 통신정보, 대상관련정보를 추출한다. 즉 From, To, Call-ID, SQN, CIN, Target 머리부마당으로부터 필요한 정보를 얻는다. ③ 매체중계기는 이 정보를 인수로 하여 자료기지에 질의하여 응용관련정보를 얻는다. ④ 매체중계기는 통신정보, 대상관련정보, 응용관련정보들을 새로운 중계트랜잭션으 로써 저장한다. ⑤ 매체중계기는 우의 INVITE통보의 본체로부터 통신매체자원을 추출한다. ⑥ 매체중계기는 통신매체자원과 련결된 중계매체자원을 할당하고 그것을 200 OK 응답과 함께 쏘프트스위치에 보낸다. ⑦ 쏘프트스위치는 매체중계기가 보낸 중계매체자원을 접근관문에 알려주어 접근관 문이 매체흐름을 매체중계기에로 보내도록 한다. ⑧ 매체중계기는 또한 중계매체자원과 ③에서 얻어낸 응용관련정보를 SIP-I 규약상의 INVITE 통보에 넣어 응용봉사기에로 보낸다. ２）re-INVITE처리단계 이 처리단계는 호출이 확립되면서 변경된 통신매체자원과 관련한 정보를 받아 처리 하는 단계로서 첫 INVITE 처리단계와 기본적으로 같다. 다만 걸음 ②, ③, ④에서 통보머 리부분석과 자료기지질의를 진행하지 않고 그 정보를 중계트랜잭션으로부터 얻는다는것 이 차이날뿐이다. ３）첫 200 OK처리단계 이 처리단계는 매체중계기가 응용봉사기에 보낸 INVITE에 대한 200 OK 응답통보를 처리하는 단계로서 그 과정은 다음과 같다. ① 매체중계기는 응용봉사기로부터 오는 200 OK 응답을 접수한다. ② 매체중계기는 이 응답과 련결된 중계트랜잭션을 얻는다. ③ 매체중계기는 우의 응답으로부터 응용매체자원을 추출하여 중계트랜잭션에 저장한다. ④ 매체중계기는 접근관문들로부터 오는 매체흐름을 응용봉사기에도 보낸다. ４）두번째 200 OK처리단계 이 처리단계는 re-INVITE처리단계에서 응용봉사기에 보낸 INVITE에 대한 200 OK응 답통보를 처리하는 단계로서 첫 200 OK 처리단계와 같다. － 27 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제1호 ５）매체흐름단계 이 단계는 접근관문들과 매체중계기, 응용봉사기들사이에 매체흐름이 진행되는 단계 이다. 매체중계기는 접근관문들이 보내는 매체흐름을 중계하면서 동시에 응용봉사기에로 도 보낸다. 이 단계에서는 통신이 끝날 때가지 매체흐름만 있고 신호조종정보의 교환은 진행되지 않는다. ６）BYE처리단계 이 처리단계는 매체중계기가 쏘프트스위치로부터 통신의 완료를 알리는 BYE통보를 접수하고 응용봉사기에 통신이 끝났다는것을 알려주며 쏘프트스위치에 BYE통보에 대한 200 OK 응답을 송신하는 단계로서 그 과정은 다음과 같다. ① 매체중계기는 쏘프트스위치로부터 BYE통보를 접수한다. ② 매체중계기는 우의 통보로부터 추출한 정보에 기초하여 해당한 중계트랜잭션을 검색하여 해방한다. ③ 매체중계기는 매체중계처리를 완료하고 매체자원을 해방하도록 한다. ④ 매체중계기는 응용봉사기에 BYE통보를 보내여 매체흐름접수를 완료하도록 한다. ⑤ 매체중계기는 응용봉사기로부터 BYE통보에 대한 200 OK응답을 접수하고 쏘프트 스위치에 BYE통보에 대한 200 OK응답을 송신한다. 우의 처리단계들은 일정한 의존관계를 가지고있다. 즉 쏘프트스위치는 매체중계기에 첫 INVITE를 보낸 다음에야 re-INVITE를 보내며 통 신이 완료될 때에 BYE를 보낸다. 그러므로 1), 2), 6)의 순서로 처리가 진행된다. 또한 응용봉사기들은 INVITE들을 받 고서야 200 OK응답을 매체중계기에로 보내므로 1), 3) 그리고 2), 4)의 순서로 처리가 진 행된다. ３．비교실험 및 결과분석 우리는 그림 2와 같은 시험환경을 구축하고 봉사기로서 IBM System M4(CPU: Intel Xeon X5550 2.67GHz 8개, 기억기 8GB)를 리용하였다. 그리고 론문에서 제안한 신호조종흐름의 성능을 평 가하기 위한 지표로서 CPS(Call Per Second: 초당 호출 수)와 SRD(Session Request Delay), CPU리용률[3]을 선택 하였다. 실험에서는 가상적인 쏘프트스위치와 가상적인 응 용봉사기를 리용하여 매체중계기에 부하를 주고 신호조 종흐름의 성능을 측정하는 방법을 적용하였으며 실제적 인 매체흐름을 발생시키지 않으면서 쏘프트스위치에서 CPS의 증가에 따르는 SRD와 CPU리용률의 변화를 측 정하였다. 측정결과는 그림 3과 4와 같다. 그림 2. 시험환경 － 28 － PSTN에서 매체중계를 실현하기 위한 한가지 신호조종흐름에 대한 연구 그림 3. CPS에 따르는 SRD의 변화 그림 4. CPS에 따르는 CPU리용률의 변화 최대 CPU리용률이 도달되는 첫점과 지연특성에서 상당한 도약이 있기 전의 마지막 점을 취하여 성능을 평가한다면 결과는 표와 같다. 표에서 알수 있는바와 같이 제안된 신호조종흐름에 대해서 최대CPS는 800정도로서 같은 봉사기를 리용하 여 시험한 OpenSER+MediaProxy의 최대CPS 7 000과 대 비해볼 때 약간의 높은 성능을 나타내고있다. 표. 평가결과 판정기준 CPU리용률 SRD 종합 최대CPS/s－1 1 000 800 800 참 고 문 헌 [1] H. Nurwarsito et al.; International Journal of Advanced Computer Science, 2, 3, 125, 2012. [2] J. Rosenberg et al.; IETF RFC 3261, 70～147, 2002. [3] V. Miroslav; Evaluation of SIP Infrastructure Performance, Cesnet, 5～20, 2011. 주체103(2014)년 9월 5일 원고접수 On a Signaling Flow for Media Relaying in PSTN Kim Yong Nam, Mun Il Nam and Ryu Kwang Sik We proposed a new signaling flow for media relaying in conjunction with a softswitch in PSTN, and measured the flow’s performance in terms of CPS (Call Per Second), SRD (Session Request Delay), CPU usage. Key words: VoIP, B2BUA, media relay, signaling flow － 29 －