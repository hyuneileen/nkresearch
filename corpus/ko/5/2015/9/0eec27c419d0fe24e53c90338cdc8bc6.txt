김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체104(2015)년 제61권 제9호 Vol. 61 No. 9  JUCHE104(2015). 비원형동공경계검출에서 능동륜곽모형의 한가지 효률적인 적용방법 김수경, 김영민 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《과학기술을 발전시켜야 나라의 경제를 빨리 추켜세울수 있으며 뒤떨어진 기술을 앞 선 기술로 갱신하여 생산을 끊임없이 높여나갈수 있습니다.》(《선집》 증보판 제20권 62페지) 론문에서는 홍채인식의 첫단계인 홍채화상의 토막화에서 비원형동공경계검출에 능동 륜곽모형을 효률적으로 적용하기 위한 한가지 방법을 제기하였다. １．홍채경계검출방법 홍채인식의 첫단계는 홍채의 내부 및 외부경계를 검출하는 토막화단계이다. 동공의 경계는 비교적 원형을 이루고있으며 이로부터 적분－미분연산자나 원형하프 변환과 같은 여러가지 원형검출방법들을 적용하여 경계를 검출하기 위한 연구가 진행 되였다.[2, 3] 그러나 동공의 경계는 원형을 이루지 못하고 이지러지는 경우가 적지 않다.(그림 1) 그림 1. 동공의 경계가 비원형인 실례 선행연구[4]에서는 능동륜곽모형을 리용하여 이러한 이지러진 동공의 경계를 검출하 는 한가지 방법을 제기하였다. 능동륜곽모형은 에네르기를 정의하고 이것을 최소화하는 방법으로 객체의 닫긴 륜곽 을 검출하는 방법으로서 객체륜곽검출에서 많이 리용되고있다.[6, 7] 그러나 반복법인것으 로 하여 계산량이 비교적 많은 결함을 가지고있다. 이러한 부족점을 극복하기 위하여 우리는 홍채인식의 첫단계인 토막화에서 비원형인 동공경계를 검출하는데 능동륜곽모형을 효률적으로 리용하기 위한 한가지 방법을 제기하 였다. － 11 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제9호 ２．능동륜곽모형 능동륜곽모형(Active Contour Model: ACM)[5]은 객체를 포함하는 일정한 령역에 초기 륜곽을 설정하고 주어진 대역적인 에네르기함수를 최소화함으로써 륜곽이 점차 객체의 륜곽에로 수렴하도록 한다. 륜곽은 화상평면 y ) 에서 다음과 같은 하나의 파라메터곡선으로 정의된다.[5]               (1) s = )( sx (( sy ( x ,( )) ), v 륜곽은 3개의 에네르기항 즉 내부에네르기와 외부에네르기, 속박에네르기의 합으로 정의되는 에네르기를 가지고있다. 에네르기항들은 륜곽의 최종위치에서 최소에네르기를 가지도록 정의된다. 따라서 객 E 륜곽 E = 내부 + E 외부 E + 속박 (2) 체륜곽검출문제는 에네르기최소화문제로 귀착된다. 내부에네르기는 곡선의 고유속성에 의존하는데 탄성에네르기와 만곡에네르기의 합으 로 되며 탄성에네르기는 다음의 식으로 정의한다. E 탄성 1 ∫= 2 s vα s |)( s 2 | ds , v = s sd )(v ds (3) 탄성에네르기의 정의로부터 린접한 곡선토막들사이에 길이가 차이나면 에네르기가 커진다는것을 알수 있다. 탄성에네르기는 마치도 륜곽점들사이의 끌힘과 같이 작용하면서 륜곽을 이루는 매 곡선토막들이 불균형적으로 늘어나거나 줄어드는것을 방지하는 역할을 )(sα 는 륜곽의 서로 다른 부분들에서 탄성에네르기를 조종하는데 수행한다. 여기서 무게 리용한다. 많은 실천적인 응용들에서는 이것을 상수 α로 취급한다. 만곡에네르기는 륜곽의 두제곱곡률들의 합으로 정의된다. E 만곡 1 ∫= 2 s vβ |)( s ss 2 | ds (4) 륜곽의 전체 내부에네르기는 다음과 같이 정의할수 있다. E 내부 = E 탄성 + E 만곡 = ( α | v s 2 | + β | v ss 2 )| ds (5) 1 2 ∫ s 륜곽의 외부에네르기는 화상으로부터 얻는다. 경계와 같은 관심특징우에서 보다 작은 값을 가지도록 하나의 함수 E화상 yx ,( ) 를 정의한다. E 외부 ((v화상 E ∫= s s )) ds (6) 목표는 다음의 에네르기가 최소로 되는 하나의 륜곽 )(sv 를 찾는것이다. E 륜곽 = (( α |)( s v 2 | s 2/ + β |)( s v ss 2 )| + γ )( Es 화상 v (( s ))) ds (7) ∫ s ３．동공경계검출에서 능동륜곽모형의 효률적리용 능동륜곽모형을 리용하는데서 중요한것은 초기륜곽의 설정이다. 능동륜곽모형은 초기륜곽의 설정에 민감하다. － 12 － 비원형동공경계검출에서 능동륜곽모형의 한가지 효률적인 적용방법 이제 찾으려는 최종륜곽이 동공의 경계로서 원형에 가까운 조건에서 초기륜곽을 최 종륜곽에 가깝게 원형으로 설정한다면 능동륜곽모형의 계산량을 어느 정도 줄일수 있다. 먼저 선행연구[1]에서 제기한 적분화상에 의한 원형경계검출방법을 리용하여 동공의 경계에 가까운 원을 찾는다. 이 원은 동공의 경계가 완전히 원형인 경우에는 정확한 경계 로 되며 그렇지 않은 경우에도 매우 근사한 경계로 된다. 론문에서는 찾아진 원의 중심을 그대로 유지하고 반경을 일정한 정도로 증가시켜 얻 은 새로운 원을 능동륜곽모형에서의 초기륜곽으로 설정한다.(그림 2) 초기륜곽을 설정한 다음 초기륜곽의 원둘레를 n등분하는 n개의 륜곽점들을 설정하고 찾아낸 원의 중심과 잇는 반직선들우에서 륜곽점들의 이동이 진행되도록 한다.(그림 3) 그림 2. 초기륜곽의 선택 그림 3. 초기륜곽점들의 설정과 이동허용구역의 한정 안쪽의 원은 적분화상법으로 찾아낸 경계근사이며 바깥쪽의 원이 선택된 초기륜곽이다. 이렇게 하면 매 걸음에서 륜곽점의 다음번 이동위치결정을 그 륜곽점주위의 어떤 창문 령역에서 진행하는것이 아니라 정해진 반직선상에서 진행하므로 시간을 보다 단축할수 있 게 된다. 또한 매 륜곽점들이 정해진 방향을 따라서만 움직일수 있으므로 매 반복걸음때마 다 륜곽점들이 한쪽 방향에만 지나치게 쏠리는것과 같은 현상이 없이 모든 방향으로 고르 롭게 놓이게 된다. 따라서 능동륜곽모형의 에네르기항들중에서 탄성에네르기를 리용하지 않고도 만곡에네르기와 화상에네르기만을 리용하여 능히 홍채륜곽을 정확히 검출할수 있다. 이로부터 능동륜곽모형을 리용하여 다음의 에네르기를 최소로 하는 최종륜곽을 찾아낸다. E 륜곽 = ( α |)( s v 2 | ss 2/ + β )( Es 화상 v (( s ))) ds (8) ∫ s 이것은 경계가 원형이 아니라 어느 정도 이지러진 홍채에 대하여서도 경계검출을 정 확히 그리고 빠른 속도로 진행할수 있는 효률적인 방법이라는것을 알수 있다. 능동륜곽모형을 리용한 동공경계검출알고리듬은 다음과 같다. 먼저 초기륜곽파라메터 δ , 매 반복걸음에서 이동하는 륜곽점수와 관련한 턱값 1N , 최대반복회수 2N 를 결정한다. xC ( i) 선행연구[1]에서 제기한 적분화상법을 리용하여 동공경계에 가장 가까운 원 , y r 0 0 ii) 원 의 원둘레우에서 n개의 등간격점 를 찾는다. xC ( y 들을 선택하여 (cid:34)= ,1 δ+r ) i ( n ) ) , , , , ′ Vi 0 능동륜곽모형의 초기륜곽을 설정한다. 0 iii) 매 반복걸음에서의 륜곽정점 iV 가 초기륜곽점 iV ′ 와 원의 중심 ( x , 0 y 0 ) 을 잇는 반직선우에서만 이동할수 있도록 허용구역을 한정한다. － 13 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제9호 반복회수 counter 와 이동한 륜곽점수 move 를 초기화 즉 iv) 에네르기최소화에 따라 륜곽의 이동을 진행한다. ① (cid:34)= ,1 i ( n ) , ′ Vi 에 대하여 허용구역안의 일정한 령역에서 식 (4), (6)에 따라 만곡 에네르기와 화상에네르기를 계산하고 식 (8)에 의해 계산되는 륜곽에네르기가 최소로 되 는 새로운 륜곽 에로 현재륜곽을 이동시킨다. (cid:34)= ,1 new i ( n ) , Vi counter = , 0 move = 으로 한다. 0 1=i new ② ③ ④ ⑤ v) n 1 . = + ≠ 이면 V i move move V i i < 이면 로 놓고 ③에로 이행하고 그렇지 않으면 ⑤에로 이행한다.  1+= i 로 놓고 v)에로 이행한다. counter 1 = + counter N> 이면 vi)에로 이행하고 그렇지 않으면 move N< 이거나 1 counter i 2 move = 으로 0 놓고 iv)에로 이행한다. vi) 현재의 륜곽 iVi ( (cid:34)= ,1 , n ) 를 최종륜곽으로 출력한다. ４．실험 및 분석 실험은 CASIA자료기지우에서 249명의 홍채화상자료 2 641개를 가지고 진행하였다. 화상의 크기는 320pixel×280pixel이다. 우선 주어진 화상에 대하여 중간려파를 진행하여 잡음을 제거한 다음 국부조명에 의 한 밝은 색의 작은 령역들을 모두 제거하였다. 이에 대하여 적분화상을 리용한 원형검출을 진행하여 홍채의 내부경계를 검출하고 찾아진 중심점을 유지하면서 반경을 δ만큼 늘여 홍채경계를 포함하는 원을 얻었다. 원둘레우에 등간격으로 n개의 점들을 찍어 초기륜곽을 설정하였다.  성능평가는 근본진실(ground-truth)을 가지고 진행하였다.  성능평가방법은 다음과 같다. iVi ( iVi |{ 을 근본진실이라고 하자. (cid:34)= ,1 (cid:34)= ,1 N n } ) , , =Γ 들을  우의  방법으로  얻어진  최종륜곽의  정점들이라고  하고 (cid:65) i = |min{ VV − i j ,| V j , Γ∈ j = ,1 (cid:34) , N } 으로 놓고 일정한 턱값 θ 를 정의하여 n 1 θ<∑ (cid:65) i n 1 i = 로 될 때 성공한것으로 평가하였다. 화시키면서 진행한 실험결과를 분석하였다. 론문에서는 δ 를 4/r 로, 턱값 θ 를 0.6으로 설정하고 륜곽점수 n을 16, 32, 48로 변 론문에서 제기한 방법의 성능을 적분미분연산자와 원형하프변환과 비교한 결과는 표 와 같다. 표. 륜곽점수 n에 따르는 성능분석(성공률) 론문에서 제기한 방법/% 적분미분연산자/% 원형하프변환/% 16 99.2 91.7 90.9 － 14 － 륜곽점수 n 32 99.8 92.0 91.2 48 100 93.2 92.4 비원형동공경계검출에서 능동륜곽모형의 한가지 효률적인 적용방법 실험은 n을 크게 설정해줄수록 성능이 보다 높아지며 론문에서 제기한 방법이 선행 방법들에 비하여 상당히 우월한 성능을 가진다는것을 보여준다. [1] 김영민 등; 수학, 3, 3, 주체103(2014). 참 고 문 헌 2004. [3] R. P. Wildes; Proc. IEEE, 85, 9, 1348, 1997. [2] J. Daugman; IEEE Transactions on Circuits and Systems for Video Technology, 14, 1, 21, [4] J. Daugman; IEEE Transactions on Systems, Man, and Cybernetics, 37, 5, 1167, 2007. [5] M. Kass et al.; International Journal of Computer Vision, 1, 4, 321, 1987. [6] G. Chiou et al.; IEEE Transactions on Image Processing, 6, 8, 1192, 1997. [7] Xin Liu et al.; Pattern Recognition(ICPR)-20th International Conference, 4332～4335, 2010. 주체104(2015)년 5월 5일 원고접수 An Efficient Method for Applying Active Contour Models in Noncircular Pupil Boundary Detection Kim Su Gyong, Kim Yong Min We proposed an efficient method for applying active contour models(ACM) to noncircular pupil boundary detection in segmentation of iris image, which is first stage in iris recognition.  First, we found the circle close to pupil boundary using circular boundary detection method by integral image and set the new circle to initial contour of ACM by holding the center and increasing the radius of this one. Second, we saved the computation time without using elastic energy among energy in terms of ACM. Key words: ACM, iris recognition － 15 －