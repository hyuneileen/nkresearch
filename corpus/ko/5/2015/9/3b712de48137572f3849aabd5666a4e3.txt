김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체104(2015)년 제61권 제9호 Vol. 61 No. 9  JUCHE104(2015). 순간주파수측정값들에 의한 피동거리추정의 한가지 방법 리강진, 엄철남 피동음향수감부로 이동하는 음원의 음향신호를 수감하여 목표의 이동파라메터를 추 정하는것은 음향탐지기에서 중요한 문제의 하나이다. 선행연구[1]에서는 1개의 수감부로 측정된 순간주파수값들을 리용하여 음원의 이동파 라메터추정문제를 2차원비선형최량화문제로 귀착시켰지만 이 방법은 음원이 수감부우로 지나갈 때에만 적용할수 있다. 여러개의 수감부로 측정된 도달시간차값[2] 또는 에네르기 값[4]들을 리용하여 음원의 3차원위치를 추정하는 방법들도 연구되였지만 이 방법들은 수 감부의 개수가 많을것을 요구하며 신호대잡음비가 낮은 경우에 불충분한 추정을 낳는다. 우리는 1개의 수감부를 리용하여 음원이 수감부방향으로 비행할 때 측정된 순간주파 수값들에 기초하여 음원의 이동파라메터를 추정하는 한가지 방법을 제안하고 모의실험을 진행하였다. １．순간주파수와 음원의 이동파라메터사이 관계 도플러효과는 음원과 수감부사이의 호상운동에 의하여 발생하는 주파수변화효과로서 이 주파수변화는 수감부에서 순간주파수로 측정된다. 이러한 운동하는 음원에 대하여 일정한 관측시간구간안에서 다음의 가정을 세울수 있다. ① 음원은 일정한 높이에서 등속으로 직선비행하며 이동속도는 음속보다 작다. ② 음원주파수는 일정하다. 우의 가정에 기초하여 부동수감부에 의하여 얻어지는 순간주파수값은 다음과 같다. C cos 여기서 V는 음원의 이동속도, C는 음속, ∓ 부호는 음원이 수감부방향으로 날아올 때에는 부의 부호, 멀어질 때에는 정의 부호를 나타낸다. 그리고 γ는 음원의 이동방향과 음파의 전달경로사이 각이며 Dθ 는 수감부에 대한 음원의 비탈각이다. jt 시각에 대하여 식 (1)은 다음과 같이 전개될수 있다. ) (1) (2) tZBA ( ⋅+= θ cos D ∓ VC tf ( γ = s ) f f t 0 , , I j j c CfA 0 = ⋅ 2 2 /( C − V 2 ) , B −= CVCf ⋅ 0 ( ⋅ 2 2 − V ) (3) −= CL , CLs ⋅= 2 − V (2 VC ) , tZ ( tc , j t c , s ) = t ( − t c ) j 2 s + t ( − t c j 2 ) (4) 여기서 tc는 최소접근점(수감부에서 음원의 비행경로에 내린 수직선의 밑점)에서 수감부까 지(거리 L) 소리가 전파되는데 걸리는 시간이다. － 37 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제9호 선행연구[1]에서는 시각 tj들을 미리 알고있다는 가정하에서 tc와 s에 관한 2차원비선 형최량화문제의 풀이를 구하는 방법으로 이동파라메터를 추정하였다. 그러나 이 방법은 현실조건에서 tj들을 결정하기 힘들며 또 목표가 수감부우로 지나갈 때에만 적용할수 있 는것으로 하여 실용성이 없다. 이 결함을 극복하기 위해 우리는 측정의 마감시각을 T로 놓고 TΔ 시간간격으로 순간주파수를 측정하였다. 이때 식 (2)는 다음과 같이 변경된다. Tf ( ) ⋅+= TZBA ( j , j s ) (5) T j T −= ( j )1 Δ− T , Z = TZ ( , j j s ) = T j 2 s 2 + T j (6) 여기서 A, B는 식 (3)에서와 같고 j=1, …, N이다. 측정시간간격을 등간격( TΔ 는 사용자가 설정한다.)으로 놓음으로써 이동파라메터추정 문제를 변수 T와 s에 관한 2차원최량화문제로 귀착시킬수 있다. ２．이동파라메터 추정 비행체의 이동파라메터 V, L, f0, T들은 매 시각 Tj에서 순간주파수의 측정값 jfˆ 들과 식 (2)에 의해 계산된 예측값 jf 들의 2제곱오차를 최소화하여 얻을수 있다. 즉 N ∑ ˆ( f j − f 2 ) j = N ∑ ˆ( f j ⋅−− ZBA 2 ) j (7) 1 j = 한편 Tj와 s의 값들이 고정되여있을 때 식 (4)를 A와 B에 관하여 최소화하면 A와 B는 1 = j ˆ B = ˆ( f j − f ) Z ⋅ j j ( Z j − 2 ,) z ˆ zBfA ⋅− = (8) N ∑ j 1 = 로 추정된다. 여기서 f 와 z 는 각각 jfˆ , jZ 들의 평균이다. 식 (8)을 (7)에 대입하고 정돈하면 식 (7)의 최소화문제는 다음식의 최대화문제와 동등 해진다. 이제 문제로 된다. ,[=x T Ts ] ⎛ ⎜ ⎜ ⎝ N ∑ j 1 = 2 ⎞ ⎟ ⎟ ⎠ N ∑ j 1 = ˆ( f j − f j ) ⋅ Z j ( Z j 2 − z ) (9) 로 놓으면 식 (9)의 최대화문제는 다음과 같은 함수 )( xF 의 최소화 F )( x = ,( TF t c ) = ( g j ( x 2)) , g )( x = j ( Z j − z ) ˆ( f j − f ) ⋅ Z j (10) N ∑ j 1 = ⎛ ⎜ ⎜ ⎝ N ∑ j 1 = ⎞ ⎟ ⎟ ⎠ 이 최소화문제는 Marquardt－Levenberg방법을 적용하여 풀수 있다. 함수 )( xF 의 그라디엔트(2차원렬벡토르)는 다음과 같이 해석적으로 구할수 있다. ∇ F )( x = 2 g j )( x ∇⋅ g j )( x (11) 여기서 ∇ g )( x = j [ g ∂ /)( x Z ∂ ] ∇⋅ Z k i )( x , ∇ Z )( x k k [  ∂= Z k T ∂ , Z ∂ k s ∂ ]T , N ∑ k 1 = N ∑ j 1 = － 38 － N ∑ j 1 = N ∑ j 1 = 순간주파수측정값들에 의한 피동거리추정의 한가지 방법 Z  ∂ k T =∂ s 2 + T k 2 ) − 5.1 , Z  ∂ k s −=∂ 2 + T k 2 ) − 5.1 , 2 ( s [ N − 2 N ∑ k 1 = ssT ( k ] , ) f N ∑ j 1 = g ∂ j )( x Z ∂ k = Z f ⋅ Z f jk − ( Z j − z () ⋅ f − k Z f = ( f j − f ) ⋅ Z j 이며 Njk는 j=k일 때에는 1－1/N이고 j≠k 일 때에는 －1/N이다. 한편 Marquardt－Levenberg알고리듬의 l번째 순환에서 탐색방향은 다음과 같이 쓸수 있다.[1] d l −= G l 1 − ( F x∇ 2 ) , l lF x ( 2 l ) ( x F Q l ∇= β+ l (12) G l 이 비부값행렬일 때 lG 이 정값행렬이 되도록 취 2 은 그라디엔트행렬 ∇ ( lF x ) 여기서 lβ 은 부아닌 상수로서 한다. 그리고 lQ 은 정값행렬(실례로 단위행렬)이며 Hesse행렬 에 의해 근사적으로 다음과 같이 계산될수 있다. ( lF x∇ ∇ ) ) l 2 ( ) x F ∇ [ ∇≈ 우와 같은 론의에 기초하여 이동파라메터를 계산하는 알고리듬은 다음과 같다. ① 초기값을 다음과 같이 설정한다. l=0, ( lF x∇ 을 계산하고 탐색방향 dl을 계산한다.(식 (11), (12)) (T<0, s>0이면서 0에 가까운 실수) ② 그라디엔트 (13) ,[=x T ] [ T ∇ l ) ]) T ] F F x x s ( ) ( l l ③ x 를 다음과 같이 갱신한다.  =+ 1 ④ Δ x l = x l x 1−− l x xl+1 = xl + λl dl 가 허용오차한계에 들어갈 때까지 ②부터 ④까지를 반복한다. λ+ l d x l l l ⑤ 최종적으로 얻어진 파라메터 ,ˆ[ TsT ]ˆ 음에 식 (8)에 의해 A, B의 값을 계산한다. ˆ =x 를 가지고 식 (6)에 의해 Tj, Zj를 얻은 다 ˆ V −= )ˆ/ˆ( CAB ⑥ 이동파라메터를 다음의 식에 의하여 계산한다. ˆ ⋅= ˆ tc ⑦ 시각 t에서 비행체와 수감부사이 거리는 다음과 같이 평가한다. ˆ/ˆ(( 2 ˆ ˆ VCVCLVtC [ ˆ ˆ CCVsL 1(ˆ A −⋅= ˆ 2 CV / 2/12 ) )ˆ 2 V 2/12 ˆ 2 L ˆ f 0 C ( , , , V /( − ˆ ˆ ) 2 2 2 ⋅ ⋅ 2 = + tr )( 2 () 알고리듬에서 입력은 순간주파수측정값 jfˆ 과 측정시간간격 TΔ 이며 출력은 이동파라메 터{ V, L, f0, T }와 t시각의 거리 r(t)이다. CCVL (15) ))ˆ t c t ( −+ )] − + − − 2 2 2 ˆ V −= ˆ ˆ CL (14) 이다. 비행체의 이동파라메터를 표 1에서와 같이 설정할 때 평가되는 순간주파수는 ３．모의실험 및 결과분석 25.995 7, 25.982 1, 25.966 7, 25.949 1, 25.929 0, 25.906 0, 25.879 2, 25.848 1, 25.811 5, 25.768 3Hz 표 １．모의파라메터설정값 F0/Hz 20 V 1−⋅ )sm/( 80 L/m 100 T/s －5 ΔT/s 0.2 N 10 SNR/% 10 － 39 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제9호 82.80m/s, L= 102.24m이다. 이때 제안된 방법의 알고리듬을 리용하여 계산된 파라메터값은 f0 =19.785Hz, V= 한편 몇가지 지표를 가지고 제안된 방법과 선행한 방법들을 비교한 결과는 표 2와 같다. 표 ２．제안된 방법과 선행한 방법들과의 비교 지표 측정값 수감부개수 계산시간/ms 특징 제안된 방법 도플러주파수 선행한 방법[3] 도플러주파수 선행한 방법[2] 도달시간차 에네르기 선행한 방법[4] 1 1 3 4 10 12 35 47 2차원비선형문제 주파수측정시각을 예측하고  2차원비선형문제풀기 3차원비선형문제풀기 4차원비선형문제풀기 여기서 계산시간은 Pentium 4 CPU 2.8GHZ, RAM 512M, 하드 80GB의 콤퓨터로 이동 파라메터를 한번 계산하는데 걸리는 시간이다. 표들로부터 제안된 방법이 선행한 방법들에 비하여 적은 개수의 수감부를 쓰면서도 계산시간을 훨씬 단축할수 있다는것을 알수 있다. 맺 는 말 1개의 수감부를 리용하여 음원이 수감부방향으로 비행할 때 측정된 순간주파수값들 에 기초하여 음원의 이동파라메터를 추정하는 한가지 방법을 제안하였다. 모의결과로부터 제안된 방법이 선행한 방법들에 비하여 계산정확도가 높고 파라메터 추정연산속도가 빠른것으로 하여 음원의 이동파라메터추정에 효과적이라는것을 알수 있다. [1] 오용범; 최량화방법, 종합대학출판사, 195～199, 주체98(2009). 참 고 문 헌 [2] Tao Wang et al.; Motive Parameters Estimation Using Narrow-band Passive Acoustical Measurements, University of Electronic Science and Technology of China, 662～666, 2005. [3] D. Ampeliotis et al.; Signal Processing, 90, 1300, 2010. [4] 王昭; 一种基于瞬时频率估计的被动声学测距方法, 西北工业大声学工程研究所, 10～17, 2000. 주체104(2015)년 5월 5일 원고접수 A Method of Passive Distance Estimation by using Instantaneous Frequency Measurements Ri Kang Jin, Om Chol Nam We proposed a method how to estimate the moving parameters of the acoustic source by using instantaneous frequency measurements when it was flying to one sensor. Key words: moving parameter, instantaneous frequency － 40 －