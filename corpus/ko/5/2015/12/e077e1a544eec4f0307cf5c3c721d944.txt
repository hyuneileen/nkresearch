김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체104(2015)년 제61권 제12호 Vol. 61 No. 12  JUCHE104(2015). 척도변화와 부분적가리움에 안정한 대상추적의 한가지 방법 리금성, 하정원 선행연구[1, 2]에서는 Mean-Shift(MS)를 리용한 대상추적방법을 제기하였으나 그 방법 은 척도변화와 부분적가리움에 잘 적응하지 못하는 결함이 있다. 한편 선행연구[3]에서는 척도변화와 부분적가리움문제를 론의하였으나 성능이 낮으며 일정한 조건에 제한되여있다. 역을 탐색하여 이 문제를 해결하였다. 론문에서는 매 화소를 전경과 배경으로 분류하고 대부분의 전경화소를 포함하는 구 １．화소분류와 적분을 리용한 대상추적방법 화소분류는 현재 프레임의 매 화소에 점수를 부여하는 과정으로서 이러한 화소분류 결과들을 적분하면 대상추적을 원만히 진행할수 있다. 화소분류와 적분을 리용한 대상추적체계를 PCI라고 한다. PCI에서는 현재 프레임에서의 새로운 대상령역을 다음과 같이 결정한다. R f = arg max R ( RJ ) = arg max R ∑ Rx ∈ )( xs (1) 여기서 ) (RJ 는 최량화해야 할 목적함수로서 ∑ ∈Rx )( 로 표현되는 령역 R안의 화소점수들 xs 의 적분이다. 여기로부터 PCI에서 기본은 화소점수 )(xs 를 계산하는것이다. 화소점수의 분류과정을 보기로 하자. 론문에서는 화소분류를 진행하기 위한 특징 )(xc 로서 화소색 YUV를 리용하고 전경 대상과 배경대상의 색히스토그람을 리용하여 분류를 진행한다. 이때 간단화를 위해 화소색 )(xc 대신에 그에 대응한 히스토그람번호 u = ,2,1 (cid:34) , m 에 대한 )(xu 를 리용한다. 우선 전경대상이 첫 프레임에서 주어지면 그것의 히스토그람 )(up f 를 계산한다. 다음 배경히스토그람은 항상 추적과정에 이전 프레임으로부터 만들어진다. 즉 이전 프레임의 매 방향으로 α 만큼 대상령역을 확장하고 그것을 둘러싸고있는 배경령역 1−t bR 의 색히스토그람 pt b )(1 u − 를 계산한다. 여기로부터 프레임 t 의 화소 x 에서 화소점수의 분류는 다음과 같이 진행한다. t )( xs = log , Rx ∈ (2) t s )) (( xup f 1 t − b (( xu p )) － 29 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제12호 여기서 R t s = R t 1 − ∪ f t 1 − R b 이다. 식 (1)에 의하여 다음 프레임에서의 추적된 대상령역은 다음과 같이 계산한다. R t f = arg max R t ( RJ ) = arg max RR ⊂ t s t 1 − q ( R ) t )( xs ∑ Rx ∈ (3) 여기서 qt − (1 R ) 는 이전 대상위치와 현재 대상위치사이의 시간관계를 Epanechnikov핵심부 를 가지고 모형화한것이다. 즉 t 1 − q ( R ) = 1,0max( − RRd , ( )) (4) 2 t 1 − f 로서 , fRRd ( ) 은 R 와 fR 의 중심들사이의 표준화된 유클리드거리이다. 1−t 1−t 우의 방법은 목적대상의 척도변화를 고려하지 않은것이다. 따라서 우리는 목적대상의 척도변화에 적응하도록 전경령역을 다음과 같이 새롭게 결정하였다. R t f = arg J t scale ( R ) = max R t 1 − = arg max RR ⊂ ⎡ ⎢ ⎢ ⎣ hw ⋅ 는 령역 R 의 크기, 1 hw ⋅ R q ) ( t s 1( − + γγ 2 1 ) t xs )( + γ 1 t xs )( − γ 2 ∑ Rx ∈ ∑ Rx ∈ β 1 (5) t xs )( ∑ Rx ∈ β 2 ⎤ ⎥ ⎥ ⎦ 여기서 2βR 는 령역 R 가 약간 확장된것이다. 그리고 1γ 과 2γ 는 전경대상과 배경대상의 중요성을 조절하는 인자로서 첫 프레임에서 다음과 같이 결정한다. 1βR 은 령역 R 가 약간 축소된것, ∑ Rx ∈ 1β 0 s )( x − 0 s )( x ∑ Rx ∈ γ 1 = , γ 2 = 0 s )( x ∑ Rx ∈ 0 )( x − 0 s )( x ∑ s Rx ∈ ∑ Rx ∈ 2β )( x 0 ∑ s Rx ∈ (6) 대상추적기의 또 다른 중요한 측면의 하나는 부분적가리움으로 인한 출현변화에 적 응하는 능력이다. 우리는 이를 위해 전경과 배경히스토그람을 다음과 같이 결정하였다. pmup = pmu )( )( u )( + (7) fl fl fs fs f 여기서 )(up f 와 간구성요소를, )( (8) pmup u )( = b bs )(upb 는 전경과 배경히스토그람으로서 p fl 는 전경히스토그람의 장기 p fs 는 단기간구성요소를 나타낸다. 그리고 )(u fsm 는 혼합무게로서 pmu )( flm 과 )(u + bs bl bl m fl m + fs 1= 이다. 류사하게 합무게도 bl m + bs m pbl 와 )(u 1= pbs 는 배경히스토그람의 장기간과 단기간구성요소로서 그 혼 이며 이것을 결정하기 위하여 Kullback Leibler거리를 리용하는데 그 )(u 과정은 다음과 같다. 우선 전경대상에 대하여 프레임 t 에서의 t fR 로부터 색히스토그람 )(~ up t f 를 계산한다. log)(~ t up f d l = ∑ u )(~ t up f 1 t − u )( p fl , d s = ∑ u log)(~ t up f )(~ t up f 1 t − p u )( fs (9) － 30 － 척도변화와 부분적가리움에 안정한 대상추적의 한가지 방법 여기서 ld 과 sd 는 )(~ up t f 와 두 구성요소히스토그람사이의 Kullback Leibler거리들이다. 여기로부터 새로운 무게는 다음과 같다. ~ m t fl = / σ l d − e / σ l − d e − d s e + m ) η m t fl ~ m η = t fl 1( −+ t 1 − fl , m t fs = , ~ m t fs = − ds e σ/ − d l e ~ m η t fs − d s e + 1( −+ ) η m t 1 − fs (10) (11) 여기서 =η ~ m t fs ~ m + t fs ~ m t fl (12) 이며 t flm~ 과 t fsm~ 는 매개 구성요소의 상대적인 우량도이다. 그리고 σ는 단기간구성요소에 대한 장기간구성요소의 사전믿음도를 반영한다. 다음 전경구성요소를 다음과 같이 갱신한다.(이 경우 upt ˆ f 는 )( )(~ up t f 와 같다고 본다.) p t fl u )( = ρ 1 t ˆ up )( f 1( −+ ρ 1 ) p 1 t − fl u )( (13) u )( (14) ρ 2 여기서 1ρ 과 2ρ 는 갱신속도를 조종하는 파라메터이다. 1( −+ ρ 2 u )( = p ) t ˆ up )( f t fs p 1 t − fs 류사하게 령역 t bR 로부터 배경히스토그람 )(~ up t b 를 계산한다. 이때 배경구성요소는 다음과 같이 갱신된다. t bl p t bs p u )( = ρ 1 u )( = ρ 2 t )(ˆ up b t )(ˆ up b 1( −+ ρ 1 ) p 1( −+ ρ 2 ) p 1 t − bl 1 t − bs u )( (15) u )( (16) 여기로부터 대상추적알고리듬은 다음과 같다. fR 과 배경령역 0 ① 초기화상에서 전경령역 0 ② 0 fR 과 0 bR 의 색히스토그람으로 )(0 u p fl , )(0 u pbs 를 초기화하고 0=t bR 을 설정한다. )(0 u p fs )(0 u pbl , , t 1+= t 으로 한다. ③ 로 한다. ④ 후보령역 R 를 선택한다. upt ⑤ t ˆ f 와 bR 에서 )( fR 와 t pt bs 를, 식 (7)－(12)를 리용하여 )(u pt fs )(u , ⑥ (RJ 를 계산한다. ) )(ˆ upt b 를 계산한다. 그리고 식 (13)－(16)에 의해 pt fl )(u , )(up f , )(upb 를 계산한다. ⑦ 시각 t 에서 식 (1)을 최소로 하는 령역 R 를 구한다. ⑧ 마지막 화상렬에 도달할 때까지 ③－⑥을 반복한다. ２．실험결과 및 분석 실험은 좌우로 이동하면서 촬영기에 접근하는 보행자에 대하여 첫 화상에서 대상을 선택하는 방법으로 진행하였다. 보행자가 촬영기에 접근하므로 대상의 척도는 변하며 좌 우로 이동하면서 부분적가리움이 나타난다. － 31 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제12호 정확성검증을 위하여 매 화상에서 주목하는 대상의 위치를 미리 선택하고 MS방법과 제안된 방법에 의한 추적결과를 비교하였다. 표에 프레임번호에 따르는 대상의 위치를 MS방법과 비교하고 그 오차를 정확한 위치와의 유클리드거리로 보여주었다. 프레임번호 정확한 위치 표．추적된 대상위치와 오차 MS방법 제안된 방법 대상위치 (304, 270) (287, 279) (280, 293) (276, 301) (280, 319) (295, 340) (311, 361) (341, 381) 오차 2.23 3.60 5.83 10.81 14.21 17.02 12.04 14.21 대상위치 (304, 270) (288, 280) (283, 294) (273, 312) (286, 321) (299, 348) (316, 373) (357, 393) 오차 2.23 2.23 2.82 3.60 8.60 7.61 5.65 5.83 (302, 269) (290, 281) (285, 296) (270, 310) (291, 328) (306, 351) (320, 369) (352, 390) 3 7 15 27 39 57 65 86 표로부터 척도변화와 부분적가리움이 있는 경우 제안된 방법이 정확하다는것을 알수 맺 는 말 령역의 매 화소를 그 위치와 현재 및 이전 프레임에서의 출현모형을 리용하여 전경 과 배경에 속할 점수로 분류하고 그것을 적분하는 방법으로 대상추적을 진행하는 한가지 방법을 제기하였다. [1] S. Konstantopoulos et al.; SETN, 153, 2010. 참 고 문 헌 [2] J. Jeyakar et al.; Computer Vision and Image Understanding, 112, 296, 2008. [3] C. Zhang et al.; The 18th International Conference on Pattern Recognition, 2006. 주체104(2015)년 8월 5일 원고접수 A Method for Object Tracking Robust to Scale Variation and Partial Occlusion Ri Kum Song, Ha Jong Won We proposed a method for the object tracking that is robust to different object scale and partial occlusion. We implemented the object tracking by classifying and integrating each pixel in the region into the score that belongs to the foreground and the background using the position and the appearance models of the current frame and the pre-frame and demonstrated the efficiency by tracking experiments for real video. Key words: object tracking, mean-shift, visual tracking － 32 － 있다.