김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체104(2015)년 제61권 제5호 Vol. 61 No. 5  JUCHE104(2015). ATmega128을 리용한 방사선CT조종장치에 대한 연구 리기성, 리철만 우리는 원자력부문의 과학연구 및 교육실험에 필요한 방사선CT의 자료수집과 전동기 조종을 위하여 ATmega128을 리용한 방사선CT조종장치를 개발하였다. 방사선CT장치는 방사선원천으로부터 물체까지 투과되여나오는 방사선임풀스를 측정 하여 물체의 2차원, 3차원화상을 얻는 장치로서 종전에는 주로 개별적인 조작으로 동작시 키는 단능화된 CT장치로 되여있었고 그것을 콤퓨터와 결합하여 자료를 처리하도록 체계 가 구성되여있었다.[1] 최근 한소편처리기와 ARM처리기들이 널리 도입되면서 방사선측정분야에서도 그것들 을 리용하여 측정자료분석을 비롯한 여러가지 핵측정수단들을 적극 개발리용하고있다.[2] 우리는 AVR처리소자 ATmega128의 여러가지 기능[3]들을 활용하여 방사선CT조종장 치를 개발하였다. １．방사선CT조종장치의 설계 우리가 개발한 방사선CT조종장치구성도는 그림 1과 같다. 그림 1에서 보는바와 같이 방사선CT 조종장치는 ATmega128처리부, 다통로검출 기선택 및 신호성형부, A/D변환 및 조종부, 위치수감 및 조종구동부, 4통로걸음전동기 구동부, JTAG결합부, RS232통신부로 구성 되여있다. 그림 1. 방사선CT조종장치구성도 다통로검출기선택 및 신호성형부에서 는 128개의 다통로검출기의 방사선신호를 상사통로선택기를 리용하여 다통로검출기선택 을 진행하며 연산증폭기와 단안정부진기를 리용한 2통로신호성형기로 신호성형을 진행 한다. A/D변환 및 조종부에서는 A/D변환기(AD774B 또는 AD574DJK)조종과 수자신호완충 (SN74ALS244N)을 진행하여 방사선신호를 수자화한다. 위치수감 및 조종구동부에서는 수평, 승강, 회전을 위한 위치 및 조종상태를 수감 한다. 4통로걸음전동기구동부는 2상 또는 4상걸음전동기 4대로 조종구동한다. 조종에서는 4상전동기의 2상려자방식을 리용하였다. － 68 － ATmega128을 리용한 방사선CT조종장치에 대한 연구 JTAG결합부에서는 ATmega128소자의 SPI대면부를 리용하여 조종프로그람을 적재하 RS232통신부에서는 MAX3232소자를 리용하여 콤퓨터와의 직렬통신을 실현하였다. 였다. ２．ATmega128조종부설계 ATmega128은 AVR Core형한소편처리기이다. ATmega128은 128KB 프로그람기억기, 4KB 읽기/쓰기고정기억기, 4KB 내장동적기억 기로 이루어져있으며 64개의 다리를 가진 TQFP형이며 53개의 프로그람가능한 입구/출구 다리를 가지고있다. 또한 4개의 시계 및 계수단, PWM출력단, A/D변환기, 여러 형태의 통 신단들이 있다. ATmega128처리기는 7개(PA, PB, PC, PD, PE, PF, PG)의 확장포구대면부가 있으며 매 포구는 8bit 주소화가 되여있다. 에서는 자료주소(DT[7：0])만 리용하였다. 장치주소화 PA[7：0]은 자료주소와 기억기주소가 다중화(AD[7：0])된 포구이다. 장치 PA[7：0]포구로 A/D변환기와 수행부의 말단신호를 입력하여 AVR처리기의 등록기에 자료를 입력한다. PB[3：0]포구로 SPI(Serial Peripheral Interface)기능(nSS, SCK, MOSI, MISO)을 수행하 고 PB[7：4]포구로 16통로신호성형기판(BCHSELA, BCHSELB, BCHSELC, BCHSELD)을 선 택한다. PC[7：0]은 기억기주소가 A[15：8]로 된 포구이며 장치에서는 MT[7：0]걸음전동기의 조종신호를 내보내여 수행부의 걸음전동기조종을 위한 조종임풀스신호와 걸음전동기의 자리표를 선택한다. PD[7：0]포구로 A/D변환기의 끝신호(ADINT)와 외부새치기입력(EINT1, EINT2, EINT3), 예비증폭기의 봉우리검출 및 문선택신호(WS1, WS2), A/D변환기의 시작신호(AD Start), 방 사선신호의 임풀스계수입력(TCOUT2)을 진행한다. PE[7 ： 0]포구로 외부장치와의 직렬통신(RXD, TXD)과 상사신호의 비교(AIN0MCU, AIN1MCU), 16통로의 검출기신호선택(ADSELA, ADSELB, ADSELC, ADSELD)을 진행한다. 즉 직렬통신조종과 상사신호비교, 검출기신호조종을 진행할수 있다. PF[7：0]은 소편내부A/D변환기의 8통로로 상사신호(ADC[7：0])를 입력하여 검출기로 들어오는 방사선신호를 A/D변환한다. 외부로 임풀스를 출력(TOSC1, TOSC2)한다. PG[4 ： 0]은 조종신호와 조종자료들의 입출력조종(CTLA, CTLB, CTLC)을 진행하고 그리하여 외부장치의 입출력을 조종하며 외부로 임풀스를 내보낸다.  조종프로그람 조종프로그람은 Code Vision AVR C Compiler를 리용하여 그림 2, 3과 같은 알고리듬에 기초하여 작성하였다. － 69 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제5호 그림 2. 조종알고리듬 그림 3. 새치기알고리듬 ATmega128처리기에 의한 실용γ선CT장치의 콤퓨터결합부조종장치를 설계제작하고 조 종알고리듬에 기초하여 조종프로그람을 작성하였다. 맺 는 말 참 고 문 헌 [1] 지철 등; 콤퓨터결합체계, 종합대학출판사, 87～98, 주체99(2010). [2] 백영웅 등; 조종용전기기계와 응용, 공업출판사, 54～77, 주체101(2012). [3] Li Tan; Digital Signal Processing: Fundamentals and Application, Elsevier, 124～145, 2010. On the Control Equipment of Radiation CT using ATmega128 주체104(2015)년 1월 5일 원고접수 Ri Ki Song, Ri Chol Man We have designed and manufactured the computer interface control equipment of practical gamma ray CT by using ATmega128 processor. We have developed a control algorithm and the control program based on it. Key words: CT, ATmega128 － 70 －