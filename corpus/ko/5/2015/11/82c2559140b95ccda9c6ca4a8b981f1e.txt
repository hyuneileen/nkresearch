김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체104(2015)년 제61권 제11호 Vol. 61 No. 11  JUCHE104(2015). 정규화된 색공간과 푸리에변환특징량을 리용한 움직임검출방법 리원호, 리정환 움직임검출은 교통감시를 비롯한 동화상감시에서 많이 리용되고있는데 현재 세계적으 로 촬영기로부터 입력되는 동화상에서 움직이는 물체를 실시간적으로 자동검출하는 체계 를 개발하기 위한 연구사업이 활발히 진행되고있다. 움직임검출에서 가장 널리 리용되는 방법은 배경덜기법이다. 선행연구[1]에서는 배경을 가우스혼합모형으로 모형화하여 움직임검출을 진행하였다. 여기서는 화소의 특징량으로 RGB색성분을 리용하였으며 매 성분은 서로 독립이고 같은 분 산을 가진다고 보았다. 즉 이다. Σ 2 , σ= i , t i It 선행연구[1]에서 제기한 방법은 화소단위로 RGB색성분을 직접 쓰므로 촬영기잡음과 조 명변화에 불안정한 결함을 가지고있다. 또한 그림자를 제거하기도 힘들다. 선행연구[2]에서는 이러한 결함을 극복하기 위하여 특징량으로서 문양정보를 리용하였 다. 여기서는 문양정보를 반영하기 위하여 LBP특징량을 리용하였는데 이 특징량도 조명변 화에 불안정한 결함을 가지고있다. 선행연구[3]에서는 HSV색공간과 인공신경망을 리용한 배경덜기법으로 움직임검출을 진 행하였는데 이 방법도 화소준위의 특징량을 리용하였으므로 불안정하다. 론문에서는 이러한 결함들을 극복하기 위하여 화소준위에서의 정규화된 RGB색성분과 푸 리에변환곁수들에 의한 문양정보를 결합하여 안정한 움직임검출알고리듬을 제기하였다. １．움직임검출에 리용되는 특징량의 구성 론문에서는 움직이는 물체의 검출을 위하여 두가지 특징량을 리용한다. 구체적인 특징량구성은 다음과 같다. 먼저 어두운 부분에서의 불안정성을 제거하기 위하여 매 R, G, B통로에 대하여 다음 의 변환을 진행한다. ←′ 다음 색성분을 R ' ++← 게 얻어진 정규화된 RGB특징량 ' BGR m 1 ( 235 R / 255 + ,20 G 235 G / 255 + ,20 B ←′ m ,3/)' ← 2 , mmm=m 1 3 ( , 235 ←′ /' mG 1 / + 20 255 B 와 같이 정규화한다. 이렇 , /' mmR 1 3 을 쓰면 조명변화에 보다 안정해진다. ← ) 2 다음 RGB화상을 흑백색농담화상으로 변환하고 8×8블로크단위로 표준화한다. 그리고 2차원리산푸리에변환을 진행하고 푸리에곁수의 절대값들을 구한다. 여기서 얻 어진 8×8크기의 표에서 1행 1렬원소가 직류성분인데 이 표를 오른쪽으로 4칸, 아래로 4 칸 회전시켜 직류성분이 중심에 놓이게 한다. － 8 － 정규화된 색공간과 푸리에변환특징량을 리용한 움직임검출방법 ,1 (cid:34)=k 7, 에 대하여 k 가 들어있는 칸에 해당한 곁수들의 합을 해당 개수로 나눈 값 은 주파수별 ) f 을 구성한다. f f f , , , 1 2 3 을 kf 라고 하고 푸리에변환특징량 특성을, f , =f 은 방향별특성을 나타낸다. (cid:34) f 1 ( f f f f 2 , , , , 4 5 6 7 7 해당 8×8블로크의 매 화소에 다같이 이 푸리에변환특징벡토르를 할당한다. 이 푸리에변환곁수들은 절대값을 리용하므로 평행이동에 안정하며 문양정보를 반영하 므로 조명변화에 잘 견디며 그림자검출에도 유리하다. 즉 움직이는 물체의 그림자에서는 밝 기가 본래의 배경보다 훨씬 어두워지지만 문양은 같기때문에 문양정보를 리용하면 그림자 검출의 성능이 높아진다. ２．움직임검출알고리듬 다음으로 배경모형은 선행연구[1]에서와 같이 가우스혼합모형을 리용하였다. 즉 매 화 소에서 특징량의 출현확률이 ( XP ) = t ( ηω t i , X t , μ i , , t Σ i , t ) 에 따른다고 가정한다. 여기서 tX 는 t 시각에 해당 화소에서의 특징량으로서 정규화된 RGB성분과 푸리에변환특징량으로 구성된다. 즉 이고 ( ) , tX fm= t t K ∑ i 1 = ( η X , t , μ ) =Σ 1 2/ （ )2 π n | Σ 2/1 | ⎛ exp ⎜ ⎝ − 1 2 ( X t − ) μ T 1 − Σ ( X t − ) μ ⎞ ⎟ ⎠ 는 평균이 μ이고 공분산행렬이 Σ 인 가우스확률밀도함수이다. 그리고 K 는 혼합성분의 개 수이고 i,ω 는 매 성분의 무게이다. t 론문에서는 5=K 로 하고 그중 4개는 기본배경모형이고 나머지 1개는 예비모형으로 하 였다. 처음에는 매 화소에 유효한 모형이 1개인데 후에 점차 모형의 개수가 4개까지 증가 한다. 그리고 예비모형의 무게가 일정하게 증가하면 4개의 기본모형중에서 무게가 가장 작 은 모형을 교체한다. 배경모형을 표현하는 파라메터로서 ,1 (cid:34)=n 5, , i = ,1 (cid:34) , , jN = ,1 (cid:34) , M 일 때 다음의 행 j j i j j k k k n ), ), ), :) :7, (cid:34)= ,1 :3,2,1 :3,2,1 = 번째 모형에서 특징량 째 행, j 째 렬화소의 n 번째 모형에서 특징량 km 의 평균 째 행, j 째 렬화소의 n 번째 모형에서 특징량 kf 의 평균 i 번째 모형에서 특징량 km 의 분산 , 렬들을 보관한다. ,( imnk = ,( f nk i ,( i σ nk ,(4σ i n ,(ω in ,( iB ,( iC ,( iRn MN, 은 각각 화상의 행의 개수와 렬의 개수이다. 여기서 α 0 n 번째 모형의 무게 :) : 현재 유효한 모형의 개수 i 가 현재 프레임까지 련속적으로 예비모형으로 판정된 회수 : 화소 ,( (cid:34)= :4, ,1 ), n 번째 우선순위에 있는 모형의 번호 f (cid:34) 의 분산 1 7 그리고 무게턱값과 배경학습파라메터들을 각각 로 설정한다. 첫번째 프레임이 입력되였을 때 매 화소에 대하여 배경모형을 다음과 같이 초기화한다. 012.0 ,4.0 j ) ) 2.0 β 0 j j ,5 T = = = n n ) f j j , － 9 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제11호 ,( im k 1 ,( i j ) ← j ) ← j ), k = 3,2,1 j ), k (cid:34)= ,1 7, ,( im k 1 ,( i f 1 k ,20 σ 12 ,( i j ) ← ,15 σ 13 ,( i j ) ← ,15 σ 14 ,( i j ) ← 20 ,( i ) j ) ←j ) ←j ← 1  0 f 1 k σ 11 ,( iB ,( iC ,(1 iR ,(1 i ω j ) ← ,1 j ) ← ,0 n = j ) ← ,4/1 ,( i j ) ← ,0 n ,( iR n nω 4,3,2 (cid:34)= ,2 5, 두번째 프레임부터는 움직임검출을 진행하고 배경모형을 갱신한다. 1+t 번째 프레임에서 매 i 에서 움직임검출과 배경모형갱신알고리듬은 다음과 같다. ,( ) j 걸음 １ 우선순위가 높은 모형부터 탐색하면서 처음으로 s = 3 ∑ k 1 = w k ( im ,( k − imj ) ,( 2 σ nk nk j i ,( ) 2 j )) + w 4 7 ∑ ( 1 k = f k i ,( j ) − f i ,( nk 2 j )) 2 σ 4 n i ,( j ) < 16 인 모형번호 n 과 s 를 구한다. 여기서 kw 들은 매 특징량들의 비중을 조절하는 무게인데 ww + 2 이다. w 4 w 3 = + + 1 1 그런 n 이 있으면 걸음 2로 이행하고 없으면 걸음 9로 이행한다. 걸음 ２ 걸음 1에서 구한 n 을 0n 이라고 놓고 k 를 1부터 j ) iB ,( 까지 순환하면서 걸 음 3－6을 반복실행하고 걸음 7로 이행한다. j ) n iR ,( k← 걸음 ３ n = 이면 걸음 4로 이행하고 그렇지 않으면 걸음 5로 이행한다. 0n 걸음 ４ 이면 화소 이고 j <) T T in ,(ω i 를 전경화소로 설정하고 ,( ) j max 1 ,( iBk ≤≤ 다음과 같이 모형을 갱신한다. 4/ ,( ik ω > ) j − s ) j αα ← 0 e , − s 4/ e i ,( ββ ← 0 t )( ) ωα n t )( im ,( nk t )( nk ) β ) β i ,( f i ,( j ) 1( −← i ,( j ) 1( −← i ,( j ) 1( −← j ) + α m t )1( + ω n t )1( + nk t )1( + nk t )1( + nk σ f imj ) ,( + k j ), k = 3,2,1 j ) + f k i ,( j ), k = ,1 (cid:34) 7, 1( −← t )( [ βσβ nk + ) im ,( k mj ) − t )1( + nk i ,( j )] 2 , k = 3,2,1 t )1( + σ n 4 1( −← 7 ) t )( βσβ n 4 k + ∑ [ 1 = f k i ,( j ) − f t )1( + nk i ,( 2 j )] )1( t + ω n i ,( j ) 1( −← )( t ) ωα n i ,( j ) 와 같이 감소시킨다. 다음 걸음 6으로 이행한다. 걸음 ５ n 번째 모형의 무게만 2 ω n 3 2 ∑ σ nk k 1 = 걸음 ６ ← i ,( ) t j n 걸음 ７ nt 이 작아지는 순서로 모형번호를 다시 정렬하고 iRn ,( j ), n (cid:34)= ,1 , iB ,( j ) 에 대 입한다. － 10 － 정규화된 색공간과 푸리에변환특징량을 리용한 움직임검출방법 걸음 ８ 걸음 ９ iC ,( ←j ) max ,( iBk 1 ≤≤ ω ) j 이면 알고리듬을 완료한다. 0 이면 화소 ,( ik T > ) ) j j i 를 전경화소로 설정한다. ,( 걸음 １０ 이면 다음과 같이 새로운 모형을 구성하고 알고리듬을 끝내며 iB ,( =j ) 4 <j ) iB ,( 4 이면 걸음 11로 이행한다. j ) ← iB ,( iB ,( ) j 1) + j iB ,( n ← iR ,( n ω n im ,( nk i ,( f nk σ 1 n iC ,( j ) ← n j ) ← 4/1 im ,( k i ,( f i ,( i ,( j ) ← j ) ← k ,20 ω 5 im ,( 5 k i ,( f k 5 σ 51 iC ,( j ) ← j ) ← im ,( k i ,( f k ,20 i ,( j ) ← j ) ← 1 j ) ← j ), k = 3,2,1 j ), k = ,1 (cid:34) 7, 걸음 １１ =j ) 0 이면 다음과 같이 예비모형을 초기화하고 알고리듬을 끝내며 σ n 2 i ,( j ) ← ,15 σ n 3 i ,( j ) ← ,15 σ n 4 i ,( j ) ← 20 iC ,( >j ) 0 이면 걸음 12로 이행한다. ) 4/1 ← i ,( j j ), k = 3,2,1 j ), k = ,1 (cid:34) 7, σ 52 i ,( j ) ← ,15 σ i ,( 53 j ) ← ,15 σ 54 i ,( j ) ← 20 걸음 １２ 예비모형을 다음과 같이 갱신한다. iC ,( j ) ← iC ,( j 1) + t )1( + ω 5 t )1( + m k 5 t )1( + k 5 )1( t + σ 5 k f α 1/[1 +← exp( 75(1.0 − iC ,( j )))], ββ ← 0 e − s 4/ i ,( j ) 1( −← t )( ) ωα 5 i ,( j ) + α i ,( j ) 1( −← ) β imj ) ,( + k j ), k = 3,2,1 i ,( j ) 1( −← ) β j ) + f k i ,( j ), k = 3,2,1 1( −← )( t [ βσβ 5 k + ) im ,( k )1( t + mj ) − 5 k i ,( j )] 2 , k = 3,2,1 t )( im ,( k 5 t )( k 5 i ,( f )1( t + σ 4 n 1( −← 7 ) )( t βσβ 4 n k + ∑ [ 1 = f k i ,( j ) − f )1( t + nk i ,( 2 j )] 걸음 １３ >j ) 2.0 이면 4개의 기본모형중에서 무게가 가장 작은 모형을 예비모형 으로 교체하고 j ) 를 0으로 설정한다. ,(5 iω iC ,( 이상과 같이 매 프레임에서 움직임물체를 표현하는 2진화상을 얻은 다음 후처리에서 전 경물체에 있는 작은 구멍들과 배경에 있는 작은 전경물체들을 제거한다. 8×8블로크의 매 화소들이 같은 푸리에변환특징량을 리용하므로 이렇게 얻은 움직임 물체의 령역에서는 블로크효과가 나타난다. 그러므로 우에서 얻은 물체의 경계주변에서 정규화된 RGB특징량만 리용하여 움직임 검출을 다시한번 진행한다. 이렇게 하여 자연스러운 경계를 가진 전경물체를 얻는다. － 11 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제11호 Change Detection Challenge자료기지를 리용하여 선행방법과 우리의 방법을 비교한 결 과를 실지 전경령역과 거기서 전경으로 검출된 령역의 면적비는 표와 같다. 표．실지 전경령역과 거기서 전경으로 검출된 령역의 면적비 부분자료기지 Baseline Dynamic background Shadow 방법[1] 0.73 0.68 0.65 방법[2] 0.78 0.72 0.74 방법[3] 0.80 0.75 0.73 우리의 방법 0.89 0.81 0.79 참 고 문 헌 [1] C. Stauffer et al.; In IEEE Conf. Comp. Vision & Pattern Recognition, 2, 246, 1999. [2] Jian Yao et al.; IEEE the CVPR Visual Surveillance Workshop Minneapolis, 6, 238, 2007. [3] Y. Singh et al.; International Journal of Computer Science and Network Security, 10, 3, 136, 2010. 주체104(2015)년 7월 5일 원고접수 A Moving Object Detection Method using Normalized Color Space and Fourier Transform Features Ri Won Ho, Ri Jong Hwan Background subtraction is a method which is often used in motion detection. In the previous literatures, Gaussian mixture models based on pixel-wise color information were used. We combined pixel-based normalized RGB color space and Fourier transform features in using Gaussian mixture model, thus improved robustness to illumination changes and camera noise. Key words: motion detection, background subtraction － 12 －