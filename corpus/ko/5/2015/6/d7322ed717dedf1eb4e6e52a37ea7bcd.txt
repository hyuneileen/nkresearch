김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체104(2015)년 제61권 제6호 Vol. 61 No. 6  JUCHE104(2015). 색페트리망에서 위치색벡토르의 도달가능성 김현정, 한도욱 론문에서는 암호학적통신규약의 안전성해석을 비롯하여 여러 분야들에서 리용할수 있 는 색페트리망에서의 위치색벡토르의 도달가능성문제의 해석적표시를 새롭게 밝혔다. 선행연구[1]에서는 표적에 색을 가진 색페트리망을 정의하였고 선행연구[3]에서는 위 치에 색이 있는 경우에 색벡토르의 도달가능성문제를 론의하였으나 그 풀이법에 대한 엄 밀한 해석은 주지 못하였다. 또한 선행연구[2]에서는 체계의 고장진단을 위한 색페트리망 을 정의하고 한가지 고장진단방법을 제기하였다. 여기서는 위치와 통로에 색이 주어진 경우에 통로의 발화조건과 위치색의 변화조건을 새로 밝힌데 기초하여 색벡토르의 도달가능성에 대한 해석적표시를 구하였다. (cid:34) , 를 페트리망이라고 부른다. 여기서 정의 4원조 N = = ( 은 위치들의 유한모임, mt } , 0>m , ) OITP , , (cid:34)= ,{ 1 t T , p ,{ 1 은 통로들의 유한모임, P ∞→ P 는 매 통로를 위치들의 다중모임으로 넘기는 통로입력함수이고 TI : 통로를 위치들의 다중모임으로 넘기는 통로출력함수이다. 에서 임의의 Pp ∈ 와 Tt ∈ 에 대하여 tIp ( ,(# N = , )) ) ( , } , np φ=TP ∩ ∞→ P TO : 0>n 이다. 는 매 ,(# tOp ( )) 는 각각 tOtI ), ( )( , OITP , 에서의 위치 p 의 다중도이다.  pμμ = ( i 매 위치 ip 에 부아닌 옹근수 ( 1 = μμ i 리망의 상태벡토르 또는 상태,  iμ 를 ip 의 표적 혹은 돌이라고 부른다. 를 대응시키면 벡토르 ) , (cid:34) , nμ ) 을 페트 임의의 통로 t j ∈ 에 대하여 조건 T p i P ∈∀ μ, i ≥ (# p i , tI ( )) 가 성립되면 jt 는 발화가 j 능하다고 하며 jt 가 발화된 이후의 페트리망의 상태는 다음의 규칙에 따라 변화된다. p (# tOp ( , tI ( (# )) )) P + − , , p ∈∀ i =′ μμ i i i j 에 의하여 상태가 μ로부터 μ′ 로 변하면 μ′ 는 μ로부 i j 통로들의 발화렬 t (cid:34)=τ ( i 1 , , t ki ) 터 도달가능하다고 말한다. 그리고 페트리망 N 의 초기상태를 0μ 으로 표시한다. N 에 대하여 D − = − jD ,( ( i )) , − jD ,( i (#) = p i , tI ( j )) 를 N 의 입력행렬, D + = + jD ,( ( i )) , + jD ,( i (#) = tOp , ( i )) 를 N 의 출력행렬이라고 부른다. 이 두 행렬은 모두 nm × 형행렬이 다. 그리고 DD = 를 변환행렬이라고 부른다. j + − − D μ′ 가 μ로부터 도달가능하면 련립방정식 t (cid:34)=τ ( i 1 μ로부터 도달가능하게 하는 발화렬 , Dx ×+=′ μμ 에 통로 , ) t 가 성립된다. 여기서 x 는 μ′ 가 jit 가 나타나는 회수 즉 발화회 ki 수를 j 째 성분으로 가지는 m 차원벡토르로서 발화회수벡토르라고 부른다. 이제 페트리망 N = ( OITP , , , ) 가 주어졌을 때 넘기기 TPC →∪: Z 를 보충한 망 N = ( OICTP , , , , ) 를 생각하고 그것을 색페트리망이라고 부른다. 여기서 pCPp ∈∀ , ( ) 는 위 － 15 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제6호 치색, tCTt ∈∀ , )( 벡토르 =δ 는 통로색이라고 부른다.  (cid:34) pC ( ( 1 npC ( pC ( , )) ), ), 2 , =γ 통로색벡토르라고 부른다. tC ( ( 1 ), tC ( 2 ), (cid:34) , mtC ( )) 을 각각 위치색벡토르, 그러면 임의의 상태 μ에 위치색벡토르가 일의적으로 대응된다. 색페트리망에서의 통로의 발화조건은 위치색과 통로색의 영향을 받으며 통로의 발화 후에 위치색이나 통로색들이 변하는 경우와 변하지 않는 경우로 갈라진다. 여기서는 임의 의 위치 t j ∈ 에 대하여 통 pi ∈ 에 대하여 pi ∈ 에 대하여 위치색은 어떤 옹근수로 표현되고 임의의 통로 이라고 가정한다. 또한 페트리망의 매 위치 ∈jtC ( pμ pC ) ( ( i i 통로의 발화조건은 로색은 0 ⇔≠ ,1{) }1 P P T − ≠ 0 ) )) , 이 성립된다고 가정한다. tI ( μ, p i i =ipC i P p ∈∀ tI ( j p ∈∀ i (# , , ≥ 0 ) ( ) , j p ∈∀ k p ∈∀ i tO ( j ) , ) tI ( j pC ( , k ( ) ≠ipC tC ( ) = 0 으로 놓고 jt 가 발 로 변하며 통 pC ( × ) ) j i 화한 다음에 위치색은 로색은 변하지 않는다고 가정한다. 상태의 도달가능성을 정의한것과 류사하게 위치색벡토르 δ 가 어떤 발화렬의 발화후 에 δ′ 로 변하였다면 δ′ 는 δ로부터 도달가능하다고 말한다. 문제는 주어진 δ가 초기위치색벡토르 0δ 으로부터 도달가능한가를 판정하는것이다.  nm × 형행렬들을 보자.  이를 위하여 각각 색입력행렬, 색출력행렬이라고 부르는 다음의 tOp ( ∈ ∈ i tOp ( ∉ + jE ,( − jE ,( − jE ,( − = tI ( tI ( p i , ∉ )) E = = p ( ) ) ) ) ) ) i i i j j E i j i ⎞ ⎟ ⎟ ⎠ i ( )) + = + jE ,( ⎛ ⎜ ⎜ ⎝ t j ∈ 에 대하여 T ,1 ⎧ ⎨ ,0 ⎩ , | ⎞ ⎟ ⎟ ⎠ 이라고 j 보조정리 N = 에서 임의의 | ≤jtI ( 1|) ≤jtO 1|) ( ⎛ ⎜ ⎜ ⎝ OICTP ( ,1 ⎧ ⎨ ,0 ⎩ , , , , ) 할 때 δ 가 발화렬 t (cid:34)=τ ( i 1 , , t ki ) 의 발화에 의하여 0δ 으로부터 도달가능하면 관계식 0 ( δ − 0 ( δ − 0 = δδ 0 ( δ , , , , j ) ) ) ) − = − F F i 1 i 2 () ⋅ 며 Eje )(( (cid:34) −− 0 δ F 0 ( F δ )( je 는 j 째 성분만 1이고 나머지 성분들은 모두 0인 m 차원벡토르이다. 증명 통로 jt 가 발화한 결과에 0δ 으로부터 위치색벡토르 δ가 도달되였다고 하면  0 + = δδ 가 성립된다. 여기서 0 δ ki Eje )(( + EjejC )()( ( EjejC )()( ( ,1{)( ∈jC Eje )(( Eje )(( Eje )(( Eje )(( Eje )(( Eje )(( Eje )(( Eje )(( 0 ( δ − + 0 δ 0 δ 0 δ 0 δ 0 δ () ⋅ () ⋅ () ⋅ () ⋅ () ⋅ }1 )) )) )) )) )) )) F − = + − − − . − + + − − + + − , 은 고정된 상수이 j ) 가 성립된다. 여기서 F 0 ( δ , j ) = Eje )(( 임을 고려하면 웃식은 − − 0 δ () ⋅ Eje )(( 0 δδ = )) ( 0 F δ − , 한 제한조건 | ≤jtI ( 1|) , | ≤jtO 1|) ( 과 + Eje )(( + () ⋅ 0 δ Eje )(( )) − EjejC )()( ( + + () ⋅ 0 δ Eje )(( − )) j 로 표시된다. 이것은 론문에서 제기한 페트리망에 대 ) − E E , 의 정의를 고려하면 곧 나온다. + 이것을 일반화하여 δ 가 통로들의 =τ t (cid:34) ( , i 1 , t ki 의 발화에 의하여 0δ 으로부터 도달 ) 되였다고 하면 0 δδ = 정리 색페트리망 0 ( δ − , ) F i 1 OICTPN = , ) ,( F − , , , 0 ( δ 0 ( δ 2 ) − − (cid:34) i F ) 에서 임의의 통로 ki , 가 성립된다.(증명끝) t j ∈ 에 대하여 p i (# T , tI ( )) ≤j 1 , (# tOP ( i , )) ≤j 1 이라고 가정하고 위치색벡토르 δ 가 초기위치색벡토르 0δ 으로부터 도달가 능하다면 다음의 련립방정식이 만족된다. － 16 － 색페트리망에서 위치색벡토르의 도달가능성 0 ⎧ =′ μμ ⎪⎪ 0 = δδ ⎨ ⎪ ⎪ ⎩ ,0 ≥ x ×+ Dx 옹근수 − F 0 ( δ , − F 0 ( δ , i 1 ) i 2 ) − (cid:34) − F 0 , ( i kδ ) , F 0 ( δ 0 δ 여기서 상태 0μ 과 μ는 각각 위치색벡토르 0δ 과 δ에 대응하는 상태이다. EjejC )()( ( Eje )(( Eje )(( Eje )(( Eje )(( 0 δ 0 δ () ⋅ () ⋅ () ⋅ )) )) − + = ) − − + + + j Eje )(( − )) 증명 증명하려는 련립방정식의 의미를 따져보면 그것은 색페트리망에서 어떤 발화렬 τ 가 있어서 상태 μ가 초기상태 0μ 으로부터 도달가능하고 그때 대응하는 위치색벡토르 는 0δ 으로부터 δ에로 도달가능해야 한다는것을 의미한다. 그런데 상태 0μ 으로부터 μ에로의 도달가능성의 필요조건은 라는것이 이 미 증명되여있고 그때의 발화렬에 의하여 δ가 0δ 으로부터 도달가능하기 위한 필요조건은 0 ( δ + Dx ×+=′ μμ 0 ( δ − 0 ( δ − + (cid:34) i 1 F F F − − − ) ) , , + − F 0 ( δ , j ) = Eje )(( Eje )(( )) + Eje )(( () ⋅ Eje )(( )) − , , ) ki EjejC )()( ( 0 δδ = 0 − δ () ⋅ () ⋅ 0 δ Eje )(( )) i 2 0 δ 라는것이 앞의 보조정리에서 증명되였다. 따라서 정리는 증명되였다.(증명끝) 한가지 응용실례로서 DH열쇠공유규약의 안전성판정문제를 보기로 한다. DH열쇠공유규약은 다음과 같다. 송신자 A 와 B 는 씨수 p 를 선택하고 pZ 에서의 생성원소 g 를 선택하여 공유한다. 송신자 A 는 pZx ∈ 를 비밀로 선택하고 Y A mod p 를 계산하여 B 에게로 보낸다. 수신자 B 는 A 와 B 는 각각 열쇠 pZy ∈ 를 비밀로 선택하고 x B mod Yk = , p Yk = Y B y A mod mod p 를 계산하여 A 에게로 보낸다. p 를 계산하여 열쇠를 공유한다. DH열쇠공유규약에 대한 공격은 다음과 같다. ① 공격자 E 는 A 와 B 사이에 교환되는 AY 와 BY 를 전송도중에 절취하여 AY 를 AY ′ 로, x = g y = g BY 를 BY ′ 로 바꾸어서 B 와 A 에게 전송한다. ② A 와 B 는 BY ′ 와 AY ′ 에 의하여 열쇠를 공유한다. DH열쇠공유규약에 대한 공격과정을 페트리망으로 모형화하면 그림과 같다. 그림. 공격과정에 대한 페트리망의 모형화 여기서 론의하는 위치는 p = , p = , i i 9 3 10 c 3 , 4 p = 1 p = 11 a 1 c p = 8 2 4t =발송 2, 5t =접수 2, 6t =발송 3, 7t =절취 2, 8t =수정 2, 9t =발송 4, 10t =접수 1이다. 4 , , , p = 3 , p = 2 p = 이며 통로는 =1t 발송 1, 2t =절취 1, 3t =수정 1, 12 p = 7 p = 4 p = 6 p = 5 c 1 a b 2 b 1 , , , , i 1 c i 2 2 － 17 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제6호 위치색모임은 MC { = MM , 1 모든 통로들은 색이 1이다. 여기서 BYM =2 은 아무런 정보도 도달되지 않았다는것을 의미한다. M − 2 2 AYM =1 }0, , − 1 , , 초기위치색벡토르는 이고 통로색은 , ′= AYM − 1 ( 3tC , ) = ) −=tC ( 8 1 ′= BYM − 2 이고 나머지 를 의미하며 0 0 M=δ ( ,0,0,0,0,0, 1 M 2 )0,0,0,0,0, 이며 이것은 A 와 B 가 각각 값 AY 와 BY 를 계산하여 발송준비단계에 있다는것을 의미 한다. 그리고 위치색벡토르  =δ M 1 는 AY 와 BY 가 전송도중에 공격자에 의하여 AY ′ 와 BY ′ 로 변경되여 B 와 A 에게 전달되였 다는것을 의미한다. ,0,0,0,0,0, ,0,0,0,0,0( M − − ) 2 따라서 δ가 0δ 으로부터 도달가능하다면 주어진 열쇠공유규약은 안전하지 못한것으로 )0,0,0,0,0,1,0,0,0,0,0,1( 이며 δ에 대응되는 상 이것을 론문에서 밝힌 조건에 의하여 계산하면 옹근수풀이가 존재하고 따라서 불안전 된다. 0δ 에 대응되는 초기상태는 )1,0,0,0,0,0,1,0,0,0,0,0(=μ 0 =μ 태는 이다. 상태에 도달할수 있다는 결론을 얻는다. 따라서 DH열쇠공유규약은 안전하지 못하다. 참 고 문 헌 [1] 박경철 등; 페트리망체계의 기본, 공업출판사, 36～37, 1994. [2] P. Pawlewski et al.; Applications, In-Tech, 333～350, 2010. [3] Long Shi Gong et al.; 计算机仿真, 22, 6, 2005. 주체104(2015)년 2월 5일 원고접수 Investigation for Reachability of Place Color Vector on the Colored Petri Net Kim Hyon Jong, Han To Uk The colored Petri net are used in determining security of cryptographycal protocols. We construct the analytical notation for reachability of place color vector on the colored Petri net.   Key word: place color vector － 18 －