김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체104(2015)년 제61권 제7호 Vol. 61 No. 7  JUCHE104(2015). 프레임에 의한 한가지 화상손상회복알고리듬 김 종 철 손상회복문제는 화상에서 화소자료들중의 일부가 없어지거나 다른것에 의하여 가리 워진 경우에 일어난다. 손상회복의 과제는 그러한 불완전한 관측자료로부터 잃어진 령역을 회복하는것이다. 화상을 그 화상의 렬들을 련속적으로 련결하여 얻어지는 NR 의 벡토르로 표시하자. 원시화상 f 가 령역 우에서 정의되고 비지 않은 부분모임 Ω⊂Λ N(cid:34) , ,2,1{ =Ω } 를 주어진 관측령역이라고 하면 관측된 불완전한 화상 g 는 다음과 같다. g i )( = i )( f ih ),( i i  ,)( + Λ∈ ε i     \ ΛΩ∈ ⎧ ⎨ ⎩ (1) 여기서 )(iε 는 잡음항이고 )(ih 는 0부터 255사이의 임의의 값을 취할수 있다. 그렇지 않으면 모든 0 이면 Λ∈i 에 대하여 목적은 g 로부터 원시화상 f 를 회복하는것이다. 모든 )( =iε Λ∈i 에 대하여 )( i g |)( i ΛP 는 Λ 에 있는 첨수에 대응되는 대각선원소는 1이고 기타는 0인 N 차대각선행렬이 NK × 형행렬 A 는 한계가 1인 엄격한 프레임분해행렬이며 λT 는 유연턱값연산자로서 ), = 이며 이때 f 는 보간문제의 풀이로 된다. 를 만족시키는 풀이 f 를 구한다. (2) )( i f i )( T )] ε≤ − g T )] (cid:34) (cid:34) i )( ([ ), T ≡ f , , , | , ββ 2 1 λ β K t [ λ 1 ( β 1 t λ 2 ( β 2 t λ K ( β K 고 라고 하자. 여기서 i , , , 1 ) ( ≡ K λ (cid:34) =λ ,0 i >λ i (cid:34)= ,1 ( t βλ i )이고 [ , λλ 2 T K ] | | − > λβλββ i i i          | ≤ λβ i 선행연구[1]에서는 이에 기초하여 다음의 화상손상회복반복알고리듬을 제기하였다. i) 초기근사를 0f 으로 놓는다. ii) nf 이 수렴할 때까지 n 에 관하여 반복한다. ) f ATAPI .            (3) (4) )(| i sgn( ⎧ ⎨ ,0 ⎩ | ), | − ) ( ( ∗ i i i tλ 은 유연턱값함수로서 )(⋅ Λ λ n + iii) 걸음 ii)의 출력을 ∗f 이라고 하자. P Λ = 1 + g f n 식 (1)에서 모든 Λ∈i 에 대하여 )( =iε 0 잡음을 제거할수 있기때문에 손상회복＋잡음제거문제의 풀이를 이면 ∗f 을 풀이로 놓고 그렇지 않으면 λT 가 ° = 로 놓는다. ) f ∗ ∗ λ ATA f ( 알고리듬은 효과적이며 선행연구[2, 3]에서의 변분방법과 비교할 때 PSNR를 2～3dB 개선하였다. 또한 선행연구[1]에서는 이 알고리듬을 어떤 범함수를 최소화하는 반복법으 로 해석하여 그 수렴성을 증명하였다. 론문에서는 식 (2), (3)으로 정의되는 턱값연산자 λT 를 보다 일반화한 경우에도 우의 알고리듬이 수렴한다는것을 밝혔다. － 7 － 종합대학학보(자연과학)   주체104(2015)년  제61권  제7호 １．일반화된 손상회복알고리듬과 교대방향최소화문제로의 변환 다음의 가정들을 만족시키는 아래와 같은 가법적성김성벌칙함수를 도입하자. Ψ βλ ( ) = ( βψλ i i ) (5) K ∑ 1 i = = ′ ψ + lim 0 +→ 을 들수 있다. t 가정 １ ψ는 R 에서 ( −∞ , ∞+ ] 로의 순수하고 불룩이고 하반련속이며 인 함 가 비지 않으면 f 는 순수하다고 )0( =ψ 0 수이다. 여기서 실값함수 f 의 정의역 { x ∈ fR : x )( } +∞< 말한다. 가정 ２ ψ는 짝대칭이고 부가 아니며 가정 ３ ψ는 ,0( ,0[ ∞+ 에서 비감소한다. ) ) ∞+ 에서 미분가능하며 0에서 정의오른쪽도수를 가진다. 즉  > )/)( t t )0( ( ψ . 0 p | , ( 1 p ≥ | = ) i ββψ i 실례로 이 조건밑에서 매 ψλi 에 대하여 꼭 하나의 련속이고 홀대칭인 린근연산자 ′ ,0      | ≤ ψλβ ⎧ + ⎨ ′ ′ ( ), | > ψλβαψλβ ⎩ i + 이 존재한다. 여기서 iα 는 iβ 와 동일한 부호를 가진다는것을 고려하여야 한다. − )0( )0( x ψλ i pro ( β i α i | | = = ) i i i i i i (6) i i i | | ( = ) βλβψλ i 인 경우 식 (3)에서의 t βλ ( i 의 모든 가정을 만족시키므로 식 (4)에서 λT 를  (cid:34) , pro[ T )] ([ ), T ≡ , i , ββ 2 1 β K x ψλ 1 ( β 1 λ ) 는 t λ i ( β i ) = pro x ψλ i ( β i ) 로 되고 | | ⋅ 은 우 pro x ψλ 2 ( β 2 ), (cid:34) , pro x ψλ K ( β K T )] (7) 로 리용하는 경우 λT 는 종전보다 일반적인 턱값연산자로 된다.  우리는 식 (2)대신에 식 (7)로 정의된 턱값연산자를 리용한다. 이때 알고리듬에서 식 (4)가 어떤 교대방향최소화절차와 동등하다는것을 밝히자. 린근연산자의 정의와 식 (5)의 분리가능성으로부터 식 (7)에 의하여 정의된 턱값연산 자 λT 는 다음의 식을 만족시킨다. = T β ) ( λ 다음으로 벡토르들의 모임 C y { ∈= ,0[ ]255 PN : y Λ = P Λ g } 에 대하여 론의하자. arg {||min ∈ K Rα αβ − || 2 2 2/ Ψ+ λ α )}( (8) )( xCP 으로 정의될수 있다. x − 2 2y || }2/ 로 표시하면 그것은 제한이 있는 최량화문제 모임 C 는 분명히 불룩이다. 벡토르 x 의 C 우에로의 사영을 의 최소점 = P C x )( arg {||min Cy ∈ 보조정리 １ 사영 i) ii) )( P xC P x )( C = arg {||min y x − y || 2 2 는 다음과 같은 두가지 형태로 된다. )( xCP ) PI x  − Λ = P Λ g + ( 2/ + i C ( y )} 이다. 여기서 Ci 는 C 의 지적자함수로서 )(i yC ≡ ,0     Cy ∈ ⎧ ⎨  , Cy ∞+ ∉ ⎩ － 8 － .             (9) 프레임에 의한 한가지 화상손상회복알고리듬 이제는 우의 결과들을 리용하여 알고리듬에서 식 (4)를 다시 쓰자.  식 (8)에 의하여 이다. α )}( Ψ+ arg 2/ A f α α ≡ = − || ) n AT ( f λ n 2 2 n λ {||min α nα 의 정의를 식 (4)에 대입하고 보조정리 1을 리용하면  ∗ API α α Λ ∗ ( AP C arg ∗ A P Λ α − = + = = 1 + g f ) ( ) n n n n − f || 2 2 2/ + i C ( f )} 이므로 프레임에 기초한 손상회복알고리듬 (4)는 주파수－공간교대최소화문제 A f n − α || 2 2 2/ Ψ+ ( α )}, f n 1 + = arg ∗ A α n − f || 2 2 2/ + i C ( f )} (10) α n = arg {||min α 로 정의될수 있다. {||min f {||min f ２．알고리듬의 수렴성 여기서는 식 (10)에서 렬 먼저 lim n ∞→ ∗ f n ≡ f 이 존재하며 그것이 { nf 과 } { nα 이 둘다 수렴한다는것을 증명한다. } {min Cf ∈ {||min α A f − α || 2 2 2/ Ψ+ α })}( (11) λ 의 최소점이라는것을 밝히자. , ( ] −∞ ∞+ 린근연산자는 로 정의되고 그 최소값은 에서 값을 취하는 임의의 불룩이며 하반련속인 함수 ϕ 에 대하여 그것의 pro x ϕ x )( ≡ arg x − y || 2 2 {||min y 2/ + ( ϕ y )} (12) 1 ϕ x )( ≡ {||min y x − y || 2 2 2/ + ( ϕ y )} (13) 이며 함수 )(1 xϕ 는 불룩이고 미분가능하며 그것의 그라디엔트는 다음과 같다. 정리 １[4] 최소화문제 F ({min 1 f ) + F 2 ( f )} 를 보자. 여기서 1F 은 ( −∞ , ∞+ ] 에서 값을 ∇ (1 ( ϕ x )) x −= pro x ϕ x )( (14) 취하는 순수하고 하반련속인 불룩함수이며 2F 는 값구역이 R 인 순수하고 불룩이고 미분 가능하며 −b/1 리프쉬츠련속인 그라디엔트를 가지는 함수이다.  2/1>b 의 최소점이 존재하고 이라고 가정하자. 최소화문제 )} + ) f f ( ({min F 1 f f F 2 이때 임의의 초기점 0f 에 대하여 반복법 F 1 의 최소점에로 수렴한다. n f =+ 1 pro x 은 ( ( ) f f + F 2 F 1 이 정리를 적용하기 위하여 ) C 식 (9)와 식 (13)에 의하여 다음의 식이 성립된다. λ ({min F 1 f ) + F 2 ( f )} = 1 (cid:68)ξ {(min Cf ∈ A )( f )} = 1 {(min Cf ∈ Ψ λ ( A f ))} = ( f n ∇− F 2 ( f n )) (15) ) Ψ≡ξ β ( ( β ), F 1 ( f ) ≡ i ( f ) , F 2 ( f ) 1 (cid:68)ξ≡ ( A )( f ) 로 정의하자. min Cf ∈ min α ⎧ ⎨ ⎩ 1 2 ⎧ ⎨ ⎩ || A αf − || 2 2 Ψ+ λ )( α ⎫ ⎫ ⎬ ⎬ ⎭ ⎭ (16) － 9 － f 종합대학학보(자연과학)   주체104(2015)년  제61권  제7호 이것은 바로 최소화문제 (11)이다. 식 (10)에 식 (12)를 대입하고 ∗ ∗ ( ( Ax Ax i i C C pro pro pro α = = + 1 f ) n n =∗ IAA f ( Ax ξ 를 리용하면 알고리듬은 다음과 같이 된다.  (17) ∗ f ( AA pro pro ))) )) − = − f ( f ( Ax ξ n n n n x i C 한편 식 (14)에 의하여 ∇ F 2 ( f ) ∇= 1 ( ξ (cid:68) A )( f ) = ∗ AA ( f − pro Ax ( f ξ )) 이므로 식 (17)은 식 (15)와 같다. 따라서 식 (4)와 동등한 식 (17)이 식 (11)의 최소점에로 수렴한다는것을 보 여주기 위해서는 정리 1에서의 조건들이 성립된다는것을 밝히면 된다. 보조정리 ２ 값구역이 ( −∞ , 인 함수 Ci 와 값구역이 R 에 있는 A(cid:68)ξ1 는 순수하고 불룩이며 하반련속이다. 그리고 는 미분가능하며 1－리프쉬츠련속인 그라디엔트를 ] ∞+ A(cid:68)ξ1 가진다. 하나의 최소점을 가진다. 보조정리 ３ A 를 한계가 1인 엄격한 프레임이라고 하면 최소화문제 (11)은 적어도 정리 ２ A 를 한계가 1인 엄격한 프레임이라고 하자. 이때 알고리듬에서 반복식 (4)는 임의의 초기점 0f 에 대하여 최소화문제 (11)의 최소 점에로 수렴한다. 다음으로 nα 의 수렴성에 대하여 론의하자. 여기서는 렬 ({} AT f λ ∗ AP ( Λ 의 극한 (||2/ + ° ≡ P Λ { α )} α ≡ α − 2 2 g || ) I n n ( λ AT f ∗ AA − ∗ ) ) α 이 2 2 || {||min α 의 최소점이라는것을 보여준다. 2/ Ψ+ λ α )}( (18) 식 (12)와 (17)에 의하여 식 (10)에서 nα 에 대한 반복은 다음과 같이 쓸수 있다. = pro pro pro )] α α = ) Ax f ( ξ n 1 + [ Ax ξ ∗ Ax ( i C n n 1 + 식 (17)과 (4)에 의하여 pro ∗ ( Ax i C α n ) = f n 1 + = gP Λ + ( ∗ API Λ − ) α n 이고 α n 1 + = pro [ x ξ ∗ APIAgAP ( − + ) α Λ Λ ] = pro x [ ξ α n n − (( I − AA ∗ ) α n + AP Λ ( P 2 Λ = P Λ ∗ AP Λ α − n 이므로 gP Λ ))] . ( I ∗ − AA ) 은 ∗A 의 핵우에로의 직교사영연산자이므로 ( I − 2 ) = − ∗ AA ) 이다. 따라서 α n 1 + = pro [ x ξ α n ∇− ||( ∗ AP Λ α n − P Λ g || 2 2 (||2/ + I − ) α n || )]2/ . ∗ AA ∗ AA ( I 2 2 F 3 )( α ≡ ( ξ α ), F 4 )( α || ≡ ∗ AP Λ α − P Λ g || 2 2 (||2/ + I − ∗ AA ) α || 2 2 2/ 이라고 놓으면 웃식은 반복도 식 (15)의 형태로 된다. 즉 n 정리 1을 적용하기 위해 3F 과 4F 가 정리 1에서 1F 과 2F 에 대한 조건들을 만족시키 F 3 n n α =+ 1 pro x ( α ∇− F 4 ( α )) .           (19) 는가를 검증하자. 보조정리 ４ 함수 ( −∞ , ∞+ ] 에서 값구역을 가지고 순수하고 불룩이며 하반련 속이고 함수 || ∗ AP Λ α − (||2/ + I − ∗ AA ) α || 2 2 2/ 은 값구역이 R 인 순수하고 불룩이며 미 )(αξ 는 2 2 P Λ g || 분가능하다고 하면 그것의 그라디엔트는 1－리프쉬츠련속이다. 증명 ξ는 정의로부터 값구역이 R 에 있고 불룩이며 하반련속이다. 두번째 함수는 α 의 어떤 아핀변환에 대한 노름이므로 그것은 순수하고 불룩이며 R 에 서 값을 취하는 련속인 함수이다. 더우기 그것의 노름이 미분가능하므로 그 함수 역시 미분 － 10 － 프레임에 의한 한가지 화상손상회복알고리듬 가능하다. 산할수 있다. ∗ AP ∇ Λ [|| || 그리디엔트의 1－리프쉬츠련속성은 직접 계산에 의해 알수 있다. 즉 다음과 같이 계 α − P Λ g || 2 2 (||2/ + I − ∗ AA ) α || 2 2 ]2/ − || ∗ AP Λ g || 2 2 (||2/ + I − ∗ AA ) α ′ || 2 2 ||2/ = 2 = [(|| I − ∗ AA ) α + AP Λ = (|| ∗ APIAI − − ( ) )( ( ∗ AP Λ ′− αα α − P Λ g )] − [( I − AP Λ ( ∗ AP Λ || ≤ ∗ APIAI − − ( ) Λ || 2 || αα ≤′− || || 2 g ||)] = 2 α −′ P Λ ′− αα || 2 α −′ ∗ AA ) α P Λ +′ 마지막부등식은 ( APIAI ) ( 이 자기공액이므로 ∗ APIAI − − ) ( || Λ || 2 = ∗ APIAI − − ) ( αα ,) Λ | => 2 1| <− ( ∗ API Λ − ) α , ∗ A α | => 2 ||) ∗ 2 ) Λ − Λ− | ( < sup α || || 1 = 2 1| <− ( ∗ API Λ − ) α (, API Λ − ) ∗ α | => 2 (||1| − ∗ API Λ − ) α || 2 2 | = sup α || || 1 = 2 sup α || || 1 = 2 sup α || || 1 = 2 ∗ 2 2 2 2 2 2 ∗ API Λ ) 2 2 이고 ) || || || || − ≤ − ≤ α α (|| PI − Λ API Λ 이다.(증명끝) (|| (|| 이제는 nα 이 최소화문제 (18)의 최소점에로 수렴한다는것을 증명할수 있다. 정리 ３ 식 (4)에서 이라고 하자. 이때 nα 은 임의의 초기점 0α 에 대하여 최소화문제 (18)의 최소점에로 수렴한다. 증명 정리 2에 의하여 렬 f AT ( f AT ( λ= || = ||) α α α α } || || || || || ) n n { nf 은 수렴하므로 λT 의 련속성으로부터 렬 F ( 4 { nα 의 극한 (cid:68)α 은 ∇− pro xF α α = } ( (cid:68) (cid:68) n (cid:68) λ= )) α 도 수렴한다. 또한 식 (19)에 의하여 ∗ A 2 2 2 2 2 2 ) n 을 만족 3 F 3 α )( + F 4 α )}( 의 최소점이며 따 시킨다. 이것과 보조정리 4, 정리 1로부터 극한 (cid:68)α 은 {min α 라서 그것은 최소화문제 (18)의 최소점으로 된다.(증명끝) 참 고 문 헌 [1] Cai Jian Feng et al.; Appl. Comput. Harmon. Anal., 24, 131, 2008. [2] T. Chan et al.; J. Visual Commun. Image Represent, 12, 436, 2001. [3] T. Chan et al.; SIAM J. Appl. Math., 62, 1019, 2001. [4] P. L. Combettes et al.; Multiscale Model. Simul., 4, 1168, 2005. A Frame-based Image Inpainting Algorithm 주체104(2015)년 3월 5일 원고접수 Kim Jong Chol Image inpainting is a fundamental problem in image processing and has many applications. In this paper we generalize a previous algorithm for image inpainting based on framelets and analyse it as an iteration for minimizing a special functions to prove convergence of the algorithm. The proof of the convergence is under the framework of convex analysis and optimization theory. Key words: tight frame, inpainting, convex analysis － 11 －