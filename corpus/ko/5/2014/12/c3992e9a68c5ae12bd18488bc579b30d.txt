김일성종합대학학보 (자연과학) JOURNAL OF KIM IL SUNG UNIVERSITY (NATURAL SCIENCE) 주체103(2014)년 제60권 제12호 Vol. 60 No. 12  JUCHE103(2014). 내부상태예측공격에 안전한 통보문인증부호구성의 한가지 방법 박 진 국 위대한 령도자 동지께서는 다음과 같이 교시하시였다. 《기초과학부문들을 발전시켜야 나라의 과학기술수준을 빨리 높일수 있고 인민경제 여 러 분야에서 나서는 과학기술적문제들을 원만히 풀수 있으며 과학기술을 주체성있게 발전 시켜나갈수 있습니다.》(《선집》 증보판 제10권 485페지) 론문에서는 정보보안의 중요한 수단의 하나로 되고있는 통보문인증부호(MAC)의 한가 지 구성방법을 연구하였다. 선행연구[1]에서는 통보문인증부호에 대한 내부상태예측공격방법과 그 효과성을 론의 하였으나 그 공격에 안전한 통보문인증부호의 구성방안에 대하여 제기하지 못하였다. 론문에서는 선행연구[1]에서 제안된 공격방법에 견딜수 있는 한가지 새로운 통보문인 증부호를 비밀열쇠암호 AES와 4단 AES를 리용하여 구성하고 그 효과성을 검증하였다. １．제안한 통보문인증부호(MAC)알고리듬 여기서 제기한 통보문인증부호는 임의의 길이의 통보문을 입력하면 128bit의 통보문을 출력한다. 만일 입력통보의 길이가 128bit의 배수로 되지 않는다면 통보문의 첫 비트는 1이 고 128의 배수로 되는 최소의 비트수만큼 0을 붙여서 얻은 렬을 통보문에 보충하여 통보 문을 확장한다. 이때 확장된 통보문을 으로 표시한다. 여기서 iX 는 128bit X mX X 1 2 , , , L 이다. 제안한 통보문인증부호알고리듬은 다음과 같다. ① E k ⊕ )0( X 1 Y 0 = 여기서 E는 AES암호화함수이고 k는 비밀열쇠이며 ⊕는 XOR연산이다. 로 하고 1Y 을 구한다. 즉 E Yf ( 0 = =′ ) ( YYHY 1 1 0 ⊕⊕ X 1 =′ Y 0 ( EF ② )0( )0( 2 , ⊕ ⊕ ⊕ 1( )) X X + a ( ) ( 0 k k k ) EG kk 1 ( α ⊕ aiE ( ⊕+ ) ) β k , kk i = iE ( k ⊕− )1 iE )( k , a + m 이며 F 는 ) . ⊕ X 1 2 L21 ++= 여기서 H , ( ) βα = G kki 4-AES암호화함수이다. ′ = YHY Y i i − − 1 1 k HE ( Trunc C = ④ ③ ( ( , i i )) m ) = YG i kk i ( − 1 ⊕ iE ( k ⊕+ ))1 ( YF ( i − 1 ) ⊕ X ) i 여기서 Trunc(·) 는 끝을 자르는 함수이다. 제기한 통보문인증부호구성도는 그림 1과 같다. － 32 － 내부상태예측공격에 안전한 통보문인증부호구성의 한가지 방법 그림 1. 한가지 통보문인증부호구성도 ２．선행한 방법과 비교 선행연구[2]에서는 통보문의 2, 3, 4, 7, 8, 9, 13, 14번째 Byte들의 값들을 동일하게 취 할 때 1Y , 1Y ′ 가 오직 1개의 B만큼 차이나는 통보문쌍의 존재성을 밝히고 그에 기초하여 충 돌쌍을 생일공격을 리용하여 찾을수 있는 방 법을 제기하였다. 여기서 제기한 MAC는 1X , 1X ′ 가 주어진 경우로서 그 128bit통보문 그림 2. 선행한 방법의 MAC구성도 도식은 그림 2와 같다. 론문에서 새롭게 제안한 MAC는 그림 3과 같다. 그림 2와 3으로부터 알수 있는바와 같이 선 행연구[2]에서는 MAC값  C 에  대하여 어떤 ′ 가 있어서 충돌이 생기는 경우를 Y 2 , Y 2 = Y 2 AES 인 ⊕ X 4r 2 Y ( ) 1 4r AES ) ⊕ Y ( 1 =′⊕+ X a ) ) AES 1 = Δ X 1 Y 1 X 2 ′− Y 1 X ′ 즉 Y 1, Y 1 4r =′ Y ( ) 1 ′⊕ X 2 를 리용하여 특수한 경 ′⊕ X 2 , 2 그림 3. 제기한 MAC구성도 4r AES 를 만족시키는 그런 ( E k 2 , X 우의 충돌통보문쌍을 얻을수 있다는것을 밝혔다. ′ 를 찾는 문제를 제기하고 2 ⊕+ ) a AES ⊕ 1( 1( X X E ) ( 1 k 4r 그러나 론문에서 제안한 MAC도식에서는 다음과 같이 결정된다. 4r AES ( E k 1( ⊕+ a ) YE ( k 0 ) ⊕ X ) ⊕ AES 1 ( E k 1( 4r AES Y ( 1 ) ⊕ AES =′ Y ( ) 1 4r 4r 2 X X k⊕′⊕ 2 ⊕+ YE a ) ( ) k 0 YE ( 0 =′⊕ X 1 , ) ) X 2 ⊕′⊕ X 2 YE ( k 0 ) 우의 식에서 보는바와 같이 론문에서 제기한 MAC는 선행연구[2]에서 리용한 공격방 )(⋅F 에서의 열쇠값은 k 와 kk 로서 서 와 같이 구성함으로써 원문 법에 비하여 안전하다. 특히 론문에서 리용한 로 다르다. 또한 론문에서는 kk 의 생성을 )(⋅G 와 ⊕− )1 kk = iE ( k i iE )( k 의 혼란과 확산을 크게 하였다. 선행연구에서 주목한 내부상태공격에 대응하여 비밀열쇠를 보조적으로 생성하는 방법 으로 극복하고 원문의 혼란과 확산을 크게 하였다. 맺 는 말 － 33 － 종합대학학보(자연과학)   주체103(2014)년  제60권  제12호 참 고 문 헌 [1] K. Mimenmatsu et al.; Mathematics and Computer Science, 2, 2, 226, 2006. [2] G. Yuval et al.; Cryptologia, 3, 187, 1999. 주체103(2014)년 8월 5일 원고접수 A Method on Secure Component of MAC for Internal State Recovery Attack Pak Jin Guk The previous study presented a method of internal state recovery for one MAC and proved its effectiveness. In this paper, internal state recovery attack observed in the previous study was overcome by making the sub-secret key from the main key, which enlarged confusion and expansion of the original message. Key words: MAC, birthday attack, internal state recovery － 34 －